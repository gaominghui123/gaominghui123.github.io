<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Jason</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-09-19T08:52:59.229Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>é«˜æ˜è¾‰</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Springæºç é˜…è¯»</title>
    <link href="http://example.com/2024/09/19/Spring%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    <id>http://example.com/2024/09/19/Spring%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/</id>
    <published>2024-09-19T08:41:13.000Z</published>
    <updated>2024-09-19T08:52:59.229Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å®¹å™¨ä¸-bean"><a href="#å®¹å™¨ä¸-bean" class="headerlink" title="å®¹å™¨ä¸ bean"></a>å®¹å™¨ä¸ bean</h2><h3 id="1-å®¹å™¨æ¥å£"><a href="#1-å®¹å™¨æ¥å£" class="headerlink" title="1) å®¹å™¨æ¥å£"></a>1) å®¹å™¨æ¥å£</h3><ul><li><p>BeanFactory æ¥å£ï¼Œå…¸å‹åŠŸèƒ½æœ‰ï¼š</p><ul><li>getBean</li></ul></li><li><p>ApplicationContext æ¥å£ï¼Œæ˜¯ BeanFactory çš„å­æ¥å£ã€‚å®ƒæ‰©å±•äº† BeanFactory æ¥å£çš„åŠŸèƒ½ï¼Œå¦‚ï¼š</p><ul><li>å›½é™…åŒ–</li><li>é€šé…ç¬¦æ–¹å¼è·å–ä¸€ç»„ Resource èµ„æº</li><li>æ•´åˆ Environment ç¯å¢ƒï¼ˆèƒ½é€šè¿‡å®ƒè·å–å„ç§æ¥æºçš„é…ç½®ä¿¡æ¯ï¼‰</li><li>äº‹ä»¶å‘å¸ƒä¸ç›‘å¬ï¼Œå®ç°ç»„ä»¶ä¹‹é—´çš„è§£è€¦</li></ul></li></ul><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬è¯¾ä¸Šè®²çš„ï¼Œéƒ½æ˜¯ BeanFactory æä¾›çš„åŸºæœ¬åŠŸèƒ½ï¼ŒApplicationContext ä¸­çš„æ‰©å±•åŠŸèƒ½éƒ½æ²¡æœ‰ç”¨åˆ°ã€‚</p><h4 id="æ¼”ç¤º1-BeanFactory-ä¸-ApplicationContext-çš„åŒºåˆ«"><a href="#æ¼”ç¤º1-BeanFactory-ä¸-ApplicationContext-çš„åŒºåˆ«" class="headerlink" title="æ¼”ç¤º1 - BeanFactory ä¸ ApplicationContext çš„åŒºåˆ«"></a>æ¼”ç¤º1 - BeanFactory ä¸ ApplicationContext çš„åŒºåˆ«</h4><h5 id="ä»£ç å‚è€ƒ"><a href="#ä»£ç å‚è€ƒ" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a01</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡"><a href="#æ”¶è·ğŸ’¡" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><p>é€šè¿‡è¿™ä¸ªç¤ºä¾‹ç»“åˆ debug æŸ¥çœ‹ ApplicationContext å¯¹è±¡çš„å†…éƒ¨ç»“æ„ï¼Œå­¦åˆ°ï¼š</p><ol><li><p>åˆ°åº•ä»€ä¹ˆæ˜¯ BeanFactory</p><ul><li>å®ƒæ˜¯ ApplicationContext çš„çˆ¶æ¥å£</li><li>å®ƒæ‰æ˜¯ Spring çš„æ ¸å¿ƒå®¹å™¨, ä¸»è¦çš„ ApplicationContext å®ç°éƒ½ã€ç»„åˆã€‘äº†å®ƒçš„åŠŸèƒ½ï¼Œã€ç»„åˆã€‘æ˜¯æŒ‡ ApplicationContext çš„ä¸€ä¸ªé‡è¦æˆå‘˜å˜é‡å°±æ˜¯ BeanFactory</li></ul></li><li><p>BeanFactory èƒ½å¹²ç‚¹å•¥</p><ul><li>è¡¨é¢ä¸Šåªæœ‰ getBean</li><li>å®é™…ä¸Šæ§åˆ¶åè½¬ã€åŸºæœ¬çš„ä¾èµ–æ³¨å…¥ã€ç›´è‡³ Bean çš„ç”Ÿå‘½å‘¨æœŸçš„å„ç§åŠŸèƒ½ï¼Œéƒ½ç”±å®ƒçš„å®ç°ç±»æä¾›</li><li>ä¾‹å­ä¸­é€šè¿‡åå°„æŸ¥çœ‹äº†å®ƒçš„æˆå‘˜å˜é‡ singletonObjectsï¼Œå†…éƒ¨åŒ…å«äº†æ‰€æœ‰çš„å•ä¾‹ bean</li></ul></li><li><p>ApplicationContext æ¯” BeanFactory å¤šç‚¹å•¥</p><ul><li>ApplicationContext ç»„åˆå¹¶æ‰©å±•äº† BeanFactory çš„åŠŸèƒ½</li><li>å›½é™…åŒ–ã€é€šé…ç¬¦æ–¹å¼è·å–ä¸€ç»„ Resource èµ„æºã€æ•´åˆ Environment ç¯å¢ƒã€äº‹ä»¶å‘å¸ƒä¸ç›‘å¬</li><li>æ–°å­¦ä¸€ç§ä»£ç ä¹‹é—´è§£è€¦é€”å¾„ï¼Œäº‹ä»¶è§£è€¦</li></ul></li></ol><p>å»ºè®®ç»ƒä¹ ï¼šå®Œæˆç”¨æˆ·æ³¨å†Œä¸å‘é€çŸ­ä¿¡ä¹‹é—´çš„è§£è€¦ï¼Œç”¨äº‹ä»¶æ–¹å¼ã€å’Œ AOP æ–¹å¼åˆ†åˆ«å®ç°</p><blockquote><p><em><strong>æ³¨æ„</strong></em></p><ul><li>å¦‚æœ jdk &gt; 8, è¿è¡Œæ—¶è¯·æ·»åŠ  â€“add-opens java.base/java.lang=ALL-UNNAMEDï¼Œè¿™æ˜¯å› ä¸ºè¿™äº›ç‰ˆæœ¬çš„ jdk é»˜è®¤ä¸å…è®¸è·¨ module åå°„</li><li>äº‹ä»¶å‘å¸ƒè¿˜å¯ä»¥å¼‚æ­¥ï¼Œè¿™ä¸ªè§†é¢‘ä¸­æ²¡æœ‰å±•ç¤ºï¼Œè¯·è‡ªè¡ŒæŸ¥é˜… @EnableAsyncï¼Œ@Async çš„ç”¨æ³•</li></ul></blockquote><h4 id="æ¼”ç¤º2-å›½é™…åŒ–"><a href="#æ¼”ç¤º2-å›½é™…åŒ–" class="headerlink" title="æ¼”ç¤º2 - å›½é™…åŒ–"></a>æ¼”ç¤º2 - å›½é™…åŒ–</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMessageSource</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        GenericApplicationContext context = <span class="keyword">new</span> GenericApplicationContext();</span><br><span class="line"></span><br><span class="line">        context.registerBean(<span class="string">&quot;messageSource&quot;</span>, MessageSource.class, () -&gt; &#123;</span><br><span class="line">            ResourceBundleMessageSource ms = <span class="keyword">new</span> ResourceBundleMessageSource();</span><br><span class="line">            ms.setDefaultEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">            ms.setBasename(<span class="string">&quot;messages&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> ms;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        context.refresh();</span><br><span class="line"></span><br><span class="line">        System.out.println(context.getMessage(<span class="string">&quot;hi&quot;</span>, <span class="keyword">null</span>, Locale.ENGLISH));</span><br><span class="line">        System.out.println(context.getMessage(<span class="string">&quot;hi&quot;</span>, <span class="keyword">null</span>, Locale.CHINESE));</span><br><span class="line">        System.out.println(context.getMessage(<span class="string">&quot;hi&quot;</span>, <span class="keyword">null</span>, Locale.JAPANESE));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å›½é™…åŒ–æ–‡ä»¶å‡åœ¨ src/resources ç›®å½•ä¸‹</p><p>messages.propertiesï¼ˆç©ºï¼‰</p><p>messages_en.properties</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">hi</span>=<span class="string">Hello</span></span><br></pre></td></tr></table></figure><p>messages_ja.properties</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">hi</span>=<span class="string">ã“ã‚“ã«ã¡ã¯</span></span><br></pre></td></tr></table></figure><p>messages_zh.properties</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">hi</span>=<span class="string">ä½ å¥½</span></span><br></pre></td></tr></table></figure><blockquote><p><em><strong>æ³¨æ„</strong></em></p><ul><li>ApplicationContext ä¸­ MessageSource bean çš„åå­—å›ºå®šä¸º messageSource</li><li>ä½¿ç”¨ SpringBoot æ—¶ï¼Œå›½é™…åŒ–æ–‡ä»¶åå›ºå®šä¸º messages</li><li>ç©ºçš„ messages.properties ä¹Ÿå¿…é¡»å­˜åœ¨</li></ul></blockquote><h3 id="2-å®¹å™¨å®ç°"><a href="#2-å®¹å™¨å®ç°" class="headerlink" title="2) å®¹å™¨å®ç°"></a>2) å®¹å™¨å®ç°</h3><p>Spring çš„å‘å±•å†å²è¾ƒä¸ºæ‚ ä¹…ï¼Œå› æ­¤å¾ˆå¤šèµ„æ–™è¿˜åœ¨è®²è§£å®ƒè¾ƒæ—§çš„å®ç°ï¼Œè¿™é‡Œå‡ºäºæ€€æ—§çš„åŸå› ï¼ŒæŠŠå®ƒä»¬éƒ½åˆ—å‡ºæ¥ï¼Œä¾›å¤§å®¶å‚è€ƒ</p><ul><li>DefaultListableBeanFactoryï¼Œæ˜¯ BeanFactory æœ€é‡è¦çš„å®ç°ï¼Œåƒ<strong>æ§åˆ¶åè½¬</strong>å’Œ<strong>ä¾èµ–æ³¨å…¥</strong>åŠŸèƒ½ï¼Œéƒ½æ˜¯å®ƒæ¥å®ç°</li><li>ClassPathXmlApplicationContextï¼Œä»ç±»è·¯å¾„æŸ¥æ‰¾ XML é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºå®¹å™¨ï¼ˆæ—§ï¼‰</li><li>FileSystemXmlApplicationContextï¼Œä»ç£ç›˜è·¯å¾„æŸ¥æ‰¾ XML é…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºå®¹å™¨ï¼ˆæ—§ï¼‰</li><li>XmlWebApplicationContextï¼Œä¼ ç»Ÿ SSM æ•´åˆæ—¶ï¼ŒåŸºäº XML é…ç½®æ–‡ä»¶çš„å®¹å™¨ï¼ˆæ—§ï¼‰</li><li>AnnotationConfigWebApplicationContextï¼Œä¼ ç»Ÿ SSM æ•´åˆæ—¶ï¼ŒåŸºäº java é…ç½®ç±»çš„å®¹å™¨ï¼ˆæ—§ï¼‰</li><li>AnnotationConfigApplicationContextï¼ŒSpring boot ä¸­é web ç¯å¢ƒå®¹å™¨ï¼ˆæ–°ï¼‰</li><li>AnnotationConfigServletWebServerApplicationContextï¼ŒSpring boot ä¸­ servlet web ç¯å¢ƒå®¹å™¨ï¼ˆæ–°ï¼‰</li><li>AnnotationConfigReactiveWebServerApplicationContextï¼ŒSpring boot ä¸­ reactive web ç¯å¢ƒå®¹å™¨ï¼ˆæ–°ï¼‰</li></ul><p>å¦å¤–è¦æ³¨æ„çš„æ˜¯ï¼Œåé¢è¿™äº›å¸¦æœ‰ ApplicationContext çš„ç±»éƒ½æ˜¯ ApplicationContext æ¥å£çš„å®ç°ï¼Œä½†å®ƒä»¬æ˜¯<strong>ç»„åˆ</strong>äº† DefaultListableBeanFactory çš„åŠŸèƒ½ï¼Œå¹¶éç»§æ‰¿è€Œæ¥</p><h4 id="æ¼”ç¤º1-DefaultListableBeanFactory"><a href="#æ¼”ç¤º1-DefaultListableBeanFactory" class="headerlink" title="æ¼”ç¤º1 - DefaultListableBeanFactory"></a>æ¼”ç¤º1 - DefaultListableBeanFactory</h4><h5 id="ä»£ç å‚è€ƒ-1"><a href="#ä»£ç å‚è€ƒ-1" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a02.TestBeanFactory</strong></p><h4 id="æ”¶è·ğŸ’¡-1"><a href="#æ”¶è·ğŸ’¡-1" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ul><li>beanFactory å¯ä»¥é€šè¿‡ registerBeanDefinition æ³¨å†Œä¸€ä¸ª bean definition å¯¹è±¡<ul><li>æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨çš„é…ç½®ç±»ã€xmlã€ç»„ä»¶æ‰«æç­‰æ–¹å¼éƒ½æ˜¯ç”Ÿæˆ bean definition å¯¹è±¡æ³¨å†Œåˆ° beanFactory å½“ä¸­</li><li>bean definition æè¿°äº†è¿™ä¸ª bean çš„åˆ›å»ºè“å›¾ï¼šscope æ˜¯ä»€ä¹ˆã€ç”¨æ„é€ è¿˜æ˜¯å·¥å‚åˆ›å»ºã€åˆå§‹åŒ–é”€æ¯æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Œç­‰ç­‰</li></ul></li><li>beanFactory éœ€è¦æ‰‹åŠ¨è°ƒç”¨ beanFactory åå¤„ç†å™¨å¯¹å®ƒåšå¢å¼º<ul><li>ä¾‹å¦‚é€šè¿‡è§£æ @Beanã€@ComponentScan ç­‰æ³¨è§£ï¼Œæ¥è¡¥å……ä¸€äº› bean definition</li></ul></li><li>beanFactory éœ€è¦æ‰‹åŠ¨æ·»åŠ  bean åå¤„ç†å™¨ï¼Œä»¥ä¾¿å¯¹åç»­ bean çš„åˆ›å»ºè¿‡ç¨‹æä¾›å¢å¼º<ul><li>ä¾‹å¦‚ @Autowiredï¼Œ@Resource ç­‰æ³¨è§£çš„è§£æéƒ½æ˜¯ bean åå¤„ç†å™¨å®Œæˆçš„</li><li>bean åå¤„ç†çš„æ·»åŠ é¡ºåºä¼šå¯¹è§£æç»“æœæœ‰å½±å“ï¼Œè§è§†é¢‘ä¸­åŒæ—¶åŠ  @Autowiredï¼Œ@Resource çš„ä¾‹å­</li></ul></li><li>beanFactory éœ€è¦æ‰‹åŠ¨è°ƒç”¨æ–¹æ³•æ¥åˆå§‹åŒ–å•ä¾‹</li><li>beanFactory éœ€è¦é¢å¤–è®¾ç½®æ‰èƒ½è§£æ ${} ä¸ #{}</li></ul><h4 id="æ¼”ç¤º2-å¸¸è§-ApplicationContext-å®ç°"><a href="#æ¼”ç¤º2-å¸¸è§-ApplicationContext-å®ç°" class="headerlink" title="æ¼”ç¤º2 - å¸¸è§ ApplicationContext å®ç°"></a>æ¼”ç¤º2 - å¸¸è§ ApplicationContext å®ç°</h4><h5 id="ä»£ç å‚è€ƒ-2"><a href="#ä»£ç å‚è€ƒ-2" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a02.A02</strong></p><h4 id="æ”¶è·ğŸ’¡-2"><a href="#æ”¶è·ğŸ’¡-2" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>å¸¸è§çš„ ApplicationContext å®¹å™¨å®ç°</li><li>å†…åµŒå®¹å™¨ã€DispatcherServlet çš„åˆ›å»ºæ–¹æ³•ã€ä½œç”¨</li></ol><h3 id="3-Bean-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#3-Bean-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="3) Bean çš„ç”Ÿå‘½å‘¨æœŸ"></a>3) Bean çš„ç”Ÿå‘½å‘¨æœŸ</h3><p>ä¸€ä¸ªå— Spring ç®¡ç†çš„ beanï¼Œç”Ÿå‘½å‘¨æœŸä¸»è¦é˜¶æ®µæœ‰</p><ol><li>åˆ›å»ºï¼šæ ¹æ® bean çš„æ„é€ æ–¹æ³•æˆ–è€…å·¥å‚æ–¹æ³•æ¥åˆ›å»º bean å®ä¾‹å¯¹è±¡</li><li>ä¾èµ–æ³¨å…¥ï¼šæ ¹æ® @Autowiredï¼Œ@Value æˆ–å…¶å®ƒä¸€äº›æ‰‹æ®µï¼Œä¸º bean çš„æˆå‘˜å˜é‡å¡«å……å€¼ã€å»ºç«‹å…³ç³»</li><li>åˆå§‹åŒ–ï¼šå›è°ƒå„ç§ Aware æ¥å£ï¼Œè°ƒç”¨å¯¹è±¡çš„å„ç§åˆå§‹åŒ–æ–¹æ³•</li><li>é”€æ¯ï¼šåœ¨å®¹å™¨å…³é—­æ—¶ï¼Œä¼šé”€æ¯æ‰€æœ‰å•ä¾‹å¯¹è±¡ï¼ˆå³è°ƒç”¨å®ƒä»¬çš„é”€æ¯æ–¹æ³•ï¼‰<ul><li>prototype å¯¹è±¡ä¹Ÿèƒ½å¤Ÿé”€æ¯ï¼Œä¸è¿‡éœ€è¦å®¹å™¨è¿™è¾¹ä¸»åŠ¨è°ƒç”¨</li></ul></li></ol><p>ä¸€äº›èµ„æ–™ä¼šæåˆ°ï¼Œç”Ÿå‘½å‘¨æœŸä¸­è¿˜æœ‰ä¸€ç±» bean åå¤„ç†å™¨ï¼šBeanPostProcessorï¼Œä¼šåœ¨ bean çš„åˆå§‹åŒ–çš„å‰åï¼Œæä¾›ä¸€äº›æ‰©å±•é€»è¾‘ã€‚ä½†è¿™ç§è¯´æ³•æ˜¯ä¸å®Œæ•´çš„ï¼Œè§ä¸‹é¢çš„æ¼”ç¤º1</p><h4 id="æ¼”ç¤º1-bean-ç”Ÿå‘½å‘¨æœŸ"><a href="#æ¼”ç¤º1-bean-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="æ¼”ç¤º1 - bean ç”Ÿå‘½å‘¨æœŸ"></a>æ¼”ç¤º1 - bean ç”Ÿå‘½å‘¨æœŸ</h4><h5 id="ä»£ç å‚è€ƒ-3"><a href="#ä»£ç å‚è€ƒ-3" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a03</strong> åŒ…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line"></span><br><span class="line">åˆ›å»º --&gt; ä¾èµ–æ³¨å…¥</span><br><span class="line">ä¾èµ–æ³¨å…¥ --&gt; åˆå§‹åŒ–</span><br><span class="line">åˆå§‹åŒ– --&gt; å¯ç”¨</span><br><span class="line">å¯ç”¨ --&gt; é”€æ¯</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå‰åçš„å¢å¼º</p><ul><li>postProcessBeforeInstantiation<ul><li>è¿™é‡Œè¿”å›çš„å¯¹è±¡è‹¥ä¸ä¸º null ä¼šæ›¿æ¢æ‰åŸæœ¬çš„ beanï¼Œå¹¶ä¸”ä»…ä¼šèµ° postProcessAfterInitialization æµç¨‹</li></ul></li><li>postProcessAfterInstantiation<ul><li>è¿™é‡Œå¦‚æœè¿”å› false ä¼šè·³è¿‡ä¾èµ–æ³¨å…¥é˜¶æ®µ</li></ul></li></ul><p>ä¾èµ–æ³¨å…¥å‰çš„å¢å¼º</p><ul><li>postProcessProperties<ul><li>å¦‚ @Autowiredã€@Valueã€@Resource </li></ul></li></ul><p>åˆå§‹åŒ–å‰åçš„å¢å¼º</p><ul><li>postProcessBeforeInitialization<ul><li>è¿™é‡Œè¿”å›çš„å¯¹è±¡ä¼šæ›¿æ¢æ‰åŸæœ¬çš„ bean</li><li>å¦‚ @PostConstructã€@ConfigurationProperties</li></ul></li><li>postProcessAfterInitialization <ul><li>è¿™é‡Œè¿”å›çš„å¯¹è±¡ä¼šæ›¿æ¢æ‰åŸæœ¬çš„ bean</li><li>å¦‚ä»£ç†å¢å¼º</li></ul></li></ul><p>é”€æ¯ä¹‹å‰çš„å¢å¼º</p><ul><li>postProcessBeforeDestruction<ul><li>å¦‚ @PreDestroy </li></ul></li></ul><h4 id="æ”¶è·ğŸ’¡-3"><a href="#æ”¶è·ğŸ’¡-3" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>Spring bean ç”Ÿå‘½å‘¨æœŸå„ä¸ªé˜¶æ®µ</li><li>æ¨¡æ¿è®¾è®¡æ¨¡å¼, æŒ‡å¤§æµç¨‹å·²ç»å›ºå®šå¥½äº†, é€šè¿‡æ¥å£å›è°ƒï¼ˆbean åå¤„ç†å™¨ï¼‰åœ¨ä¸€äº›å…³é”®ç‚¹å‰åæä¾›æ‰©å±•</li></ol><h4 id="æ¼”ç¤º2-æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼"><a href="#æ¼”ç¤º2-æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼" class="headerlink" title="æ¼”ç¤º2 - æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼"></a>æ¼”ç¤º2 - æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼</h4><h5 id="å…³é”®ä»£ç "><a href="#å…³é”®ä»£ç " class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMethodTemplate</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        MyBeanFactory beanFactory = <span class="keyword">new</span> MyBeanFactory();</span><br><span class="line">        beanFactory.addBeanPostProcessor(bean -&gt; System.out.println(<span class="string">&quot;è§£æ @Autowired&quot;</span>));</span><br><span class="line">        beanFactory.addBeanPostProcessor(bean -&gt; System.out.println(<span class="string">&quot;è§£æ @Resource&quot;</span>));</span><br><span class="line">        beanFactory.getBean();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ¿æ–¹æ³•  Template Method Pattern</span></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeanFactory</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Object <span class="title">getBean</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            Object bean = <span class="keyword">new</span> Object();</span><br><span class="line">            System.out.println(<span class="string">&quot;æ„é€  &quot;</span> + bean);</span><br><span class="line">            System.out.println(<span class="string">&quot;ä¾èµ–æ³¨å…¥ &quot;</span> + bean); <span class="comment">// @Autowired, @Resource</span></span><br><span class="line">            <span class="keyword">for</span> (BeanPostProcessor processor : processors) &#123;</span><br><span class="line">                processor.inject(bean);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;åˆå§‹åŒ– &quot;</span> + bean);</span><br><span class="line">            <span class="keyword">return</span> bean;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> List&lt;BeanPostProcessor&gt; processors = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addBeanPostProcessor</span><span class="params">(BeanPostProcessor processor)</span> </span>&#123;</span><br><span class="line">            processors.add(processor);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanPostProcessor</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">inject</span><span class="params">(Object bean)</span></span>; <span class="comment">// å¯¹ä¾èµ–æ³¨å…¥é˜¶æ®µçš„æ‰©å±•</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¼”ç¤º3-bean-åå¤„ç†å™¨æ’åº"><a href="#æ¼”ç¤º3-bean-åå¤„ç†å™¨æ’åº" class="headerlink" title="æ¼”ç¤º3 - bean åå¤„ç†å™¨æ’åº"></a>æ¼”ç¤º3 - bean åå¤„ç†å™¨æ’åº</h4><h5 id="ä»£ç å‚è€ƒ-4"><a href="#ä»£ç å‚è€ƒ-4" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a03.TestProcessOrder</strong></p><h4 id="æ”¶è·ğŸ’¡-4"><a href="#æ”¶è·ğŸ’¡-4" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>å®ç°äº† PriorityOrdered æ¥å£çš„ä¼˜å…ˆçº§æœ€é«˜</li><li>å®ç°äº† Ordered æ¥å£ä¸åŠ äº† @Order æ³¨è§£çš„å¹³çº§, æŒ‰æ•°å­—å‡åº</li><li>å…¶å®ƒçš„æ’åœ¨æœ€å</li></ol><h3 id="4-Bean-åå¤„ç†å™¨"><a href="#4-Bean-åå¤„ç†å™¨" class="headerlink" title="4) Bean åå¤„ç†å™¨"></a>4) Bean åå¤„ç†å™¨</h3><h4 id="æ¼”ç¤º1-åå¤„ç†å™¨ä½œç”¨"><a href="#æ¼”ç¤º1-åå¤„ç†å™¨ä½œç”¨" class="headerlink" title="æ¼”ç¤º1 - åå¤„ç†å™¨ä½œç”¨"></a>æ¼”ç¤º1 - åå¤„ç†å™¨ä½œç”¨</h4><h5 id="ä»£ç å‚è€ƒ-5"><a href="#ä»£ç å‚è€ƒ-5" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a04</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-5"><a href="#æ”¶è·ğŸ’¡-5" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>@Autowired ç­‰æ³¨è§£çš„è§£æå±äº bean ç”Ÿå‘½å‘¨æœŸé˜¶æ®µï¼ˆä¾èµ–æ³¨å…¥, åˆå§‹åŒ–ï¼‰çš„æ‰©å±•åŠŸèƒ½ï¼Œè¿™äº›æ‰©å±•åŠŸèƒ½ç”± bean åå¤„ç†å™¨æ¥å®Œæˆ</li><li>æ¯ä¸ªåå¤„ç†å™¨å„è‡ªå¢å¼ºä»€ä¹ˆåŠŸèƒ½<ul><li>AutowiredAnnotationBeanPostProcessor è§£æ @Autowired ä¸ @Value</li><li>CommonAnnotationBeanPostProcessor è§£æ @Resourceã€@PostConstructã€@PreDestroy</li><li>ConfigurationPropertiesBindingPostProcessor è§£æ @ConfigurationProperties</li></ul></li><li>å¦å¤– ContextAnnotationAutowireCandidateResolver è´Ÿè´£è·å– @Value çš„å€¼ï¼Œè§£æ @Qualifierã€æ³›å‹ã€@Lazy ç­‰</li></ol><h4 id="æ¼”ç¤º2-Autowired-bean-åå¤„ç†å™¨è¿è¡Œåˆ†æ"><a href="#æ¼”ç¤º2-Autowired-bean-åå¤„ç†å™¨è¿è¡Œåˆ†æ" class="headerlink" title="æ¼”ç¤º2 - @Autowired bean åå¤„ç†å™¨è¿è¡Œåˆ†æ"></a>æ¼”ç¤º2 - @Autowired bean åå¤„ç†å™¨è¿è¡Œåˆ†æ</h4><h5 id="ä»£ç å‚è€ƒ-6"><a href="#ä»£ç å‚è€ƒ-6" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a04.DigInAutowired</strong></p><h4 id="æ”¶è·ğŸ’¡-6"><a href="#æ”¶è·ğŸ’¡-6" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>AutowiredAnnotationBeanPostProcessor.findAutowiringMetadata ç”¨æ¥è·å–æŸä¸ª bean ä¸ŠåŠ äº† @Value @Autowired çš„æˆå‘˜å˜é‡ï¼Œæ–¹æ³•å‚æ•°çš„ä¿¡æ¯ï¼Œè¡¨ç¤ºä¸º InjectionMetadata</li><li>InjectionMetadata å¯ä»¥å®Œæˆä¾èµ–æ³¨å…¥</li><li>InjectionMetadata å†…éƒ¨æ ¹æ®æˆå‘˜å˜é‡ï¼Œæ–¹æ³•å‚æ•°å°è£…ä¸º DependencyDescriptor ç±»å‹</li><li>æœ‰äº† DependencyDescriptorï¼Œå°±å¯ä»¥åˆ©ç”¨ beanFactory.doResolveDependency æ–¹æ³•è¿›è¡ŒåŸºäºç±»å‹çš„æŸ¥æ‰¾</li></ol><h3 id="5-BeanFactory-åå¤„ç†å™¨"><a href="#5-BeanFactory-åå¤„ç†å™¨" class="headerlink" title="5) BeanFactory åå¤„ç†å™¨"></a>5) BeanFactory åå¤„ç†å™¨</h3><h4 id="æ¼”ç¤º1-BeanFactory-åå¤„ç†å™¨çš„ä½œç”¨"><a href="#æ¼”ç¤º1-BeanFactory-åå¤„ç†å™¨çš„ä½œç”¨" class="headerlink" title="æ¼”ç¤º1 - BeanFactory åå¤„ç†å™¨çš„ä½œç”¨"></a>æ¼”ç¤º1 - BeanFactory åå¤„ç†å™¨çš„ä½œç”¨</h4><h5 id="ä»£ç å‚è€ƒ-7"><a href="#ä»£ç å‚è€ƒ-7" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a05</strong> åŒ…</p><ul><li>ConfigurationClassPostProcessor å¯ä»¥è§£æ<ul><li>@ComponentScan</li><li>@Bean</li><li>@Import</li><li>@ImportResource</li></ul></li><li>MapperScannerConfigurer å¯ä»¥è§£æ<ul><li>Mapper æ¥å£</li></ul></li></ul><h4 id="æ”¶è·ğŸ’¡-7"><a href="#æ”¶è·ğŸ’¡-7" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>@ComponentScan, @Bean, @Mapper ç­‰æ³¨è§£çš„è§£æå±äºæ ¸å¿ƒå®¹å™¨ï¼ˆå³ BeanFactoryï¼‰çš„æ‰©å±•åŠŸèƒ½</li><li>è¿™äº›æ‰©å±•åŠŸèƒ½ç”±ä¸åŒçš„ BeanFactory åå¤„ç†å™¨æ¥å®Œæˆï¼Œå…¶å®ä¸»è¦å°±æ˜¯è¡¥å……äº†ä¸€äº› bean å®šä¹‰</li></ol><h4 id="æ¼”ç¤º2-æ¨¡æ‹Ÿè§£æ-ComponentScan"><a href="#æ¼”ç¤º2-æ¨¡æ‹Ÿè§£æ-ComponentScan" class="headerlink" title="æ¼”ç¤º2 - æ¨¡æ‹Ÿè§£æ @ComponentScan"></a>æ¼”ç¤º2 - æ¨¡æ‹Ÿè§£æ @ComponentScan</h4><h5 id="ä»£ç å‚è€ƒ-8"><a href="#ä»£ç å‚è€ƒ-8" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a05.ComponentScanPostProcessor</strong></p><h4 id="æ”¶è·ğŸ’¡-8"><a href="#æ”¶è·ğŸ’¡-8" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>Spring æ“ä½œå…ƒæ•°æ®çš„å·¥å…·ç±» CachingMetadataReaderFactory</li><li>é€šè¿‡æ³¨è§£å…ƒæ•°æ®ï¼ˆAnnotationMetadataï¼‰è·å–ç›´æ¥æˆ–é—´æ¥æ ‡æ³¨çš„æ³¨è§£ä¿¡æ¯</li><li>é€šè¿‡ç±»å…ƒæ•°æ®ï¼ˆClassMetadataï¼‰è·å–ç±»åï¼ŒAnnotationBeanNameGenerator ç”Ÿæˆ bean å</li><li>è§£æå…ƒæ•°æ®æ˜¯åŸºäº ASM æŠ€æœ¯</li></ol><h4 id="æ¼”ç¤º3-æ¨¡æ‹Ÿè§£æ-Bean"><a href="#æ¼”ç¤º3-æ¨¡æ‹Ÿè§£æ-Bean" class="headerlink" title="æ¼”ç¤º3 - æ¨¡æ‹Ÿè§£æ @Bean"></a>æ¼”ç¤º3 - æ¨¡æ‹Ÿè§£æ @Bean</h4><h5 id="ä»£ç å‚è€ƒ-9"><a href="#ä»£ç å‚è€ƒ-9" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a05.AtBeanPostProcessor</strong></p><h4 id="æ”¶è·ğŸ’¡-9"><a href="#æ”¶è·ğŸ’¡-9" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>è¿›ä¸€æ­¥ç†Ÿæ‚‰æ³¨è§£å…ƒæ•°æ®ï¼ˆAnnotationMetadataï¼‰è·å–æ–¹æ³•ä¸Šæ³¨è§£ä¿¡æ¯</li></ol><h4 id="æ¼”ç¤º4-æ¨¡æ‹Ÿè§£æ-Mapper-æ¥å£"><a href="#æ¼”ç¤º4-æ¨¡æ‹Ÿè§£æ-Mapper-æ¥å£" class="headerlink" title="æ¼”ç¤º4 - æ¨¡æ‹Ÿè§£æ Mapper æ¥å£"></a>æ¼”ç¤º4 - æ¨¡æ‹Ÿè§£æ Mapper æ¥å£</h4><h5 id="ä»£ç å‚è€ƒ-10"><a href="#ä»£ç å‚è€ƒ-10" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a05.MapperPostProcessor</strong></p><h4 id="æ”¶è·ğŸ’¡-10"><a href="#æ”¶è·ğŸ’¡-10" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>Mapper æ¥å£è¢« Spring ç®¡ç†çš„æœ¬è´¨ï¼šå®é™…æ˜¯è¢«ä½œä¸º MapperFactoryBean æ³¨å†Œåˆ°å®¹å™¨ä¸­</li><li>Spring çš„è¯¡å¼‚åšæ³•ï¼Œæ ¹æ®æ¥å£ç”Ÿæˆçš„ BeanDefinition ä»…ä¸ºæ ¹æ®æ¥å£åç”Ÿæˆ bean å</li></ol><h3 id="6-Aware-æ¥å£"><a href="#6-Aware-æ¥å£" class="headerlink" title="6) Aware æ¥å£"></a>6) Aware æ¥å£</h3><h4 id="æ¼”ç¤º-Aware-æ¥å£åŠ-InitializingBean-æ¥å£"><a href="#æ¼”ç¤º-Aware-æ¥å£åŠ-InitializingBean-æ¥å£" class="headerlink" title="æ¼”ç¤º - Aware æ¥å£åŠ InitializingBean æ¥å£"></a>æ¼”ç¤º - Aware æ¥å£åŠ InitializingBean æ¥å£</h4><h5 id="ä»£ç å‚è€ƒ-11"><a href="#ä»£ç å‚è€ƒ-11" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a06</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-11"><a href="#æ”¶è·ğŸ’¡-11" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>Aware æ¥å£æä¾›äº†ä¸€ç§ã€å†…ç½®ã€‘ çš„æ³¨å…¥æ‰‹æ®µï¼Œä¾‹å¦‚<ul><li>BeanNameAware æ³¨å…¥ bean çš„åå­—</li><li>BeanFactoryAware æ³¨å…¥ BeanFactory å®¹å™¨</li><li>ApplicationContextAware æ³¨å…¥ ApplicationContext å®¹å™¨</li><li>EmbeddedValueResolverAware æ³¨å…¥ ${} è§£æå™¨</li></ul></li><li>InitializingBean æ¥å£æä¾›äº†ä¸€ç§ã€å†…ç½®ã€‘çš„åˆå§‹åŒ–æ‰‹æ®µ</li><li>å¯¹æ¯”<ul><li>å†…ç½®çš„æ³¨å…¥å’Œåˆå§‹åŒ–ä¸å—æ‰©å±•åŠŸèƒ½çš„å½±å“ï¼Œæ€»ä¼šè¢«æ‰§è¡Œ</li><li>è€Œæ‰©å±•åŠŸèƒ½å—æŸäº›æƒ…å†µå½±å“å¯èƒ½ä¼šå¤±æ•ˆ</li><li>å› æ­¤ Spring æ¡†æ¶å†…éƒ¨çš„ç±»å¸¸ç”¨å†…ç½®æ³¨å…¥å’Œåˆå§‹åŒ–</li></ul></li></ol><h4 id="é…ç½®ç±»-Autowired-å¤±æ•ˆåˆ†æ"><a href="#é…ç½®ç±»-Autowired-å¤±æ•ˆåˆ†æ" class="headerlink" title="é…ç½®ç±» @Autowired å¤±æ•ˆåˆ†æ"></a>é…ç½®ç±» @Autowired å¤±æ•ˆåˆ†æ</h4><p>Java é…ç½®ç±»ä¸åŒ…å« BeanFactoryPostProcessor çš„æƒ…å†µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram </span><br><span class="line">participant ac as ApplicationContext</span><br><span class="line">participant bfpp as BeanFactoryPostProcessor</span><br><span class="line">participant bpp as BeanPostProcessor</span><br><span class="line">participant config as Javaé…ç½®ç±»</span><br><span class="line">ac -&gt;&gt; bfpp : 1. æ‰§è¡Œ BeanFactoryPostProcessor</span><br><span class="line">ac -&gt;&gt; bpp : 2. æ³¨å†Œ BeanPostProcessor</span><br><span class="line">ac -&gt;&gt; +config : 3. åˆ›å»ºå’Œåˆå§‹åŒ–</span><br><span class="line">bpp -&gt;&gt; config : 3.1 ä¾èµ–æ³¨å…¥æ‰©å±•(å¦‚ @Value å’Œ @Autowired)</span><br><span class="line">bpp -&gt;&gt; config : 3.2 åˆå§‹åŒ–æ‰©å±•(å¦‚ @PostConstruct)</span><br><span class="line">ac -&gt;&gt; config : 3.3 æ‰§è¡Œ Aware åŠ InitializingBean</span><br><span class="line">config --&gt;&gt; -ac : 3.4 åˆ›å»ºæˆåŠŸ</span><br></pre></td></tr></table></figure><p>Java é…ç½®ç±»åŒ…å« BeanFactoryPostProcessor çš„æƒ…å†µï¼Œå› æ­¤è¦åˆ›å»ºå…¶ä¸­çš„ BeanFactoryPostProcessor å¿…é¡»æå‰åˆ›å»º Java é…ç½®ç±»ï¼Œè€Œæ­¤æ—¶çš„ BeanPostProcessor è¿˜æœªå‡†å¤‡å¥½ï¼Œå¯¼è‡´ @Autowired ç­‰æ³¨è§£å¤±æ•ˆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram </span><br><span class="line">participant ac as ApplicationContext</span><br><span class="line">participant bfpp as BeanFactoryPostProcessor</span><br><span class="line">participant bpp as BeanPostProcessor</span><br><span class="line">participant config as Javaé…ç½®ç±»</span><br><span class="line">ac -&gt;&gt; +config : 3. åˆ›å»ºå’Œåˆå§‹åŒ–</span><br><span class="line">ac -&gt;&gt; config : 3.1 æ‰§è¡Œ Aware åŠ InitializingBean</span><br><span class="line">config --&gt;&gt; -ac : 3.2 åˆ›å»ºæˆåŠŸ</span><br><span class="line"></span><br><span class="line">ac -&gt;&gt; bfpp : 1. æ‰§è¡Œ BeanFactoryPostProcessor</span><br><span class="line">ac -&gt;&gt; bpp : 2. æ³¨å†Œ BeanPostProcessor</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯¹åº”ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyConfig1</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(MyConfig1.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> </span>&#123;</span><br><span class="line">        log.debug(<span class="string">&quot;æ³¨å…¥ ApplicationContext&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.debug(<span class="string">&quot;åˆå§‹åŒ–&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span> <span class="comment">//  â¬…ï¸ æ³¨é‡Šæˆ–æ·»åŠ  beanFactory åå¤„ç†å™¨å¯¹åº”ä¸Šæ–¹ä¸¤ç§æƒ…å†µ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BeanFactoryPostProcessor <span class="title">processor1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> beanFactory -&gt; &#123;</span><br><span class="line">            log.debug(<span class="string">&quot;æ‰§è¡Œ processor1&quot;</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><em><strong>æ³¨æ„</strong></em></p><p>è§£å†³æ–¹æ³•ï¼š</p><ul><li>ç”¨å†…ç½®ä¾èµ–æ³¨å…¥å’Œåˆå§‹åŒ–å–ä»£æ‰©å±•ä¾èµ–æ³¨å…¥å’Œåˆå§‹åŒ–</li><li>ç”¨é™æ€å·¥å‚æ–¹æ³•ä»£æ›¿å®ä¾‹å·¥å‚æ–¹æ³•ï¼Œé¿å…å·¥å‚å¯¹è±¡æå‰è¢«åˆ›å»º</li></ul></blockquote><h3 id="7-åˆå§‹åŒ–ä¸é”€æ¯"><a href="#7-åˆå§‹åŒ–ä¸é”€æ¯" class="headerlink" title="7) åˆå§‹åŒ–ä¸é”€æ¯"></a>7) åˆå§‹åŒ–ä¸é”€æ¯</h3><h4 id="æ¼”ç¤º-åˆå§‹åŒ–é”€æ¯é¡ºåº"><a href="#æ¼”ç¤º-åˆå§‹åŒ–é”€æ¯é¡ºåº" class="headerlink" title="æ¼”ç¤º - åˆå§‹åŒ–é”€æ¯é¡ºåº"></a>æ¼”ç¤º - åˆå§‹åŒ–é”€æ¯é¡ºåº</h4><h5 id="ä»£ç å‚è€ƒ-12"><a href="#ä»£ç å‚è€ƒ-12" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a07</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-12"><a href="#æ”¶è·ğŸ’¡-12" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><p>Spring æä¾›äº†å¤šç§åˆå§‹åŒ–æ‰‹æ®µï¼Œé™¤äº†è¯¾å ‚ä¸Šè®²çš„ @PostConstructï¼Œ@Bean(initMethod) ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å®ç° InitializingBean æ¥å£æ¥è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚æœåŒä¸€ä¸ª bean ç”¨äº†ä»¥ä¸Šæ‰‹æ®µå£°æ˜äº† 3 ä¸ªåˆå§‹åŒ–æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒä»¬çš„æ‰§è¡Œé¡ºåºæ˜¯</p><ol><li>@PostConstruct æ ‡æ³¨çš„åˆå§‹åŒ–æ–¹æ³•</li><li>InitializingBean æ¥å£çš„åˆå§‹åŒ–æ–¹æ³•</li><li>@Bean(initMethod) æŒ‡å®šçš„åˆå§‹åŒ–æ–¹æ³•</li></ol><p>ä¸åˆå§‹åŒ–ç±»ä¼¼ï¼ŒSpring ä¹Ÿæä¾›äº†å¤šç§é”€æ¯æ‰‹æ®µï¼Œæ‰§è¡Œé¡ºåºä¸º</p><ol><li>@PreDestroy æ ‡æ³¨çš„é”€æ¯æ–¹æ³•</li><li>DisposableBean æ¥å£çš„é”€æ¯æ–¹æ³•</li><li>@Bean(destroyMethod) æŒ‡å®šçš„é”€æ¯æ–¹æ³•</li></ol><h3 id="8-Scope"><a href="#8-Scope" class="headerlink" title="8) Scope"></a>8) Scope</h3><p>åœ¨å½“å‰ç‰ˆæœ¬çš„ Spring å’Œ Spring Boot ç¨‹åºä¸­ï¼Œæ”¯æŒäº”ç§ Scope</p><ul><li>singletonï¼Œå®¹å™¨å¯åŠ¨æ—¶åˆ›å»ºï¼ˆæœªè®¾ç½®å»¶è¿Ÿï¼‰ï¼Œå®¹å™¨å…³é—­æ—¶é”€æ¯</li><li>prototypeï¼Œæ¯æ¬¡ä½¿ç”¨æ—¶åˆ›å»ºï¼Œä¸ä¼šè‡ªåŠ¨é”€æ¯ï¼Œéœ€è¦è°ƒç”¨ DefaultListableBeanFactory.destroyBean(bean) é”€æ¯</li><li>requestï¼Œæ¯æ¬¡è¯·æ±‚ç”¨åˆ°æ­¤ bean æ—¶åˆ›å»ºï¼Œè¯·æ±‚ç»“æŸæ—¶é”€æ¯</li><li>sessionï¼Œæ¯ä¸ªä¼šè¯ç”¨åˆ°æ­¤ bean æ—¶åˆ›å»ºï¼Œä¼šè¯ç»“æŸæ—¶é”€æ¯</li><li>applicationï¼Œweb å®¹å™¨ç”¨åˆ°æ­¤ bean æ—¶åˆ›å»ºï¼Œå®¹å™¨åœæ­¢æ—¶é”€æ¯</li></ul><p>æœ‰äº›æ–‡ç« æåˆ°æœ‰ globalSession è¿™ä¸€ Scopeï¼Œä¹Ÿæ˜¯é™ˆæ—§çš„è¯´æ³•ï¼Œç›®å‰ Spring ä¸­å·²åºŸå¼ƒ</p><p>ä½†è¦æ³¨æ„ï¼Œå¦‚æœåœ¨ singleton æ³¨å…¥å…¶å®ƒ scope éƒ½ä¼šæœ‰é—®é¢˜ï¼Œè§£å†³æ–¹æ³•æœ‰</p><ul><li>@Lazy</li><li>@Scope(proxyMode = ScopedProxyMode.TARGET_CLASS)</li><li>ObjectFactory</li><li>ApplicationContext.getBean</li></ul><h4 id="æ¼”ç¤º1-request-session-application-ä½œç”¨åŸŸ"><a href="#æ¼”ç¤º1-request-session-application-ä½œç”¨åŸŸ" class="headerlink" title="æ¼”ç¤º1 - request, session, application ä½œç”¨åŸŸ"></a>æ¼”ç¤º1 - request, session, application ä½œç”¨åŸŸ</h4><h5 id="ä»£ç å‚è€ƒ-13"><a href="#ä»£ç å‚è€ƒ-13" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a08</strong> åŒ…</p><ul><li>æ‰“å¼€ä¸åŒçš„æµè§ˆå™¨, åˆ·æ–° <a href="http://localhost:8080/test">http://localhost:8080/test</a> å³å¯æŸ¥çœ‹æ•ˆæœ</li><li>å¦‚æœ jdk &gt; 8, è¿è¡Œæ—¶è¯·æ·»åŠ  â€“add-opens java.base/java.lang=ALL-UNNAMED</li></ul><h4 id="æ”¶è·ğŸ’¡-13"><a href="#æ”¶è·ğŸ’¡-13" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>æœ‰å‡ ç§ scope</li><li>åœ¨ singleton ä¸­ä½¿ç”¨å…¶å®ƒå‡ ç§ scope çš„æ–¹æ³•</li><li>å…¶å®ƒ scope çš„é”€æ¯æ—¶æœº<ul><li>å¯ä»¥å°†é€šè¿‡ server.servlet.session.timeout=30s è§‚å¯Ÿ session bean çš„é”€æ¯</li><li>ServletContextScope é”€æ¯æœºåˆ¶ç–‘ä¼¼å®ç°æœ‰è¯¯</li></ul></li></ol><h4 id="åˆ†æ-singleton-æ³¨å…¥å…¶å®ƒ-scope-å¤±æ•ˆ"><a href="#åˆ†æ-singleton-æ³¨å…¥å…¶å®ƒ-scope-å¤±æ•ˆ" class="headerlink" title="åˆ†æ - singleton æ³¨å…¥å…¶å®ƒ scope å¤±æ•ˆ"></a>åˆ†æ - singleton æ³¨å…¥å…¶å®ƒ scope å¤±æ•ˆ</h4><p>ä»¥å•ä¾‹æ³¨å…¥å¤šä¾‹ä¸ºä¾‹</p><p>æœ‰ä¸€ä¸ªå•ä¾‹å¯¹è±¡ E</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">E</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(E.class);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> F f;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">E</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;E()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setF</span><span class="params">(F f)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.f = f;</span><br><span class="line">        log.info(<span class="string">&quot;setF(F f) &#123;&#125;&quot;</span>, f.getClass());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> F <span class="title">getF</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> f;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦æ³¨å…¥çš„å¯¹è±¡ F æœŸæœ›æ˜¯å¤šä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Scope(&quot;prototype&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">F</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(F.class);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">F</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;F()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">E e = context.getBean(E.class);</span><br><span class="line">F f1 = e.getF();</span><br><span class="line">F f2 = e.getF();</span><br><span class="line">System.out.println(f1);</span><br><span class="line">System.out.println(f2);</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">com.itheima.demo.cycle.F@6622fc65</span><br><span class="line">com.itheima.demo.cycle.F@6622fc65</span><br></pre></td></tr></table></figure><p>å‘ç°å®ƒä»¬æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯æœŸæœ›çš„å¤šä¾‹å¯¹è±¡</p><p>å¯¹äºå•ä¾‹å¯¹è±¡æ¥è®²ï¼Œä¾èµ–æ³¨å…¥ä»…å‘ç”Ÿäº†ä¸€æ¬¡ï¼Œåç»­å†æ²¡æœ‰ç”¨åˆ°å¤šä¾‹çš„ Fï¼Œå› æ­¤ E ç”¨çš„å§‹ç»ˆæ˜¯ç¬¬ä¸€æ¬¡ä¾èµ–æ³¨å…¥çš„ F</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line"></span><br><span class="line">e1(e åˆ›å»º)</span><br><span class="line">e2(e set æ³¨å…¥ f)</span><br><span class="line"></span><br><span class="line">f1(f åˆ›å»º)</span><br><span class="line"></span><br><span class="line">e1--&gt;f1--&gt;e2</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è§£å†³</p><ul><li>ä»ç„¶ä½¿ç”¨ @Lazy ç”Ÿæˆä»£ç†</li><li>ä»£ç†å¯¹è±¡è™½ç„¶è¿˜æ˜¯åŒä¸€ä¸ªï¼Œä½†å½“æ¯æ¬¡<strong>ä½¿ç”¨ä»£ç†å¯¹è±¡çš„ä»»æ„æ–¹æ³•</strong>æ—¶ï¼Œç”±ä»£ç†åˆ›å»ºæ–°çš„ f å¯¹è±¡</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line"></span><br><span class="line">e1(e åˆ›å»º)</span><br><span class="line">e2(e set æ³¨å…¥ fä»£ç†)</span><br><span class="line"></span><br><span class="line">f1(f åˆ›å»º)</span><br><span class="line">f2(f åˆ›å»º)</span><br><span class="line">f3(f åˆ›å»º)</span><br><span class="line"></span><br><span class="line">e1--&gt;e2</span><br><span class="line">e2--ä½¿ç”¨fæ–¹æ³•--&gt;f1</span><br><span class="line">e2--ä½¿ç”¨fæ–¹æ³•--&gt;f2</span><br><span class="line">e2--ä½¿ç”¨fæ–¹æ³•--&gt;f3</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">E</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Lazy</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setF</span><span class="params">(F f)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.f = f;</span><br><span class="line">        log.info(<span class="string">&quot;setF(F f) &#123;&#125;&quot;</span>, f.getClass());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><em><strong>æ³¨æ„</strong></em></p><ul><li>@Lazy åŠ åœ¨ä¹Ÿå¯ä»¥åŠ åœ¨æˆå‘˜å˜é‡ä¸Šï¼Œä½†åŠ åœ¨ set æ–¹æ³•ä¸Šçš„ç›®çš„æ˜¯å¯ä»¥è§‚å¯Ÿè¾“å‡ºï¼ŒåŠ åœ¨æˆå‘˜å˜é‡ä¸Šå°±ä¸è¡Œäº†</li><li>@Autowired åŠ åœ¨ set æ–¹æ³•çš„ç›®çš„ç±»ä¼¼</li></ul></blockquote><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">E: setF(F f) class com.itheima.demo.cycle.F$$EnhancerBySpringCGLIB$$8b54f2bc</span><br><span class="line">F: F()</span><br><span class="line">com.itheima.demo.cycle.F@3a6f2de3</span><br><span class="line">F: F()</span><br><span class="line">com.itheima.demo.cycle.F@56303b57</span><br></pre></td></tr></table></figure><p>ä»è¾“å‡ºæ—¥å¿—å¯ä»¥çœ‹åˆ°è°ƒç”¨ setF æ–¹æ³•æ—¶ï¼Œf å¯¹è±¡çš„ç±»å‹æ˜¯ä»£ç†ç±»å‹</p><h4 id="æ¼”ç¤º2-4ç§è§£å†³æ–¹æ³•"><a href="#æ¼”ç¤º2-4ç§è§£å†³æ–¹æ³•" class="headerlink" title="æ¼”ç¤º2 - 4ç§è§£å†³æ–¹æ³•"></a>æ¼”ç¤º2 - 4ç§è§£å†³æ–¹æ³•</h4><h5 id="ä»£ç å‚è€ƒ-14"><a href="#ä»£ç å‚è€ƒ-14" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a08.sub</strong> åŒ…</p><ul><li>å¦‚æœ jdk &gt; 8, è¿è¡Œæ—¶è¯·æ·»åŠ  â€“add-opens java.base/java.lang=ALL-UNNAMED</li></ul><h4 id="æ”¶è·ğŸ’¡-14"><a href="#æ”¶è·ğŸ’¡-14" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>å•ä¾‹æ³¨å…¥å…¶å®ƒ scope çš„å››ç§è§£å†³æ–¹æ³•<ul><li>@Lazy</li><li>@Scope(value = â€œprototypeâ€, proxyMode = ScopedProxyMode.TARGET_CLASS)</li><li>ObjectFactory</li><li>ApplicationContext</li></ul></li><li>è§£å†³æ–¹æ³•è™½ç„¶ä¸åŒï¼Œä½†ç†å¿µä¸Šæ®Šé€”åŒå½’: éƒ½æ˜¯æ¨è¿Ÿå…¶å®ƒ scope bean çš„è·å–</li></ol><h2 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h2><p>AOP åº•å±‚å®ç°æ–¹å¼ä¹‹ä¸€æ˜¯ä»£ç†ï¼Œç”±ä»£ç†ç»“åˆé€šçŸ¥å’Œç›®æ ‡ï¼Œæä¾›å¢å¼ºåŠŸèƒ½</p><p>é™¤æ­¤ä»¥å¤–ï¼Œaspectj æä¾›äº†ä¸¤ç§å¦å¤–çš„ AOP åº•å±‚å®ç°ï¼š</p><ul><li><p>ç¬¬ä¸€ç§æ˜¯é€šè¿‡ ajc ç¼–è¯‘å™¨åœ¨<strong>ç¼–è¯‘</strong> class ç±»æ–‡ä»¶æ—¶ï¼Œå°±æŠŠé€šçŸ¥çš„å¢å¼ºåŠŸèƒ½ï¼Œç»‡å…¥åˆ°ç›®æ ‡ç±»çš„å­—èŠ‚ç ä¸­</p></li><li><p>ç¬¬äºŒç§æ˜¯é€šè¿‡ agent åœ¨<strong>åŠ è½½</strong>ç›®æ ‡ç±»æ—¶ï¼Œä¿®æ”¹ç›®æ ‡ç±»çš„å­—èŠ‚ç ï¼Œç»‡å…¥å¢å¼ºåŠŸèƒ½</p></li><li><p>ä½œä¸ºå¯¹æ¯”ï¼Œä¹‹å‰å­¦ä¹ çš„ä»£ç†æ˜¯<strong>è¿è¡Œ</strong>æ—¶ç”Ÿæˆæ–°çš„å­—èŠ‚ç </p></li></ul><p>ç®€å•æ¯”è¾ƒçš„è¯ï¼š</p><ul><li>aspectj åœ¨ç¼–è¯‘å’ŒåŠ è½½æ—¶ï¼Œä¿®æ”¹ç›®æ ‡å­—èŠ‚ç ï¼Œæ€§èƒ½è¾ƒé«˜</li><li>aspectj å› ä¸ºä¸ç”¨ä»£ç†ï¼Œèƒ½çªç ´ä¸€äº›æŠ€æœ¯ä¸Šçš„é™åˆ¶ï¼Œä¾‹å¦‚å¯¹æ„é€ ã€å¯¹é™æ€æ–¹æ³•ã€å¯¹ final ä¹Ÿèƒ½å¢å¼º</li><li>ä½† aspectj ä¾µå…¥æ€§è¾ƒå¼ºï¼Œä¸”éœ€è¦å­¦ä¹ æ–°çš„ aspectj ç‰¹æœ‰è¯­æ³•ï¼Œå› æ­¤æ²¡æœ‰å¹¿æ³›æµè¡Œ</li></ul><h3 id="9-AOP-å®ç°ä¹‹-ajc-ç¼–è¯‘å™¨"><a href="#9-AOP-å®ç°ä¹‹-ajc-ç¼–è¯‘å™¨" class="headerlink" title="9) AOP å®ç°ä¹‹ ajc ç¼–è¯‘å™¨"></a>9) AOP å®ç°ä¹‹ ajc ç¼–è¯‘å™¨</h3><p>ä»£ç å‚è€ƒé¡¹ç›® <strong>demo6_advanced_aspectj_01</strong></p><h4 id="æ”¶è·ğŸ’¡-15"><a href="#æ”¶è·ğŸ’¡-15" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>ç¼–è¯‘å™¨ä¹Ÿèƒ½ä¿®æ”¹ class å®ç°å¢å¼º</li><li>ç¼–è¯‘å™¨å¢å¼ºèƒ½çªç ´ä»£ç†ä»…èƒ½é€šè¿‡æ–¹æ³•é‡å†™å¢å¼ºçš„é™åˆ¶ï¼šå¯ä»¥å¯¹æ„é€ æ–¹æ³•ã€é™æ€æ–¹æ³•ç­‰å®ç°å¢å¼º</li></ol><blockquote><p><em><strong>æ³¨æ„</strong></em></p><ul><li>ç‰ˆæœ¬é€‰æ‹©äº† java 8, å› ä¸ºç›®å‰çš„ aspectj-maven-plugin 1.14.0 æœ€é«˜åªæ”¯æŒåˆ° java 16</li><li>ä¸€å®šè¦ç”¨ maven çš„ compile æ¥ç¼–è¯‘, idea ä¸ä¼šè°ƒç”¨ ajc ç¼–è¯‘å™¨</li></ul></blockquote><h3 id="10-AOP-å®ç°ä¹‹-agent-ç±»åŠ è½½"><a href="#10-AOP-å®ç°ä¹‹-agent-ç±»åŠ è½½" class="headerlink" title="10) AOP å®ç°ä¹‹ agent ç±»åŠ è½½"></a>10) AOP å®ç°ä¹‹ agent ç±»åŠ è½½</h3><p>ä»£ç å‚è€ƒé¡¹ç›® <strong>demo6_advanced_aspectj_02</strong></p><h4 id="æ”¶è·ğŸ’¡-16"><a href="#æ”¶è·ğŸ’¡-16" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>ç±»åŠ è½½æ—¶å¯ä»¥é€šè¿‡ agent ä¿®æ”¹ class å®ç°å¢å¼º</li></ol><h3 id="11-AOP-å®ç°ä¹‹-proxy"><a href="#11-AOP-å®ç°ä¹‹-proxy" class="headerlink" title="11) AOP å®ç°ä¹‹ proxy"></a>11) AOP å®ç°ä¹‹ proxy</h3><h4 id="æ¼”ç¤º1-jdk-åŠ¨æ€ä»£ç†"><a href="#æ¼”ç¤º1-jdk-åŠ¨æ€ä»£ç†" class="headerlink" title="æ¼”ç¤º1 - jdk åŠ¨æ€ä»£ç†"></a>æ¼”ç¤º1 - jdk åŠ¨æ€ä»£ç†</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JdkProxyDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Target</span> <span class="keyword">implements</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;target foo&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] param)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ç›®æ ‡å¯¹è±¡</span></span><br><span class="line">        Target target = <span class="keyword">new</span> Target();</span><br><span class="line">        <span class="comment">// ä»£ç†å¯¹è±¡</span></span><br><span class="line">        Foo proxy = (Foo) Proxy.newProxyInstance(</span><br><span class="line">                Target.class.getClassLoader(), <span class="keyword">new</span> Class[]&#123;Foo.class&#125;,</span><br><span class="line">                (p, method, args) -&gt; &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;proxy before...&quot;</span>);</span><br><span class="line">                    Object result = method.invoke(target, args);</span><br><span class="line">                    System.out.println(<span class="string">&quot;proxy after...&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> result;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="comment">// è°ƒç”¨ä»£ç†</span></span><br><span class="line">        proxy.foo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proxy before...</span><br><span class="line">target foo</span><br><span class="line">proxy after...</span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-17"><a href="#æ”¶è·ğŸ’¡-17" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ul><li>jdk åŠ¨æ€ä»£ç†è¦æ±‚ç›®æ ‡<strong>å¿…é¡»</strong>å®ç°æ¥å£ï¼Œç”Ÿæˆçš„ä»£ç†ç±»å®ç°ç›¸åŒæ¥å£ï¼Œå› æ­¤ä»£ç†ä¸ç›®æ ‡ä¹‹é—´æ˜¯å¹³çº§å…„å¼Ÿå…³ç³»</li></ul><h4 id="æ¼”ç¤º2-cglib-ä»£ç†"><a href="#æ¼”ç¤º2-cglib-ä»£ç†" class="headerlink" title="æ¼”ç¤º2 - cglib ä»£ç†"></a>æ¼”ç¤º2 - cglib ä»£ç†</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CglibProxyDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Target</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;target foo&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] param)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ç›®æ ‡å¯¹è±¡</span></span><br><span class="line">        Target target = <span class="keyword">new</span> Target();</span><br><span class="line">        <span class="comment">// ä»£ç†å¯¹è±¡</span></span><br><span class="line">        Target proxy = (Target) Enhancer.create(Target.class, </span><br><span class="line">                (MethodInterceptor) (p, method, args, methodProxy) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;proxy before...&quot;</span>);</span><br><span class="line">            Object result = methodProxy.invoke(target, args);</span><br><span class="line">            <span class="comment">// å¦ä¸€ç§è°ƒç”¨æ–¹æ³•ï¼Œä¸éœ€è¦ç›®æ ‡å¯¹è±¡å®ä¾‹</span></span><br><span class="line"><span class="comment">//            Object result = methodProxy.invokeSuper(p, args);</span></span><br><span class="line">            System.out.println(<span class="string">&quot;proxy after...&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è°ƒç”¨ä»£ç†</span></span><br><span class="line">        proxy.foo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœä¸ jdk åŠ¨æ€ä»£ç†ç›¸åŒ</p><h4 id="æ”¶è·ğŸ’¡-18"><a href="#æ”¶è·ğŸ’¡-18" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ul><li>cglib ä¸è¦æ±‚ç›®æ ‡å®ç°æ¥å£ï¼Œå®ƒç”Ÿæˆçš„ä»£ç†ç±»æ˜¯ç›®æ ‡çš„å­ç±»ï¼Œå› æ­¤ä»£ç†ä¸ç›®æ ‡ä¹‹é—´æ˜¯å­çˆ¶å…³ç³»</li><li>é™åˆ¶â›”ï¼šæ ¹æ®ä¸Šè¿°åˆ†æ final ç±»æ— æ³•è¢« cglib å¢å¼º</li></ul><h3 id="12-jdk-åŠ¨æ€ä»£ç†è¿›é˜¶"><a href="#12-jdk-åŠ¨æ€ä»£ç†è¿›é˜¶" class="headerlink" title="12) jdk åŠ¨æ€ä»£ç†è¿›é˜¶"></a>12) jdk åŠ¨æ€ä»£ç†è¿›é˜¶</h3><h4 id="æ¼”ç¤º1-æ¨¡æ‹Ÿ-jdk-åŠ¨æ€ä»£ç†"><a href="#æ¼”ç¤º1-æ¨¡æ‹Ÿ-jdk-åŠ¨æ€ä»£ç†" class="headerlink" title="æ¼”ç¤º1 - æ¨¡æ‹Ÿ jdk åŠ¨æ€ä»£ç†"></a>æ¼”ç¤º1 - æ¨¡æ‹Ÿ jdk åŠ¨æ€ä»£ç†</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A12</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">interface</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span></span>;</span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">bar</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Target</span> <span class="keyword">implements</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;target foo&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">bar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;target bar&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">100</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] param)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// â¬‡ï¸1. åˆ›å»ºä»£ç†ï¼Œè¿™æ—¶ä¼ å…¥ InvocationHandler</span></span><br><span class="line">        Foo proxy = <span class="keyword">new</span> $Proxy0(<span class="keyword">new</span> InvocationHandler() &#123;    </span><br><span class="line">            <span class="comment">// â¬‡ï¸5. è¿›å…¥ InvocationHandler</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable</span>&#123;</span><br><span class="line">                <span class="comment">// â¬‡ï¸6. åŠŸèƒ½å¢å¼º</span></span><br><span class="line">                System.out.println(<span class="string">&quot;before...&quot;</span>);</span><br><span class="line">                <span class="comment">// â¬‡ï¸7. åå°„è°ƒç”¨ç›®æ ‡æ–¹æ³•</span></span><br><span class="line">                <span class="keyword">return</span> method.invoke(<span class="keyword">new</span> Target(), args);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// â¬‡ï¸2. è°ƒç”¨ä»£ç†æ–¹æ³•</span></span><br><span class="line">        proxy.foo();</span><br><span class="line">        proxy.bar();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¨¡æ‹Ÿä»£ç†å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.UndeclaredThrowableException;</span><br><span class="line"></span><br><span class="line"><span class="comment">// â¬‡ï¸è¿™å°±æ˜¯ jdk ä»£ç†ç±»çš„æºç , ç§˜å¯†éƒ½åœ¨é‡Œé¢</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> $<span class="title">Proxy0</span> <span class="keyword">extends</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">A12</span>.<span class="title">Foo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $Proxy0(InvocationHandler h) &#123;</span><br><span class="line">        <span class="keyword">super</span>(h);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// â¬‡ï¸3. è¿›å…¥ä»£ç†æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// â¬‡ï¸4. å›è°ƒ InvocationHandler</span></span><br><span class="line">            h.invoke(<span class="keyword">this</span>, foo, <span class="keyword">new</span> Object[<span class="number">0</span>]);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException | Error e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">bar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Object result = h.invoke(<span class="keyword">this</span>, bar, <span class="keyword">new</span> Object[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">int</span>) result;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException | Error e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Method foo;</span><br><span class="line">    <span class="keyword">static</span> Method bar;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            foo = A12.Foo.class.getMethod(<span class="string">&quot;foo&quot;</span>);</span><br><span class="line">            bar = A12.Foo.class.getMethod(<span class="string">&quot;bar&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchMethodError(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-19"><a href="#æ”¶è·ğŸ’¡-19" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><p>ä»£ç†ä¸€ç‚¹éƒ½ä¸éš¾ï¼Œæ— éå°±æ˜¯åˆ©ç”¨äº†å¤šæ€ã€åå°„çš„çŸ¥è¯†</p><ol><li>æ–¹æ³•é‡å†™å¯ä»¥å¢å¼ºé€»è¾‘ï¼Œåªä¸è¿‡è¿™ã€å¢å¼ºé€»è¾‘ã€‘åƒå˜ä¸‡åŒ–ï¼Œä¸èƒ½å†™æ­»åœ¨ä»£ç†å†…éƒ¨</li><li>é€šè¿‡æ¥å£å›è°ƒå°†ã€å¢å¼ºé€»è¾‘ã€‘ç½®äºä»£ç†ç±»ä¹‹å¤–</li><li>é…åˆæ¥å£æ–¹æ³•åå°„ï¼ˆæ˜¯å¤šæ€è°ƒç”¨ï¼‰ï¼Œå°±å¯ä»¥å†è”åŠ¨è°ƒç”¨ç›®æ ‡æ–¹æ³•</li><li>ä¼šç”¨ arthas çš„ jad å·¥å…·åç¼–è¯‘ä»£ç†ç±»</li><li>é™åˆ¶â›”ï¼šä»£ç†å¢å¼ºæ˜¯å€ŸåŠ©å¤šæ€æ¥å®ç°ï¼Œå› æ­¤æˆå‘˜å˜é‡ã€é™æ€æ–¹æ³•ã€final æ–¹æ³•å‡ä¸èƒ½é€šè¿‡ä»£ç†å®ç°</li></ol><h4 id="æ¼”ç¤º2-æ–¹æ³•åå°„ä¼˜åŒ–"><a href="#æ¼”ç¤º2-æ–¹æ³•åå°„ä¼˜åŒ–" class="headerlink" title="æ¼”ç¤º2 - æ–¹æ³•åå°„ä¼˜åŒ–"></a>æ¼”ç¤º2 - æ–¹æ³•åå°„ä¼˜åŒ–</h4><h5 id="ä»£ç å‚è€ƒ-15"><a href="#ä»£ç å‚è€ƒ-15" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a12.TestMethodInvoke</strong></p><h4 id="æ”¶è·ğŸ’¡-20"><a href="#æ”¶è·ğŸ’¡-20" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>å‰ 16 æ¬¡åå°„æ€§èƒ½è¾ƒä½</li><li>ç¬¬ 17 æ¬¡è°ƒç”¨ä¼šç”Ÿæˆä»£ç†ç±»ï¼Œä¼˜åŒ–ä¸ºéåå°„è°ƒç”¨</li><li>ä¼šç”¨ arthas çš„ jad å·¥å…·åç¼–è¯‘ç¬¬ 17 æ¬¡è°ƒç”¨ç”Ÿæˆçš„ä»£ç†ç±»</li></ol><blockquote><p><em><strong>æ³¨æ„</strong></em></p><p>è¿è¡Œæ—¶è¯·æ·»åŠ  â€“add-opens java.base/java.lang.reflect=ALL-UNNAMED â€“add-opens java.base/jdk.internal.reflect=ALL-UNNAMED</p></blockquote><h3 id="13-cglib-ä»£ç†è¿›é˜¶"><a href="#13-cglib-ä»£ç†è¿›é˜¶" class="headerlink" title="13) cglib ä»£ç†è¿›é˜¶"></a>13) cglib ä»£ç†è¿›é˜¶</h3><h4 id="æ¼”ç¤º-æ¨¡æ‹Ÿ-cglib-ä»£ç†"><a href="#æ¼”ç¤º-æ¨¡æ‹Ÿ-cglib-ä»£ç†" class="headerlink" title="æ¼”ç¤º - æ¨¡æ‹Ÿ cglib ä»£ç†"></a>æ¼”ç¤º - æ¨¡æ‹Ÿ cglib ä»£ç†</h4><h5 id="ä»£ç å‚è€ƒ-16"><a href="#ä»£ç å‚è€ƒ-16" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a13</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-21"><a href="#æ”¶è·ğŸ’¡-21" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><p>å’Œ jdk åŠ¨æ€ä»£ç†åŸç†æŸ¥ä¸å¤š</p><ol><li>å›è°ƒçš„æ¥å£æ¢äº†ä¸€ä¸‹ï¼ŒInvocationHandler æ”¹æˆäº† MethodInterceptor</li><li>è°ƒç”¨ç›®æ ‡æ—¶æœ‰æ‰€æ”¹è¿›ï¼Œè§ä¸‹é¢ä»£ç ç‰‡æ®µ<ol><li>method.invoke æ˜¯åå°„è°ƒç”¨ï¼Œå¿…é¡»è°ƒç”¨åˆ°è¶³å¤Ÿæ¬¡æ•°æ‰ä¼šè¿›è¡Œä¼˜åŒ–</li><li>methodProxy.invoke æ˜¯ä¸åå°„è°ƒç”¨ï¼Œå®ƒä¼šæ­£å¸¸ï¼ˆé—´æ¥ï¼‰è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•ï¼ˆSpring é‡‡ç”¨ï¼‰</li><li>methodProxy.invokeSuper ä¹Ÿæ˜¯ä¸åå°„è°ƒç”¨ï¼Œå®ƒä¼šæ­£å¸¸ï¼ˆé—´æ¥ï¼‰è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•ï¼Œå¯ä»¥çœç•¥ç›®æ ‡å¯¹è±¡</li></ol></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A14Application</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InvocationTargetException </span>&#123;</span><br><span class="line"></span><br><span class="line">        Target target = <span class="keyword">new</span> Target();</span><br><span class="line">        Proxy proxy = <span class="keyword">new</span> Proxy();</span><br><span class="line">        </span><br><span class="line">        proxy.setCallbacks(<span class="keyword">new</span> Callback[]&#123;(MethodInterceptor) (p, m, a, mp) -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;proxy before...&quot;</span> + mp.getSignature());</span><br><span class="line">            <span class="comment">// â¬‡ï¸è°ƒç”¨ç›®æ ‡æ–¹æ³•(ä¸‰ç§)</span></span><br><span class="line"><span class="comment">//            Object result = m.invoke(target, a);  // â¬…ï¸åå°„è°ƒç”¨</span></span><br><span class="line"><span class="comment">//            Object result = mp.invoke(target, a); // â¬…ï¸éåå°„è°ƒç”¨, ç»“åˆç›®æ ‡ç”¨</span></span><br><span class="line">            Object result = mp.invokeSuper(p, a);   <span class="comment">// â¬…ï¸éåå°„è°ƒç”¨, ç»“åˆä»£ç†ç”¨</span></span><br><span class="line">            System.out.println(<span class="string">&quot;proxy after...&quot;</span> + mp.getSignature());</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;&#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// â¬‡ï¸è°ƒç”¨ä»£ç†æ–¹æ³•</span></span><br><span class="line">        proxy.save();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><em><strong>æ³¨æ„</strong></em></p><ul><li>è°ƒç”¨ Object çš„æ–¹æ³•, åä¸¤ç§åœ¨ jdk &gt;= 9 æ—¶éƒ½æœ‰é—®é¢˜, éœ€è¦ â€“add-opens java.base/java.lang=ALL-UNNAMED</li></ul></blockquote><h3 id="14-cglib-é¿å…åå°„è°ƒç”¨"><a href="#14-cglib-é¿å…åå°„è°ƒç”¨" class="headerlink" title="14) cglib é¿å…åå°„è°ƒç”¨"></a>14) cglib é¿å…åå°„è°ƒç”¨</h3><h4 id="æ¼”ç¤º-cglib-å¦‚ä½•é¿å…åå°„"><a href="#æ¼”ç¤º-cglib-å¦‚ä½•é¿å…åå°„" class="headerlink" title="æ¼”ç¤º - cglib å¦‚ä½•é¿å…åå°„"></a>æ¼”ç¤º - cglib å¦‚ä½•é¿å…åå°„</h4><h5 id="ä»£ç å‚è€ƒ-17"><a href="#ä»£ç å‚è€ƒ-17" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a13.ProxyFastClass</strong>ï¼Œ<strong>com.itheima.a13.TargetFastClass</strong></p><h4 id="æ”¶è·ğŸ’¡-22"><a href="#æ”¶è·ğŸ’¡-22" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>å½“è°ƒç”¨ MethodProxy çš„ invoke æˆ– invokeSuper æ–¹æ³•æ—¶, ä¼šåŠ¨æ€ç”Ÿæˆä¸¤ä¸ªç±»<ul><li>ProxyFastClass é…åˆä»£ç†å¯¹è±¡ä¸€èµ·ä½¿ç”¨, é¿å…åå°„</li><li>TargetFastClass é…åˆç›®æ ‡å¯¹è±¡ä¸€èµ·ä½¿ç”¨, é¿å…åå°„ (Spring ç”¨çš„è¿™ç§)</li></ul></li><li>TargetFastClass è®°å½•äº† Target ä¸­æ–¹æ³•ä¸ç¼–å·çš„å¯¹åº”å…³ç³»<ul><li>save(long) ç¼–å· 2</li><li>save(int) ç¼–å· 1</li><li>save() ç¼–å· 0</li><li>é¦–å…ˆæ ¹æ®æ–¹æ³•åå’Œå‚æ•°ä¸ªæ•°ã€ç±»å‹, ç”¨ switch å’Œ if æ‰¾åˆ°è¿™äº›æ–¹æ³•ç¼–å·</li><li>ç„¶åå†æ ¹æ®ç¼–å·å»è°ƒç”¨ç›®æ ‡æ–¹æ³•, åˆç”¨äº†ä¸€å¤§å † switch å’Œ if, ä½†é¿å…äº†åå°„</li></ul></li><li>ProxyFastClass è®°å½•äº† Proxy ä¸­æ–¹æ³•ä¸ç¼–å·çš„å¯¹åº”å…³ç³»ï¼Œä¸è¿‡ Proxy é¢å¤–æä¾›äº†ä¸‹é¢å‡ ä¸ªæ–¹æ³•<ul><li>saveSuper(long) ç¼–å· 2ï¼Œä¸å¢å¼ºï¼Œä»…æ˜¯è°ƒç”¨ super.save(long)</li><li>saveSuper(int) ç¼–å· 1ï¼Œä¸å¢å¼º, ä»…æ˜¯è°ƒç”¨ super.save(int)</li><li>saveSuper() ç¼–å· 0ï¼Œä¸å¢å¼º, ä»…æ˜¯è°ƒç”¨ super.save()</li><li>æŸ¥æ‰¾æ–¹å¼ä¸ TargetFastClass ç±»ä¼¼</li></ul></li><li>ä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆéº»çƒ¦çš„ä¸€å¥—ä¸œè¥¿å‘¢ï¼Ÿ<ul><li>é¿å…åå°„, æé«˜æ€§èƒ½, ä»£ä»·æ˜¯ä¸€ä¸ªä»£ç†ç±»é…ä¸¤ä¸ª FastClass ç±», ä»£ç†ç±»ä¸­è¿˜å¾—å¢åŠ ä»…è°ƒç”¨ super çš„ä¸€å †æ–¹æ³•</li><li>ç”¨ç¼–å·å¤„ç†æ–¹æ³•å¯¹åº”å…³ç³»æ¯”è¾ƒçœå†…å­˜, å¦å¤–, æœ€åˆè·å¾—æ–¹æ³•é¡ºåºæ˜¯ä¸ç¡®å®šçš„, è¿™ä¸ªè¿‡ç¨‹æ²¡æ³•å›ºå®šæ­»</li></ul></li></ol><h3 id="15-jdk-å’Œ-cglib-åœ¨-Spring-ä¸­çš„ç»Ÿä¸€"><a href="#15-jdk-å’Œ-cglib-åœ¨-Spring-ä¸­çš„ç»Ÿä¸€" class="headerlink" title="15) jdk å’Œ cglib åœ¨ Spring ä¸­çš„ç»Ÿä¸€"></a>15) jdk å’Œ cglib åœ¨ Spring ä¸­çš„ç»Ÿä¸€</h3><p>Spring ä¸­å¯¹åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢çš„æŠ½è±¡å¦‚ä¸‹</p><ul><li>åˆ‡ç‚¹ï¼šæ¥å£ Pointcutï¼Œå…¸å‹å®ç° AspectJExpressionPointcut</li><li>é€šçŸ¥ï¼šå…¸å‹æ¥å£ä¸º MethodInterceptor ä»£è¡¨ç¯ç»•é€šçŸ¥</li><li>åˆ‡é¢ï¼šAdvisorï¼ŒåŒ…å«ä¸€ä¸ª Advice é€šçŸ¥ï¼ŒPointcutAdvisor åŒ…å«ä¸€ä¸ª Advice é€šçŸ¥å’Œä¸€ä¸ª Pointcut</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line"></span><br><span class="line">class Advice</span><br><span class="line">class MethodInterceptor</span><br><span class="line">class Advisor</span><br><span class="line">class PointcutAdvisor</span><br><span class="line"></span><br><span class="line">Pointcut &lt;|-- AspectJExpressionPointcut</span><br><span class="line">Advice &lt;|-- MethodInterceptor</span><br><span class="line">Advisor &lt;|-- PointcutAdvisor</span><br><span class="line">PointcutAdvisor o-- &quot;ä¸€&quot; Pointcut</span><br><span class="line">PointcutAdvisor o-- &quot;ä¸€&quot; Advice</span><br><span class="line"></span><br><span class="line">&lt;&lt;interface&gt;&gt; Advice</span><br><span class="line">&lt;&lt;interface&gt;&gt; MethodInterceptor</span><br><span class="line">&lt;&lt;interface&gt;&gt; Pointcut</span><br><span class="line">&lt;&lt;interface&gt;&gt; Advisor</span><br><span class="line">&lt;&lt;interface&gt;&gt; PointcutAdvisor</span><br></pre></td></tr></table></figure><p>ä»£ç†ç›¸å…³ç±»å›¾</p><ul><li>AopProxyFactory æ ¹æ® proxyTargetClass ç­‰è®¾ç½®é€‰æ‹© AopProxy å®ç°</li><li>AopProxy é€šè¿‡ getProxy åˆ›å»ºä»£ç†å¯¹è±¡</li><li>å›¾ä¸­ Proxy éƒ½å®ç°äº† Advised æ¥å£ï¼Œèƒ½å¤Ÿè·å¾—å…³è”çš„åˆ‡é¢é›†åˆä¸ç›®æ ‡ï¼ˆå…¶å®æ˜¯ä» ProxyFactory å–å¾—ï¼‰</li><li>è°ƒç”¨ä»£ç†æ–¹æ³•æ—¶ï¼Œä¼šå€ŸåŠ© ProxyFactory å°†é€šçŸ¥ç»Ÿä¸€è½¬ä¸ºç¯ç»•é€šçŸ¥ï¼šMethodInterceptor</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line"></span><br><span class="line">Advised &lt;|-- ProxyFactory</span><br><span class="line">ProxyFactory o-- Target</span><br><span class="line">ProxyFactory o-- &quot;å¤š&quot; Advisor</span><br><span class="line"></span><br><span class="line">ProxyFactory --&gt; AopProxyFactory : ä½¿ç”¨</span><br><span class="line">AopProxyFactory --&gt; AopProxy</span><br><span class="line">Advised &lt;|-- åŸºäºCGLIBçš„Proxy</span><br><span class="line">åŸºäºCGLIBçš„Proxy &lt;-- ObjenesisCglibAopProxy : åˆ›å»º</span><br><span class="line">AopProxy &lt;|-- ObjenesisCglibAopProxy</span><br><span class="line">AopProxy &lt;|-- JdkDynamicAopProxy</span><br><span class="line">åŸºäºJDKçš„Proxy &lt;-- JdkDynamicAopProxy : åˆ›å»º</span><br><span class="line">Advised &lt;|-- åŸºäºJDKçš„Proxy</span><br><span class="line"></span><br><span class="line">class AopProxy &#123;</span><br><span class="line">   +getProxy() Object</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ProxyFactory &#123;</span><br><span class="line">proxyTargetClass : boolean</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ObjenesisCglibAopProxy &#123;</span><br><span class="line">advised : ProxyFactory</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class JdkDynamicAopProxy &#123;</span><br><span class="line">advised : ProxyFactory</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;&lt;interface&gt;&gt; Advised</span><br><span class="line">&lt;&lt;interface&gt;&gt; AopProxyFactory</span><br><span class="line">&lt;&lt;interface&gt;&gt; AopProxy</span><br></pre></td></tr></table></figure><h4 id="æ¼”ç¤º-åº•å±‚åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢"><a href="#æ¼”ç¤º-åº•å±‚åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢" class="headerlink" title="æ¼”ç¤º - åº•å±‚åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢"></a>æ¼”ç¤º - åº•å±‚åˆ‡ç‚¹ã€é€šçŸ¥ã€åˆ‡é¢</h4><h5 id="ä»£ç å‚è€ƒ-18"><a href="#ä»£ç å‚è€ƒ-18" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a15.A15</strong></p><h4 id="æ”¶è·ğŸ’¡-23"><a href="#æ”¶è·ğŸ’¡-23" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>åº•å±‚çš„åˆ‡ç‚¹å®ç°</li><li>åº•å±‚çš„é€šçŸ¥å®ç°</li><li>åº•å±‚çš„åˆ‡é¢å®ç°</li><li>ProxyFactory ç”¨æ¥åˆ›å»ºä»£ç†<ul><li>å¦‚æœæŒ‡å®šäº†æ¥å£ï¼Œä¸” proxyTargetClass = falseï¼Œä½¿ç”¨ JdkDynamicAopProxy</li><li>å¦‚æœæ²¡æœ‰æŒ‡å®šæ¥å£ï¼Œæˆ–è€… proxyTargetClass = trueï¼Œä½¿ç”¨ ObjenesisCglibAopProxy<ul><li>ä¾‹å¤–ï¼šå¦‚æœç›®æ ‡æ˜¯æ¥å£ç±»å‹æˆ–å·²ç»æ˜¯ Jdk ä»£ç†ï¼Œä½¿ç”¨ JdkDynamicAopProxy</li></ul></li></ul></li></ol><blockquote><p><em><strong>æ³¨æ„</strong></em></p><ul><li>è¦åŒºåˆ†æœ¬ç« èŠ‚æåˆ°çš„ MethodInterceptorï¼Œå®ƒä¸ä¹‹å‰ cglib ä¸­ç”¨çš„çš„ MethodInterceptor æ˜¯ä¸åŒçš„æ¥å£</li></ul></blockquote><h3 id="16-åˆ‡ç‚¹åŒ¹é…"><a href="#16-åˆ‡ç‚¹åŒ¹é…" class="headerlink" title="16) åˆ‡ç‚¹åŒ¹é…"></a>16) åˆ‡ç‚¹åŒ¹é…</h3><h4 id="æ¼”ç¤º-åˆ‡ç‚¹åŒ¹é…"><a href="#æ¼”ç¤º-åˆ‡ç‚¹åŒ¹é…" class="headerlink" title="æ¼”ç¤º - åˆ‡ç‚¹åŒ¹é…"></a>æ¼”ç¤º - åˆ‡ç‚¹åŒ¹é…</h4><h5 id="ä»£ç å‚è€ƒ-19"><a href="#ä»£ç å‚è€ƒ-19" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a16.A16</strong></p><h4 id="æ”¶è·ğŸ’¡-24"><a href="#æ”¶è·ğŸ’¡-24" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>å¸¸è§ aspectj åˆ‡ç‚¹ç”¨æ³•</li><li>aspectj åˆ‡ç‚¹çš„å±€é™æ€§ï¼Œå®é™…çš„ @Transactional åˆ‡ç‚¹å®ç°</li></ol><h3 id="17-ä»-Aspect-åˆ°-Advisor"><a href="#17-ä»-Aspect-åˆ°-Advisor" class="headerlink" title="17) ä» @Aspect åˆ° Advisor"></a>17) ä» @Aspect åˆ° Advisor</h3><h4 id="æ¼”ç¤º1-ä»£ç†åˆ›å»ºå™¨"><a href="#æ¼”ç¤º1-ä»£ç†åˆ›å»ºå™¨" class="headerlink" title="æ¼”ç¤º1 - ä»£ç†åˆ›å»ºå™¨"></a>æ¼”ç¤º1 - ä»£ç†åˆ›å»ºå™¨</h4><h5 id="ä»£ç å‚è€ƒ-20"><a href="#ä»£ç å‚è€ƒ-20" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>org.springframework.aop.framework.autoproxy</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-25"><a href="#æ”¶è·ğŸ’¡-25" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>AnnotationAwareAspectJAutoProxyCreator çš„ä½œç”¨<ul><li>å°†é«˜çº§ @Aspect åˆ‡é¢ç»Ÿä¸€ä¸ºä½çº§ Advisor åˆ‡é¢</li><li>åœ¨åˆé€‚çš„æ—¶æœºåˆ›å»ºä»£ç†</li></ul></li><li>findEligibleAdvisors æ‰¾åˆ°æœ‰ã€èµ„æ ¼ã€‘çš„ Advisors<ul><li>æœ‰ã€èµ„æ ¼ã€‘çš„ Advisor ä¸€éƒ¨åˆ†æ˜¯ä½çº§çš„, å¯ä»¥ç”±è‡ªå·±ç¼–å†™, å¦‚æœ¬ä¾‹ A17 ä¸­çš„ advisor3</li><li>æœ‰ã€èµ„æ ¼ã€‘çš„ Advisor å¦ä¸€éƒ¨åˆ†æ˜¯é«˜çº§çš„, ç”±è§£æ @Aspect åè·å¾—</li></ul></li><li>wrapIfNecessary<ul><li>å®ƒå†…éƒ¨è°ƒç”¨ findEligibleAdvisors, åªè¦è¿”å›é›†åˆä¸ç©º, åˆ™è¡¨ç¤ºéœ€è¦åˆ›å»ºä»£ç†</li><li>å®ƒçš„è°ƒç”¨æ—¶æœºé€šå¸¸åœ¨åŸå§‹å¯¹è±¡åˆå§‹åŒ–åæ‰§è¡Œ, ä½†ç¢°åˆ°å¾ªç¯ä¾èµ–ä¼šæå‰è‡³ä¾èµ–æ³¨å…¥ä¹‹å‰æ‰§è¡Œ</li></ul></li></ol><h4 id="æ¼”ç¤º2-ä»£ç†åˆ›å»ºæ—¶æœº"><a href="#æ¼”ç¤º2-ä»£ç†åˆ›å»ºæ—¶æœº" class="headerlink" title="æ¼”ç¤º2 - ä»£ç†åˆ›å»ºæ—¶æœº"></a>æ¼”ç¤º2 - ä»£ç†åˆ›å»ºæ—¶æœº</h4><h5 id="ä»£ç å‚è€ƒ-21"><a href="#ä»£ç å‚è€ƒ-21" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>org.springframework.aop.framework.autoproxy.A17_1</strong></p><h4 id="æ”¶è·ğŸ’¡-26"><a href="#æ”¶è·ğŸ’¡-26" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>ä»£ç†çš„åˆ›å»ºæ—¶æœº<ul><li>åˆå§‹åŒ–ä¹‹å (æ— å¾ªç¯ä¾èµ–æ—¶)</li><li>å®ä¾‹åˆ›å»ºå, ä¾èµ–æ³¨å…¥å‰ (æœ‰å¾ªç¯ä¾èµ–æ—¶), å¹¶æš‚å­˜äºäºŒçº§ç¼“å­˜</li></ul></li><li>ä¾èµ–æ³¨å…¥ä¸åˆå§‹åŒ–ä¸åº”è¯¥è¢«å¢å¼º, ä»åº”è¢«æ–½åŠ äºåŸå§‹å¯¹è±¡</li></ol><h4 id="æ¼”ç¤º3-Before-å¯¹åº”çš„ä½çº§é€šçŸ¥"><a href="#æ¼”ç¤º3-Before-å¯¹åº”çš„ä½çº§é€šçŸ¥" class="headerlink" title="æ¼”ç¤º3 - @Before å¯¹åº”çš„ä½çº§é€šçŸ¥"></a>æ¼”ç¤º3 - @Before å¯¹åº”çš„ä½çº§é€šçŸ¥</h4><h5 id="ä»£ç å‚è€ƒ-22"><a href="#ä»£ç å‚è€ƒ-22" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>org.springframework.aop.framework.autoproxy.A17_2</strong></p><h4 id="æ”¶è·ğŸ’¡-27"><a href="#æ”¶è·ğŸ’¡-27" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>@Before å‰ç½®é€šçŸ¥ä¼šè¢«è½¬æ¢ä¸ºåŸå§‹çš„ AspectJMethodBeforeAdvice å½¢å¼, è¯¥å¯¹è±¡åŒ…å«äº†å¦‚ä¸‹ä¿¡æ¯<ol><li>é€šçŸ¥ä»£ç ä»å“ªå„¿æ¥</li><li>åˆ‡ç‚¹æ˜¯ä»€ä¹ˆ(è¿™é‡Œä¸ºå•¥è¦åˆ‡ç‚¹, åé¢è§£é‡Š)</li><li>é€šçŸ¥å¯¹è±¡å¦‚ä½•åˆ›å»º, æœ¬ä¾‹å…±ç”¨åŒä¸€ä¸ª Aspect å¯¹è±¡</li></ol></li><li>ç±»ä¼¼çš„è¿˜æœ‰<ol><li>AspectJAroundAdvice (ç¯ç»•é€šçŸ¥)</li><li>AspectJAfterReturningAdvice</li><li>AspectJAfterThrowingAdvice (ç¯ç»•é€šçŸ¥)</li><li>AspectJAfterAdvice (ç¯ç»•é€šçŸ¥)</li></ol></li></ol><h3 id="18-é™æ€é€šçŸ¥è°ƒç”¨"><a href="#18-é™æ€é€šçŸ¥è°ƒç”¨" class="headerlink" title="18) é™æ€é€šçŸ¥è°ƒç”¨"></a>18) é™æ€é€šçŸ¥è°ƒç”¨</h3><p>ä»£ç†å¯¹è±¡è°ƒç”¨æµç¨‹å¦‚ä¸‹ï¼ˆä»¥ JDK åŠ¨æ€ä»£ç†å®ç°ä¸ºä¾‹ï¼‰</p><ul><li>ä» ProxyFactory è·å¾— Target å’Œç¯ç»•é€šçŸ¥é“¾ï¼Œæ ¹æ®ä»–ä¿©åˆ›å»º MethodInvocationï¼Œç®€ç§° mi</li><li>é¦–æ¬¡æ‰§è¡Œ mi.proceed() å‘ç°æœ‰ä¸‹ä¸€ä¸ªç¯ç»•é€šçŸ¥ï¼Œè°ƒç”¨å®ƒçš„ invoke(mi)</li><li>è¿›å…¥ç¯ç»•é€šçŸ¥1ï¼Œæ‰§è¡Œå‰å¢å¼ºï¼Œå†æ¬¡è°ƒç”¨ mi.proceed() å‘ç°æœ‰ä¸‹ä¸€ä¸ªç¯ç»•é€šçŸ¥ï¼Œè°ƒç”¨å®ƒçš„ invoke(mi)</li><li>è¿›å…¥ç¯ç»•é€šçŸ¥2ï¼Œæ‰§è¡Œå‰å¢å¼ºï¼Œè°ƒç”¨ mi.proceed() å‘ç°æ²¡æœ‰ç¯ç»•é€šçŸ¥ï¼Œè°ƒç”¨ mi.invokeJoinPoint() æ‰§è¡Œç›®æ ‡æ–¹æ³•</li><li>ç›®æ ‡æ–¹æ³•æ‰§è¡Œç»“æŸï¼Œå°†ç»“æœè¿”å›ç»™ç¯ç»•é€šçŸ¥2ï¼Œæ‰§è¡Œç¯ç»•é€šçŸ¥2 çš„åå¢å¼º</li><li>ç¯ç»•é€šçŸ¥2ç»§ç»­å°†ç»“æœè¿”å›ç»™ç¯ç»•é€šçŸ¥1ï¼Œæ‰§è¡Œç¯ç»•é€šçŸ¥1 çš„åå¢å¼º</li><li>ç¯ç»•é€šçŸ¥1è¿”å›æœ€ç»ˆçš„ç»“æœ</li></ul><p>å›¾ä¸­ä¸åŒé¢œè‰²å¯¹åº”ä¸€æ¬¡ç¯ç»•é€šçŸ¥æˆ–ç›®æ ‡çš„è°ƒç”¨èµ·å§‹è‡³ç»ˆç»“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">participant Proxy</span><br><span class="line">participant ih as InvocationHandler</span><br><span class="line">participant mi as MethodInvocation</span><br><span class="line">participant Factory as ProxyFactory</span><br><span class="line">participant mi1 as MethodInterceptor1</span><br><span class="line">participant mi2 as MethodInterceptor2</span><br><span class="line">participant Target</span><br><span class="line"></span><br><span class="line">Proxy -&gt;&gt; +ih : invoke()</span><br><span class="line">ih -&gt;&gt; +Factory : è·å¾— Target</span><br><span class="line">Factory --&gt;&gt; -ih : </span><br><span class="line">ih -&gt;&gt; +Factory : è·å¾— MethodInterceptor é“¾</span><br><span class="line">Factory --&gt;&gt; -ih : </span><br><span class="line">ih -&gt;&gt; +mi : åˆ›å»º mi</span><br><span class="line">mi --&gt;&gt; -ih : </span><br><span class="line">rect rgb(200, 223, 255)</span><br><span class="line">ih -&gt;&gt; +mi : mi.proceed()</span><br><span class="line">mi -&gt;&gt; +mi1 : invoke(mi)</span><br><span class="line">mi1 -&gt;&gt; mi1 : å‰å¢å¼º</span><br><span class="line">rect rgb(200, 190, 255)</span><br><span class="line">mi1 -&gt;&gt; mi : mi.proceed()</span><br><span class="line">mi -&gt;&gt; +mi2 : invoke(mi)</span><br><span class="line">mi2 -&gt;&gt; mi2 : å‰å¢å¼º</span><br><span class="line">rect rgb(150, 190, 155)</span><br><span class="line">mi2 -&gt;&gt; mi : mi.proceed()</span><br><span class="line">mi -&gt;&gt; +Target : mi.invokeJoinPoint()</span><br><span class="line">Target -&gt;&gt; Target : </span><br><span class="line">Target --&gt;&gt; -mi2 : ç»“æœ</span><br><span class="line">end</span><br><span class="line">mi2 -&gt;&gt; mi2 : åå¢å¼º</span><br><span class="line">mi2 --&gt;&gt; -mi1 : ç»“æœ</span><br><span class="line">end</span><br><span class="line">mi1 -&gt;&gt; mi1 : åå¢å¼º</span><br><span class="line">mi1 --&gt;&gt; -mi : ç»“æœ</span><br><span class="line">mi --&gt;&gt; -ih : </span><br><span class="line">end</span><br><span class="line">ih --&gt;&gt; -Proxy : </span><br></pre></td></tr></table></figure><h4 id="æ¼”ç¤º1-é€šçŸ¥è°ƒç”¨è¿‡ç¨‹"><a href="#æ¼”ç¤º1-é€šçŸ¥è°ƒç”¨è¿‡ç¨‹" class="headerlink" title="æ¼”ç¤º1 - é€šçŸ¥è°ƒç”¨è¿‡ç¨‹"></a>æ¼”ç¤º1 - é€šçŸ¥è°ƒç”¨è¿‡ç¨‹</h4><h5 id="ä»£ç å‚è€ƒ-23"><a href="#ä»£ç å‚è€ƒ-23" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>org.springframework.aop.framework.A18</strong></p><h4 id="æ”¶è·ğŸ’¡-28"><a href="#æ”¶è·ğŸ’¡-28" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><p>ä»£ç†æ–¹æ³•æ‰§è¡Œæ—¶ä¼šåšå¦‚ä¸‹å·¥ä½œ</p><ol><li>é€šè¿‡ proxyFactory çš„ getInterceptorsAndDynamicInterceptionAdvice() å°†å…¶ä»–é€šçŸ¥ç»Ÿä¸€è½¬æ¢ä¸º MethodInterceptor ç¯ç»•é€šçŸ¥<ul><li>MethodBeforeAdviceAdapter å°† @Before AspectJMethodBeforeAdvice é€‚é…ä¸º MethodBeforeAdviceInterceptor</li><li>AfterReturningAdviceAdapter å°† @AfterReturning AspectJAfterReturningAdvice é€‚é…ä¸º AfterReturningAdviceInterceptor</li><li>è¿™ä½“ç°çš„æ˜¯é€‚é…å™¨è®¾è®¡æ¨¡å¼</li></ul></li><li>æ‰€è°“é™æ€é€šçŸ¥ï¼Œä½“ç°åœ¨ä¸Šé¢æ–¹æ³•çš„ Interceptors éƒ¨åˆ†ï¼Œè¿™äº›é€šçŸ¥è°ƒç”¨æ—¶æ— éœ€å†æ¬¡æ£€æŸ¥åˆ‡ç‚¹ï¼Œç›´æ¥è°ƒç”¨å³å¯</li><li>ç»“åˆç›®æ ‡ä¸ç¯ç»•é€šçŸ¥é“¾ï¼Œåˆ›å»º MethodInvocation å¯¹è±¡ï¼Œé€šè¿‡å®ƒå®Œæˆæ•´ä¸ªè°ƒç”¨</li></ol><h4 id="æ¼”ç¤º2-æ¨¡æ‹Ÿ-MethodInvocation"><a href="#æ¼”ç¤º2-æ¨¡æ‹Ÿ-MethodInvocation" class="headerlink" title="æ¼”ç¤º2 - æ¨¡æ‹Ÿ MethodInvocation"></a>æ¼”ç¤º2 - æ¨¡æ‹Ÿ MethodInvocation</h4><h5 id="ä»£ç å‚è€ƒ-24"><a href="#ä»£ç å‚è€ƒ-24" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>org.springframework.aop.framework.A18_1</strong></p><h4 id="æ”¶è·ğŸ’¡-29"><a href="#æ”¶è·ğŸ’¡-29" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>proceed() æ–¹æ³•è°ƒç”¨é“¾ä¸­ä¸‹ä¸€ä¸ªç¯ç»•é€šçŸ¥</li><li>æ¯ä¸ªç¯ç»•é€šçŸ¥å†…éƒ¨ç»§ç»­è°ƒç”¨ proceed()</li><li>è°ƒç”¨åˆ°æ²¡æœ‰æ›´å¤šé€šçŸ¥äº†, å°±è°ƒç”¨ç›®æ ‡æ–¹æ³•</li></ol><p>MethodInvocation çš„ç¼–ç¨‹æŠ€å·§åœ¨å®ç°æ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨æ—¶èƒ½ç”¨ä¸Š</p><h3 id="19-åŠ¨æ€é€šçŸ¥è°ƒç”¨"><a href="#19-åŠ¨æ€é€šçŸ¥è°ƒç”¨" class="headerlink" title="19) åŠ¨æ€é€šçŸ¥è°ƒç”¨"></a>19) åŠ¨æ€é€šçŸ¥è°ƒç”¨</h3><h4 id="æ¼”ç¤º-å¸¦å‚æ•°ç»‘å®šçš„é€šçŸ¥æ–¹æ³•è°ƒç”¨"><a href="#æ¼”ç¤º-å¸¦å‚æ•°ç»‘å®šçš„é€šçŸ¥æ–¹æ³•è°ƒç”¨" class="headerlink" title="æ¼”ç¤º - å¸¦å‚æ•°ç»‘å®šçš„é€šçŸ¥æ–¹æ³•è°ƒç”¨"></a>æ¼”ç¤º - å¸¦å‚æ•°ç»‘å®šçš„é€šçŸ¥æ–¹æ³•è°ƒç”¨</h4><h5 id="ä»£ç å‚è€ƒ-25"><a href="#ä»£ç å‚è€ƒ-25" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>org.springframework.aop.framework.autoproxy.A19</strong></p><h4 id="æ”¶è·ğŸ’¡-30"><a href="#æ”¶è·ğŸ’¡-30" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>é€šè¿‡ proxyFactory çš„ getInterceptorsAndDynamicInterceptionAdvice() å°†å…¶ä»–é€šçŸ¥ç»Ÿä¸€è½¬æ¢ä¸º MethodInterceptor ç¯ç»•é€šçŸ¥</li><li>æ‰€è°“åŠ¨æ€é€šçŸ¥ï¼Œä½“ç°åœ¨ä¸Šé¢æ–¹æ³•çš„ DynamicInterceptionAdvice éƒ¨åˆ†ï¼Œè¿™äº›é€šçŸ¥è°ƒç”¨æ—¶å› ä¸ºè¦ä¸ºé€šçŸ¥æ–¹æ³•ç»‘å®šå‚æ•°ï¼Œè¿˜éœ€å†æ¬¡åˆ©ç”¨åˆ‡ç‚¹è¡¨è¾¾å¼</li><li>åŠ¨æ€é€šçŸ¥è°ƒç”¨å¤æ‚ç¨‹åº¦é«˜ï¼Œæ€§èƒ½è¾ƒä½</li></ol><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="20-RequestMappingHandlerMapping-ä¸-RequestMappingHandlerAdapter"><a href="#20-RequestMappingHandlerMapping-ä¸-RequestMappingHandlerAdapter" class="headerlink" title="20) RequestMappingHandlerMapping ä¸ RequestMappingHandlerAdapter"></a>20) RequestMappingHandlerMapping ä¸ RequestMappingHandlerAdapter</h3><p>RequestMappingHandlerMapping ä¸ RequestMappingHandlerAdapter ä¿©æ˜¯ä¸€å¯¹ï¼Œåˆ†åˆ«ç”¨æ¥</p><ul><li>å¤„ç† @RequestMapping æ˜ å°„</li><li>è°ƒç”¨æ§åˆ¶å™¨æ–¹æ³•ã€å¹¶å¤„ç†æ–¹æ³•å‚æ•°ä¸æ–¹æ³•è¿”å›å€¼</li></ul><h4 id="æ¼”ç¤º1-DispatcherServlet-åˆå§‹åŒ–"><a href="#æ¼”ç¤º1-DispatcherServlet-åˆå§‹åŒ–" class="headerlink" title="æ¼”ç¤º1 - DispatcherServlet åˆå§‹åŒ–"></a>æ¼”ç¤º1 - DispatcherServlet åˆå§‹åŒ–</h4><h5 id="ä»£ç å‚è€ƒ-26"><a href="#ä»£ç å‚è€ƒ-26" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a20</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-31"><a href="#æ”¶è·ğŸ’¡-31" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>DispatcherServlet æ˜¯åœ¨ç¬¬ä¸€æ¬¡è¢«è®¿é—®æ—¶æ‰§è¡Œåˆå§‹åŒ–, ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®ä¿®æ”¹ä¸º Tomcat å¯åŠ¨åå°±åˆå§‹åŒ–</li><li>åœ¨åˆå§‹åŒ–æ—¶ä¼šä» Spring å®¹å™¨ä¸­æ‰¾ä¸€äº› Web éœ€è¦çš„ç»„ä»¶, å¦‚ HandlerMappingã€HandlerAdapter ç­‰ï¼Œå¹¶é€ä¸€è°ƒç”¨å®ƒä»¬çš„åˆå§‹åŒ–</li><li>RequestMappingHandlerMapping åˆå§‹åŒ–æ—¶ï¼Œä¼šæ”¶é›†æ‰€æœ‰ @RequestMapping æ˜ å°„ä¿¡æ¯ï¼Œå°è£…ä¸º Mapï¼Œå…¶ä¸­<ul><li>key æ˜¯ RequestMappingInfo ç±»å‹ï¼ŒåŒ…æ‹¬è¯·æ±‚è·¯å¾„ã€è¯·æ±‚æ–¹æ³•ç­‰ä¿¡æ¯</li><li>value æ˜¯ HandlerMethod ç±»å‹ï¼ŒåŒ…æ‹¬æ§åˆ¶å™¨æ–¹æ³•å¯¹è±¡ã€æ§åˆ¶å™¨å¯¹è±¡</li><li>æœ‰äº†è¿™ä¸ª Mapï¼Œå°±å¯ä»¥åœ¨è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œå¿«é€Ÿå®Œæˆæ˜ å°„ï¼Œæ‰¾åˆ° HandlerMethod å¹¶ä¸åŒ¹é…çš„æ‹¦æˆªå™¨ä¸€èµ·è¿”å›ç»™ DispatcherServlet</li></ul></li><li>RequestMappingHandlerAdapter åˆå§‹åŒ–æ—¶ï¼Œä¼šå‡†å¤‡ HandlerMethod è°ƒç”¨æ—¶éœ€è¦çš„å„ä¸ªç»„ä»¶ï¼Œå¦‚ï¼š<ul><li>HandlerMethodArgumentResolver è§£ææ§åˆ¶å™¨æ–¹æ³•å‚æ•°</li><li>HandlerMethodReturnValueHandler å¤„ç†æ§åˆ¶å™¨æ–¹æ³•è¿”å›å€¼</li></ul></li></ol><h4 id="æ¼”ç¤º2-è‡ªå®šä¹‰å‚æ•°ä¸è¿”å›å€¼å¤„ç†å™¨"><a href="#æ¼”ç¤º2-è‡ªå®šä¹‰å‚æ•°ä¸è¿”å›å€¼å¤„ç†å™¨" class="headerlink" title="æ¼”ç¤º2 - è‡ªå®šä¹‰å‚æ•°ä¸è¿”å›å€¼å¤„ç†å™¨"></a>æ¼”ç¤º2 - è‡ªå®šä¹‰å‚æ•°ä¸è¿”å›å€¼å¤„ç†å™¨</h4><h5 id="ä»£ç å‚è€ƒ-27"><a href="#ä»£ç å‚è€ƒ-27" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a20.TokenArgumentResolver</strong> ï¼Œ<strong>com.itheima.a20.YmlReturnValueHandler</strong></p><h4 id="æ”¶è·ğŸ’¡-32"><a href="#æ”¶è·ğŸ’¡-32" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>ä½“ä¼šå‚æ•°è§£æå™¨çš„ä½œç”¨</li><li>ä½“ä¼šè¿”å›å€¼å¤„ç†å™¨çš„ä½œç”¨</li></ol><h3 id="21-å‚æ•°è§£æå™¨"><a href="#21-å‚æ•°è§£æå™¨" class="headerlink" title="21) å‚æ•°è§£æå™¨"></a>21) å‚æ•°è§£æå™¨</h3><h4 id="æ¼”ç¤º-å¸¸è§å‚æ•°è§£æå™¨"><a href="#æ¼”ç¤º-å¸¸è§å‚æ•°è§£æå™¨" class="headerlink" title="æ¼”ç¤º - å¸¸è§å‚æ•°è§£æå™¨"></a>æ¼”ç¤º - å¸¸è§å‚æ•°è§£æå™¨</h4><h5 id="ä»£ç å‚è€ƒ-28"><a href="#ä»£ç å‚è€ƒ-28" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a21</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-33"><a href="#æ”¶è·ğŸ’¡-33" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>åˆæ­¥äº†è§£ RequestMappingHandlerAdapter çš„è°ƒç”¨è¿‡ç¨‹<ol><li>æ§åˆ¶å™¨æ–¹æ³•è¢«å°è£…ä¸º HandlerMethod</li><li>å‡†å¤‡å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢</li><li>å‡†å¤‡ ModelAndViewContainer ç”¨æ¥å­˜å‚¨ä¸­é—´ Model ç»“æœ</li><li>è§£ææ¯ä¸ªå‚æ•°å€¼</li></ol></li><li>è§£æå‚æ•°ä¾èµ–çš„å°±æ˜¯å„ç§å‚æ•°è§£æå™¨ï¼Œå®ƒä»¬éƒ½æœ‰ä¸¤ä¸ªé‡è¦æ–¹æ³•<ul><li>supportsParameter åˆ¤æ–­æ˜¯å¦æ”¯æŒæ–¹æ³•å‚æ•°</li><li>resolveArgument è§£ææ–¹æ³•å‚æ•°</li></ul></li><li>å¸¸è§å‚æ•°çš„è§£æ<ul><li>@RequestParam</li><li>çœç•¥ @RequestParam</li><li>@RequestParam(defaultValue)</li><li>MultipartFile</li><li>@PathVariable</li><li>@RequestHeader</li><li>@CookieValue</li><li>@Value</li><li>HttpServletRequest ç­‰</li><li>@ModelAttribute</li><li>çœç•¥ @ModelAttribute</li><li>@RequestBody</li></ul></li><li>ç»„åˆæ¨¡å¼åœ¨ Spring ä¸­çš„ä½“ç°</li><li>@RequestParam, @CookieValue ç­‰æ³¨è§£ä¸­çš„å‚æ•°åã€é»˜è®¤å€¼, éƒ½å¯ä»¥å†™æˆæ´»çš„, å³ä» ${ } #{ }ä¸­è·å–</li></ol><h3 id="22-å‚æ•°åè§£æ"><a href="#22-å‚æ•°åè§£æ" class="headerlink" title="22) å‚æ•°åè§£æ"></a>22) å‚æ•°åè§£æ</h3><h4 id="æ¼”ç¤º-ä¸¤ç§æ–¹æ³•è·å–å‚æ•°å"><a href="#æ¼”ç¤º-ä¸¤ç§æ–¹æ³•è·å–å‚æ•°å" class="headerlink" title="æ¼”ç¤º - ä¸¤ç§æ–¹æ³•è·å–å‚æ•°å"></a>æ¼”ç¤º - ä¸¤ç§æ–¹æ³•è·å–å‚æ•°å</h4><h5 id="ä»£ç å‚è€ƒ-29"><a href="#ä»£ç å‚è€ƒ-29" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a22.A22</strong></p><h4 id="æ”¶è·ğŸ’¡-34"><a href="#æ”¶è·ğŸ’¡-34" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>å¦‚æœç¼–è¯‘æ—¶æ·»åŠ äº† -parameters å¯ä»¥ç”Ÿæˆå‚æ•°è¡¨, åå°„æ—¶å°±å¯ä»¥æ‹¿åˆ°å‚æ•°å</li><li>å¦‚æœç¼–è¯‘æ—¶æ·»åŠ äº† -g å¯ä»¥ç”Ÿæˆè°ƒè¯•ä¿¡æ¯, ä½†åˆ†ä¸ºä¸¤ç§æƒ…å†µ<ul><li>æ™®é€šç±», ä¼šåŒ…å«å±€éƒ¨å˜é‡è¡¨, ç”¨ asm å¯ä»¥æ‹¿åˆ°å‚æ•°å</li><li>æ¥å£, ä¸ä¼šåŒ…å«å±€éƒ¨å˜é‡è¡¨, æ— æ³•è·å¾—å‚æ•°å<ul><li>è¿™ä¹Ÿæ˜¯ MyBatis åœ¨å®ç° Mapper æ¥å£æ—¶ä¸ºä½•è¦æä¾› @Param æ³¨è§£æ¥è¾…åŠ©è·å¾—å‚æ•°å</li></ul></li></ul></li></ol><h3 id="23-å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢"><a href="#23-å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢" class="headerlink" title="23) å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢"></a>23) å¯¹è±¡ç»‘å®šä¸ç±»å‹è½¬æ¢</h3><h4 id="åº•å±‚ç¬¬ä¸€å¥—è½¬æ¢æ¥å£ä¸å®ç°"><a href="#åº•å±‚ç¬¬ä¸€å¥—è½¬æ¢æ¥å£ä¸å®ç°" class="headerlink" title="åº•å±‚ç¬¬ä¸€å¥—è½¬æ¢æ¥å£ä¸å®ç°"></a>åº•å±‚ç¬¬ä¸€å¥—è½¬æ¢æ¥å£ä¸å®ç°</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line"></span><br><span class="line">Formatter --|&gt; Printer</span><br><span class="line">Formatter --|&gt; Parser</span><br><span class="line"></span><br><span class="line">class Converters &#123;</span><br><span class="line">   Set~GenericConverter~</span><br><span class="line">&#125;</span><br><span class="line">class Converter</span><br><span class="line"></span><br><span class="line">class ConversionService</span><br><span class="line">class FormattingConversionService</span><br><span class="line"></span><br><span class="line">ConversionService &lt;|-- FormattingConversionService</span><br><span class="line">FormattingConversionService o-- Converters</span><br><span class="line"></span><br><span class="line">Printer --&gt; Adapter1</span><br><span class="line">Adapter1 --&gt; Converters</span><br><span class="line">Parser --&gt; Adapter2</span><br><span class="line">Adapter2 --&gt; Converters</span><br><span class="line">Converter --&gt; Adapter3</span><br><span class="line">Adapter3 --&gt; Converters</span><br><span class="line"></span><br><span class="line">&lt;&lt;interface&gt;&gt; Formatter</span><br><span class="line">&lt;&lt;interface&gt;&gt; Printer</span><br><span class="line">&lt;&lt;interface&gt;&gt; Parser</span><br><span class="line">&lt;&lt;interface&gt;&gt; Converter</span><br><span class="line">&lt;&lt;interface&gt;&gt; ConversionService</span><br></pre></td></tr></table></figure><ul><li>Printer æŠŠå…¶å®ƒç±»å‹è½¬ä¸º String</li><li>Parser æŠŠ String è½¬ä¸ºå…¶å®ƒç±»å‹</li><li>Formatter ç»¼åˆ Printer ä¸ Parser åŠŸèƒ½</li><li>Converter æŠŠç±»å‹ S è½¬ä¸ºç±»å‹ T</li><li>Printerã€Parserã€Converter ç»è¿‡é€‚é…è½¬æ¢æˆ GenericConverter æ”¾å…¥ Converters é›†åˆ</li><li>FormattingConversionService åˆ©ç”¨å…¶å®ƒä»¬å®ç°è½¬æ¢</li></ul><h4 id="åº•å±‚ç¬¬äºŒå¥—è½¬æ¢æ¥å£"><a href="#åº•å±‚ç¬¬äºŒå¥—è½¬æ¢æ¥å£" class="headerlink" title="åº•å±‚ç¬¬äºŒå¥—è½¬æ¢æ¥å£"></a>åº•å±‚ç¬¬äºŒå¥—è½¬æ¢æ¥å£</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line"></span><br><span class="line">PropertyEditorRegistry o-- &quot;å¤š&quot; PropertyEditor</span><br><span class="line"></span><br><span class="line">&lt;&lt;interface&gt;&gt; PropertyEditorRegistry</span><br><span class="line">&lt;&lt;interface&gt;&gt; PropertyEditor</span><br></pre></td></tr></table></figure><ul><li>PropertyEditor æŠŠ String ä¸å…¶å®ƒç±»å‹ç›¸äº’è½¬æ¢</li><li>PropertyEditorRegistry å¯ä»¥æ³¨å†Œå¤šä¸ª PropertyEditor å¯¹è±¡</li><li>ä¸ç¬¬ä¸€å¥—æ¥å£ç›´æ¥å¯ä»¥é€šè¿‡ FormatterPropertyEditorAdapter æ¥è¿›è¡Œé€‚é…</li></ul><h4 id="é«˜å±‚æ¥å£ä¸å®ç°"><a href="#é«˜å±‚æ¥å£ä¸å®ç°" class="headerlink" title="é«˜å±‚æ¥å£ä¸å®ç°"></a>é«˜å±‚æ¥å£ä¸å®ç°</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">TypeConverter &lt;|-- SimpleTypeConverter</span><br><span class="line">TypeConverter &lt;|-- BeanWrapperImpl</span><br><span class="line">TypeConverter &lt;|-- DirectFieldAccessor</span><br><span class="line">TypeConverter &lt;|-- ServletRequestDataBinder</span><br><span class="line"></span><br><span class="line">SimpleTypeConverter --&gt; TypeConverterDelegate</span><br><span class="line">BeanWrapperImpl --&gt; TypeConverterDelegate</span><br><span class="line">DirectFieldAccessor --&gt; TypeConverterDelegate</span><br><span class="line">ServletRequestDataBinder --&gt; TypeConverterDelegate</span><br><span class="line"></span><br><span class="line">TypeConverterDelegate --&gt; ConversionService</span><br><span class="line">TypeConverterDelegate --&gt; PropertyEditorRegistry</span><br><span class="line"></span><br><span class="line">&lt;&lt;interface&gt;&gt; TypeConverter</span><br><span class="line">&lt;&lt;interface&gt;&gt; ConversionService</span><br><span class="line">&lt;&lt;interface&gt;&gt; PropertyEditorRegistry</span><br></pre></td></tr></table></figure><ul><li>å®ƒä»¬éƒ½å®ç°äº† TypeConverter è¿™ä¸ªé«˜å±‚è½¬æ¢æ¥å£ï¼Œåœ¨è½¬æ¢æ—¶ï¼Œä¼šç”¨åˆ° TypeConverter Delegate å§”æ´¾ConversionService ä¸ PropertyEditorRegistry çœŸæ­£æ‰§è¡Œè½¬æ¢ï¼ˆFacade é—¨é¢æ¨¡å¼ï¼‰<ul><li>é¦–å…ˆçœ‹æ˜¯å¦æœ‰è‡ªå®šä¹‰è½¬æ¢å™¨, @InitBinder æ·»åŠ çš„å³å±äºè¿™ç§ (ç”¨äº†é€‚é…å™¨æ¨¡å¼æŠŠ Formatter è½¬ä¸ºéœ€è¦çš„ PropertyEditor)</li><li>å†çœ‹æœ‰æ²¡æœ‰ ConversionService è½¬æ¢</li><li>å†åˆ©ç”¨é»˜è®¤çš„ PropertyEditor è½¬æ¢</li><li>æœ€åæœ‰ä¸€äº›ç‰¹æ®Šå¤„ç†</li></ul></li><li>SimpleTypeConverter ä»…åšç±»å‹è½¬æ¢</li><li>BeanWrapperImpl ä¸º bean çš„å±æ€§èµ‹å€¼ï¼Œå½“éœ€è¦æ—¶åšç±»å‹è½¬æ¢ï¼Œèµ° Property</li><li>DirectFieldAccessor ä¸º bean çš„å±æ€§èµ‹å€¼ï¼Œå½“éœ€è¦æ—¶åšç±»å‹è½¬æ¢ï¼Œèµ° Field</li><li>ServletRequestDataBinder ä¸º bean çš„å±æ€§æ‰§è¡Œç»‘å®šï¼Œå½“éœ€è¦æ—¶åšç±»å‹è½¬æ¢ï¼Œæ ¹æ® directFieldAccess é€‰æ‹©èµ° Property è¿˜æ˜¯ Fieldï¼Œå…·å¤‡æ ¡éªŒä¸è·å–æ ¡éªŒç»“æœåŠŸèƒ½</li></ul><h4 id="æ¼”ç¤º1-ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®š"><a href="#æ¼”ç¤º1-ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®š" class="headerlink" title="æ¼”ç¤º1 - ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®š"></a>æ¼”ç¤º1 - ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®š</h4><h5 id="ä»£ç å‚è€ƒ-30"><a href="#ä»£ç å‚è€ƒ-30" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a23</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-35"><a href="#æ”¶è·ğŸ’¡-35" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><p>åŸºæœ¬çš„ç±»å‹è½¬æ¢ä¸æ•°æ®ç»‘å®šç”¨æ³•</p><ul><li>SimpleTypeConverter</li><li>BeanWrapperImpl</li><li>DirectFieldAccessor</li><li>ServletRequestDataBinder</li></ul><h4 id="æ¼”ç¤º2-æ•°æ®ç»‘å®šå·¥å‚"><a href="#æ¼”ç¤º2-æ•°æ®ç»‘å®šå·¥å‚" class="headerlink" title="æ¼”ç¤º2 - æ•°æ®ç»‘å®šå·¥å‚"></a>æ¼”ç¤º2 - æ•°æ®ç»‘å®šå·¥å‚</h4><h5 id="ä»£ç å‚è€ƒ-31"><a href="#ä»£ç å‚è€ƒ-31" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a23.TestServletDataBinderFactory</strong></p><h4 id="æ”¶è·ğŸ’¡-36"><a href="#æ”¶è·ğŸ’¡-36" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><p>ServletRequestDataBinderFactory çš„ç”¨æ³•å’Œæ‰©å±•ç‚¹</p><ol><li>å¯ä»¥è§£ææ§åˆ¶å™¨çš„ @InitBinder æ ‡æ³¨æ–¹æ³•ä½œä¸ºæ‰©å±•ç‚¹ï¼Œæ·»åŠ è‡ªå®šä¹‰è½¬æ¢å™¨<ul><li>æ§åˆ¶å™¨ç§æœ‰èŒƒå›´</li></ul></li><li>å¯ä»¥é€šè¿‡ ConfigurableWebBindingInitializer é…ç½® ConversionService ä½œä¸ºæ‰©å±•ç‚¹ï¼Œæ·»åŠ è‡ªå®šä¹‰è½¬æ¢å™¨<ul><li>å…¬å…±èŒƒå›´</li></ul></li><li>åŒæ—¶åŠ äº† @InitBinder å’Œ ConversionService çš„è½¬æ¢ä¼˜å…ˆçº§<ol><li>ä¼˜å…ˆé‡‡ç”¨ @InitBinder çš„è½¬æ¢å™¨</li><li>å…¶æ¬¡ä½¿ç”¨ ConversionService çš„è½¬æ¢å™¨</li><li>ä½¿ç”¨é»˜è®¤è½¬æ¢å™¨</li><li>ç‰¹æ®Šå¤„ç†ï¼ˆä¾‹å¦‚æœ‰å‚æ„é€ ï¼‰</li></ol></li></ol><h4 id="æ¼”ç¤º3-è·å–æ³›å‹å‚æ•°"><a href="#æ¼”ç¤º3-è·å–æ³›å‹å‚æ•°" class="headerlink" title="æ¼”ç¤º3 - è·å–æ³›å‹å‚æ•°"></a>æ¼”ç¤º3 - è·å–æ³›å‹å‚æ•°</h4><h5 id="ä»£ç å‚è€ƒ-32"><a href="#ä»£ç å‚è€ƒ-32" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a23.sub</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-37"><a href="#æ”¶è·ğŸ’¡-37" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>java api è·å–æ³›å‹å‚æ•°</li><li>spring api è·å–æ³›å‹å‚æ•°</li></ol><h3 id="24-ControllerAdvice-ä¹‹-InitBinder"><a href="#24-ControllerAdvice-ä¹‹-InitBinder" class="headerlink" title="24) @ControllerAdvice ä¹‹ @InitBinder"></a>24) @ControllerAdvice ä¹‹ @InitBinder</h3><h4 id="æ¼”ç¤º-å‡†å¤‡-InitBinder"><a href="#æ¼”ç¤º-å‡†å¤‡-InitBinder" class="headerlink" title="æ¼”ç¤º - å‡†å¤‡ @InitBinder"></a>æ¼”ç¤º - å‡†å¤‡ @InitBinder</h4><p><strong>å‡†å¤‡ @InitBinder</strong> åœ¨æ•´ä¸ª HandlerAdapter è°ƒç”¨è¿‡ç¨‹ä¸­æ‰€å¤„çš„ä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">participant adapter as HandlerAdapter</span><br><span class="line">participant bf as WebDataBinderFactory</span><br><span class="line">participant mf as ModelFactory</span><br><span class="line">participant ihm as ServletInvocableHandlerMethod</span><br><span class="line">participant ar as ArgumentResolvers </span><br><span class="line">participant rh as ReturnValueHandlers</span><br><span class="line">participant container as ModelAndViewContainer</span><br><span class="line">rect rgb(200, 150, 255)</span><br><span class="line">adapter -&gt;&gt; +bf: å‡†å¤‡ @InitBinder</span><br><span class="line">bf --&gt;&gt; -adapter: </span><br><span class="line">end</span><br><span class="line">adapter -&gt;&gt; +mf: å‡†å¤‡ @ModelAttribute</span><br><span class="line">mf -&gt;&gt; +container: æ·»åŠ Modelæ•°æ®</span><br><span class="line">container --&gt;&gt; -mf: </span><br><span class="line">mf --&gt;&gt; -adapter: </span><br><span class="line"></span><br><span class="line">adapter -&gt;&gt; +ihm: invokeAndHandle</span><br><span class="line">ihm -&gt;&gt; +ar: è·å– args</span><br><span class="line">ar -&gt;&gt; ar: æœ‰çš„è§£æå™¨æ¶‰åŠ RequestBodyAdvice</span><br><span class="line">ar -&gt;&gt; container: æœ‰çš„è§£æå™¨æ¶‰åŠæ•°æ®ç»‘å®šç”ŸæˆModelæ•°æ®</span><br><span class="line">ar --&gt;&gt; -ihm: args</span><br><span class="line">ihm -&gt;&gt; ihm: method.invoke(bean,args) å¾—åˆ° returnValue</span><br><span class="line">ihm -&gt;&gt; +rh: å¤„ç† returnValue</span><br><span class="line">rh -&gt;&gt; rh: æœ‰çš„å¤„ç†å™¨æ¶‰åŠ ResponseBodyAdvice</span><br><span class="line">rh -&gt;&gt; +container: æ·»åŠ Modelæ•°æ®,å¤„ç†è§†å›¾å,æ˜¯å¦æ¸²æŸ“ç­‰</span><br><span class="line">container --&gt;&gt; -rh: </span><br><span class="line">rh --&gt;&gt; -ihm: </span><br><span class="line">ihm --&gt;&gt; -adapter: </span><br><span class="line">adapter -&gt;&gt; +container: è·å– ModelAndView</span><br><span class="line">container --&gt;&gt; -adapter: </span><br></pre></td></tr></table></figure><ul><li>RequestMappingHandlerAdapter åœ¨å›¾ä¸­ç¼©å†™ä¸º HandlerAdapter</li><li>HandlerMethodArgumentResolverComposite åœ¨å›¾ä¸­ç¼©å†™ä¸º ArgumentResolvers</li><li>HandlerMethodReturnValueHandlerComposite åœ¨å›¾ä¸­ç¼©å†™ä¸º ReturnValueHandlers</li></ul><h4 id="æ”¶è·ğŸ’¡-38"><a href="#æ”¶è·ğŸ’¡-38" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>RequestMappingHandlerAdapter åˆå§‹åŒ–æ—¶ä¼šè§£æ @ControllerAdvice ä¸­çš„ @InitBinder æ–¹æ³•</li><li>RequestMappingHandlerAdapter ä¼šä»¥ç±»ä¸ºå•ä½ï¼Œåœ¨è¯¥ç±»é¦–æ¬¡ä½¿ç”¨æ—¶ï¼Œè§£ææ­¤ç±»çš„ @InitBinder æ–¹æ³•</li><li>ä»¥ä¸Šä¸¤ç§ @InitBinder çš„è§£æç»“æœéƒ½ä¼šç¼“å­˜æ¥é¿å…é‡å¤è§£æ</li><li>æ§åˆ¶å™¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼šç»¼åˆåˆ©ç”¨æœ¬ç±»çš„ @InitBinder æ–¹æ³•å’Œ @ControllerAdvice ä¸­çš„ @InitBinder æ–¹æ³•åˆ›å»ºç»‘å®šå·¥å‚</li></ol><h3 id="25-æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹"><a href="#25-æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹" class="headerlink" title="25) æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹"></a>25) æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œæµç¨‹</h3><h4 id="å›¾1"><a href="#å›¾1" class="headerlink" title="å›¾1"></a>å›¾1</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">class ServletInvocableHandlerMethod &#123;</span><br><span class="line">+invokeAndHandle(ServletWebRequest,ModelAndViewContainer)</span><br><span class="line">&#125;</span><br><span class="line">HandlerMethod &lt;|-- ServletInvocableHandlerMethod</span><br><span class="line">HandlerMethod o-- bean</span><br><span class="line">HandlerMethod o-- method</span><br><span class="line">ServletInvocableHandlerMethod o-- WebDataBinderFactory</span><br><span class="line">ServletInvocableHandlerMethod o-- ParameterNameDiscoverer</span><br><span class="line">ServletInvocableHandlerMethod o-- HandlerMethodArgumentResolverComposite</span><br><span class="line">ServletInvocableHandlerMethod o-- HandlerMethodReturnValueHandlerComposite</span><br></pre></td></tr></table></figure><p>HandlerMethod éœ€è¦</p><ul><li>bean å³æ˜¯å“ªä¸ª Controller</li><li>method å³æ˜¯ Controller ä¸­çš„å“ªä¸ªæ–¹æ³•</li></ul><p>ServletInvocableHandlerMethod éœ€è¦</p><ul><li>WebDataBinderFactory è´Ÿè´£å¯¹è±¡ç»‘å®šã€ç±»å‹è½¬æ¢</li><li>ParameterNameDiscoverer è´Ÿè´£å‚æ•°åè§£æ</li><li>HandlerMethodArgumentResolverComposite è´Ÿè´£è§£æå‚æ•°</li><li>HandlerMethodReturnValueHandlerComposite è´Ÿè´£å¤„ç†è¿”å›å€¼</li></ul><h4 id="å›¾2"><a href="#å›¾2" class="headerlink" title="å›¾2"></a>å›¾2</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">participant adapter as RequestMappingHandlerAdapter</span><br><span class="line">participant bf as WebDataBinderFactory</span><br><span class="line">participant mf as ModelFactory</span><br><span class="line">participant container as ModelAndViewContainer</span><br><span class="line">adapter -&gt;&gt; +bf: å‡†å¤‡ @InitBinder</span><br><span class="line">bf --&gt;&gt; -adapter: </span><br><span class="line">adapter -&gt;&gt; +mf: å‡†å¤‡ @ModelAttribute</span><br><span class="line">mf -&gt;&gt; +container: æ·»åŠ Modelæ•°æ®</span><br><span class="line">container --&gt;&gt; -mf: </span><br><span class="line">mf --&gt;&gt; -adapter: </span><br></pre></td></tr></table></figure><h4 id="å›¾3"><a href="#å›¾3" class="headerlink" title="å›¾3"></a>å›¾3</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">participant adapter as RequestMappingHandlerAdapter</span><br><span class="line">participant ihm as ServletInvocableHandlerMethod</span><br><span class="line">participant ar as ArgumentResolvers</span><br><span class="line">participant rh as ReturnValueHandlers</span><br><span class="line">participant container as ModelAndViewContainer</span><br><span class="line"></span><br><span class="line">adapter -&gt;&gt; +ihm: invokeAndHandle</span><br><span class="line">ihm -&gt;&gt; +ar: è·å– args</span><br><span class="line">ar -&gt;&gt; ar: æœ‰çš„è§£æå™¨æ¶‰åŠ RequestBodyAdvice</span><br><span class="line">ar -&gt;&gt; container: æœ‰çš„è§£æå™¨æ¶‰åŠæ•°æ®ç»‘å®šç”Ÿæˆæ¨¡å‹æ•°æ®</span><br><span class="line">container --&gt;&gt; ar: </span><br><span class="line">ar --&gt;&gt; -ihm: args</span><br><span class="line">ihm -&gt;&gt; ihm: method.invoke(bean,args) å¾—åˆ° returnValue</span><br><span class="line">ihm -&gt;&gt; +rh: å¤„ç† returnValue</span><br><span class="line">rh -&gt;&gt; rh: æœ‰çš„å¤„ç†å™¨æ¶‰åŠ ResponseBodyAdvice</span><br><span class="line">rh -&gt;&gt; +container: æ·»åŠ Modelæ•°æ®,å¤„ç†è§†å›¾å,æ˜¯å¦æ¸²æŸ“ç­‰</span><br><span class="line">container --&gt;&gt; -rh: </span><br><span class="line">rh --&gt;&gt; -ihm: </span><br><span class="line">ihm --&gt;&gt; -adapter: </span><br><span class="line">adapter -&gt;&gt; +container: è·å– ModelAndView</span><br><span class="line">container --&gt;&gt; -adapter: </span><br></pre></td></tr></table></figure><h3 id="26-ControllerAdvice-ä¹‹-ModelAttribute"><a href="#26-ControllerAdvice-ä¹‹-ModelAttribute" class="headerlink" title="26) @ControllerAdvice ä¹‹ @ModelAttribute"></a>26) @ControllerAdvice ä¹‹ @ModelAttribute</h3><h4 id="æ¼”ç¤º-å‡†å¤‡-ModelAttribute"><a href="#æ¼”ç¤º-å‡†å¤‡-ModelAttribute" class="headerlink" title="æ¼”ç¤º - å‡†å¤‡ @ModelAttribute"></a>æ¼”ç¤º - å‡†å¤‡ @ModelAttribute</h4><h5 id="ä»£ç å‚è€ƒ-33"><a href="#ä»£ç å‚è€ƒ-33" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a26</strong> åŒ…</p><p><strong>å‡†å¤‡ @ModelAttribute</strong> åœ¨æ•´ä¸ª HandlerAdapter è°ƒç”¨è¿‡ç¨‹ä¸­æ‰€å¤„çš„ä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">participant adapter as HandlerAdapter</span><br><span class="line">participant bf as WebDataBinderFactory</span><br><span class="line">participant mf as ModelFactory</span><br><span class="line">participant ihm as ServletInvocableHandlerMethod</span><br><span class="line">participant ar as ArgumentResolvers </span><br><span class="line">participant rh as ReturnValueHandlers</span><br><span class="line">participant container as ModelAndViewContainer</span><br><span class="line"></span><br><span class="line">adapter -&gt;&gt; +bf: å‡†å¤‡ @InitBinder</span><br><span class="line">bf --&gt;&gt; -adapter: </span><br><span class="line">rect rgb(200, 150, 255)</span><br><span class="line">adapter -&gt;&gt; +mf: å‡†å¤‡ @ModelAttribute</span><br><span class="line">mf -&gt;&gt; +container: æ·»åŠ Modelæ•°æ®</span><br><span class="line">container --&gt;&gt; -mf: </span><br><span class="line">mf --&gt;&gt; -adapter: </span><br><span class="line">end</span><br><span class="line">adapter -&gt;&gt; +ihm: invokeAndHandle</span><br><span class="line">ihm -&gt;&gt; +ar: è·å– args</span><br><span class="line">ar -&gt;&gt; ar: æœ‰çš„è§£æå™¨æ¶‰åŠ RequestBodyAdvice</span><br><span class="line">ar -&gt;&gt; container: æœ‰çš„è§£æå™¨æ¶‰åŠæ•°æ®ç»‘å®šç”ŸæˆModelæ•°æ®</span><br><span class="line">ar --&gt;&gt; -ihm: args</span><br><span class="line">ihm -&gt;&gt; ihm: method.invoke(bean,args) å¾—åˆ° returnValue</span><br><span class="line">ihm -&gt;&gt; +rh: å¤„ç† returnValue</span><br><span class="line">rh -&gt;&gt; rh: æœ‰çš„å¤„ç†å™¨æ¶‰åŠ ResponseBodyAdvice</span><br><span class="line">rh -&gt;&gt; +container: æ·»åŠ Modelæ•°æ®,å¤„ç†è§†å›¾å,æ˜¯å¦æ¸²æŸ“ç­‰</span><br><span class="line">container --&gt;&gt; -rh: </span><br><span class="line">rh --&gt;&gt; -ihm: </span><br><span class="line">ihm --&gt;&gt; -adapter: </span><br><span class="line">adapter -&gt;&gt; +container: è·å– ModelAndView</span><br><span class="line">container --&gt;&gt; -adapter: </span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-39"><a href="#æ”¶è·ğŸ’¡-39" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>RequestMappingHandlerAdapter åˆå§‹åŒ–æ—¶ä¼šè§£æ @ControllerAdvice ä¸­çš„ @ModelAttribute æ–¹æ³•</li><li>RequestMappingHandlerAdapter ä¼šä»¥ç±»ä¸ºå•ä½ï¼Œåœ¨è¯¥ç±»é¦–æ¬¡ä½¿ç”¨æ—¶ï¼Œè§£ææ­¤ç±»çš„ @ModelAttribute æ–¹æ³•</li><li>ä»¥ä¸Šä¸¤ç§ @ModelAttribute çš„è§£æç»“æœéƒ½ä¼šç¼“å­˜æ¥é¿å…é‡å¤è§£æ</li><li>æ§åˆ¶å™¨æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼šç»¼åˆåˆ©ç”¨æœ¬ç±»çš„ @ModelAttribute æ–¹æ³•å’Œ @ControllerAdvice ä¸­çš„ @ModelAttribute æ–¹æ³•åˆ›å»ºæ¨¡å‹å·¥å‚</li></ol><h3 id="27-è¿”å›å€¼å¤„ç†å™¨"><a href="#27-è¿”å›å€¼å¤„ç†å™¨" class="headerlink" title="27) è¿”å›å€¼å¤„ç†å™¨"></a>27) è¿”å›å€¼å¤„ç†å™¨</h3><h4 id="æ¼”ç¤º-å¸¸è§è¿”å›å€¼å¤„ç†å™¨"><a href="#æ¼”ç¤º-å¸¸è§è¿”å›å€¼å¤„ç†å™¨" class="headerlink" title="æ¼”ç¤º - å¸¸è§è¿”å›å€¼å¤„ç†å™¨"></a>æ¼”ç¤º - å¸¸è§è¿”å›å€¼å¤„ç†å™¨</h4><h5 id="ä»£ç å‚è€ƒ-34"><a href="#ä»£ç å‚è€ƒ-34" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a27</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-40"><a href="#æ”¶è·ğŸ’¡-40" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>å¸¸è§çš„è¿”å›å€¼å¤„ç†å™¨<ul><li>ModelAndViewï¼Œåˆ†åˆ«è·å–å…¶æ¨¡å‹å’Œè§†å›¾åï¼Œæ”¾å…¥ ModelAndViewContainer</li><li>è¿”å›å€¼ç±»å‹ä¸º String æ—¶ï¼ŒæŠŠå®ƒå½“åšè§†å›¾åï¼Œæ”¾å…¥ ModelAndViewContainer</li><li>è¿”å›å€¼æ·»åŠ äº† @ModelAttribute æ³¨è§£æ—¶ï¼Œå°†è¿”å›å€¼ä½œä¸ºæ¨¡å‹ï¼Œæ”¾å…¥ ModelAndViewContainer<ul><li>æ­¤æ—¶éœ€æ‰¾åˆ°é»˜è®¤è§†å›¾å</li></ul></li><li>è¿”å›å€¼çœç•¥ @ModelAttribute æ³¨è§£ä¸”è¿”å›éç®€å•ç±»å‹æ—¶ï¼Œå°†è¿”å›å€¼ä½œä¸ºæ¨¡å‹ï¼Œæ”¾å…¥ ModelAndViewContainer<ul><li>æ­¤æ—¶éœ€æ‰¾åˆ°é»˜è®¤è§†å›¾å</li></ul></li><li>è¿”å›å€¼ç±»å‹ä¸º ResponseEntity æ—¶<ul><li>æ­¤æ—¶èµ° MessageConverterï¼Œå¹¶è®¾ç½® ModelAndViewContainer.requestHandled ä¸º true</li></ul></li><li>è¿”å›å€¼ç±»å‹ä¸º HttpHeaders æ—¶<ul><li>ä¼šè®¾ç½® ModelAndViewContainer.requestHandled ä¸º true</li></ul></li><li>è¿”å›å€¼æ·»åŠ äº† @ResponseBody æ³¨è§£æ—¶<ul><li>æ­¤æ—¶èµ° MessageConverterï¼Œå¹¶è®¾ç½® ModelAndViewContainer.requestHandled ä¸º true</li></ul></li></ul></li><li>ç»„åˆæ¨¡å¼åœ¨ Spring ä¸­çš„ä½“ç° + 1</li></ol><h3 id="28-MessageConverter"><a href="#28-MessageConverter" class="headerlink" title="28) MessageConverter"></a>28) MessageConverter</h3><h4 id="æ¼”ç¤º-MessageConverter-çš„ä½œç”¨"><a href="#æ¼”ç¤º-MessageConverter-çš„ä½œç”¨" class="headerlink" title="æ¼”ç¤º - MessageConverter çš„ä½œç”¨"></a>æ¼”ç¤º - MessageConverter çš„ä½œç”¨</h4><h5 id="ä»£ç å‚è€ƒ-35"><a href="#ä»£ç å‚è€ƒ-35" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a28.A28</strong></p><h4 id="æ”¶è·ğŸ’¡-41"><a href="#æ”¶è·ğŸ’¡-41" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>MessageConverter çš„ä½œç”¨<ul><li>@ResponseBody æ˜¯è¿”å›å€¼å¤„ç†å™¨è§£æçš„</li><li>ä½†å…·ä½“è½¬æ¢å·¥ä½œæ˜¯ MessageConverter åšçš„</li></ul></li><li>å¦‚ä½•é€‰æ‹© MediaType<ul><li>é¦–å…ˆçœ‹ @RequestMapping ä¸Šæœ‰æ²¡æœ‰æŒ‡å®š</li><li>å…¶æ¬¡çœ‹ request çš„ Accept å¤´æœ‰æ²¡æœ‰æŒ‡å®š</li><li>æœ€åæŒ‰ MessageConverter çš„é¡ºåº, è°èƒ½è°å…ˆè½¬æ¢</li></ul></li></ol><h3 id="29-ControllerAdvice-ä¹‹-ResponseBodyAdvice"><a href="#29-ControllerAdvice-ä¹‹-ResponseBodyAdvice" class="headerlink" title="29) @ControllerAdvice ä¹‹ ResponseBodyAdvice"></a>29) @ControllerAdvice ä¹‹ ResponseBodyAdvice</h3><h4 id="æ¼”ç¤º-ResponseBodyAdvice-å¢å¼º"><a href="#æ¼”ç¤º-ResponseBodyAdvice-å¢å¼º" class="headerlink" title="æ¼”ç¤º - ResponseBodyAdvice å¢å¼º"></a>æ¼”ç¤º - ResponseBodyAdvice å¢å¼º</h4><h5 id="ä»£ç å‚è€ƒ-36"><a href="#ä»£ç å‚è€ƒ-36" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a29</strong> åŒ…</p><p><strong>ResponseBodyAdvice å¢å¼º</strong> åœ¨æ•´ä¸ª HandlerAdapter è°ƒç”¨è¿‡ç¨‹ä¸­æ‰€å¤„çš„ä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">participant adapter as HandlerAdapter</span><br><span class="line">participant bf as WebDataBinderFactory</span><br><span class="line">participant mf as ModelFactory</span><br><span class="line">participant ihm as ServletInvocableHandlerMethod</span><br><span class="line">participant ar as ArgumentResolvers </span><br><span class="line">participant rh as ReturnValueHandlers</span><br><span class="line">participant container as ModelAndViewContainer</span><br><span class="line"></span><br><span class="line">adapter -&gt;&gt; +bf: å‡†å¤‡ @InitBinder</span><br><span class="line">bf --&gt;&gt; -adapter: </span><br><span class="line">adapter -&gt;&gt; +mf: å‡†å¤‡ @ModelAttribute</span><br><span class="line">mf -&gt;&gt; +container: æ·»åŠ Modelæ•°æ®</span><br><span class="line">container --&gt;&gt; -mf: </span><br><span class="line">mf --&gt;&gt; -adapter: </span><br><span class="line">adapter -&gt;&gt; +ihm: invokeAndHandle</span><br><span class="line">ihm -&gt;&gt; +ar: è·å– args</span><br><span class="line">ar -&gt;&gt; ar: æœ‰çš„è§£æå™¨æ¶‰åŠ RequestBodyAdvice</span><br><span class="line">ar -&gt;&gt; container: æœ‰çš„è§£æå™¨æ¶‰åŠæ•°æ®ç»‘å®šç”ŸæˆModelæ•°æ®</span><br><span class="line">ar --&gt;&gt; -ihm: args</span><br><span class="line">ihm -&gt;&gt; ihm: method.invoke(bean,args) å¾—åˆ° returnValue</span><br><span class="line">ihm -&gt;&gt; +rh: å¤„ç† returnValue</span><br><span class="line">rect rgb(200, 150, 255)</span><br><span class="line">rh -&gt;&gt; rh: æœ‰çš„å¤„ç†å™¨æ¶‰åŠ ResponseBodyAdvice</span><br><span class="line">end</span><br><span class="line">rh -&gt;&gt; +container: æ·»åŠ Modelæ•°æ®,å¤„ç†è§†å›¾å,æ˜¯å¦æ¸²æŸ“ç­‰</span><br><span class="line">container --&gt;&gt; -rh: </span><br><span class="line">rh --&gt;&gt; -ihm: </span><br><span class="line">ihm --&gt;&gt; -adapter: </span><br><span class="line">adapter -&gt;&gt; +container: è·å– ModelAndView</span><br><span class="line">container --&gt;&gt; -adapter: </span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-42"><a href="#æ”¶è·ğŸ’¡-42" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>ResponseBodyAdvice è¿”å›å“åº”ä½“å‰åŒ…è£…</li></ol><h3 id="30-å¼‚å¸¸è§£æå™¨"><a href="#30-å¼‚å¸¸è§£æå™¨" class="headerlink" title="30) å¼‚å¸¸è§£æå™¨"></a>30) å¼‚å¸¸è§£æå™¨</h3><h4 id="æ¼”ç¤º-ExceptionHandlerExceptionResolver"><a href="#æ¼”ç¤º-ExceptionHandlerExceptionResolver" class="headerlink" title="æ¼”ç¤º - ExceptionHandlerExceptionResolver"></a>æ¼”ç¤º - ExceptionHandlerExceptionResolver</h4><h5 id="ä»£ç å‚è€ƒ-37"><a href="#ä»£ç å‚è€ƒ-37" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a30.A30</strong></p><h4 id="æ”¶è·ğŸ’¡-43"><a href="#æ”¶è·ğŸ’¡-43" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>å®ƒèƒ½å¤Ÿé‡ç”¨å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ï¼Œå®ç°ç»„ä»¶é‡ç”¨</li><li>å®ƒèƒ½å¤Ÿæ”¯æŒåµŒå¥—å¼‚å¸¸</li></ol><h3 id="31-ControllerAdvice-ä¹‹-ExceptionHandler"><a href="#31-ControllerAdvice-ä¹‹-ExceptionHandler" class="headerlink" title="31) @ControllerAdvice ä¹‹ @ExceptionHandler"></a>31) @ControllerAdvice ä¹‹ @ExceptionHandler</h3><h4 id="æ¼”ç¤º-å‡†å¤‡-ExceptionHandler"><a href="#æ¼”ç¤º-å‡†å¤‡-ExceptionHandler" class="headerlink" title="æ¼”ç¤º - å‡†å¤‡ @ExceptionHandler"></a>æ¼”ç¤º - å‡†å¤‡ @ExceptionHandler</h4><h5 id="ä»£ç å‚è€ƒ-38"><a href="#ä»£ç å‚è€ƒ-38" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a31</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-44"><a href="#æ”¶è·ğŸ’¡-44" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>ExceptionHandlerExceptionResolver åˆå§‹åŒ–æ—¶ä¼šè§£æ @ControllerAdvice ä¸­çš„ @ExceptionHandler æ–¹æ³•</li><li>ExceptionHandlerExceptionResolver ä¼šä»¥ç±»ä¸ºå•ä½ï¼Œåœ¨è¯¥ç±»é¦–æ¬¡å¤„ç†å¼‚å¸¸æ—¶ï¼Œè§£ææ­¤ç±»çš„ @ExceptionHandler æ–¹æ³•</li><li>ä»¥ä¸Šä¸¤ç§ @ExceptionHandler çš„è§£æç»“æœéƒ½ä¼šç¼“å­˜æ¥é¿å…é‡å¤è§£æ</li></ol><h3 id="32-Tomcat-å¼‚å¸¸å¤„ç†"><a href="#32-Tomcat-å¼‚å¸¸å¤„ç†" class="headerlink" title="32) Tomcat å¼‚å¸¸å¤„ç†"></a>32) Tomcat å¼‚å¸¸å¤„ç†</h3><ul><li><p>æˆ‘ä»¬çŸ¥é“ @ExceptionHandler åªèƒ½å¤„ç†å‘ç”Ÿåœ¨ mvc æµç¨‹ä¸­çš„å¼‚å¸¸ï¼Œä¾‹å¦‚æ§åˆ¶å™¨å†…ã€æ‹¦æˆªå™¨å†…ï¼Œé‚£ä¹ˆå¦‚æœæ˜¯ Filter å‡ºç°äº†å¼‚å¸¸ï¼Œå¦‚ä½•è¿›è¡Œå¤„ç†å‘¢ï¼Ÿ</p></li><li><p>åœ¨ Spring Boot ä¸­ï¼Œæ˜¯è¿™ä¹ˆå®ç°çš„ï¼š</p><ol><li>å› ä¸ºå†…åµŒäº† Tomcat å®¹å™¨ï¼Œå› æ­¤å¯ä»¥é…ç½® Tomcat çš„é”™è¯¯é¡µé¢ï¼ŒFilter ä¸ é”™è¯¯é¡µé¢ä¹‹é—´æ˜¯é€šè¿‡è¯·æ±‚è½¬å‘è·³è½¬çš„ï¼Œå¯ä»¥åœ¨è¿™é‡Œåšæ‰‹è„š</li><li>å…ˆé€šè¿‡ ErrorPageRegistrarBeanPostProcessor è¿™ä¸ªåå¤„ç†å™¨é…ç½®é”™è¯¯é¡µé¢åœ°å€ï¼Œé»˜è®¤ä¸º <code>/error</code> ä¹Ÿå¯ä»¥é€šè¿‡ <code>$&#123;server.error.path&#125;</code> è¿›è¡Œé…ç½®</li><li>å½“ Filter å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œä¸ä¼šèµ° Spring æµç¨‹ï¼Œä½†ä¼šèµ° Tomcat çš„é”™è¯¯å¤„ç†ï¼Œäºæ˜¯å°±å¸Œæœ›è½¬å‘è‡³ <code>/error</code> è¿™ä¸ªåœ°å€<ul><li>å½“ç„¶ï¼Œå¦‚æœæ²¡æœ‰ @ExceptionHandlerï¼Œé‚£ä¹ˆæœ€ç»ˆä¹Ÿä¼šèµ°åˆ° Tomcat çš„é”™è¯¯å¤„ç†</li></ul></li><li>Spring Boot åˆæä¾›äº†ä¸€ä¸ª BasicErrorControllerï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªæ ‡å‡† @Controllerï¼Œ@RequestMapping é…ç½®ä¸º <code>/error</code>ï¼Œæ‰€ä»¥å¤„ç†å¼‚å¸¸çš„èŒè´£å°±åˆå›åˆ°äº† Spring</li><li>å¼‚å¸¸ä¿¡æ¯ç”±äºä¼šè¢« Tomcat æ”¾å…¥ request ä½œç”¨åŸŸï¼Œå› æ­¤ BasicErrorController é‡Œä¹Ÿèƒ½è·å–åˆ°</li><li>å…·ä½“å¼‚å¸¸ä¿¡æ¯ä¼šç”± DefaultErrorAttributes å°è£…å¥½</li><li>BasicErrorController é€šè¿‡ Accept å¤´åˆ¤æ–­éœ€è¦ç”Ÿæˆå“ªç§ MediaType çš„å“åº”<ul><li>å¦‚æœè¦çš„ä¸æ˜¯ text/htmlï¼Œèµ° MessageConverter æµç¨‹</li><li>å¦‚æœéœ€è¦ text/htmlï¼Œèµ° mvc æµç¨‹ï¼Œæ­¤æ—¶åˆåˆ†ä¸¤ç§æƒ…å†µ<ul><li>é…ç½®äº† ErrorViewResolverï¼Œæ ¹æ®çŠ¶æ€ç å»æ‰¾ View</li><li>æ²¡é…ç½®æˆ–æ²¡æ‰¾åˆ°ï¼Œç”¨ BeanNameViewResolver æ ¹æ®ä¸€ä¸ªå›ºå®šä¸º error çš„åå­—æ‰¾åˆ° Viewï¼Œå³æ‰€è°“çš„ WhitelabelErrorView</li></ul></li></ul></li></ol></li></ul><blockquote><p><em><strong>è¯„ä»·</strong></em></p><ul><li>ä¸€ä¸ªé”™è¯¯å¤„ç†æå¾—è¿™ä¹ˆå¤æ‚ï¼Œå°±é—®æ¶å¿ƒä¸ï¼Ÿ</li></ul></blockquote><h4 id="æ¼”ç¤º1-é”™è¯¯é¡µå¤„ç†"><a href="#æ¼”ç¤º1-é”™è¯¯é¡µå¤„ç†" class="headerlink" title="æ¼”ç¤º1 - é”™è¯¯é¡µå¤„ç†"></a>æ¼”ç¤º1 - é”™è¯¯é¡µå¤„ç†</h4><h5 id="å…³é”®ä»£ç -1"><a href="#å…³é”®ä»£ç -1" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span> <span class="comment">// â¬…ï¸ä¿®æ”¹äº† Tomcat æœåŠ¡å™¨é»˜è®¤é”™è¯¯åœ°å€, å‡ºé”™æ—¶ä½¿ç”¨è¯·æ±‚è½¬å‘æ–¹å¼è·³è½¬</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ErrorPageRegistrar <span class="title">errorPageRegistrar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> webServerFactory -&gt; webServerFactory.addErrorPages(<span class="keyword">new</span> ErrorPage(<span class="string">&quot;/error&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span> <span class="comment">// â¬…ï¸TomcatServletWebServerFactory åˆå§‹åŒ–å‰ç”¨å®ƒå¢å¼º, æ³¨å†Œæ‰€æœ‰ ErrorPageRegistrar</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ErrorPageRegistrarBeanPostProcessor <span class="title">errorPageRegistrarBeanPostProcessor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ErrorPageRegistrarBeanPostProcessor();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-45"><a href="#æ”¶è·ğŸ’¡-45" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>Tomcat çš„é”™è¯¯é¡µå¤„ç†æ‰‹æ®µ</li></ol><h4 id="æ¼”ç¤º2-BasicErrorController"><a href="#æ¼”ç¤º2-BasicErrorController" class="headerlink" title="æ¼”ç¤º2 - BasicErrorController"></a>æ¼”ç¤º2 - BasicErrorController</h4><h5 id="å…³é”®ä»£ç -2"><a href="#å…³é”®ä»£ç -2" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span> <span class="comment">// â¬…ï¸ErrorProperties å°è£…ç¯å¢ƒé”®å€¼, ErrorAttributes æ§åˆ¶æœ‰å“ªäº›é”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> BasicErrorController <span class="title">basicErrorController</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ErrorProperties errorProperties = <span class="keyword">new</span> ErrorProperties();</span><br><span class="line">    errorProperties.setIncludeException(<span class="keyword">true</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> BasicErrorController(<span class="keyword">new</span> DefaultErrorAttributes(), errorProperties);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span> <span class="comment">// â¬…ï¸åç§°ä¸º error çš„è§†å›¾, ä½œä¸º BasicErrorController çš„ text/html å“åº”ç»“æœ</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> View <span class="title">error</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> View() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">render</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">            Map&lt;String, ?&gt; model, </span></span></span><br><span class="line"><span class="params"><span class="function">            HttpServletRequest request, </span></span></span><br><span class="line"><span class="params"><span class="function">            HttpServletResponse response</span></span></span><br><span class="line"><span class="params"><span class="function">        )</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            System.out.println(model);</span><br><span class="line">            response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">            response.getWriter().print(<span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">                    &lt;h3&gt;æœåŠ¡å™¨å†…éƒ¨é”™è¯¯&lt;/h3&gt;</span></span><br><span class="line"><span class="string">                    &quot;</span><span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span> <span class="comment">// â¬…ï¸æ”¶é›†å®¹å™¨ä¸­æ‰€æœ‰ View å¯¹è±¡, bean çš„åå­—ä½œä¸ºè§†å›¾å</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ViewResolver <span class="title">viewResolver</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> BeanNameViewResolver();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-46"><a href="#æ”¶è·ğŸ’¡-46" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>Spring Boot ä¸­ BasicErrorController å¦‚ä½•å·¥ä½œ</li></ol><h3 id="33-BeanNameUrlHandlerMapping-ä¸-SimpleControllerHandlerAdapter"><a href="#33-BeanNameUrlHandlerMapping-ä¸-SimpleControllerHandlerAdapter" class="headerlink" title="33) BeanNameUrlHandlerMapping ä¸ SimpleControllerHandlerAdapter"></a>33) BeanNameUrlHandlerMapping ä¸ SimpleControllerHandlerAdapter</h3><h4 id="æ¼”ç¤º-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨"><a href="#æ¼”ç¤º-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨" class="headerlink" title="æ¼”ç¤º - æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨"></a>æ¼”ç¤º - æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨</h4><h5 id="å…³é”®ä»£ç -3"><a href="#å…³é”®ä»£ç -3" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> BeanNameUrlHandlerMapping <span class="title">beanNameUrlHandlerMapping</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> BeanNameUrlHandlerMapping();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> SimpleControllerHandlerAdapter <span class="title">simpleControllerHandlerAdapter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SimpleControllerHandlerAdapter();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean(&quot;/c3&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Controller <span class="title">controller3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (request, response) -&gt; &#123;</span><br><span class="line">        response.getWriter().print(<span class="string">&quot;this is c3&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-47"><a href="#æ”¶è·ğŸ’¡-47" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>BeanNameUrlHandlerMappingï¼Œä»¥ / å¼€å¤´çš„ bean çš„åå­—ä¼šè¢«å½“ä½œæ˜ å°„è·¯å¾„</li><li>è¿™äº› bean æœ¬èº«å½“ä½œ handlerï¼Œè¦æ±‚å®ç° Controller æ¥å£</li><li>SimpleControllerHandlerAdapterï¼Œè°ƒç”¨ handler</li><li>æ¨¡æ‹Ÿå®ç°è¿™ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨</li></ol><h3 id="34-RouterFunctionMapping-ä¸-HandlerFunctionAdapter"><a href="#34-RouterFunctionMapping-ä¸-HandlerFunctionAdapter" class="headerlink" title="34) RouterFunctionMapping ä¸ HandlerFunctionAdapter"></a>34) RouterFunctionMapping ä¸ HandlerFunctionAdapter</h3><h4 id="æ¼”ç¤º-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨-1"><a href="#æ¼”ç¤º-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨-1" class="headerlink" title="æ¼”ç¤º - æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨"></a>æ¼”ç¤º - æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨</h4><h5 id="å…³é”®ä»£ç -4"><a href="#å…³é”®ä»£ç -4" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> RouterFunctionMapping <span class="title">routerFunctionMapping</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> RouterFunctionMapping();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> HandlerFunctionAdapter <span class="title">handlerFunctionAdapter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> HandlerFunctionAdapter();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> RouterFunction&lt;ServerResponse&gt; <span class="title">r1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//           â¬‡ï¸æ˜ å°„æ¡ä»¶   â¬‡ï¸handler</span></span><br><span class="line">    <span class="keyword">return</span> route(GET(<span class="string">&quot;/r1&quot;</span>), request -&gt; ok().body(<span class="string">&quot;this is r1&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-48"><a href="#æ”¶è·ğŸ’¡-48" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>RouterFunctionMapping, é€šè¿‡ RequestPredicate æ¡ä»¶æ˜ å°„</li><li>handler è¦å®ç° HandlerFunction æ¥å£</li><li>HandlerFunctionAdapter, è°ƒç”¨ handler</li></ol><h3 id="35-SimpleUrlHandlerMapping-ä¸-HttpRequestHandlerAdapter"><a href="#35-SimpleUrlHandlerMapping-ä¸-HttpRequestHandlerAdapter" class="headerlink" title="35) SimpleUrlHandlerMapping ä¸ HttpRequestHandlerAdapter"></a>35) SimpleUrlHandlerMapping ä¸ HttpRequestHandlerAdapter</h3><h4 id="æ¼”ç¤º1-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨"><a href="#æ¼”ç¤º1-æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨" class="headerlink" title="æ¼”ç¤º1 - æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨"></a>æ¼”ç¤º1 - æœ¬ç»„æ˜ å°„å™¨å’Œé€‚é…å™¨</h4><h5 id="ä»£ç å‚è€ƒ-39"><a href="#ä»£ç å‚è€ƒ-39" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>org.springframework.boot.autoconfigure.web.servlet.A35</strong></p><h5 id="å…³é”®ä»£ç -5"><a href="#å…³é”®ä»£ç -5" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> SimpleUrlHandlerMapping <span class="title">simpleUrlHandlerMapping</span><span class="params">(ApplicationContext context)</span> </span>&#123;</span><br><span class="line">    SimpleUrlHandlerMapping handlerMapping = <span class="keyword">new</span> SimpleUrlHandlerMapping();</span><br><span class="line">    Map&lt;String, ResourceHttpRequestHandler&gt; map </span><br><span class="line">        = context.getBeansOfType(ResourceHttpRequestHandler.class);</span><br><span class="line">    handlerMapping.setUrlMap(map);</span><br><span class="line">    <span class="keyword">return</span> handlerMapping;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> HttpRequestHandlerAdapter <span class="title">httpRequestHandlerAdapter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> HttpRequestHandlerAdapter();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean(&quot;/**&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ResourceHttpRequestHandler <span class="title">handler1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ResourceHttpRequestHandler handler = <span class="keyword">new</span> ResourceHttpRequestHandler();</span><br><span class="line">    handler.setLocations(List.of(<span class="keyword">new</span> ClassPathResource(<span class="string">&quot;static/&quot;</span>)));</span><br><span class="line">    <span class="keyword">return</span> handler;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean(&quot;/img/**&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ResourceHttpRequestHandler <span class="title">handler2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ResourceHttpRequestHandler handler = <span class="keyword">new</span> ResourceHttpRequestHandler();</span><br><span class="line">    handler.setLocations(List.of(<span class="keyword">new</span> ClassPathResource(<span class="string">&quot;images/&quot;</span>)));</span><br><span class="line">    <span class="keyword">return</span> handler;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-49"><a href="#æ”¶è·ğŸ’¡-49" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>SimpleUrlHandlerMapping ä¸ä¼šåœ¨åˆå§‹åŒ–æ—¶æ”¶é›†æ˜ å°„ä¿¡æ¯ï¼Œéœ€è¦æ‰‹åŠ¨æ”¶é›†</li><li>SimpleUrlHandlerMapping æ˜ å°„è·¯å¾„</li><li>ResourceHttpRequestHandler ä½œä¸ºé™æ€èµ„æº handler</li><li>HttpRequestHandlerAdapter, è°ƒç”¨æ­¤ handler</li></ol><h4 id="æ¼”ç¤º2-é™æ€èµ„æºè§£æä¼˜åŒ–"><a href="#æ¼”ç¤º2-é™æ€èµ„æºè§£æä¼˜åŒ–" class="headerlink" title="æ¼”ç¤º2 - é™æ€èµ„æºè§£æä¼˜åŒ–"></a>æ¼”ç¤º2 - é™æ€èµ„æºè§£æä¼˜åŒ–</h4><h5 id="å…³é”®ä»£ç -6"><a href="#å…³é”®ä»£ç -6" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean(&quot;/**&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ResourceHttpRequestHandler <span class="title">handler1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ResourceHttpRequestHandler handler = <span class="keyword">new</span> ResourceHttpRequestHandler();</span><br><span class="line">    handler.setLocations(List.of(<span class="keyword">new</span> ClassPathResource(<span class="string">&quot;static/&quot;</span>)));</span><br><span class="line">    handler.setResourceResolvers(List.of(</span><br><span class="line">        <span class="comment">// â¬‡ï¸ç¼“å­˜ä¼˜åŒ–</span></span><br><span class="line">            <span class="keyword">new</span> CachingResourceResolver(<span class="keyword">new</span> ConcurrentMapCache(<span class="string">&quot;cache1&quot;</span>)),</span><br><span class="line">        <span class="comment">// â¬‡ï¸å‹ç¼©ä¼˜åŒ–</span></span><br><span class="line">            <span class="keyword">new</span> EncodedResourceResolver(),</span><br><span class="line">        <span class="comment">// â¬‡ï¸åŸå§‹èµ„æºè§£æ</span></span><br><span class="line">            <span class="keyword">new</span> PathResourceResolver()</span><br><span class="line">    ));</span><br><span class="line">    <span class="keyword">return</span> handler;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-50"><a href="#æ”¶è·ğŸ’¡-50" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>è´£ä»»é“¾æ¨¡å¼ä½“ç°</li><li>å‹ç¼©æ–‡ä»¶éœ€è¦æ‰‹åŠ¨ç”Ÿæˆ</li></ol><h4 id="æ¼”ç¤º3-æ¬¢è¿é¡µ"><a href="#æ¼”ç¤º3-æ¬¢è¿é¡µ" class="headerlink" title="æ¼”ç¤º3 - æ¬¢è¿é¡µ"></a>æ¼”ç¤º3 - æ¬¢è¿é¡µ</h4><h5 id="å…³é”®ä»£ç -7"><a href="#å…³é”®ä»£ç -7" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> WelcomePageHandlerMapping <span class="title">welcomePageHandlerMapping</span><span class="params">(ApplicationContext context)</span> </span>&#123;</span><br><span class="line">    Resource resource = context.getResource(<span class="string">&quot;classpath:static/index.html&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> WelcomePageHandlerMapping(<span class="keyword">null</span>, context, resource, <span class="string">&quot;/**&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> SimpleControllerHandlerAdapter <span class="title">simpleControllerHandlerAdapter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SimpleControllerHandlerAdapter();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-51"><a href="#æ”¶è·ğŸ’¡-51" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>æ¬¢è¿é¡µæ”¯æŒé™æ€æ¬¢è¿é¡µä¸åŠ¨æ€æ¬¢è¿é¡µ</li><li>WelcomePageHandlerMapping æ˜ å°„æ¬¢è¿é¡µï¼ˆå³åªæ˜ å°„ â€˜/â€˜ï¼‰<ul><li>å®ƒå†…ç½®çš„ handler ParameterizableViewController ä½œç”¨æ˜¯ä¸æ‰§è¡Œé€»è¾‘ï¼Œä»…æ ¹æ®è§†å›¾åæ‰¾è§†å›¾</li><li>è§†å›¾åå›ºå®šä¸º forward:index.html</li></ul></li><li>SimpleControllerHandlerAdapter, è°ƒç”¨ handler<ul><li>è½¬å‘è‡³ /index.html</li><li>å¤„ç† /index.html åˆä¼šèµ°ä¸Šé¢çš„é™æ€èµ„æºå¤„ç†æµç¨‹</li></ul></li></ol><h4 id="æ˜ å°„å™¨ä¸é€‚é…å™¨å°ç»“"><a href="#æ˜ å°„å™¨ä¸é€‚é…å™¨å°ç»“" class="headerlink" title="æ˜ å°„å™¨ä¸é€‚é…å™¨å°ç»“"></a>æ˜ å°„å™¨ä¸é€‚é…å™¨å°ç»“</h4><ol><li>HandlerMapping è´Ÿè´£å»ºç«‹è¯·æ±‚ä¸æ§åˆ¶å™¨ä¹‹é—´çš„æ˜ å°„å…³ç³»<ul><li>RequestMappingHandlerMapping (ä¸ @RequestMapping åŒ¹é…)</li><li>WelcomePageHandlerMapping    (/)</li><li>BeanNameUrlHandlerMapping    (ä¸ bean çš„åå­—åŒ¹é… ä»¥ / å¼€å¤´)</li><li>RouterFunctionMapping        (å‡½æ•°å¼ RequestPredicate, HandlerFunction)</li><li>SimpleUrlHandlerMapping      (é™æ€èµ„æº é€šé…ç¬¦ /** /img/**)</li><li>ä¹‹é—´ä¹Ÿä¼šæœ‰é¡ºåºé—®é¢˜, boot ä¸­é»˜è®¤é¡ºåºå¦‚ä¸Š</li></ul></li><li>HandlerAdapter è´Ÿè´£å®ç°å¯¹å„ç§å„æ ·çš„ handler çš„é€‚é…è°ƒç”¨<ul><li>RequestMappingHandlerAdapter å¤„ç†ï¼š@RequestMapping æ–¹æ³•<ul><li>å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ä½“ç°äº†ç»„åˆæ¨¡å¼</li></ul></li><li>SimpleControllerHandlerAdapter å¤„ç†ï¼šController æ¥å£</li><li>HandlerFunctionAdapter å¤„ç†ï¼šHandlerFunction å‡½æ•°å¼æ¥å£</li><li>HttpRequestHandlerAdapter å¤„ç†ï¼šHttpRequestHandler æ¥å£ (é™æ€èµ„æºå¤„ç†)</li><li>è¿™ä¹Ÿæ˜¯å…¸å‹é€‚é…å™¨æ¨¡å¼ä½“ç°</li></ul></li></ol><h3 id="36-mvc-å¤„ç†æµç¨‹"><a href="#36-mvc-å¤„ç†æµç¨‹" class="headerlink" title="36) mvc å¤„ç†æµç¨‹"></a>36) mvc å¤„ç†æµç¨‹</h3><p>å½“æµè§ˆå™¨å‘é€ä¸€ä¸ªè¯·æ±‚ <code>http://localhost:8080/hello</code> åï¼Œè¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ï¼Œå…¶å¤„ç†æµç¨‹æ˜¯ï¼š</p><ol><li><p>æœåŠ¡å™¨æä¾›äº† DispatcherServletï¼Œå®ƒä½¿ç”¨çš„æ˜¯æ ‡å‡† Servlet æŠ€æœ¯</p><ul><li>è·¯å¾„ï¼šé»˜è®¤æ˜ å°„è·¯å¾„ä¸º <code>/</code>ï¼Œå³ä¼šåŒ¹é…åˆ°æ‰€æœ‰è¯·æ±‚ URLï¼Œå¯ä½œä¸ºè¯·æ±‚çš„ç»Ÿä¸€å…¥å£ï¼Œä¹Ÿè¢«ç§°ä¹‹ä¸º<strong>å‰æ§åˆ¶å™¨</strong><ul><li>jsp ä¸ä¼šåŒ¹é…åˆ° DispatcherServlet</li><li>å…¶å®ƒæœ‰è·¯å¾„çš„ Servlet åŒ¹é…ä¼˜å…ˆçº§ä¹Ÿé«˜äº DispatcherServlet</li></ul></li><li>åˆ›å»ºï¼šåœ¨ Boot ä¸­ï¼Œç”± DispatcherServletAutoConfiguration è¿™ä¸ªè‡ªåŠ¨é…ç½®ç±»æä¾› DispatcherServlet çš„ bean</li><li>åˆå§‹åŒ–ï¼šDispatcherServlet åˆå§‹åŒ–æ—¶ä¼šä¼˜å…ˆåˆ°å®¹å™¨é‡Œå¯»æ‰¾å„ç§ç»„ä»¶ï¼Œä½œä¸ºå®ƒçš„æˆå‘˜å˜é‡<ul><li>HandlerMappingï¼Œåˆå§‹åŒ–æ—¶è®°å½•æ˜ å°„å…³ç³»</li><li>HandlerAdapterï¼Œåˆå§‹åŒ–æ—¶å‡†å¤‡å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ã€æ¶ˆæ¯è½¬æ¢å™¨</li><li>HandlerExceptionResolverï¼Œåˆå§‹åŒ–æ—¶å‡†å¤‡å‚æ•°è§£æå™¨ã€è¿”å›å€¼å¤„ç†å™¨ã€æ¶ˆæ¯è½¬æ¢å™¨</li><li>ViewResolver</li></ul></li></ul></li><li><p>DispatcherServlet ä¼šåˆ©ç”¨ RequestMappingHandlerMapping æŸ¥æ‰¾æ§åˆ¶å™¨æ–¹æ³•</p><ul><li><p>ä¾‹å¦‚æ ¹æ® /hello è·¯å¾„æ‰¾åˆ° @RequestMapping(â€œ/helloâ€) å¯¹åº”çš„æ§åˆ¶å™¨æ–¹æ³•</p></li><li><p>æ§åˆ¶å™¨æ–¹æ³•ä¼šè¢«å°è£…ä¸º HandlerMethod å¯¹è±¡ï¼Œå¹¶ç»“åˆåŒ¹é…åˆ°çš„æ‹¦æˆªå™¨ä¸€èµ·è¿”å›ç»™ DispatcherServlet </p></li><li><p>HandlerMethod å’Œæ‹¦æˆªå™¨åˆåœ¨ä¸€èµ·ç§°ä¸º HandlerExecutionChainï¼ˆè°ƒç”¨é“¾ï¼‰å¯¹è±¡</p></li></ul></li><li><p>DispatcherServlet æ¥ä¸‹æ¥ä¼šï¼š</p><ol><li>è°ƒç”¨æ‹¦æˆªå™¨çš„ preHandle æ–¹æ³•</li><li>RequestMappingHandlerAdapter è°ƒç”¨ handle æ–¹æ³•ï¼Œå‡†å¤‡æ•°æ®ç»‘å®šå·¥å‚ã€æ¨¡å‹å·¥å‚ã€ModelAndViewContainerã€å°† HandlerMethod å®Œå–„ä¸º ServletInvocableHandlerMethod<ul><li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹1ï¸âƒ£ï¼šè¡¥å……æ¨¡å‹æ•°æ®</li><li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹2ï¸âƒ£ï¼šè¡¥å……è‡ªå®šä¹‰ç±»å‹è½¬æ¢å™¨</li><li>ä½¿ç”¨ HandlerMethodArgumentResolver å‡†å¤‡å‚æ•°<ul><li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹3ï¸âƒ£ï¼šRequestBody å¢å¼º</li></ul></li><li>è°ƒç”¨ ServletInvocableHandlerMethod </li><li>ä½¿ç”¨ HandlerMethodReturnValueHandler å¤„ç†è¿”å›å€¼<ul><li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹4ï¸âƒ£ï¼šResponseBody å¢å¼º</li></ul></li><li>æ ¹æ® ModelAndViewContainer è·å– ModelAndView<ul><li>å¦‚æœè¿”å›çš„ ModelAndView ä¸º nullï¼Œä¸èµ°ç¬¬ 4 æ­¥è§†å›¾è§£æåŠæ¸²æŸ“æµç¨‹<ul><li>ä¾‹å¦‚ï¼Œæœ‰çš„è¿”å›å€¼å¤„ç†å™¨è°ƒç”¨äº† HttpMessageConverter æ¥å°†ç»“æœè½¬æ¢ä¸º JSONï¼Œè¿™æ—¶ ModelAndView å°±ä¸º null</li></ul></li><li>å¦‚æœè¿”å›çš„ ModelAndView ä¸ä¸º nullï¼Œä¼šåœ¨ç¬¬ 4 æ­¥èµ°è§†å›¾è§£æåŠæ¸²æŸ“æµç¨‹</li></ul></li></ul></li><li>è°ƒç”¨æ‹¦æˆªå™¨çš„ postHandle æ–¹æ³•</li><li>å¤„ç†å¼‚å¸¸æˆ–è§†å›¾æ¸²æŸ“<ul><li>å¦‚æœ 1~3 å‡ºç°å¼‚å¸¸ï¼Œèµ° ExceptionHandlerExceptionResolver å¤„ç†å¼‚å¸¸æµç¨‹<ul><li>@ControllerAdvice å…¨å±€å¢å¼ºç‚¹5ï¸âƒ£ï¼š@ExceptionHandler å¼‚å¸¸å¤„ç†</li></ul></li><li>æ­£å¸¸ï¼Œèµ°è§†å›¾è§£æåŠæ¸²æŸ“æµç¨‹</li></ul></li><li>è°ƒç”¨æ‹¦æˆªå™¨çš„ afterCompletion æ–¹æ³•</li></ol></li></ol><h2 id="Boot"><a href="#Boot" class="headerlink" title="Boot"></a>Boot</h2><h3 id="37-Boot-éª¨æ¶é¡¹ç›®"><a href="#37-Boot-éª¨æ¶é¡¹ç›®" class="headerlink" title="37) Boot éª¨æ¶é¡¹ç›®"></a>37) Boot éª¨æ¶é¡¹ç›®</h3><p>å¦‚æœæ˜¯ linux ç¯å¢ƒï¼Œç”¨ä»¥ä¸‹å‘½ä»¤å³å¯è·å– spring boot çš„éª¨æ¶ pom.xml</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -G https://start.spring.io/pom.xml -d dependencies=web,mysql,mybatis -o pom.xml</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ Postman ç­‰å·¥å…·å®ç°</p><p>è‹¥æƒ³è·å–æ›´å¤šç”¨æ³•ï¼Œè¯·å‚è€ƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://start.spring.io</span><br></pre></td></tr></table></figure><h3 id="38-Boot-Waré¡¹ç›®"><a href="#38-Boot-Waré¡¹ç›®" class="headerlink" title="38) Boot Waré¡¹ç›®"></a>38) Boot Waré¡¹ç›®</h3><p>æ­¥éª¤1ï¼šåˆ›å»ºæ¨¡å—ï¼ŒåŒºåˆ«åœ¨äºæ‰“åŒ…æ–¹å¼é€‰æ‹© war</p><img src="/img/java/04é˜¶æ®µçƒ­é—¨æ¡†æ¶/day01-spring-IOC-1/image-20211021160145072.png" alt="image-20211021160145072" style="zoom: 50%;" /><p>æ¥ä¸‹æ¥å‹¾é€‰ Spring Web æ”¯æŒ</p><img src="/img/java/04é˜¶æ®µçƒ­é—¨æ¡†æ¶/day01-spring-IOC-1/image-20211021162416525.png" alt="image-20211021162416525" style="zoom:50%;" /><p>æ­¥éª¤2ï¼šç¼–å†™æ§åˆ¶å™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">abc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è¿›å…¥äº†æ§åˆ¶å™¨&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¥éª¤3ï¼šç¼–å†™ jsp è§†å›¾ï¼Œæ–°å»º webapp ç›®å½•å’Œä¸€ä¸ª hello.jsp æ–‡ä»¶ï¼Œæ³¨æ„æ–‡ä»¶åä¸æ§åˆ¶å™¨æ–¹æ³•è¿”å›çš„è§†å›¾é€»è¾‘åä¸€è‡´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">src</span><br><span class="line">|- main</span><br><span class="line">|- java</span><br><span class="line">|- resources</span><br><span class="line">|- webapp</span><br><span class="line">|- hello.jsp</span><br></pre></td></tr></table></figure><p>æ­¥éª¤4ï¼šé…ç½®è§†å›¾è·¯å¾„ï¼Œæ‰“å¼€ application.properties æ–‡ä»¶</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.mvc.view.prefix</span>=<span class="string">/</span></span><br><span class="line"><span class="meta">spring.mvc.view.suffix</span>=<span class="string">.jsp</span></span><br></pre></td></tr></table></figure><blockquote><p>å°†æ¥ prefix + æ§åˆ¶å™¨æ–¹æ³•è¿”å›å€¼ + suffix å³ä¸ºè§†å›¾å®Œæ•´è·¯å¾„</p></blockquote><h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><p>å¦‚æœç”¨ mvn æ’ä»¶ <code>mvn spring-boot:run</code> æˆ– main æ–¹æ³•æµ‹è¯•</p><ul><li>å¿…é¡»æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼Œå› ä¸ºæ­¤æ—¶ç”¨çš„è¿˜æ˜¯å†…åµŒ tomcatï¼Œè€Œå†…åµŒ tomcat é»˜è®¤ä¸å¸¦ jasperï¼ˆç”¨æ¥è§£æ jspï¼‰</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ Idea é…ç½® tomcat æ¥æµ‹è¯•ï¼Œæ­¤æ—¶ç”¨çš„æ˜¯å¤–ç½® tomcat</p><ul><li>éª¨æ¶ç”Ÿæˆçš„ä»£ç ä¸­ï¼Œå¤šäº†ä¸€ä¸ª ServletInitializerï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯é…ç½®å¤–ç½® Tomcat ä½¿ç”¨çš„ï¼Œåœ¨å¤–ç½® Tomcat å¯åŠ¨åï¼Œå»è°ƒç”¨å®ƒåˆ›å»ºå’Œè¿è¡Œ SpringApplication</li></ul><h4 id="å¯ç¤º"><a href="#å¯ç¤º" class="headerlink" title="å¯ç¤º"></a>å¯ç¤º</h4><p>å¯¹äº jar é¡¹ç›®ï¼Œè‹¥è¦æ”¯æŒ jspï¼Œä¹Ÿå¯ä»¥åœ¨åŠ å…¥ jasper ä¾èµ–çš„å‰æä¸‹ï¼ŒæŠŠ jsp æ–‡ä»¶ç½®å…¥ <code>META-INF/resources</code> </p><h3 id="39-Boot-å¯åŠ¨è¿‡ç¨‹"><a href="#39-Boot-å¯åŠ¨è¿‡ç¨‹" class="headerlink" title="39) Boot å¯åŠ¨è¿‡ç¨‹"></a>39) Boot å¯åŠ¨è¿‡ç¨‹</h3><p>é˜¶æ®µä¸€ï¼šSpringApplication æ„é€ </p><ol><li>è®°å½• BeanDefinition æº</li><li>æ¨æ–­åº”ç”¨ç±»å‹</li><li>è®°å½• ApplicationContext åˆå§‹åŒ–å™¨</li><li>è®°å½•ç›‘å¬å™¨</li><li>æ¨æ–­ä¸»å¯åŠ¨ç±»</li></ol><p>é˜¶æ®µäºŒï¼šæ‰§è¡Œ run æ–¹æ³•</p><ol><li><p>å¾—åˆ° SpringApplicationRunListenersï¼Œåå­—å–å¾—ä¸å¥½ï¼Œå®é™…æ˜¯äº‹ä»¶å‘å¸ƒå™¨</p><ul><li>å‘å¸ƒ application starting äº‹ä»¶1ï¸âƒ£</li></ul></li><li><p>å°è£…å¯åŠ¨ args</p></li><li><p>å‡†å¤‡ Environment æ·»åŠ å‘½ä»¤è¡Œå‚æ•°ï¼ˆ*ï¼‰</p></li><li><p>ConfigurationPropertySources å¤„ç†ï¼ˆ*ï¼‰</p><ul><li>å‘å¸ƒ application environment å·²å‡†å¤‡äº‹ä»¶2ï¸âƒ£</li></ul></li><li><p>é€šè¿‡ EnvironmentPostProcessorApplicationListener è¿›è¡Œ env åå¤„ç†ï¼ˆ*ï¼‰</p><ul><li>application.propertiesï¼Œç”± StandardConfigDataLocationResolver è§£æ</li><li>spring.application.json</li></ul></li><li><p>ç»‘å®š spring.main åˆ° SpringApplication å¯¹è±¡ï¼ˆ*ï¼‰</p></li><li><p>æ‰“å° bannerï¼ˆ*ï¼‰</p></li><li><p>åˆ›å»ºå®¹å™¨</p></li><li><p>å‡†å¤‡å®¹å™¨</p><ul><li>å‘å¸ƒ application context å·²åˆå§‹åŒ–äº‹ä»¶3ï¸âƒ£</li></ul></li><li><p>åŠ è½½ bean å®šä¹‰</p><ul><li>å‘å¸ƒ application prepared äº‹ä»¶4ï¸âƒ£</li></ul></li><li><p>refresh å®¹å™¨</p><ul><li>å‘å¸ƒ application started äº‹ä»¶5ï¸âƒ£</li></ul></li><li><p>æ‰§è¡Œ runner</p><ul><li><p>å‘å¸ƒ application ready äº‹ä»¶6ï¸âƒ£</p></li><li><p>è¿™å…¶ä¸­æœ‰å¼‚å¸¸ï¼Œå‘å¸ƒ application failed äº‹ä»¶7ï¸âƒ£</p></li></ul></li></ol><blockquote><p>å¸¦ * çš„æœ‰ç‹¬ç«‹çš„ç¤ºä¾‹</p></blockquote><h4 id="æ¼”ç¤º-å¯åŠ¨è¿‡ç¨‹"><a href="#æ¼”ç¤º-å¯åŠ¨è¿‡ç¨‹" class="headerlink" title="æ¼”ç¤º - å¯åŠ¨è¿‡ç¨‹"></a>æ¼”ç¤º - å¯åŠ¨è¿‡ç¨‹</h4><p><strong>com.itheima.a39.A39_1</strong> å¯¹åº” SpringApplication æ„é€ </p><p><strong>com.itheima.a39.A39_2</strong> å¯¹åº”ç¬¬1æ­¥ï¼Œå¹¶æ¼”ç¤º 7 ä¸ªäº‹ä»¶</p><p><strong>com.itheima.a39.A39_3</strong> å¯¹åº”ç¬¬2ã€8åˆ°12æ­¥</p><p><strong>org.springframework.boot.Step3</strong></p><p><strong>org.springframework.boot.Step4</strong></p><p><strong>org.springframework.boot.Step5</strong></p><p><strong>org.springframework.boot.Step6</strong></p><p><strong>org.springframework.boot.Step7</strong></p><h4 id="æ”¶è·ğŸ’¡-52"><a href="#æ”¶è·ğŸ’¡-52" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>SpringApplication æ„é€ æ–¹æ³•ä¸­æ‰€åšçš„æ“ä½œ<ul><li>å¯ä»¥æœ‰å¤šç§æºç”¨æ¥åŠ è½½ bean å®šä¹‰</li><li>åº”ç”¨ç±»å‹æ¨æ–­</li><li>æ·»åŠ å®¹å™¨åˆå§‹åŒ–å™¨</li><li>æ·»åŠ ç›‘å¬å™¨</li><li>æ¼”ç¤ºä¸»ç±»æ¨æ–­</li></ul></li><li>å¦‚ä½•è¯»å– spring.factories ä¸­çš„é…ç½®</li><li>ä»é…ç½®ä¸­è·å–é‡è¦çš„äº‹ä»¶å‘å¸ƒå™¨ï¼šSpringApplicationRunListeners</li><li>å®¹å™¨çš„åˆ›å»ºã€åˆå§‹åŒ–å™¨å¢å¼ºã€åŠ è½½ bean å®šä¹‰ç­‰</li><li>CommandLineRunnerã€ApplicationRunner çš„ä½œç”¨</li><li>ç¯å¢ƒå¯¹è±¡<ol><li>å‘½ä»¤è¡Œ PropertySource</li><li>ConfigurationPropertySources è§„èŒƒç¯å¢ƒé”®åç§°</li><li>EnvironmentPostProcessor åå¤„ç†å¢å¼º<ul><li>ç”± EventPublishingRunListener é€šè¿‡ç›‘å¬äº‹ä»¶2ï¸âƒ£æ¥è°ƒç”¨</li></ul></li><li>ç»‘å®š spring.main å‰ç¼€çš„ key value è‡³ SpringApplication</li></ol></li><li>Banner </li></ol><h3 id="40-Tomcat-å†…åµŒå®¹å™¨"><a href="#40-Tomcat-å†…åµŒå®¹å™¨" class="headerlink" title="40) Tomcat å†…åµŒå®¹å™¨"></a>40) Tomcat å†…åµŒå®¹å™¨</h3><p>Tomcat åŸºæœ¬ç»“æ„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Server</span><br><span class="line">â””â”€â”€â”€Service</span><br><span class="line">    â”œâ”€â”€â”€Connector (åè®®, ç«¯å£)</span><br><span class="line">    â””â”€â”€â”€Engine</span><br><span class="line">        â””â”€â”€â”€Host(è™šæ‹Ÿä¸»æœº localhost)</span><br><span class="line">            â”œâ”€â”€â”€Context1 (åº”ç”¨1, å¯ä»¥è®¾ç½®è™šæ‹Ÿè·¯å¾„, / å³ url èµ·å§‹è·¯å¾„; é¡¹ç›®ç£ç›˜è·¯å¾„, å³ docBase )</span><br><span class="line">            â”‚   â”‚   index.html</span><br><span class="line">            â”‚   â””â”€â”€â”€WEB-INF</span><br><span class="line">            â”‚       â”‚   web.xml (servlet, filter, listener) 3.0</span><br><span class="line">            â”‚       â”œâ”€â”€â”€classes (servlet, controller, service ...)</span><br><span class="line">            â”‚       â”œâ”€â”€â”€jsp</span><br><span class="line">            â”‚       â””â”€â”€â”€lib (ç¬¬ä¸‰æ–¹ jar åŒ…)</span><br><span class="line">            â””â”€â”€â”€Context2 (åº”ç”¨2)</span><br><span class="line">                â”‚   index.html</span><br><span class="line">                â””â”€â”€â”€WEB-INF</span><br><span class="line">                        web.xml</span><br></pre></td></tr></table></figure><h4 id="æ¼”ç¤º1-Tomcat-å†…åµŒå®¹å™¨"><a href="#æ¼”ç¤º1-Tomcat-å†…åµŒå®¹å™¨" class="headerlink" title="æ¼”ç¤º1 - Tomcat å†…åµŒå®¹å™¨"></a>æ¼”ç¤º1 - Tomcat å†…åµŒå®¹å™¨</h4><h5 id="å…³é”®ä»£ç -8"><a href="#å…³é”®ä»£ç -8" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> LifecycleException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">// 1.åˆ›å»º Tomcat å¯¹è±¡</span></span><br><span class="line">    Tomcat tomcat = <span class="keyword">new</span> Tomcat();</span><br><span class="line">    tomcat.setBaseDir(<span class="string">&quot;tomcat&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹, å³ docBase æ–‡ä»¶å¤¹</span></span><br><span class="line">    File docBase = Files.createTempDirectory(<span class="string">&quot;boot.&quot;</span>).toFile();</span><br><span class="line">    docBase.deleteOnExit();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.åˆ›å»º Tomcat é¡¹ç›®, åœ¨ Tomcat ä¸­ç§°ä¸º Context</span></span><br><span class="line">    Context context = tomcat.addContext(<span class="string">&quot;&quot;</span>, docBase.getAbsolutePath());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4.ç¼–ç¨‹æ·»åŠ  Servlet</span></span><br><span class="line">    context.addServletContainerInitializer(<span class="keyword">new</span> ServletContainerInitializer() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStartup</span><span class="params">(Set&lt;Class&lt;?&gt;&gt; c, ServletContext ctx)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">            HelloServlet helloServlet = <span class="keyword">new</span> HelloServlet();</span><br><span class="line">            ctx.addServlet(<span class="string">&quot;aaa&quot;</span>, helloServlet).addMapping(<span class="string">&quot;/hello&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, Collections.emptySet());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 5.å¯åŠ¨ Tomcat</span></span><br><span class="line">    tomcat.start();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 6.åˆ›å»ºè¿æ¥å™¨, è®¾ç½®ç›‘å¬ç«¯å£</span></span><br><span class="line">    Connector connector = <span class="keyword">new</span> Connector(<span class="keyword">new</span> Http11Nio2Protocol());</span><br><span class="line">    connector.setPort(<span class="number">8080</span>);</span><br><span class="line">    tomcat.setConnector(connector);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¼”ç¤º2-é›†æˆ-Spring-å®¹å™¨"><a href="#æ¼”ç¤º2-é›†æˆ-Spring-å®¹å™¨" class="headerlink" title="æ¼”ç¤º2 - é›†æˆ Spring å®¹å™¨"></a>æ¼”ç¤º2 - é›†æˆ Spring å®¹å™¨</h4><h5 id="å…³é”®ä»£ç -9"><a href="#å…³é”®ä»£ç -9" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">WebApplicationContext springContext = getApplicationContext();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.ç¼–ç¨‹æ·»åŠ  Servlet</span></span><br><span class="line">context.addServletContainerInitializer(<span class="keyword">new</span> ServletContainerInitializer() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStartup</span><span class="params">(Set&lt;Class&lt;?&gt;&gt; c, ServletContext ctx)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        <span class="comment">// â¬‡ï¸é€šè¿‡ ServletRegistrationBean æ·»åŠ  DispatcherServlet ç­‰</span></span><br><span class="line">        <span class="keyword">for</span> (ServletRegistrationBean registrationBean : </span><br><span class="line">             springContext.getBeansOfType(ServletRegistrationBean.class).values()) &#123;</span><br><span class="line">            registrationBean.onStartup(ctx);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, Collections.emptySet());</span><br></pre></td></tr></table></figure><h3 id="41-Boot-è‡ªåŠ¨é…ç½®"><a href="#41-Boot-è‡ªåŠ¨é…ç½®" class="headerlink" title="41) Boot è‡ªåŠ¨é…ç½®"></a>41) Boot è‡ªåŠ¨é…ç½®</h3><h4 id="AopAutoConfiguration"><a href="#AopAutoConfiguration" class="headerlink" title="AopAutoConfiguration"></a>AopAutoConfiguration</h4><p>Spring Boot æ˜¯åˆ©ç”¨äº†è‡ªåŠ¨é…ç½®ç±»æ¥ç®€åŒ–äº† aop ç›¸å…³é…ç½®</p><ul><li>AOP è‡ªåŠ¨é…ç½®ç±»ä¸º <code>org.springframework.boot.autoconfigure.aop.AopAutoConfiguration</code></li><li>å¯ä»¥é€šè¿‡ <code>spring.aop.auto=false</code> ç¦ç”¨ aop è‡ªåŠ¨é…ç½®</li><li>AOP è‡ªåŠ¨é…ç½®çš„æœ¬è´¨æ˜¯é€šè¿‡ <code>@EnableAspectJAutoProxy</code> æ¥å¼€å¯äº†è‡ªåŠ¨ä»£ç†ï¼Œå¦‚æœåœ¨å¼•å¯¼ç±»ä¸Šè‡ªå·±æ·»åŠ äº† <code>@EnableAspectJAutoProxy</code> é‚£ä¹ˆä»¥è‡ªå·±æ·»åŠ çš„ä¸ºå‡†</li><li><code>@EnableAspectJAutoProxy</code> çš„æœ¬è´¨æ˜¯å‘å®¹å™¨ä¸­æ·»åŠ äº† <code>AnnotationAwareAspectJAutoProxyCreator</code> è¿™ä¸ª bean åå¤„ç†å™¨ï¼Œå®ƒèƒ½å¤Ÿæ‰¾åˆ°å®¹å™¨ä¸­æ‰€æœ‰åˆ‡é¢ï¼Œå¹¶ä¸ºåŒ¹é…åˆ‡ç‚¹çš„ç›®æ ‡ç±»åˆ›å»ºä»£ç†ï¼Œåˆ›å»ºä»£ç†çš„å·¥ä½œä¸€èˆ¬æ˜¯åœ¨ bean çš„åˆå§‹åŒ–é˜¶æ®µå®Œæˆçš„</li></ul><h4 id="DataSourceAutoConfiguration"><a href="#DataSourceAutoConfiguration" class="headerlink" title="DataSourceAutoConfiguration"></a>DataSourceAutoConfiguration</h4><ul><li>å¯¹åº”çš„è‡ªåŠ¨é…ç½®ç±»ä¸ºï¼šorg.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration</li><li>å®ƒå†…éƒ¨é‡‡ç”¨äº†æ¡ä»¶è£…é…ï¼Œé€šè¿‡æ£€æŸ¥å®¹å™¨çš„ beanï¼Œä»¥åŠç±»è·¯å¾„ä¸‹çš„ classï¼Œæ¥å†³å®šè¯¥ @Bean æ˜¯å¦ç”Ÿæ•ˆ</li></ul><p>ç®€å•è¯´æ˜ä¸€ä¸‹ï¼ŒSpring Boot æ”¯æŒä¸¤å¤§ç±»æ•°æ®æºï¼š</p><ul><li>EmbeddedDatabase - å†…åµŒæ•°æ®åº“è¿æ¥æ± </li><li>PooledDataSource - éå†…åµŒæ•°æ®åº“è¿æ¥æ± </li></ul><p>PooledDataSource åˆæ”¯æŒå¦‚ä¸‹æ•°æ®æº</p><ul><li>hikari æä¾›çš„ HikariDataSource</li><li>tomcat-jdbc æä¾›çš„ DataSource</li><li>dbcp2 æä¾›çš„ BasicDataSource</li><li>oracle æä¾›çš„ PoolDataSourceImpl</li></ul><p>å¦‚æœçŸ¥é“æ•°æ®æºçš„å®ç°ç±»ç±»å‹ï¼Œå³æŒ‡å®šäº† <code>spring.datasource.type</code>ï¼Œç†è®ºä¸Šå¯ä»¥æ”¯æŒæ‰€æœ‰æ•°æ®æºï¼Œä½†è¿™æ ·åšçš„ä¸€ä¸ªæœ€å¤§é—®é¢˜æ˜¯æ— æ³•è®¢åˆ¶æ¯ç§æ•°æ®æºçš„è¯¦ç»†é…ç½®ï¼ˆå¦‚æœ€å¤§ã€æœ€å°è¿æ¥æ•°ç­‰ï¼‰</p><h4 id="MybatisAutoConfiguration"><a href="#MybatisAutoConfiguration" class="headerlink" title="MybatisAutoConfiguration"></a>MybatisAutoConfiguration</h4><ul><li>MyBatis è‡ªåŠ¨é…ç½®ç±»ä¸º <code>org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration</code></li><li>å®ƒä¸»è¦é…ç½®äº†ä¸¤ä¸ª bean<ul><li>SqlSessionFactory - MyBatis æ ¸å¿ƒå¯¹è±¡ï¼Œç”¨æ¥åˆ›å»º SqlSession</li><li>SqlSessionTemplate - SqlSession çš„å®ç°ï¼Œæ­¤å®ç°ä¼šä¸å½“å‰çº¿ç¨‹ç»‘å®š</li><li>ç”¨ ImportBeanDefinitionRegistrar çš„æ–¹å¼æ‰«ææ‰€æœ‰æ ‡æ³¨äº† @Mapper æ³¨è§£çš„æ¥å£</li><li>ç”¨ AutoConfigurationPackages æ¥ç¡®å®šæ‰«æçš„åŒ…</li></ul></li><li>è¿˜æœ‰ä¸€ä¸ªç›¸å…³çš„ beanï¼šMybatisPropertiesï¼Œå®ƒä¼šè¯»å–é…ç½®æ–‡ä»¶ä¸­å¸¦ <code>mybatis.</code> å‰ç¼€çš„é…ç½®é¡¹è¿›è¡Œå®šåˆ¶é…ç½®</li></ul><p>@MapperScan æ³¨è§£çš„ä½œç”¨ä¸ MybatisAutoConfiguration ç±»ä¼¼ï¼Œä¼šæ³¨å†Œ MapperScannerConfigurer æœ‰å¦‚ä¸‹åŒºåˆ«</p><ul><li>@MapperScan æ‰«æå…·ä½“åŒ…ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥é…ç½®å…³æ³¨å“ªä¸ªæ³¨è§£ï¼‰</li><li>@MapperScan å¦‚æœä¸æŒ‡å®šæ‰«æå…·ä½“åŒ…ï¼Œåˆ™ä¼šæŠŠå¼•å¯¼ç±»èŒƒå›´å†…ï¼Œæ‰€æœ‰æ¥å£å½“åš Mapper æ¥å£</li><li>MybatisAutoConfiguration å…³æ³¨çš„æ˜¯æ‰€æœ‰æ ‡æ³¨ @Mapper æ³¨è§£çš„æ¥å£ï¼Œä¼šå¿½ç•¥æ‰é @Mapper æ ‡æ³¨çš„æ¥å£</li></ul><p>è¿™é‡Œæœ‰åŒå­¦æœ‰ç–‘é—®ï¼Œä¹‹å‰ä»‹ç»çš„éƒ½æ˜¯å°†å…·ä½“ç±»äº¤ç»™ Spring ç®¡ç†ï¼Œæ€ä¹ˆåˆ°äº† MyBatis è¿™å„¿ï¼Œæ¥å£å°±å¯ä»¥è¢«ç®¡ç†å‘¢ï¼Ÿ</p><ul><li>å…¶å®å¹¶éå°†æ¥å£äº¤ç»™ Spring ç®¡ç†ï¼Œè€Œæ˜¯æ¯ä¸ªæ¥å£ä¼šå¯¹åº”ä¸€ä¸ª MapperFactoryBeanï¼Œæ˜¯åè€…è¢« Spring æ‰€ç®¡ç†ï¼Œæ¥å£åªæ˜¯ä½œä¸º MapperFactoryBean çš„ä¸€ä¸ªå±æ€§æ¥é…ç½®</li></ul><h4 id="TransactionAutoConfiguration"><a href="#TransactionAutoConfiguration" class="headerlink" title="TransactionAutoConfiguration"></a>TransactionAutoConfiguration</h4><ul><li><p>äº‹åŠ¡è‡ªåŠ¨é…ç½®ç±»æœ‰ä¸¤ä¸ªï¼š</p><ul><li><code>org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration</code></li><li><code>org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration</code></li></ul></li><li><p>å‰è€…é…ç½®äº† DataSourceTransactionManager ç”¨æ¥æ‰§è¡Œäº‹åŠ¡çš„æäº¤ã€å›æ»šæ“ä½œ</p></li><li><p>åè€…åŠŸèƒ½ä¸Šå¯¹æ ‡ @EnableTransactionManagementï¼ŒåŒ…å«ä»¥ä¸‹ä¸‰ä¸ª bean</p><ul><li>BeanFactoryTransactionAttributeSourceAdvisor äº‹åŠ¡åˆ‡é¢ç±»ï¼ŒåŒ…å«é€šçŸ¥å’Œåˆ‡ç‚¹</li><li>TransactionInterceptor äº‹åŠ¡é€šçŸ¥ç±»ï¼Œç”±å®ƒåœ¨ç›®æ ‡æ–¹æ³•è°ƒç”¨å‰ååŠ å…¥äº‹åŠ¡æ“ä½œ</li><li>AnnotationTransactionAttributeSource ä¼šè§£æ @Transactional åŠäº‹åŠ¡å±æ€§ï¼Œä¹ŸåŒ…å«äº†åˆ‡ç‚¹åŠŸèƒ½</li></ul></li><li><p>å¦‚æœè‡ªå·±é…ç½®äº† DataSourceTransactionManager æˆ–æ˜¯åœ¨å¼•å¯¼ç±»åŠ äº† @EnableTransactionManagementï¼Œåˆ™ä»¥è‡ªå·±é…ç½®çš„ä¸ºå‡†</p></li></ul><h4 id="ServletWebServerFactoryAutoConfiguration"><a href="#ServletWebServerFactoryAutoConfiguration" class="headerlink" title="ServletWebServerFactoryAutoConfiguration"></a>ServletWebServerFactoryAutoConfiguration</h4><ul><li>æä¾› ServletWebServerFactory</li></ul><h4 id="DispatcherServletAutoConfiguration"><a href="#DispatcherServletAutoConfiguration" class="headerlink" title="DispatcherServletAutoConfiguration"></a>DispatcherServletAutoConfiguration</h4><ul><li>æä¾› DispatcherServlet</li><li>æä¾› DispatcherServletRegistrationBean</li></ul><h4 id="WebMvcAutoConfiguration"><a href="#WebMvcAutoConfiguration" class="headerlink" title="WebMvcAutoConfiguration"></a>WebMvcAutoConfiguration</h4><ul><li>é…ç½® DispatcherServlet çš„å„é¡¹ç»„ä»¶ï¼Œæä¾›çš„ bean è§è¿‡çš„æœ‰<ul><li>å¤šé¡¹ HandlerMapping</li><li>å¤šé¡¹ HandlerAdapter</li><li>HandlerExceptionResolver</li></ul></li></ul><h4 id="ErrorMvcAutoConfiguration"><a href="#ErrorMvcAutoConfiguration" class="headerlink" title="ErrorMvcAutoConfiguration"></a>ErrorMvcAutoConfiguration</h4><ul><li>æä¾›çš„ bean æœ‰ BasicErrorController</li></ul><h4 id="MultipartAutoConfiguration"><a href="#MultipartAutoConfiguration" class="headerlink" title="MultipartAutoConfiguration"></a>MultipartAutoConfiguration</h4><ul><li>å®ƒæä¾›äº† org.springframework.web.multipart.support.StandardServletMultipartResolver</li><li>è¯¥ bean ç”¨æ¥è§£æ multipart/form-data æ ¼å¼çš„æ•°æ®</li></ul><h4 id="HttpEncodingAutoConfiguration"><a href="#HttpEncodingAutoConfiguration" class="headerlink" title="HttpEncodingAutoConfiguration"></a>HttpEncodingAutoConfiguration</h4><ul><li>POST è¯·æ±‚å‚æ•°å¦‚æœæœ‰ä¸­æ–‡ï¼Œæ— éœ€ç‰¹æ®Šè®¾ç½®ï¼Œè¿™æ˜¯å› ä¸º Spring Boot å·²ç»é…ç½®äº† org.springframework.boot.web.servlet.filter.OrderedCharacterEncodingFilter</li><li>å¯¹åº”é…ç½® server.servlet.encoding.charset=UTF-8ï¼Œé»˜è®¤å°±æ˜¯ UTF-8</li><li>å½“ç„¶ï¼Œå®ƒåªå½±å“é json æ ¼å¼çš„æ•°æ®</li></ul><h4 id="æ¼”ç¤º-è‡ªåŠ¨é…ç½®ç±»åŸç†"><a href="#æ¼”ç¤º-è‡ªåŠ¨é…ç½®ç±»åŸç†" class="headerlink" title="æ¼”ç¤º - è‡ªåŠ¨é…ç½®ç±»åŸç†"></a>æ¼”ç¤º - è‡ªåŠ¨é…ç½®ç±»åŸç†</h4><h5 id="å…³é”®ä»£ç -10"><a href="#å…³é”®ä»£ç -10" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h5><p>å‡è®¾å·²æœ‰ç¬¬ä¸‰æ–¹çš„ä¸¤ä¸ªè‡ªåŠ¨é…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">// â¬…ï¸ç¬¬ä¸‰æ–¹çš„é…ç½®ç±»</span></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoConfiguration1</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Bean1 <span class="title">bean1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Bean1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">// â¬…ï¸ç¬¬ä¸‰æ–¹çš„é…ç½®ç±»</span></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoConfiguration2</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Bean2 <span class="title">bean2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Bean2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æä¾›ä¸€ä¸ªé…ç½®æ–‡ä»¶ META-INF/spring.factoriesï¼Œkey ä¸ºå¯¼å…¥å™¨ç±»åï¼Œå€¼ä¸ºå¤šä¸ªè‡ªåŠ¨é…ç½®ç±»åï¼Œç”¨é€—å·åˆ†éš”</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">MyImportSelector</span>=<span class="string">\</span></span><br><span class="line"><span class="string">AutoConfiguration1,\</span></span><br><span class="line"><span class="string">AutoConfiguration2</span></span><br></pre></td></tr></table></figure><blockquote><p><em><strong>æ³¨æ„</strong></em></p><ul><li>ä¸Šè¿°é…ç½®æ–‡ä»¶ä¸­ MyImportSelector ä¸ AutoConfiguration1ï¼ŒAutoConfiguration2 ä¸ºç®€æ´å‡çœç•¥äº†åŒ…åï¼Œè‡ªå·±æµ‹è¯•æ—¶è¯·å°†åŒ…åæ ¹æ®æƒ…å†µè¡¥å…¨</li></ul></blockquote><p>å¼•å…¥è‡ªåŠ¨é…ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">// â¬…ï¸æœ¬é¡¹ç›®çš„é…ç½®ç±»</span></span><br><span class="line"><span class="meta">@Import(MyImportSelector.class)</span></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Config</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyImportSelector</span> <span class="keyword">implements</span> <span class="title">DeferredImportSelector</span> </span>&#123;</span><br><span class="line">    <span class="comment">// â¬‡ï¸è¯¥æ–¹æ³•ä» META-INF/spring.factories è¯»å–è‡ªåŠ¨é…ç½®ç±»åï¼Œè¿”å›çš„ String[] å³ä¸ºè¦å¯¼å…¥çš„é…ç½®ç±»</span></span><br><span class="line">    <span class="keyword">public</span> String[] selectImports(AnnotationMetadata importingClassMetadata) &#123;</span><br><span class="line">        <span class="keyword">return</span> SpringFactoriesLoader</span><br><span class="line">            .loadFactoryNames(MyImportSelector.class, <span class="keyword">null</span>).toArray(<span class="keyword">new</span> String[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-53"><a href="#æ”¶è·ğŸ’¡-53" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>è‡ªåŠ¨é…ç½®ç±»æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªé…ç½®ç±»è€Œå·²ï¼Œåªæ˜¯ç”¨ META-INF/spring.factories ç®¡ç†ï¼Œä¸åº”ç”¨é…ç½®ç±»è§£è€¦</li><li>@Enable æ‰“å¤´çš„æ³¨è§£æœ¬è´¨æ˜¯åˆ©ç”¨äº† @Import</li><li>@Import é…åˆ DeferredImportSelector å³å¯å®ç°å¯¼å…¥ï¼ŒselectImports æ–¹æ³•çš„è¿”å›å€¼å³ä¸ºè¦å¯¼å…¥çš„é…ç½®ç±»å</li><li>DeferredImportSelector çš„å¯¼å…¥ä¼šåœ¨æœ€åæ‰§è¡Œï¼Œä¸ºçš„æ˜¯è®©å…¶å®ƒé…ç½®ä¼˜å…ˆè§£æ</li></ol><h3 id="42-æ¡ä»¶è£…é…åº•å±‚"><a href="#42-æ¡ä»¶è£…é…åº•å±‚" class="headerlink" title="42) æ¡ä»¶è£…é…åº•å±‚"></a>42) æ¡ä»¶è£…é…åº•å±‚</h3><p>æ¡ä»¶è£…é…çš„åº•å±‚æ˜¯æœ¬è´¨ä¸Šæ˜¯ @Conditional ä¸ Conditionï¼Œè¿™ä¸¤ä¸ªæ³¨è§£ã€‚å¼•å…¥è‡ªåŠ¨é…ç½®ç±»æ—¶ï¼ŒæœŸæœ›æ»¡è¶³ä¸€å®šæ¡ä»¶æ‰èƒ½è¢« Spring ç®¡ç†ï¼Œä¸æ»¡è¶³åˆ™ä¸ç®¡ç†ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>æ¯”å¦‚æ¡ä»¶æ˜¯ã€ç±»è·¯å¾„ä¸‹å¿…é¡»æœ‰ dataSourceã€‘è¿™ä¸ª bean ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>é¦–å…ˆç¼–å†™æ¡ä»¶åˆ¤æ–­ç±»ï¼Œå®ƒå®ç° Condition æ¥å£ï¼Œç¼–å†™æ¡ä»¶åˆ¤æ–­é€»è¾‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyCondition1</span> <span class="keyword">implements</span> <span class="title">Condition</span> </span>&#123; </span><br><span class="line">    <span class="comment">// â¬‡ï¸å¦‚æœå­˜åœ¨ Druid ä¾èµ–ï¼Œæ¡ä»¶æˆç«‹</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">matches</span><span class="params">(ConditionContext context, AnnotatedTypeMetadata metadata)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ClassUtils.isPresent(<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶æ¬¡ï¼Œåœ¨è¦å¯¼å…¥çš„è‡ªåŠ¨é…ç½®ç±»ä¸Šæ·»åŠ  <code>@Conditional(MyCondition1.class)</code>ï¼Œå°†æ¥æ­¤ç±»è¢«å¯¼å…¥æ—¶å°±ä¼šåšæ¡ä»¶æ£€æŸ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">// ç¬¬ä¸‰æ–¹çš„é…ç½®ç±»</span></span><br><span class="line"><span class="meta">@Conditional(MyCondition1.class)</span> <span class="comment">// â¬…ï¸åŠ å…¥æ¡ä»¶</span></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoConfiguration1</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Bean1 <span class="title">bean1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Bean1();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ†åˆ«æµ‹è¯•åŠ å…¥å’Œå»é™¤ druid ä¾èµ–ï¼Œè§‚å¯Ÿ bean1 æ˜¯å¦å­˜åœ¨äºå®¹å™¨</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="æ”¶è·ğŸ’¡-54"><a href="#æ”¶è·ğŸ’¡-54" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>å­¦ä¹ ä¸€ç§ç‰¹æ®Šçš„ if - else</li></ol><h2 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h2><h3 id="43-FactoryBean"><a href="#43-FactoryBean" class="headerlink" title="43) FactoryBean"></a>43) FactoryBean</h3><h4 id="æ¼”ç¤º-FactoryBean"><a href="#æ¼”ç¤º-FactoryBean" class="headerlink" title="æ¼”ç¤º - FactoryBean"></a>æ¼”ç¤º - FactoryBean</h4><h5 id="ä»£ç å‚è€ƒ-40"><a href="#ä»£ç å‚è€ƒ-40" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a43</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-55"><a href="#æ”¶è·ğŸ’¡-55" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>å®ƒçš„ä½œç”¨æ˜¯ç”¨åˆ¶é€ åˆ›å»ºè¿‡ç¨‹è¾ƒä¸ºå¤æ‚çš„äº§å“, å¦‚ SqlSessionFactory, ä½† @Bean å·²å…·å¤‡ç­‰ä»·åŠŸèƒ½</li><li>ä½¿ç”¨ä¸Šè¾ƒä¸ºå¤æ€ª, ä¸€ä¸ç•™ç¥å°±ä¼šç”¨é”™<ol><li>è¢« FactoryBean åˆ›å»ºçš„äº§å“<ul><li>ä¼šè®¤ä¸ºåˆ›å»ºã€ä¾èµ–æ³¨å…¥ã€Aware æ¥å£å›è°ƒã€å‰åˆå§‹åŒ–è¿™äº›éƒ½æ˜¯ FactoryBean çš„èŒè´£, è¿™äº›æµç¨‹éƒ½ä¸ä¼šèµ°</li><li>å”¯æœ‰ååˆå§‹åŒ–çš„æµç¨‹ä¼šèµ°, ä¹Ÿå°±æ˜¯äº§å“å¯ä»¥è¢«ä»£ç†å¢å¼º</li><li>å•ä¾‹çš„äº§å“ä¸ä¼šå­˜å‚¨äº BeanFactory çš„ singletonObjects æˆå‘˜ä¸­, è€Œæ˜¯å¦ä¸€ä¸ª factoryBeanObjectCache æˆå‘˜ä¸­</li></ul></li><li>æŒ‰åå­—å»è·å–æ—¶, æ‹¿åˆ°çš„æ˜¯äº§å“å¯¹è±¡, åå­—å‰é¢åŠ  &amp; è·å–çš„æ˜¯å·¥å‚å¯¹è±¡</li></ol></li></ol><h3 id="44-Indexed-åŸç†"><a href="#44-Indexed-åŸç†" class="headerlink" title="44) @Indexed åŸç†"></a>44) @Indexed åŸç†</h3><p>çœŸå®é¡¹ç›®ä¸­ï¼Œåªéœ€è¦åŠ å…¥ä»¥ä¸‹ä¾èµ–å³å¯</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context-indexer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="æ¼”ç¤º-Indexed"><a href="#æ¼”ç¤º-Indexed" class="headerlink" title="æ¼”ç¤º - @Indexed"></a>æ¼”ç¤º - @Indexed</h4><h5 id="ä»£ç å‚è€ƒ-41"><a href="#ä»£ç å‚è€ƒ-41" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a44</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-56"><a href="#æ”¶è·ğŸ’¡-56" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>åœ¨ç¼–è¯‘æ—¶å°±æ ¹æ® @Indexed ç”Ÿæˆ META-INF/spring.components æ–‡ä»¶</li><li>æ‰«ææ—¶<ul><li>å¦‚æœå‘ç° META-INF/spring.components å­˜åœ¨, ä»¥å®ƒä¸ºå‡†åŠ è½½ bean definition</li><li>å¦åˆ™, ä¼šéå†åŒ…ä¸‹æ‰€æœ‰ class èµ„æº (åŒ…æ‹¬ jar å†…çš„)</li></ul></li><li>è§£å†³çš„é—®é¢˜ï¼Œåœ¨ç¼–è¯‘æœŸå°±æ‰¾åˆ° @Component ç»„ä»¶ï¼ŒèŠ‚çœè¿è¡ŒæœŸé—´æ‰«æ @Component çš„æ—¶é—´</li></ol><h3 id="45-ä»£ç†è¿›ä¸€æ­¥ç†è§£"><a href="#45-ä»£ç†è¿›ä¸€æ­¥ç†è§£" class="headerlink" title="45) ä»£ç†è¿›ä¸€æ­¥ç†è§£"></a>45) ä»£ç†è¿›ä¸€æ­¥ç†è§£</h3><h4 id="æ¼”ç¤º-ä»£ç†"><a href="#æ¼”ç¤º-ä»£ç†" class="headerlink" title="æ¼”ç¤º - ä»£ç†"></a>æ¼”ç¤º - ä»£ç†</h4><h5 id="ä»£ç å‚è€ƒ-42"><a href="#ä»£ç å‚è€ƒ-42" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a45</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-57"><a href="#æ”¶è·ğŸ’¡-57" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li><p>spring ä»£ç†çš„è®¾è®¡ç‰¹ç‚¹</p><ul><li><p>ä¾èµ–æ³¨å…¥å’Œåˆå§‹åŒ–å½±å“çš„æ˜¯åŸå§‹å¯¹è±¡</p><ul><li>å› æ­¤ cglib ä¸èƒ½ç”¨ MethodProxy.invokeSuper()</li></ul></li><li><p>ä»£ç†ä¸ç›®æ ‡æ˜¯ä¸¤ä¸ªå¯¹è±¡ï¼ŒäºŒè€…æˆå‘˜å˜é‡å¹¶ä¸å…±ç”¨æ•°æ®</p></li></ul></li><li><p>static æ–¹æ³•ã€final æ–¹æ³•ã€private æ–¹æ³•å‡æ— æ³•å¢å¼º</p><ul><li>è¿›ä¸€æ­¥ç†è§£ä»£ç†å¢å¼ºåŸºäºæ–¹æ³•é‡å†™</li></ul></li></ol><h3 id="46-Value-è£…é…åº•å±‚"><a href="#46-Value-è£…é…åº•å±‚" class="headerlink" title="46) @Value è£…é…åº•å±‚"></a>46) @Value è£…é…åº•å±‚</h3><h4 id="æŒ‰ç±»å‹è£…é…çš„æ­¥éª¤"><a href="#æŒ‰ç±»å‹è£…é…çš„æ­¥éª¤" class="headerlink" title="æŒ‰ç±»å‹è£…é…çš„æ­¥éª¤"></a>æŒ‰ç±»å‹è£…é…çš„æ­¥éª¤</h4><ol><li>æŸ¥çœ‹éœ€è¦çš„ç±»å‹æ˜¯å¦ä¸º Optionalï¼Œæ˜¯ï¼Œåˆ™è¿›è¡Œå°è£…ï¼ˆéå»¶è¿Ÿï¼‰ï¼Œå¦åˆ™å‘ä¸‹èµ°</li><li>æŸ¥çœ‹éœ€è¦çš„ç±»å‹æ˜¯å¦ä¸º ObjectFactory æˆ– ObjectProviderï¼Œæ˜¯ï¼Œåˆ™è¿›è¡Œå°è£…ï¼ˆå»¶è¿Ÿï¼‰ï¼Œå¦åˆ™å‘ä¸‹èµ°</li><li>æŸ¥çœ‹éœ€è¦çš„ç±»å‹ï¼ˆæˆå‘˜æˆ–å‚æ•°ï¼‰ä¸Šæ˜¯å¦ç”¨ @Lazy ä¿®é¥°ï¼Œæ˜¯ï¼Œåˆ™è¿”å›ä»£ç†ï¼Œå¦åˆ™å‘ä¸‹èµ°</li><li>è§£æ @Value çš„å€¼<ol><li>å¦‚æœéœ€è¦çš„å€¼æ˜¯å­—ç¬¦ä¸²ï¼Œå…ˆè§£æ ${ }ï¼Œå†è§£æ #{ }</li><li>ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œéœ€è¦ç”¨ TypeConverter è½¬æ¢</li></ol></li><li>çœ‹éœ€è¦çš„ç±»å‹æ˜¯å¦ä¸º Streamã€Arrayã€Collectionã€Mapï¼Œæ˜¯ï¼Œåˆ™æŒ‰é›†åˆå¤„ç†ï¼Œå¦åˆ™å‘ä¸‹èµ°</li><li>åœ¨ BeanFactory çš„ resolvableDependencies ä¸­æ‰¾æœ‰æ²¡æœ‰ç±»å‹åˆé€‚çš„å¯¹è±¡æ³¨å…¥ï¼Œæ²¡æœ‰å‘ä¸‹èµ°</li><li>åœ¨ BeanFactory åŠçˆ¶å·¥å‚ä¸­æ‰¾ç±»å‹åŒ¹é…çš„ bean è¿›è¡Œç­›é€‰ï¼Œç­›é€‰æ—¶ä¼šè€ƒè™‘ @Qualifier åŠæ³›å‹</li><li>ç»“æœä¸ªæ•°ä¸º 0 æŠ›å‡º NoSuchBeanDefinitionException å¼‚å¸¸ </li><li>å¦‚æœç»“æœ &gt; 1ï¼Œå†æ ¹æ® @Primary è¿›è¡Œç­›é€‰</li><li>å¦‚æœç»“æœä» &gt; 1ï¼Œå†æ ¹æ®æˆå‘˜åæˆ–å˜é‡åè¿›è¡Œç­›é€‰</li><li>ç»“æœä» &gt; 1ï¼ŒæŠ›å‡º NoUniqueBeanDefinitionException å¼‚å¸¸</li></ol><h4 id="æ¼”ç¤º-Value-è£…é…è¿‡ç¨‹"><a href="#æ¼”ç¤º-Value-è£…é…è¿‡ç¨‹" class="headerlink" title="æ¼”ç¤º - @Value è£…é…è¿‡ç¨‹"></a>æ¼”ç¤º - @Value è£…é…è¿‡ç¨‹</h4><h5 id="ä»£ç å‚è€ƒ-43"><a href="#ä»£ç å‚è€ƒ-43" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a46</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-58"><a href="#æ”¶è·ğŸ’¡-58" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>ContextAnnotationAutowireCandidateResolver ä½œç”¨ä¹‹ä¸€ï¼Œè·å– @Value çš„å€¼</li><li>äº†è§£ ${ } å¯¹åº”çš„è§£æå™¨</li><li>äº†è§£ #{ } å¯¹åº”çš„è§£æå™¨</li><li>TypeConvert çš„ä¸€é¡¹ä½“ç°</li></ol><h3 id="47-Autowired-è£…é…åº•å±‚"><a href="#47-Autowired-è£…é…åº•å±‚" class="headerlink" title="47) @Autowired è£…é…åº•å±‚"></a>47) @Autowired è£…é…åº•å±‚</h3><h4 id="æ¼”ç¤º-Autowired-è£…é…è¿‡ç¨‹"><a href="#æ¼”ç¤º-Autowired-è£…é…è¿‡ç¨‹" class="headerlink" title="æ¼”ç¤º - @Autowired è£…é…è¿‡ç¨‹"></a>æ¼”ç¤º - @Autowired è£…é…è¿‡ç¨‹</h4><h5 id="ä»£ç å‚è€ƒ-44"><a href="#ä»£ç å‚è€ƒ-44" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a47</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-59"><a href="#æ”¶è·ğŸ’¡-59" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><ol><li>@Autowired æœ¬è´¨ä¸Šæ˜¯æ ¹æ®æˆå‘˜å˜é‡æˆ–æ–¹æ³•å‚æ•°çš„ç±»å‹è¿›è¡Œè£…é…</li><li>å¦‚æœå¾…è£…é…ç±»å‹æ˜¯ Optionalï¼Œéœ€è¦æ ¹æ® Optional æ³›å‹æ‰¾åˆ° beanï¼Œå†å°è£…ä¸º Optional å¯¹è±¡è£…é…</li><li>å¦‚æœå¾…è£…é…çš„ç±»å‹æ˜¯ ObjectFactoryï¼Œéœ€è¦æ ¹æ® ObjectFactory æ³›å‹åˆ›å»º ObjectFactory å¯¹è±¡è£…é…<ul><li>æ­¤æ–¹æ³•å¯ä»¥å»¶è¿Ÿ bean çš„è·å–</li></ul></li><li>å¦‚æœå¾…è£…é…çš„æˆå‘˜å˜é‡æˆ–æ–¹æ³•å‚æ•°ä¸Šç”¨ @Lazy æ ‡æ³¨ï¼Œä¼šåˆ›å»ºä»£ç†å¯¹è±¡è£…é…<ul><li>æ­¤æ–¹æ³•å¯ä»¥å»¶è¿ŸçœŸå® bean çš„è·å–</li><li>è¢«è£…é…çš„ä»£ç†ä¸ä½œä¸º bean</li></ul></li><li>å¦‚æœå¾…è£…é…ç±»å‹æ˜¯æ•°ç»„ï¼Œéœ€è¦è·å–æ•°ç»„å…ƒç´ ç±»å‹ï¼Œæ ¹æ®æ­¤ç±»å‹æ‰¾åˆ°å¤šä¸ª bean è¿›è¡Œè£…é…</li><li>å¦‚æœå¾…è£…é…ç±»å‹æ˜¯ Collection æˆ–å…¶å­æ¥å£ï¼Œéœ€è¦è·å– Collection æ³›å‹ï¼Œæ ¹æ®æ­¤ç±»å‹æ‰¾åˆ°å¤šä¸ª bean</li><li>å¦‚æœå¾…è£…é…ç±»å‹æ˜¯ ApplicationContext ç­‰ç‰¹æ®Šç±»å‹<ul><li>ä¼šåœ¨ BeanFactory çš„ resolvableDependencies æˆå‘˜æŒ‰ç±»å‹æŸ¥æ‰¾è£…é…</li><li>resolvableDependencies æ˜¯ map é›†åˆï¼Œkey æ˜¯ç‰¹æ®Šç±»å‹ï¼Œvalue æ˜¯å…¶å¯¹åº”å¯¹è±¡</li><li>ä¸èƒ½ç›´æ¥æ ¹æ® key è¿›è¡ŒæŸ¥æ‰¾ï¼Œè€Œæ˜¯ç”¨ isAssignableFrom é€ä¸€å°è¯•å³è¾¹ç±»å‹æ˜¯å¦å¯ä»¥è¢«èµ‹å€¼ç»™å·¦è¾¹çš„ key ç±»å‹</li></ul></li><li>å¦‚æœå¾…è£…é…ç±»å‹æœ‰æ³›å‹å‚æ•°<ul><li>éœ€è¦åˆ©ç”¨ ContextAnnotationAutowireCandidateResolver æŒ‰æ³›å‹å‚æ•°ç±»å‹ç­›é€‰</li></ul></li><li>å¦‚æœå¾…è£…é…ç±»å‹æœ‰ @Qualifier<ul><li>éœ€è¦åˆ©ç”¨ ContextAnnotationAutowireCandidateResolver æŒ‰æ³¨è§£æä¾›çš„ bean åç§°ç­›é€‰</li></ul></li><li>æœ‰ @Primary æ ‡æ³¨çš„ @Component æˆ– @Bean çš„å¤„ç†</li><li>ä¸æˆå‘˜å˜é‡åæˆ–æ–¹æ³•å‚æ•°ååŒå bean çš„å¤„ç†</li></ol><h3 id="48-äº‹ä»¶ç›‘å¬å™¨"><a href="#48-äº‹ä»¶ç›‘å¬å™¨" class="headerlink" title="48) äº‹ä»¶ç›‘å¬å™¨"></a>48) äº‹ä»¶ç›‘å¬å™¨</h3><h4 id="æ¼”ç¤º-äº‹ä»¶ç›‘å¬å™¨"><a href="#æ¼”ç¤º-äº‹ä»¶ç›‘å¬å™¨" class="headerlink" title="æ¼”ç¤º - äº‹ä»¶ç›‘å¬å™¨"></a>æ¼”ç¤º - äº‹ä»¶ç›‘å¬å™¨</h4><h5 id="ä»£ç å‚è€ƒ-45"><a href="#ä»£ç å‚è€ƒ-45" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a48</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-60"><a href="#æ”¶è·ğŸ’¡-60" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><p>äº‹ä»¶ç›‘å¬å™¨çš„ä¸¤ç§æ–¹å¼</p><ol><li>å®ç° ApplicationListener æ¥å£<ul><li>æ ¹æ®æ¥å£æ³›å‹ç¡®å®šäº‹ä»¶ç±»å‹</li></ul></li><li>@EventListener æ ‡æ³¨ç›‘å¬æ–¹æ³•<ul><li>æ ¹æ®ç›‘å¬å™¨æ–¹æ³•å‚æ•°ç¡®å®šäº‹ä»¶ç±»å‹</li><li>è§£ææ—¶æœºï¼šåœ¨ SmartInitializingSingletonï¼ˆæ‰€æœ‰å•ä¾‹åˆå§‹åŒ–å®Œæˆåï¼‰ï¼Œè§£ææ¯ä¸ªå•ä¾‹ bean</li></ul></li></ol><h3 id="49-äº‹ä»¶å‘å¸ƒå™¨"><a href="#49-äº‹ä»¶å‘å¸ƒå™¨" class="headerlink" title="49) äº‹ä»¶å‘å¸ƒå™¨"></a>49) äº‹ä»¶å‘å¸ƒå™¨</h3><h4 id="æ¼”ç¤º-äº‹ä»¶å‘å¸ƒå™¨"><a href="#æ¼”ç¤º-äº‹ä»¶å‘å¸ƒå™¨" class="headerlink" title="æ¼”ç¤º - äº‹ä»¶å‘å¸ƒå™¨"></a>æ¼”ç¤º - äº‹ä»¶å‘å¸ƒå™¨</h4><h5 id="ä»£ç å‚è€ƒ-46"><a href="#ä»£ç å‚è€ƒ-46" class="headerlink" title="ä»£ç å‚è€ƒ"></a>ä»£ç å‚è€ƒ</h5><p><strong>com.itheima.a49</strong> åŒ…</p><h4 id="æ”¶è·ğŸ’¡-61"><a href="#æ”¶è·ğŸ’¡-61" class="headerlink" title="æ”¶è·ğŸ’¡"></a>æ”¶è·ğŸ’¡</h4><p>äº‹ä»¶å‘å¸ƒå™¨æ¨¡æ‹Ÿå®ç°</p><ol><li>addApplicationListenerBean è´Ÿè´£æ”¶é›†å®¹å™¨ä¸­çš„ç›‘å¬å™¨<ul><li>ç›‘å¬å™¨ä¼šç»Ÿä¸€è½¬æ¢ä¸º GenericApplicationListener å¯¹è±¡ï¼Œä»¥æ”¯æŒåˆ¤æ–­äº‹ä»¶ç±»å‹</li></ul></li><li>multicastEvent éå†ç›‘å¬å™¨é›†åˆï¼Œå‘å¸ƒäº‹ä»¶<ul><li>å‘å¸ƒå‰å…ˆé€šè¿‡ GenericApplicationListener.supportsEventType åˆ¤æ–­æ”¯æŒè¯¥äº‹ä»¶ç±»å‹æ‰å‘äº‹ä»¶</li><li>å¯ä»¥åˆ©ç”¨çº¿ç¨‹æ± è¿›è¡Œå¼‚æ­¥å‘äº‹ä»¶ä¼˜åŒ–</li></ul></li><li>å¦‚æœå‘é€çš„äº‹ä»¶å¯¹è±¡ä¸æ˜¯ ApplicationEvent ç±»å‹ï¼ŒSpring ä¼šæŠŠå®ƒåŒ…è£…ä¸º PayloadApplicationEvent å¹¶ç”¨æ³›å‹æŠ€æœ¯è§£æäº‹ä»¶å¯¹è±¡çš„åŸå§‹ç±»å‹<ul><li>è§†é¢‘ä¸­æœªè®²è§£</li></ul></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;å®¹å™¨ä¸-bean&quot;&gt;&lt;a href=&quot;#å®¹å™¨ä¸-bean&quot; class=&quot;headerlink&quot; title=&quot;å®¹å™¨ä¸ bean&quot;&gt;&lt;/a&gt;å®¹å™¨ä¸ bean&lt;/h2&gt;&lt;h3 id=&quot;1-å®¹å™¨æ¥å£&quot;&gt;&lt;a href=&quot;#1-å®¹å™¨æ¥å£&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="spring" scheme="http://example.com/categories/spring/"/>
    
    
    <category term="springæºç é˜…è¯»" scheme="http://example.com/tags/spring%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>javaè®¾è®¡æ¨¡å¼--è‡ªå®šä¹‰Springæ¡†æ¶</title>
    <link href="http://example.com/2024/09/02/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6/"/>
    <id>http://example.com/2024/09/02/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6/</id>
    <published>2024-09-02T15:32:56.000Z</published>
    <updated>2024-09-02T15:55:48.680Z</updated>
    
    <content type="html"><![CDATA[<h1 id="7ï¼Œè‡ªå®šä¹‰Springæ¡†æ¶"><a href="#7ï¼Œè‡ªå®šä¹‰Springæ¡†æ¶" class="headerlink" title="7ï¼Œè‡ªå®šä¹‰Springæ¡†æ¶"></a>7ï¼Œè‡ªå®šä¹‰Springæ¡†æ¶</h1><h2 id="7-1-springä½¿ç”¨å›é¡¾"><a href="#7-1-springä½¿ç”¨å›é¡¾" class="headerlink" title="7.1 springä½¿ç”¨å›é¡¾"></a>7.1 springä½¿ç”¨å›é¡¾</h2><p>è‡ªå®šä¹‰springæ¡†æ¶å‰ï¼Œå…ˆå›é¡¾ä¸€ä¸‹springæ¡†æ¶çš„ä½¿ç”¨ï¼Œä»è€Œåˆ†æspringçš„æ ¸å¿ƒï¼Œå¹¶å¯¹æ ¸å¿ƒåŠŸèƒ½è¿›è¡Œæ¨¡æ‹Ÿã€‚</p><ul><li><p>æ•°æ®è®¿é—®å±‚ã€‚å®šä¹‰UserDaoæ¥å£åŠå…¶å­å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;userDaoImpl ....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä¸šåŠ¡é€»è¾‘å±‚ã€‚å®šä¹‰UserServiceæ¥å£åŠå…¶å­å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">(UserDao userDao)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;userServiceImpl ...&quot;</span>);</span><br><span class="line">        userDao.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å®šä¹‰UserControllerç±»ï¼Œä½¿ç”¨mainæ–¹æ³•æ¨¡æ‹Ÿcontrollerå±‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºspringå®¹å™¨å¯¹è±¡</span></span><br><span class="line">        ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        <span class="comment">//ä»IOCå®¹å™¨ä¸­è·å–UserServiceå¯¹è±¡</span></span><br><span class="line">        UserService userService = applicationContext.getBean(<span class="string">&quot;userService&quot;</span>, UserService.class);</span><br><span class="line">        <span class="comment">//è°ƒç”¨UserServiceå¯¹è±¡çš„addæ–¹æ³•</span></span><br><span class="line">        userService.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç¼–å†™é…ç½®æ–‡ä»¶ã€‚åœ¨ç±»è·¯å¾„ä¸‹ç¼–å†™ä¸€ä¸ªåä¸ºApplicationContext.xmlçš„é…ç½®æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;beans xmlns:xsi=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="line">       xmlns=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="line">       xmlns:context=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span><br><span class="line">       xsi:schemaLocation=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/context</span></span><br><span class="line"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;bean id=<span class="string">&quot;userService&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.itheima.service.impl.UserServiceImpl&quot;</span>&gt;</span><br><span class="line">        &lt;property name=<span class="string">&quot;userDao&quot;</span> ref=<span class="string">&quot;userDao&quot;</span>&gt;&lt;/property&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">    &lt;bean id=<span class="string">&quot;userDao&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;com.itheima.dao.impl.UserDaoImpl&quot;</span>&gt;&lt;/bean&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure><p>ä»£ç è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200429165544151.png" style="zoom:60%;" /></li></ul><p>é€šè¿‡ä¸Šé¢ä»£ç åŠç»“æœå¯ä»¥çœ‹å‡ºï¼š</p><ul><li>userServiceå¯¹è±¡æ˜¯ä»applicationContextå®¹å™¨å¯¹è±¡è·å–åˆ°çš„ï¼Œä¹Ÿå°±æ˜¯userServiceå¯¹è±¡äº¤ç”±springè¿›è¡Œç®¡ç†ã€‚</li><li>ä¸Šé¢ç»“æœå¯ä»¥çœ‹åˆ°è°ƒç”¨äº†UserDaoå¯¹è±¡ä¸­çš„addæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´UserDaoå­å®ç°ç±»å¯¹è±¡ä¹Ÿäº¤ç”±springç®¡ç†äº†ã€‚</li><li>UserServiceä¸­çš„userDaoå˜é‡æˆ‘ä»¬å¹¶æ²¡æœ‰è¿›è¡Œèµ‹å€¼ï¼Œä½†æ˜¯å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œè¯´æ˜springå·²ç»å°†UserDaoå¯¹è±¡èµ‹å€¼ç»™äº†userDaoå˜é‡ã€‚</li></ul><p>ä¸Šé¢ä¸‰ç‚¹ä½“ç°äº†Springæ¡†æ¶çš„IOCï¼ˆInversion of Controlï¼‰å’ŒDIï¼ˆDependency Injection, DIï¼‰</p><h2 id="7-2-springæ ¸å¿ƒåŠŸèƒ½ç»“æ„"><a href="#7-2-springæ ¸å¿ƒåŠŸèƒ½ç»“æ„" class="headerlink" title="7.2 springæ ¸å¿ƒåŠŸèƒ½ç»“æ„"></a>7.2 springæ ¸å¿ƒåŠŸèƒ½ç»“æ„</h2><p>Springå¤§çº¦æœ‰20ä¸ªæ¨¡å—ï¼Œç”±1300å¤šä¸ªä¸åŒçš„æ–‡ä»¶æ„æˆã€‚è¿™äº›æ¨¡å—å¯ä»¥åˆ†ä¸º:</p><p>æ ¸å¿ƒå®¹å™¨ã€AOPå’Œè®¾å¤‡æ”¯æŒã€æ•°æ®è®¿é—®ä¸é›†æˆã€Webç»„ä»¶ã€é€šä¿¡æŠ¥æ–‡å’Œé›†æˆæµ‹è¯•ç­‰ï¼Œä¸‹é¢æ˜¯ Spring æ¡†æ¶çš„æ€»ä½“æ¶æ„å›¾ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200429111324770.png" style="zoom:40%;" /><p>æ ¸å¿ƒå®¹å™¨ç”± beansã€coreã€context å’Œ expressionï¼ˆSpring Expression Languageï¼ŒSpELï¼‰4ä¸ªæ¨¡å—ç»„æˆã€‚</p><ul><li>spring-beanså’Œspring-coreæ¨¡å—æ˜¯Springæ¡†æ¶çš„æ ¸å¿ƒæ¨¡å—ï¼ŒåŒ…å«äº†æ§åˆ¶åè½¬ï¼ˆInversion of Controlï¼ŒIOCï¼‰å’Œä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼ŒDIï¼‰ã€‚BeanFactoryä½¿ç”¨æ§åˆ¶åè½¬å¯¹åº”ç”¨ç¨‹åºçš„é…ç½®å’Œä¾èµ–æ€§è§„èŒƒä¸å®é™…çš„åº”ç”¨ç¨‹åºä»£ç è¿›è¡Œäº†åˆ†ç¦»ã€‚BeanFactoryå±äºå»¶æ—¶åŠ è½½ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å®ä¾‹åŒ–å®¹å™¨å¯¹è±¡åå¹¶ä¸ä¼šè‡ªåŠ¨å®ä¾‹åŒ–Beanï¼Œåªæœ‰å½“Beanè¢«ä½¿ç”¨æ—¶ï¼ŒBeanFactoryæ‰ä¼šå¯¹è¯¥ Bean è¿›è¡Œå®ä¾‹åŒ–ä¸ä¾èµ–å…³ç³»çš„è£…é…ã€‚</li><li>spring-contextæ¨¡å—æ„æ¶äºæ ¸å¿ƒæ¨¡å—ä¹‹ä¸Šï¼Œæ‰©å±•äº†BeanFactoryï¼Œä¸ºå®ƒæ·»åŠ äº†Beanç”Ÿå‘½å‘¨æœŸæ§åˆ¶ã€æ¡†æ¶äº‹ä»¶ä½“ç³»åŠèµ„æºåŠ è½½é€æ˜åŒ–ç­‰åŠŸèƒ½ã€‚æ­¤å¤–ï¼Œè¯¥æ¨¡å—è¿˜æä¾›äº†è®¸å¤šä¼ä¸šçº§æ”¯æŒï¼Œå¦‚é‚®ä»¶è®¿é—®ã€è¿œç¨‹è®¿é—®ã€ä»»åŠ¡è°ƒåº¦ç­‰ï¼ŒApplicationContext æ˜¯è¯¥æ¨¡å—çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒçš„è¶…ç±»æ˜¯ BeanFactoryã€‚ä¸BeanFactoryä¸åŒï¼ŒApplicationContextå®ä¾‹åŒ–åä¼šè‡ªåŠ¨å¯¹æ‰€æœ‰çš„å•å®ä¾‹Beanè¿›è¡Œå®ä¾‹åŒ–ä¸ä¾èµ–å…³ç³»çš„è£…é…ï¼Œä½¿ä¹‹å¤„äºå¾…ç”¨çŠ¶æ€ã€‚</li><li>spring-context-supportæ¨¡å—æ˜¯å¯¹Spring IoCå®¹å™¨åŠIoCå­å®¹å™¨çš„æ‰©å±•æ”¯æŒã€‚</li><li>spring-context-indexeræ¨¡å—æ˜¯Springçš„ç±»ç®¡ç†ç»„ä»¶å’ŒClasspathæ‰«æç»„ä»¶ã€‚</li><li>spring-expression æ¨¡å—æ˜¯ç»Ÿä¸€è¡¨è¾¾å¼è¯­è¨€ï¼ˆELï¼‰çš„æ‰©å±•æ¨¡å—ï¼Œå¯ä»¥æŸ¥è¯¢ã€ç®¡ç†è¿è¡Œä¸­çš„å¯¹è±¡ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æ–¹ä¾¿åœ°è°ƒç”¨å¯¹è±¡æ–¹æ³•ï¼Œä»¥åŠæ“ä½œæ•°ç»„ã€é›†åˆç­‰ã€‚å®ƒçš„è¯­æ³•ç±»ä¼¼äºä¼ ç»ŸELï¼Œä½†æä¾›äº†é¢å¤–çš„åŠŸèƒ½ï¼Œæœ€å‡ºè‰²çš„è¦æ•°å‡½æ•°è°ƒç”¨å’Œç®€å•å­—ç¬¦ä¸²çš„æ¨¡æ¿å‡½æ•°ã€‚ELçš„ç‰¹æ€§æ˜¯åŸºäºSpringäº§å“çš„éœ€æ±‚è€Œè®¾è®¡çš„ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿åœ°åŒSpring IoCè¿›è¡Œäº¤äº’ã€‚</li></ul><h3 id="7-1-1-beanæ¦‚è¿°"><a href="#7-1-1-beanæ¦‚è¿°" class="headerlink" title="7.1.1 beanæ¦‚è¿°"></a>7.1.1 beanæ¦‚è¿°</h3><p>Spring å°±æ˜¯é¢å‘ <code>Bean</code> çš„ç¼–ç¨‹ï¼ˆBOP,Bean Oriented Programmingï¼‰ï¼ŒBean åœ¨ Spring ä¸­å¤„äºæ ¸å¿ƒåœ°ä½ã€‚Beanå¯¹äºSpringçš„æ„ä¹‰å°±åƒObjectå¯¹äºOOPçš„æ„ä¹‰ä¸€æ ·ï¼ŒSpringä¸­æ²¡æœ‰Beanä¹Ÿå°±æ²¡æœ‰Springå­˜åœ¨çš„æ„ä¹‰ã€‚Spring IoCå®¹å™¨é€šè¿‡é…ç½®æ–‡ä»¶æˆ–è€…æ³¨è§£çš„æ–¹å¼æ¥ç®¡ç†beanå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p><p>springä¸­beanç”¨äºå¯¹ä¸€ä¸ªç±»è¿›è¡Œå°è£…ã€‚å¦‚ä¸‹é¢çš„é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.service.impl.UserServiceImpl&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.UserDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆBeanå¦‚æ­¤é‡è¦å‘¢ï¼Ÿ</p><ul><li>spring å°†beanå¯¹è±¡äº¤ç”±ä¸€ä¸ªå«IOCå®¹å™¨è¿›è¡Œç®¡ç†ã€‚</li><li>beanå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»åœ¨é…ç½®æ–‡ä»¶ä¸­ä½“ç°ï¼Œå¹¶ç”±springå®Œæˆã€‚</li></ul><h2 id="7-3-Spring-IOCç›¸å…³æ¥å£åˆ†æ"><a href="#7-3-Spring-IOCç›¸å…³æ¥å£åˆ†æ" class="headerlink" title="7.3 Spring IOCç›¸å…³æ¥å£åˆ†æ"></a>7.3 Spring IOCç›¸å…³æ¥å£åˆ†æ</h2><h3 id="7-3-1-BeanFactoryè§£æ"><a href="#7-3-1-BeanFactoryè§£æ" class="headerlink" title="7.3.1 BeanFactoryè§£æ"></a>7.3.1 BeanFactoryè§£æ</h3><p>Springä¸­Beançš„åˆ›å»ºæ˜¯å…¸å‹çš„å·¥å‚æ¨¡å¼ï¼Œè¿™ä¸€ç³»åˆ—çš„Beanå·¥å‚ï¼Œå³IoCå®¹å™¨ï¼Œä¸ºå¼€å‘è€…ç®¡ç†å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»æä¾›äº†å¾ˆå¤šä¾¿åˆ©å’ŒåŸºç¡€æœåŠ¡ï¼Œåœ¨Springä¸­æœ‰è®¸å¤šIoCå®¹å™¨çš„å®ç°ä¾›ç”¨æˆ·é€‰æ‹©ï¼Œå…¶ç›¸äº’å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200429185050396.png" style="zoom:60%;" /><p>å…¶ä¸­ï¼ŒBeanFactoryä½œä¸ºæœ€é¡¶å±‚çš„ä¸€ä¸ªæ¥å£ï¼Œå®šä¹‰äº†IoCå®¹å™¨çš„åŸºæœ¬åŠŸèƒ½è§„èŒƒï¼ŒBeanFactoryæœ‰ä¸‰ä¸ªé‡è¦çš„å­æ¥å£ï¼šListableBeanFactoryã€HierarchicalBeanFactoryå’ŒAutowireCapableBeanFactoryã€‚ä½†æ˜¯ä»ç±»å›¾ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°æœ€ç»ˆçš„é»˜è®¤å®ç°ç±»æ˜¯DefaultListableBeanFactoryï¼Œå®ƒå®ç°äº†æ‰€æœ‰çš„æ¥å£ã€‚</p><p>é‚£ä¹ˆä¸ºä½•è¦å®šä¹‰è¿™ä¹ˆå¤šå±‚æ¬¡çš„æ¥å£å‘¢ï¼Ÿ</p><p>æ¯ä¸ªæ¥å£éƒ½æœ‰å®ƒçš„ä½¿ç”¨åœºåˆï¼Œä¸»è¦æ˜¯ä¸ºäº†åŒºåˆ†åœ¨Springå†…éƒ¨æ“ä½œè¿‡ç¨‹ä¸­å¯¹è±¡çš„ä¼ é€’å’Œè½¬åŒ–ï¼Œå¯¹å¯¹è±¡çš„æ•°æ®è®¿é—®æ‰€åšçš„é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œ</p><ul><li>ListableBeanFactoryæ¥å£è¡¨ç¤ºè¿™äº›Beanå¯åˆ—è¡¨åŒ–ã€‚</li><li>HierarchicalBeanFactoryè¡¨ç¤ºè¿™äº›Bean æ˜¯æœ‰ç»§æ‰¿å…³ç³»çš„ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ª Bean å¯èƒ½æœ‰çˆ¶ Bean</li><li>AutowireCapableBeanFactory æ¥å£å®šä¹‰Beançš„è‡ªåŠ¨è£…é…è§„åˆ™ã€‚</li></ul><p>è¿™ä¸‰ä¸ªæ¥å£å…±åŒå®šä¹‰äº†Beançš„é›†åˆã€Beanä¹‹é—´çš„å…³ç³»åŠBeanè¡Œä¸ºã€‚æœ€åŸºæœ¬çš„IoCå®¹å™¨æ¥å£æ˜¯BeanFactoryï¼Œæ¥çœ‹ä¸€ä¸‹å®ƒçš„æºç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">String FACTORY_BEAN_PREFIX = <span class="string">&quot;&amp;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ ¹æ®beançš„åç§°è·å–IOCå®¹å™¨ä¸­çš„çš„beanå¯¹è±¡</span></span><br><span class="line"><span class="function">Object <span class="title">getBean</span><span class="params">(String name)</span> <span class="keyword">throws</span> BeansException</span>;</span><br><span class="line"><span class="comment">//æ ¹æ®beançš„åç§°è·å–IOCå®¹å™¨ä¸­çš„çš„beanå¯¹è±¡ï¼Œå¹¶æŒ‡å®šè·å–åˆ°çš„beanå¯¹è±¡çš„ç±»å‹ï¼Œè¿™æ ·æˆ‘ä»¬ä½¿ç”¨æ—¶å°±ä¸éœ€è¦è¿›è¡Œç±»å‹å¼ºè½¬äº†</span></span><br><span class="line">&lt;T&gt; <span class="function">T <span class="title">getBean</span><span class="params">(String name, Class&lt;T&gt; requiredType)</span> <span class="keyword">throws</span> BeansException</span>;</span><br><span class="line"><span class="function">Object <span class="title">getBean</span><span class="params">(String name, Object... args)</span> <span class="keyword">throws</span> BeansException</span>;</span><br><span class="line">&lt;T&gt; <span class="function">T <span class="title">getBean</span><span class="params">(Class&lt;T&gt; requiredType)</span> <span class="keyword">throws</span> BeansException</span>;</span><br><span class="line">&lt;T&gt; <span class="function">T <span class="title">getBean</span><span class="params">(Class&lt;T&gt; requiredType, Object... args)</span> <span class="keyword">throws</span> BeansException</span>;</span><br><span class="line"></span><br><span class="line">&lt;T&gt; <span class="function">ObjectProvider&lt;T&gt; <span class="title">getBeanProvider</span><span class="params">(Class&lt;T&gt; requiredType)</span></span>;</span><br><span class="line">&lt;T&gt; <span class="function">ObjectProvider&lt;T&gt; <span class="title">getBeanProvider</span><span class="params">(ResolvableType requiredType)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ¤æ–­å®¹å™¨ä¸­æ˜¯å¦åŒ…å«æŒ‡å®šåç§°çš„beanå¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">containsBean</span><span class="params">(String name)</span></span>;</span><br><span class="line"><span class="comment">//æ ¹æ®beançš„åç§°åˆ¤æ–­æ˜¯å¦æ˜¯å•ä¾‹</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">isSingleton</span><span class="params">(String name)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">isPrototype</span><span class="params">(String name)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">isTypeMatch</span><span class="params">(String name, ResolvableType typeToMatch)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">isTypeMatch</span><span class="params">(String name, Class&lt;?&gt; typeToMatch)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class="line"><span class="meta">@Nullable</span></span><br><span class="line">Class&lt;?&gt; getType(String name) <span class="keyword">throws</span> NoSuchBeanDefinitionException;</span><br><span class="line">String[] getAliases(String name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨BeanFactoryé‡Œåªå¯¹IoCå®¹å™¨çš„åŸºæœ¬è¡Œä¸ºåšäº†å®šä¹‰ï¼Œæ ¹æœ¬ä¸å…³å¿ƒä½ çš„Beanæ˜¯å¦‚ä½•å®šä¹‰åŠæ€æ ·åŠ è½½çš„ã€‚æ­£å¦‚æˆ‘ä»¬åªå…³å¿ƒèƒ½ä»å·¥å‚é‡Œå¾—åˆ°ä»€ä¹ˆäº§å“ï¼Œä¸å…³å¿ƒå·¥å‚æ˜¯æ€ä¹ˆç”Ÿäº§è¿™äº›äº§å“çš„ã€‚</p><p>BeanFactoryæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„å­æ¥å£ï¼Œå°±æ˜¯ApplicationContextæ¥å£ï¼Œè¯¥æ¥å£ä¸»è¦æ¥è§„èŒƒå®¹å™¨ä¸­çš„beanå¯¹è±¡æ˜¯éå»¶æ—¶åŠ è½½ï¼Œå³åœ¨åˆ›å»ºå®¹å™¨å¯¹è±¡çš„æ—¶å€™å°±å¯¹è±¡beanè¿›è¡Œåˆå§‹åŒ–ï¼Œå¹¶å­˜å‚¨åˆ°ä¸€ä¸ªå®¹å™¨ä¸­ã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200430220155371.png" style="zoom:60%;" /><p>è¦çŸ¥é“å·¥å‚æ˜¯å¦‚ä½•äº§ç”Ÿå¯¹è±¡çš„ï¼Œæˆ‘ä»¬éœ€è¦çœ‹å…·ä½“çš„IoCå®¹å™¨å®ç°ï¼ŒSpringæä¾›äº†è®¸å¤šIoCå®¹å™¨å®ç°ï¼Œæ¯”å¦‚ï¼š</p><ul><li>ClasspathXmlApplicationContext : æ ¹æ®ç±»è·¯å¾„åŠ è½½xmlé…ç½®æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºIOCå®¹å™¨å¯¹è±¡ã€‚</li><li>FileSystemXmlApplicationContext ï¼šæ ¹æ®ç³»ç»Ÿè·¯å¾„åŠ è½½xmlé…ç½®æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºIOCå®¹å™¨å¯¹è±¡ã€‚</li><li>AnnotationConfigApplicationContext ï¼šåŠ è½½æ³¨è§£ç±»é…ç½®ï¼Œå¹¶åˆ›å»ºIOCå®¹å™¨ã€‚</li></ul><h3 id="7-3-2-BeanDefinitionè§£æ"><a href="#7-3-2-BeanDefinitionè§£æ" class="headerlink" title="7.3.2 BeanDefinitionè§£æ"></a>7.3.2 BeanDefinitionè§£æ</h3><p>Spring IoCå®¹å™¨ç®¡ç†æˆ‘ä»¬å®šä¹‰çš„å„ç§Beanå¯¹è±¡åŠå…¶ç›¸äº’å…³ç³»ï¼Œè€ŒBeanå¯¹è±¡åœ¨Springå®ç°ä¸­æ˜¯ä»¥BeanDefinitionæ¥æè¿°çš„ï¼Œå¦‚ä¸‹é¢é…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.UserDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">beanæ ‡ç­¾è¿˜æœ‰å¾ˆå¤šå±æ€§ï¼š</span><br><span class="line">scopeã€init-methodã€destory-methodç­‰ã€‚</span><br></pre></td></tr></table></figure><p>å…¶ç»§æ‰¿ä½“ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200429204239868.png" style="zoom:60%;" /><h3 id="7-3-3-BeanDefinitionReaderè§£æ"><a href="#7-3-3-BeanDefinitionReaderè§£æ" class="headerlink" title="7.3.3 BeanDefinitionReaderè§£æ"></a>7.3.3 BeanDefinitionReaderè§£æ</h3><p>Beançš„è§£æè¿‡ç¨‹éå¸¸å¤æ‚ï¼ŒåŠŸèƒ½è¢«åˆ†å¾—å¾ˆç»†ï¼Œå› ä¸ºè¿™é‡Œéœ€è¦è¢«æ‰©å±•çš„åœ°æ–¹å¾ˆå¤šï¼Œå¿…é¡»ä¿è¯è¶³å¤Ÿçš„çµæ´»æ€§ï¼Œä»¥åº”å¯¹å¯èƒ½çš„å˜åŒ–ã€‚Beançš„è§£æä¸»è¦å°±æ˜¯å¯¹Springé…ç½®æ–‡ä»¶çš„è§£æã€‚è¿™ä¸ªè§£æè¿‡ç¨‹ä¸»è¦é€šè¿‡BeanDefinitionReaderæ¥å®Œæˆï¼Œçœ‹çœ‹Springä¸­BeanDefinitionReaderçš„ç±»ç»“æ„å›¾ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200429204700956.png" style="zoom:60%;" /><p>çœ‹çœ‹BeanDefinitionReaderæ¥å£å®šä¹‰çš„åŠŸèƒ½æ¥ç†è§£å®ƒå…·ä½“çš„ä½œç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanDefinitionReader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–BeanDefinitionRegistryæ³¨å†Œå™¨å¯¹è±¡</span></span><br><span class="line"><span class="function">BeanDefinitionRegistry <span class="title">getRegistry</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Nullable</span></span><br><span class="line"><span class="function">ResourceLoader <span class="title">getResourceLoader</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Nullable</span></span><br><span class="line"><span class="function">ClassLoader <span class="title">getBeanClassLoader</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">BeanNameGenerator <span class="title">getBeanNameGenerator</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ä¸‹é¢çš„loadBeanDefinitionséƒ½æ˜¯åŠ è½½beanå®šä¹‰ï¼Œä»æŒ‡å®šçš„èµ„æºä¸­</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">loadBeanDefinitions</span><span class="params">(Resource resource)</span> <span class="keyword">throws</span> BeanDefinitionStoreException</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">loadBeanDefinitions</span><span class="params">(Resource... resources)</span> <span class="keyword">throws</span> BeanDefinitionStoreException</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">loadBeanDefinitions</span><span class="params">(String location)</span> <span class="keyword">throws</span> BeanDefinitionStoreException</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">loadBeanDefinitions</span><span class="params">(String... locations)</span> <span class="keyword">throws</span> BeanDefinitionStoreException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-3-4-BeanDefinitionRegistryè§£æ"><a href="#7-3-4-BeanDefinitionRegistryè§£æ" class="headerlink" title="7.3.4 BeanDefinitionRegistryè§£æ"></a>7.3.4 BeanDefinitionRegistryè§£æ</h3><p>BeanDefinitionReaderç”¨æ¥è§£æbeanå®šä¹‰ï¼Œå¹¶å°è£…BeanDefinitionå¯¹è±¡ï¼Œè€Œæˆ‘ä»¬å®šä¹‰çš„é…ç½®æ–‡ä»¶ä¸­å®šä¹‰äº†å¾ˆå¤šbeanæ ‡ç­¾ï¼Œæ‰€ä»¥å°±æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œè§£æçš„BeanDefinitionå¯¹è±¡å­˜å‚¨åˆ°å“ªå„¿ï¼Ÿç­”æ¡ˆå°±æ˜¯BeanDefinitionçš„æ³¨å†Œä¸­å¿ƒï¼Œè€Œè¯¥æ³¨å†Œä¸­å¿ƒé¡¶å±‚æ¥å£å°±æ˜¯BeanDefinitionRegistryã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanDefinitionRegistry</span> <span class="keyword">extends</span> <span class="title">AliasRegistry</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¾€æ³¨å†Œè¡¨ä¸­æ³¨å†Œbean</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">registerBeanDefinition</span><span class="params">(String beanName, BeanDefinition beanDefinition)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> BeanDefinitionStoreException</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤æŒ‡å®šåç§°çš„bean</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">removeBeanDefinition</span><span class="params">(String beanName)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–æ³¨å†Œè¡¨ä¸­æŒ‡å®šåç§°çš„bean</span></span><br><span class="line"><span class="function">BeanDefinition <span class="title">getBeanDefinition</span><span class="params">(String beanName)</span> <span class="keyword">throws</span> NoSuchBeanDefinitionException</span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//åˆ¤æ–­æ³¨å†Œè¡¨ä¸­æ˜¯å¦å·²ç»æ³¨å†Œäº†æŒ‡å®šåç§°çš„bean</span></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">containsBeanDefinition</span><span class="params">(String beanName)</span></span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//è·å–æ³¨å†Œè¡¨ä¸­æ‰€æœ‰çš„beançš„åç§°</span></span><br><span class="line">String[] getBeanDefinitionNames();</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getBeanDefinitionCount</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">isBeanNameInUse</span><span class="params">(String beanName)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»§æ‰¿ç»“æ„å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200429211132185.png" style="zoom:60%;" /><p>ä»ä¸Šé¢ç±»å›¾å¯ä»¥çœ‹åˆ°BeanDefinitionRegistryæ¥å£çš„å­å®ç°ç±»ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š</p><ul><li><p>DefaultListableBeanFactory</p><p>åœ¨è¯¥ç±»ä¸­å®šä¹‰äº†å¦‚ä¸‹ä»£ç ï¼Œå°±æ˜¯ç”¨æ¥æ³¨å†Œbean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, BeanDefinition&gt; beanDefinitionMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;(<span class="number">256</span>);</span><br></pre></td></tr></table></figure></li><li><p>SimpleBeanDefinitionRegistry</p><p>åœ¨è¯¥ç±»ä¸­å®šä¹‰äº†å¦‚ä¸‹ä»£ç ï¼Œå°±æ˜¯ç”¨æ¥æ³¨å†Œbean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, BeanDefinition&gt; beanDefinitionMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;(<span class="number">64</span>);</span><br></pre></td></tr></table></figure></li></ul><h3 id="7-3-5-åˆ›å»ºå®¹å™¨"><a href="#7-3-5-åˆ›å»ºå®¹å™¨" class="headerlink" title="7.3.5 åˆ›å»ºå®¹å™¨"></a>7.3.5 åˆ›å»ºå®¹å™¨</h3><p>ClassPathXmlApplicationContextå¯¹Beané…ç½®èµ„æºçš„è½½å…¥æ˜¯ä»refreshï¼ˆï¼‰æ–¹æ³•å¼€å§‹çš„ã€‚refreshï¼ˆï¼‰æ–¹æ³•æ˜¯ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ï¼Œè§„å®šäº† IoC å®¹å™¨çš„å¯åŠ¨æµç¨‹ï¼Œæœ‰äº›é€»è¾‘è¦äº¤ç»™å…¶å­ç±»å®ç°ã€‚å®ƒå¯¹ Bean é…ç½®èµ„æºè¿›è¡Œè½½å…¥ï¼ŒClassPathXmlApplicationContexté€šè¿‡è°ƒç”¨å…¶çˆ¶ç±»AbstractApplicationContextçš„refreshï¼ˆï¼‰æ–¹æ³•å¯åŠ¨æ•´ä¸ªIoCå®¹å™¨å¯¹Beanå®šä¹‰çš„è½½å…¥è¿‡ç¨‹ã€‚</p><h2 id="7-4-è‡ªå®šä¹‰SpringIOC"><a href="#7-4-è‡ªå®šä¹‰SpringIOC" class="headerlink" title="7.4 è‡ªå®šä¹‰SpringIOC"></a>7.4 è‡ªå®šä¹‰SpringIOC</h2><p>ç°è¦å¯¹ä¸‹é¢çš„é…ç½®æ–‡ä»¶è¿›è¡Œè§£æï¼Œå¹¶è‡ªå®šä¹‰Springæ¡†æ¶çš„IOCå¯¹æ¶‰åŠåˆ°çš„å¯¹è±¡è¿›è¡Œç®¡ç†ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.service.impl.UserServiceImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.itheima.dao.impl.UserDaoImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="7-4-1-å®šä¹‰beanç›¸å…³çš„pojoç±»"><a href="#7-4-1-å®šä¹‰beanç›¸å…³çš„pojoç±»" class="headerlink" title="7.4.1 å®šä¹‰beanç›¸å…³çš„pojoç±»"></a>7.4.1 å®šä¹‰beanç›¸å…³çš„pojoç±»</h3><h4 id="7-4-1-1-PropertyValueç±»"><a href="#7-4-1-1-PropertyValueç±»" class="headerlink" title="7.4.1.1 PropertyValueç±»"></a>7.4.1.1 PropertyValueç±»</h4><p>ç”¨äºå°è£…beançš„å±æ€§ï¼Œä½“ç°åˆ°ä¸Šé¢çš„é…ç½®æ–‡ä»¶å°±æ˜¯å°è£…beanæ ‡ç­¾çš„å­æ ‡ç­¾propertyæ ‡ç­¾æ•°æ®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PropertyValue</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> String ref;</span><br><span class="line">  <span class="keyword">private</span> String value;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">PropertyValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">PropertyValue</span><span class="params">(String name, String ref,String value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.ref = ref;</span><br><span class="line">    <span class="keyword">this</span>.value = value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getRef</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ref;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRef</span><span class="params">(String ref)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.ref = ref;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setValue</span><span class="params">(String value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.value = value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-4-1-2-MutablePropertyValuesç±»"><a href="#7-4-1-2-MutablePropertyValuesç±»" class="headerlink" title="7.4.1.2 MutablePropertyValuesç±»"></a>7.4.1.2 MutablePropertyValuesç±»</h4><p>ä¸€ä¸ªbeanæ ‡ç­¾å¯ä»¥æœ‰å¤šä¸ªpropertyå­æ ‡ç­¾ï¼Œæ‰€ä»¥å†å®šä¹‰ä¸€ä¸ªMutablePropertyValuesç±»ï¼Œç”¨æ¥å­˜å‚¨å¹¶ç®¡ç†å¤šä¸ªPropertyValueå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MutablePropertyValues</span> <span class="keyword">implements</span> <span class="title">Iterable</span>&lt;<span class="title">PropertyValue</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> List&lt;PropertyValue&gt; propertyValueList;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MutablePropertyValues</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.propertyValueList = <span class="keyword">new</span> ArrayList&lt;PropertyValue&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MutablePropertyValues</span><span class="params">(List&lt;PropertyValue&gt; propertyValueList)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.propertyValueList = (propertyValueList != <span class="keyword">null</span> ? propertyValueList : <span class="keyword">new</span> ArrayList&lt;PropertyValue&gt;());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> PropertyValue[] getPropertyValues() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.propertyValueList.toArray(<span class="keyword">new</span> PropertyValue[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PropertyValue <span class="title">getPropertyValue</span><span class="params">(String propertyName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (PropertyValue pv : <span class="keyword">this</span>.propertyValueList) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pv.getName().equals(propertyName)) &#123;</span><br><span class="line">                <span class="keyword">return</span> pv;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;PropertyValue&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> propertyValueList.iterator();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.propertyValueList.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MutablePropertyValues <span class="title">addPropertyValue</span><span class="params">(PropertyValue pv)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.propertyValueList.size(); i++) &#123;</span><br><span class="line">            PropertyValue currentPv = <span class="keyword">this</span>.propertyValueList.get(i);</span><br><span class="line">            <span class="keyword">if</span> (currentPv.getName().equals(pv.getName())) &#123;</span><br><span class="line">                <span class="keyword">this</span>.propertyValueList.set(i, <span class="keyword">new</span> PropertyValue(pv.getName(),pv.getRef(), pv.getValue()));</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.propertyValueList.add(pv);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">contains</span><span class="params">(String propertyName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getPropertyValue(propertyName) != <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-4-1-3-BeanDefinitionç±»"><a href="#7-4-1-3-BeanDefinitionç±»" class="headerlink" title="7.4.1.3 BeanDefinitionç±»"></a>7.4.1.3 BeanDefinitionç±»</h4><p>BeanDefinitionç±»ç”¨æ¥å°è£…beanä¿¡æ¯çš„ï¼Œä¸»è¦åŒ…å«idï¼ˆå³beanå¯¹è±¡çš„åç§°ï¼‰ã€classï¼ˆéœ€è¦äº¤ç”±springç®¡ç†çš„ç±»çš„å…¨ç±»åï¼‰åŠå­æ ‡ç­¾propertyæ•°æ®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanDefinition</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String className;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> MutablePropertyValues propertyValues;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BeanDefinition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        propertyValues = <span class="keyword">new</span> MutablePropertyValues();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getClassName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> className;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setClassName</span><span class="params">(String className)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.className = className;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPropertyValues</span><span class="params">(MutablePropertyValues propertyValues)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.propertyValues = propertyValues;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MutablePropertyValues <span class="title">getPropertyValues</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> propertyValues;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-4-2-å®šä¹‰æ³¨å†Œè¡¨ç›¸å…³ç±»"><a href="#7-4-2-å®šä¹‰æ³¨å†Œè¡¨ç›¸å…³ç±»" class="headerlink" title="7.4.2 å®šä¹‰æ³¨å†Œè¡¨ç›¸å…³ç±»"></a>7.4.2 å®šä¹‰æ³¨å†Œè¡¨ç›¸å…³ç±»</h3><h4 id="7-4-2-1-BeanDefinitionRegistryæ¥å£"><a href="#7-4-2-1-BeanDefinitionRegistryæ¥å£" class="headerlink" title="7.4.2.1 BeanDefinitionRegistryæ¥å£"></a>7.4.2.1 BeanDefinitionRegistryæ¥å£</h4><p>BeanDefinitionRegistryæ¥å£å®šä¹‰äº†æ³¨å†Œè¡¨çš„ç›¸å…³æ“ä½œï¼Œå®šä¹‰å¦‚ä¸‹åŠŸèƒ½ï¼š</p><ul><li>æ³¨å†ŒBeanDefinitionå¯¹è±¡åˆ°æ³¨å†Œè¡¨ä¸­</li><li>ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤æŒ‡å®šåç§°çš„BeanDefinitionå¯¹è±¡</li><li>æ ¹æ®åç§°ä»æ³¨å†Œè¡¨ä¸­è·å–BeanDefinitionå¯¹è±¡</li><li>åˆ¤æ–­æ³¨å†Œè¡¨ä¸­æ˜¯å¦åŒ…å«æŒ‡å®šåç§°çš„BeanDefinitionå¯¹è±¡</li><li>è·å–æ³¨å†Œè¡¨ä¸­BeanDefinitionå¯¹è±¡çš„ä¸ªæ•°</li><li>è·å–æ³¨å†Œè¡¨ä¸­æ‰€æœ‰çš„BeanDefinitionçš„åç§°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanDefinitionRegistry</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ³¨å†ŒBeanDefinitionå¯¹è±¡åˆ°æ³¨å†Œè¡¨ä¸­</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">registerBeanDefinition</span><span class="params">(String beanName, BeanDefinition beanDefinition)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤æŒ‡å®šåç§°çš„BeanDefinitionå¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">removeBeanDefinition</span><span class="params">(String beanName)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¹æ®åç§°ä»æ³¨å†Œè¡¨ä¸­è·å–BeanDefinitionå¯¹è±¡</span></span><br><span class="line">    <span class="function">BeanDefinition <span class="title">getBeanDefinition</span><span class="params">(String beanName)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">containsBeanDefinition</span><span class="params">(String beanName)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getBeanDefinitionCount</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    String[] getBeanDefinitionNames();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-4-2-2-SimpleBeanDefinitionRegistryç±»"><a href="#7-4-2-2-SimpleBeanDefinitionRegistryç±»" class="headerlink" title="7.4.2.2 SimpleBeanDefinitionRegistryç±»"></a>7.4.2.2 SimpleBeanDefinitionRegistryç±»</h4><p>è¯¥ç±»å®ç°äº†BeanDefinitionRegistryæ¥å£ï¼Œå®šä¹‰äº†Mapé›†åˆä½œä¸ºæ³¨å†Œè¡¨å®¹å™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleBeanDefinitionRegistry</span> <span class="keyword">implements</span> <span class="title">BeanDefinitionRegistry</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, BeanDefinition&gt; beanDefinitionMap = <span class="keyword">new</span> HashMap&lt;String, BeanDefinition&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerBeanDefinition</span><span class="params">(String beanName, BeanDefinition beanDefinition)</span> </span>&#123;</span><br><span class="line">        beanDefinitionMap.put(beanName,beanDefinition);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeBeanDefinition</span><span class="params">(String beanName)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        beanDefinitionMap.remove(beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BeanDefinition <span class="title">getBeanDefinition</span><span class="params">(String beanName)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> beanDefinitionMap.get(beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsBeanDefinition</span><span class="params">(String beanName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> beanDefinitionMap.containsKey(beanName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getBeanDefinitionCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> beanDefinitionMap.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String[] getBeanDefinitionNames() &#123;</span><br><span class="line">        <span class="keyword">return</span> beanDefinitionMap.keySet().toArray(<span class="keyword">new</span> String[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-4-3-å®šä¹‰è§£æå™¨ç›¸å…³ç±»"><a href="#7-4-3-å®šä¹‰è§£æå™¨ç›¸å…³ç±»" class="headerlink" title="7.4.3 å®šä¹‰è§£æå™¨ç›¸å…³ç±»"></a>7.4.3 å®šä¹‰è§£æå™¨ç›¸å…³ç±»</h3><h4 id="7-4-3-1-BeanDefinitionReaderæ¥å£"><a href="#7-4-3-1-BeanDefinitionReaderæ¥å£" class="headerlink" title="7.4.3.1 BeanDefinitionReaderæ¥å£"></a>7.4.3.1 BeanDefinitionReaderæ¥å£</h4><p>BeanDefinitionReaderæ˜¯ç”¨æ¥è§£æé…ç½®æ–‡ä»¶å¹¶åœ¨æ³¨å†Œè¡¨ä¸­æ³¨å†Œbeançš„ä¿¡æ¯ã€‚å®šä¹‰äº†ä¸¤ä¸ªè§„èŒƒï¼š</p><ul><li>è·å–æ³¨å†Œè¡¨çš„åŠŸèƒ½ï¼Œè®©å¤–ç•Œå¯ä»¥é€šè¿‡è¯¥å¯¹è±¡è·å–æ³¨å†Œè¡¨å¯¹è±¡ã€‚</li><li>åŠ è½½é…ç½®æ–‡ä»¶ï¼Œå¹¶æ³¨å†Œbeanæ•°æ®ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanDefinitionReader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è·å–æ³¨å†Œè¡¨å¯¹è±¡</span></span><br><span class="line">    <span class="function">BeanDefinitionRegistry <span class="title">getRegistry</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">//åŠ è½½é…ç½®æ–‡ä»¶å¹¶åœ¨æ³¨å†Œè¡¨ä¸­è¿›è¡Œæ³¨å†Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">loadBeanDefinitions</span><span class="params">(String configLocation)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-4-3-2-XmlBeanDefinitionReaderç±»"><a href="#7-4-3-2-XmlBeanDefinitionReaderç±»" class="headerlink" title="7.4.3.2 XmlBeanDefinitionReaderç±»"></a>7.4.3.2 XmlBeanDefinitionReaderç±»</h4><p>XmlBeanDefinitionReaderç±»æ˜¯ä¸“é—¨ç”¨æ¥è§£æxmlé…ç½®æ–‡ä»¶çš„ã€‚è¯¥ç±»å®ç°BeanDefinitionReaderæ¥å£å¹¶å®ç°æ¥å£ä¸­çš„ä¸¤ä¸ªåŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XmlBeanDefinitionReader</span> <span class="keyword">implements</span> <span class="title">BeanDefinitionReader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> BeanDefinitionRegistry registry;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">XmlBeanDefinitionReader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.registry = <span class="keyword">new</span> SimpleBeanDefinitionRegistry();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BeanDefinitionRegistry <span class="title">getRegistry</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> registry;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadBeanDefinitions</span><span class="params">(String configLocation)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        InputStream is = <span class="keyword">this</span>.getClass().getClassLoader().getResourceAsStream(configLocation);</span><br><span class="line">        SAXReader reader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">        Document document = reader.read(is);</span><br><span class="line">        Element rootElement = document.getRootElement();</span><br><span class="line">        <span class="comment">//è§£æbeanæ ‡ç­¾</span></span><br><span class="line">        parseBean(rootElement);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseBean</span><span class="params">(Element rootElement)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        List&lt;Element&gt; elements = rootElement.elements();</span><br><span class="line">        <span class="keyword">for</span> (Element element : elements) &#123;</span><br><span class="line">            String id = element.attributeValue(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">            String className = element.attributeValue(<span class="string">&quot;class&quot;</span>);</span><br><span class="line">            BeanDefinition beanDefinition = <span class="keyword">new</span> BeanDefinition();</span><br><span class="line">            beanDefinition.setId(id);</span><br><span class="line">            beanDefinition.setClassName(className);</span><br><span class="line">            List&lt;Element&gt; list = element.elements(<span class="string">&quot;property&quot;</span>);</span><br><span class="line">            MutablePropertyValues mutablePropertyValues = <span class="keyword">new</span> MutablePropertyValues();</span><br><span class="line">            <span class="keyword">for</span> (Element element1 : list) &#123;</span><br><span class="line">                String name = element1.attributeValue(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">                String ref = element1.attributeValue(<span class="string">&quot;ref&quot;</span>);</span><br><span class="line">                String value = element1.attributeValue(<span class="string">&quot;value&quot;</span>);</span><br><span class="line">                PropertyValue propertyValue = <span class="keyword">new</span> PropertyValue(name,ref,value);</span><br><span class="line">                mutablePropertyValues.addPropertyValue(propertyValue);</span><br><span class="line">            &#125;</span><br><span class="line">            beanDefinition.setPropertyValues(mutablePropertyValues);</span><br><span class="line"></span><br><span class="line">            registry.registerBeanDefinition(id,beanDefinition);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-4-4-IOCå®¹å™¨ç›¸å…³ç±»"><a href="#7-4-4-IOCå®¹å™¨ç›¸å…³ç±»" class="headerlink" title="7.4.4 IOCå®¹å™¨ç›¸å…³ç±»"></a>7.4.4 IOCå®¹å™¨ç›¸å…³ç±»</h3><h4 id="7-4-4-1-BeanFactoryæ¥å£"><a href="#7-4-4-1-BeanFactoryæ¥å£" class="headerlink" title="7.4.4.1 BeanFactoryæ¥å£"></a>7.4.4.1 BeanFactoryæ¥å£</h4><p>åœ¨è¯¥æ¥å£ä¸­å®šä¹‰IOCå®¹å™¨çš„ç»Ÿä¸€è§„èŒƒå³è·å–beanå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line"><span class="comment">//æ ¹æ®beanå¯¹è±¡çš„åç§°è·å–beanå¯¹è±¡</span></span><br><span class="line">    <span class="function">Object <span class="title">getBean</span><span class="params">(String name)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line"><span class="comment">//æ ¹æ®beanå¯¹è±¡çš„åç§°è·å–beanå¯¹è±¡ï¼Œå¹¶è¿›è¡Œç±»å‹è½¬æ¢</span></span><br><span class="line">    &lt;T&gt; <span class="function">T <span class="title">getBean</span><span class="params">(String name, Class&lt;? extends T&gt; clazz)</span> <span class="keyword">throws</span> Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-4-4-2-ApplicationContextæ¥å£"><a href="#7-4-4-2-ApplicationContextæ¥å£" class="headerlink" title="7.4.4.2 ApplicationContextæ¥å£"></a>7.4.4.2 ApplicationContextæ¥å£</h4><p>è¯¥æ¥å£çš„æ‰€ä»¥çš„å­å®ç°ç±»å¯¹beanå¯¹è±¡çš„åˆ›å»ºéƒ½æ˜¯éå»¶æ—¶çš„ï¼Œæ‰€ä»¥åœ¨è¯¥æ¥å£ä¸­å®šä¹‰ <code>refresh()</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸»è¦å®Œæˆä»¥ä¸‹ä¸¤ä¸ªåŠŸèƒ½ï¼š</p><ul><li>åŠ è½½é…ç½®æ–‡ä»¶ã€‚</li><li>æ ¹æ®æ³¨å†Œè¡¨ä¸­çš„BeanDefinitionå¯¹è±¡å°è£…çš„æ•°æ®è¿›è¡Œbeanå¯¹è±¡çš„åˆ›å»ºã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ApplicationContext</span> <span class="keyword">extends</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line"><span class="comment">//è¿›è¡Œé…ç½®æ–‡ä»¶åŠ è½½å¹¶è¿›è¡Œå¯¹è±¡åˆ›å»º</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">refresh</span><span class="params">()</span> <span class="keyword">throws</span> IllegalStateException, Exception</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-4-4-3-AbstractApplicationContextç±»"><a href="#7-4-4-3-AbstractApplicationContextç±»" class="headerlink" title="7.4.4.3 AbstractApplicationContextç±»"></a>7.4.4.3 AbstractApplicationContextç±»</h4><ul><li><p>ä½œä¸ºApplicationContextæ¥å£çš„å­ç±»ï¼Œæ‰€ä»¥è¯¥ç±»ä¹Ÿæ˜¯éå»¶æ—¶åŠ è½½ï¼Œæ‰€ä»¥éœ€è¦åœ¨è¯¥ç±»ä¸­å®šä¹‰ä¸€ä¸ªMapé›†åˆï¼Œä½œä¸ºbeanå¯¹è±¡å­˜å‚¨çš„å®¹å™¨ã€‚</p></li><li><p>å£°æ˜BeanDefinitionReaderç±»å‹çš„å˜é‡ï¼Œç”¨æ¥è¿›è¡Œxmlé…ç½®æ–‡ä»¶çš„è§£æï¼Œç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚</p><p>BeanDefinitionReaderç±»å‹çš„å¯¹è±¡åˆ›å»ºäº¤ç”±å­ç±»å®ç°ï¼Œå› ä¸ºåªæœ‰å­ç±»æ˜ç¡®åˆ°åº•åˆ›å»ºBeanDefinitionReaderå“ªå„¿ä¸ªå­å®ç°ç±»å¯¹è±¡ã€‚</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractApplicationContext</span> <span class="keyword">implements</span> <span class="title">ApplicationContext</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> BeanDefinitionReader beanDefinitionReader;</span><br><span class="line">    <span class="comment">//ç”¨æ¥å­˜å‚¨beanå¯¹è±¡çš„å®¹å™¨   keyå­˜å‚¨çš„æ˜¯beançš„idå€¼ï¼Œvalueå­˜å‚¨çš„æ˜¯beanå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">protected</span> Map&lt;String, Object&gt; singletonObjects = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å­˜å‚¨é…ç½®æ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line">    <span class="keyword">protected</span> String configLocation;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">refresh</span><span class="params">()</span> <span class="keyword">throws</span> IllegalStateException, Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åŠ è½½BeanDefinition</span></span><br><span class="line">        beanDefinitionReader.loadBeanDefinitions(configLocation);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆå§‹åŒ–bean</span></span><br><span class="line">        finishBeanInitialization();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//beançš„åˆå§‹åŒ–</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">finishBeanInitialization</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        BeanDefinitionRegistry registry = beanDefinitionReader.getRegistry();</span><br><span class="line">        String[] beanNames = registry.getBeanDefinitionNames();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (String beanName : beanNames) &#123;</span><br><span class="line">            BeanDefinition beanDefinition = registry.getBeanDefinition(beanName);</span><br><span class="line">            getBean(beanName);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šè¯¥ç±»finishBeanInitialization()æ–¹æ³•ä¸­è°ƒç”¨getBean()æ–¹æ³•ä½¿ç”¨åˆ°äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚</p></blockquote><h4 id="7-4-4-4-ClassPathXmlApplicationContextç±»"><a href="#7-4-4-4-ClassPathXmlApplicationContextç±»" class="headerlink" title="7.4.4.4 ClassPathXmlApplicationContextç±»"></a>7.4.4.4 ClassPathXmlApplicationContextç±»</h4><p>è¯¥ç±»ä¸»è¦æ˜¯åŠ è½½ç±»è·¯å¾„ä¸‹çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œbeanå¯¹è±¡çš„åˆ›å»ºï¼Œä¸»è¦å®Œæˆä»¥ä¸‹åŠŸèƒ½ï¼š</p><ul><li>åœ¨æ„é€ æ–¹æ³•ä¸­ï¼Œåˆ›å»ºBeanDefinitionReaderå¯¹è±¡ã€‚</li><li>åœ¨æ„é€ æ–¹æ³•ä¸­ï¼Œè°ƒç”¨refresh()æ–¹æ³•ï¼Œç”¨äºè¿›è¡Œé…ç½®æ–‡ä»¶åŠ è½½ã€åˆ›å»ºbeanå¯¹è±¡å¹¶å­˜å‚¨åˆ°å®¹å™¨ä¸­ã€‚</li><li>é‡å†™çˆ¶æ¥å£ä¸­çš„getBean()æ–¹æ³•ï¼Œå¹¶å®ç°ä¾èµ–æ³¨å…¥æ“ä½œã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassPathXmlApplicationContext</span> <span class="keyword">extends</span> <span class="title">AbstractApplicationContext</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClassPathXmlApplicationContext</span><span class="params">(String configLocation)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.configLocation = configLocation;</span><br><span class="line">        <span class="comment">//æ„å»ºXmlBeanDefinitionReaderå¯¹è±¡</span></span><br><span class="line">        beanDefinitionReader = <span class="keyword">new</span> XmlBeanDefinitionReader();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.refresh();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¹æ®beançš„idå±æ€§å€¼è·å–beanå¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">getBean</span><span class="params">(String name)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//return singletonObjects.get(name);</span></span><br><span class="line">        Object obj = singletonObjects.get(name);</span><br><span class="line">        <span class="keyword">if</span>(obj != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> obj;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        BeanDefinitionRegistry registry = beanDefinitionReader.getRegistry();</span><br><span class="line">        BeanDefinition beanDefinition = registry.getBeanDefinition(name);</span><br><span class="line">        <span class="keyword">if</span>(beanDefinition == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        String className = beanDefinition.getClassName();</span><br><span class="line">        Class&lt;?&gt; clazz = Class.forName(className);</span><br><span class="line">        Object beanObj = clazz.newInstance();</span><br><span class="line">        MutablePropertyValues propertyValues = beanDefinition.getPropertyValues();</span><br><span class="line">        <span class="keyword">for</span> (PropertyValue propertyValue : propertyValues) &#123;</span><br><span class="line">            String propertyName = propertyValue.getName();</span><br><span class="line">            String value = propertyValue.getValue();</span><br><span class="line">            String ref = propertyValue.getRef();</span><br><span class="line">            <span class="keyword">if</span>(ref != <span class="keyword">null</span> &amp;&amp; !<span class="string">&quot;&quot;</span>.equals(ref)) &#123;</span><br><span class="line"></span><br><span class="line">                Object bean = getBean(ref);</span><br><span class="line">                String methodName = StringUtils.getSetterMethodNameByFieldName(propertyName);</span><br><span class="line">                Method[] methods = clazz.getMethods();</span><br><span class="line">                <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(method.getName().equals(methodName)) &#123;</span><br><span class="line">                        method.invoke(beanObj,bean);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(value != <span class="keyword">null</span> &amp;&amp; !<span class="string">&quot;&quot;</span>.equals(value)) &#123;</span><br><span class="line">                String methodName = StringUtils.getSetterMethodNameByFieldName(propertyName);</span><br><span class="line">                Method method = clazz.getMethod(methodName, String.class);</span><br><span class="line">                method.invoke(beanObj,value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        singletonObjects.put(name,beanObj);</span><br><span class="line">        <span class="keyword">return</span> beanObj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">getBean</span><span class="params">(String name, Class&lt;? extends T&gt; clazz)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        Object bean = getBean(name);</span><br><span class="line">        <span class="keyword">if</span>(bean != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> clazz.cast(bean);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-4-5-è‡ªå®šä¹‰Spring-IOCæ€»ç»“"><a href="#7-4-5-è‡ªå®šä¹‰Spring-IOCæ€»ç»“" class="headerlink" title="7.4.5 è‡ªå®šä¹‰Spring IOCæ€»ç»“"></a>7.4.5 è‡ªå®šä¹‰Spring IOCæ€»ç»“</h3><h4 id="7-4-5-1-ä½¿ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼"><a href="#7-4-5-1-ä½¿ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼" class="headerlink" title="7.4.5.1 ä½¿ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼"></a>7.4.5.1 ä½¿ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼</h4><ul><li>å·¥å‚æ¨¡å¼ã€‚è¿™ä¸ªä½¿ç”¨å·¥å‚æ¨¡å¼ + é…ç½®æ–‡ä»¶çš„æ–¹å¼ã€‚</li><li>å•ä¾‹æ¨¡å¼ã€‚Spring IOCç®¡ç†çš„beanå¯¹è±¡éƒ½æ˜¯å•ä¾‹çš„ï¼Œæ­¤å¤„çš„å•ä¾‹ä¸æ˜¯é€šè¿‡æ„é€ å™¨è¿›è¡Œå•ä¾‹çš„æ§åˆ¶çš„ï¼Œè€Œæ˜¯springæ¡†æ¶å¯¹æ¯ä¸€ä¸ªbeanåªåˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ã€‚</li><li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚AbstractApplicationContextç±»ä¸­çš„finishBeanInitialization()æ–¹æ³•è°ƒç”¨äº†å­ç±»çš„getBean()æ–¹æ³•ï¼Œå› ä¸ºgetBean()çš„å®ç°å’Œç¯å¢ƒæ¯æ¯ç›¸å…³ã€‚</li><li>è¿­ä»£å™¨æ¨¡å¼ã€‚å¯¹äºMutablePropertyValuesç±»å®šä¹‰ä½¿ç”¨åˆ°äº†è¿­ä»£å™¨æ¨¡å¼ï¼Œå› ä¸ºæ­¤ç±»å­˜å‚¨å¹¶ç®¡ç†PropertyValueå¯¹è±¡ï¼Œä¹Ÿå±äºä¸€ä¸ªå®¹å™¨ï¼Œæ‰€ä»¥ç»™è¯¥å®¹å™¨æä¾›ä¸€ä¸ªéå†æ–¹å¼ã€‚</li></ul><p>springæ¡†æ¶å…¶å®ä½¿ç”¨åˆ°äº†å¾ˆå¤šè®¾è®¡æ¨¡å¼ï¼Œå¦‚AOPä½¿ç”¨åˆ°äº†ä»£ç†æ¨¡å¼ï¼Œé€‰æ‹©JDKä»£ç†æˆ–è€…CGLIBä»£ç†ä½¿ç”¨åˆ°äº†ç­–ç•¥æ¨¡å¼ï¼Œè¿˜æœ‰é€‚é…å™¨æ¨¡å¼ï¼Œè£…é¥°è€…æ¨¡å¼ï¼Œè§‚å¯Ÿè€…æ¨¡å¼ç­‰ã€‚</p><h4 id="7-4-5-2-ç¬¦åˆå¤§éƒ¨åˆ†è®¾è®¡åŸåˆ™"><a href="#7-4-5-2-ç¬¦åˆå¤§éƒ¨åˆ†è®¾è®¡åŸåˆ™" class="headerlink" title="7.4.5.2 ç¬¦åˆå¤§éƒ¨åˆ†è®¾è®¡åŸåˆ™"></a>7.4.5.2 ç¬¦åˆå¤§éƒ¨åˆ†è®¾è®¡åŸåˆ™</h4><h4 id="7-4-5-3-æ•´ä¸ªè®¾è®¡å’ŒSpringçš„è®¾è®¡è¿˜æ˜¯æœ‰ä¸€å®šçš„å‡ºå…¥"><a href="#7-4-5-3-æ•´ä¸ªè®¾è®¡å’ŒSpringçš„è®¾è®¡è¿˜æ˜¯æœ‰ä¸€å®šçš„å‡ºå…¥" class="headerlink" title="7.4.5.3 æ•´ä¸ªè®¾è®¡å’ŒSpringçš„è®¾è®¡è¿˜æ˜¯æœ‰ä¸€å®šçš„å‡ºå…¥"></a>7.4.5.3 æ•´ä¸ªè®¾è®¡å’ŒSpringçš„è®¾è®¡è¿˜æ˜¯æœ‰ä¸€å®šçš„å‡ºå…¥</h4><p>springæ¡†æ¶åº•å±‚æ˜¯å¾ˆå¤æ‚çš„ï¼Œè¿›è¡Œäº†å¾ˆæ·±å…¥çš„å°è£…ï¼Œå¹¶å¯¹å¤–æä¾›äº†å¾ˆå¥½çš„æ‰©å±•æ€§ã€‚è€Œæˆ‘ä»¬è‡ªå®šä¹‰SpringIOCæœ‰ä»¥ä¸‹å‡ ä¸ªç›®çš„ï¼š</p><ul><li>äº†è§£Springåº•å±‚å¯¹å¯¹è±¡çš„å¤§ä½“ç®¡ç†æœºåˆ¶ã€‚</li><li>äº†è§£è®¾è®¡æ¨¡å¼åœ¨å…·ä½“çš„å¼€å‘ä¸­çš„ä½¿ç”¨ã€‚</li><li>ä»¥åå­¦ä¹ springæºç ï¼Œé€šè¿‡è¯¥æ¡ˆä¾‹çš„å®ç°ï¼Œå¯ä»¥é™ä½springå­¦ä¹ çš„å…¥é—¨æˆæœ¬ã€‚</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;7ï¼Œè‡ªå®šä¹‰Springæ¡†æ¶&quot;&gt;&lt;a href=&quot;#7ï¼Œè‡ªå®šä¹‰Springæ¡†æ¶&quot; class=&quot;headerlink&quot; title=&quot;7ï¼Œè‡ªå®šä¹‰Springæ¡†æ¶&quot;&gt;&lt;/a&gt;7ï¼Œè‡ªå®šä¹‰Springæ¡†æ¶&lt;/h1&gt;&lt;h2 id=&quot;7-1-springä½¿ç”¨å›é¡¾&quot;&gt;&lt;a hr</summary>
      
    
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/categories/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/tags/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="è‡ªå®šä¹‰Springæ¡†æ¶" scheme="http://example.com/tags/%E8%87%AA%E5%AE%9A%E4%B9%89Spring%E6%A1%86%E6%9E%B6/"/>
    
  </entry>
  
  <entry>
    <title>javaè®¾è®¡æ¨¡å¼--è¡Œä¸ºå‹</title>
    <link href="http://example.com/2024/09/02/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B/"/>
    <id>http://example.com/2024/09/02/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A1%8C%E4%B8%BA%E5%9E%8B/</id>
    <published>2024-09-02T15:20:13.000Z</published>
    <updated>2024-09-08T05:24:56.476Z</updated>
    
    <content type="html"><![CDATA[<h1 id="6ï¼Œè¡Œä¸ºå‹æ¨¡å¼"><a href="#6ï¼Œè¡Œä¸ºå‹æ¨¡å¼" class="headerlink" title="6ï¼Œè¡Œä¸ºå‹æ¨¡å¼"></a>6ï¼Œè¡Œä¸ºå‹æ¨¡å¼</h1><p>è¡Œä¸ºå‹æ¨¡å¼ç”¨äºæè¿°ç¨‹åºåœ¨è¿è¡Œæ—¶å¤æ‚çš„æµç¨‹æ§åˆ¶ï¼Œå³æè¿°å¤šä¸ªç±»æˆ–å¯¹è±¡ä¹‹é—´æ€æ ·ç›¸äº’åä½œå…±åŒå®Œæˆå•ä¸ªå¯¹è±¡éƒ½æ— æ³•å•ç‹¬å®Œæˆçš„ä»»åŠ¡ï¼Œå®ƒæ¶‰åŠç®—æ³•ä¸å¯¹è±¡é—´èŒè´£çš„åˆ†é…ã€‚</p><p>è¡Œä¸ºå‹æ¨¡å¼åˆ†ä¸ºç±»è¡Œä¸ºæ¨¡å¼å’Œå¯¹è±¡è¡Œä¸ºæ¨¡å¼ï¼Œå‰è€…é‡‡ç”¨ç»§æ‰¿æœºåˆ¶æ¥åœ¨ç±»é—´åˆ†æ´¾è¡Œä¸ºï¼Œåè€…é‡‡ç”¨ç»„åˆæˆ–èšåˆåœ¨å¯¹è±¡é—´åˆ†é…è¡Œä¸ºã€‚ç”±äºç»„åˆå…³ç³»æˆ–èšåˆå…³ç³»æ¯”ç»§æ‰¿å…³ç³»è€¦åˆåº¦ä½ï¼Œæ»¡è¶³â€œåˆæˆå¤ç”¨åŸåˆ™â€ï¼Œæ‰€ä»¥å¯¹è±¡è¡Œä¸ºæ¨¡å¼æ¯”ç±»è¡Œä¸ºæ¨¡å¼å…·æœ‰æ›´å¤§çš„çµæ´»æ€§ã€‚</p><p>è¡Œä¸ºå‹æ¨¡å¼åˆ†ä¸ºï¼š</p><ul><li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</li><li>ç­–ç•¥æ¨¡å¼</li><li>å‘½ä»¤æ¨¡å¼</li><li>èŒè´£é“¾æ¨¡å¼</li><li>çŠ¶æ€æ¨¡å¼</li><li>è§‚å¯Ÿè€…æ¨¡å¼</li><li>ä¸­ä»‹è€…æ¨¡å¼</li><li>è¿­ä»£å™¨æ¨¡å¼</li><li>è®¿é—®è€…æ¨¡å¼</li><li>å¤‡å¿˜å½•æ¨¡å¼</li><li>è§£é‡Šå™¨æ¨¡å¼</li></ul><p>ä»¥ä¸Š 11 ç§è¡Œä¸ºå‹æ¨¡å¼ï¼Œé™¤äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼å’Œè§£é‡Šå™¨æ¨¡å¼æ˜¯ç±»è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶ä»–çš„å…¨éƒ¨å±äºå¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ã€‚</p><h2 id="6-1-æ¨¡æ¿æ–¹æ³•æ¨¡å¼"><a href="#6-1-æ¨¡æ¿æ–¹æ³•æ¨¡å¼" class="headerlink" title="6.1 æ¨¡æ¿æ–¹æ³•æ¨¡å¼"></a>6.1 æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h2><h3 id="6-1-1-æ¦‚è¿°"><a href="#6-1-1-æ¦‚è¿°" class="headerlink" title="6.1.1 æ¦‚è¿°"></a>6.1.1 æ¦‚è¿°</h3><p>åœ¨é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡è¿‡ç¨‹ä¸­ï¼Œç¨‹åºå‘˜å¸¸å¸¸ä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼šè®¾è®¡ä¸€ä¸ªç³»ç»Ÿæ—¶çŸ¥é“äº†ç®—æ³•æ‰€éœ€çš„å…³é”®æ­¥éª¤ï¼Œè€Œä¸”ç¡®å®šäº†è¿™äº›æ­¥éª¤çš„æ‰§è¡Œé¡ºåºï¼Œä½†æŸäº›æ­¥éª¤çš„å…·ä½“å®ç°è¿˜æœªçŸ¥ï¼Œæˆ–è€…è¯´æŸäº›æ­¥éª¤çš„å®ç°ä¸å…·ä½“çš„ç¯å¢ƒç›¸å…³ã€‚</p><p>ä¾‹å¦‚ï¼Œå»é“¶è¡ŒåŠç†ä¸šåŠ¡ä¸€èˆ¬è¦ç»è¿‡ä»¥ä¸‹4ä¸ªæµç¨‹ï¼šå–å·ã€æ’é˜Ÿã€åŠç†å…·ä½“ä¸šåŠ¡ã€å¯¹é“¶è¡Œå·¥ä½œäººå‘˜è¿›è¡Œè¯„åˆ†ç­‰ï¼Œå…¶ä¸­å–å·ã€æ’é˜Ÿå’Œå¯¹é“¶è¡Œå·¥ä½œäººå‘˜è¿›è¡Œè¯„åˆ†çš„ä¸šåŠ¡å¯¹æ¯ä¸ªå®¢æˆ·æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥åœ¨çˆ¶ç±»ä¸­å®ç°ï¼Œä½†æ˜¯åŠç†å…·ä½“ä¸šåŠ¡å´å› äººè€Œå¼‚ï¼Œå®ƒå¯èƒ½æ˜¯å­˜æ¬¾ã€å–æ¬¾æˆ–è€…è½¬è´¦ç­‰ï¼Œå¯ä»¥å»¶è¿Ÿåˆ°å­ç±»ä¸­å®ç°ã€‚</p><p><strong>å®šä¹‰ï¼š</strong></p><p>å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•éª¨æ¶ï¼Œè€Œå°†ç®—æ³•çš„ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜è¯¥ç®—æ³•ç»“æ„çš„æƒ…å†µä¸‹é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</p><h3 id="6-1-2-ç»“æ„"><a href="#6-1-2-ç»“æ„" class="headerlink" title="6.1.2 ç»“æ„"></a>6.1.2 ç»“æ„</h3><p>æ¨¡æ¿æ–¹æ³•ï¼ˆTemplate Methodï¼‰æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²ï¼š</p><ul><li><p>æŠ½è±¡ç±»ï¼ˆAbstract Classï¼‰ï¼šè´Ÿè´£ç»™å‡ºä¸€ä¸ªç®—æ³•çš„è½®å»“å’Œéª¨æ¶ã€‚å®ƒç”±ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•å’Œè‹¥å¹²ä¸ªåŸºæœ¬æ–¹æ³•æ„æˆã€‚</p><ul><li><p>æ¨¡æ¿æ–¹æ³•ï¼šå®šä¹‰äº†ç®—æ³•çš„éª¨æ¶ï¼ŒæŒ‰æŸç§é¡ºåºè°ƒç”¨å…¶åŒ…å«çš„åŸºæœ¬æ–¹æ³•ã€‚</p></li><li><p>åŸºæœ¬æ–¹æ³•ï¼šæ˜¯å®ç°ç®—æ³•å„ä¸ªæ­¥éª¤çš„æ–¹æ³•ï¼Œæ˜¯æ¨¡æ¿æ–¹æ³•çš„ç»„æˆéƒ¨åˆ†ã€‚åŸºæœ¬æ–¹æ³•åˆå¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼š</p><ul><li><p>æŠ½è±¡æ–¹æ³•(Abstract Method) ï¼šä¸€ä¸ªæŠ½è±¡æ–¹æ³•ç”±æŠ½è±¡ç±»å£°æ˜ã€ç”±å…¶å…·ä½“å­ç±»å®ç°ã€‚</p></li><li><p>å…·ä½“æ–¹æ³•(Concrete Method) ï¼šä¸€ä¸ªå…·ä½“æ–¹æ³•ç”±ä¸€ä¸ªæŠ½è±¡ç±»æˆ–å…·ä½“ç±»å£°æ˜å¹¶å®ç°ï¼Œå…¶å­ç±»å¯ä»¥è¿›è¡Œè¦†ç›–ä¹Ÿå¯ä»¥ç›´æ¥ç»§æ‰¿ã€‚</p></li><li><p>é’©å­æ–¹æ³•(Hook Method) ï¼šåœ¨æŠ½è±¡ç±»ä¸­å·²ç»å®ç°ï¼ŒåŒ…æ‹¬ç”¨äºåˆ¤æ–­çš„é€»è¾‘æ–¹æ³•å’Œéœ€è¦å­ç±»é‡å†™çš„ç©ºæ–¹æ³•ä¸¤ç§ã€‚</p><p>ä¸€èˆ¬é’©å­æ–¹æ³•æ˜¯ç”¨äºåˆ¤æ–­çš„é€»è¾‘æ–¹æ³•ï¼Œè¿™ç±»æ–¹æ³•åä¸€èˆ¬ä¸ºisXxxï¼Œè¿”å›å€¼ç±»å‹ä¸ºbooleanç±»å‹ã€‚</p></li></ul></li></ul></li><li><p>å…·ä½“å­ç±»ï¼ˆConcrete Classï¼‰ï¼šå®ç°æŠ½è±¡ç±»ä¸­æ‰€å®šä¹‰çš„æŠ½è±¡æ–¹æ³•å’Œé’©å­æ–¹æ³•ï¼Œå®ƒä»¬æ˜¯ä¸€ä¸ªé¡¶çº§é€»è¾‘çš„ç»„æˆæ­¥éª¤ã€‚</p></li></ul><h3 id="6-1-3-æ¡ˆä¾‹å®ç°"><a href="#6-1-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="6.1.3 æ¡ˆä¾‹å®ç°"></a>6.1.3 æ¡ˆä¾‹å®ç°</h3><p>ã€ä¾‹ã€‘ç‚’èœ</p><p>ç‚’èœçš„æ­¥éª¤æ˜¯å›ºå®šçš„ï¼Œåˆ†ä¸ºå€’æ²¹ã€çƒ­æ²¹ã€å€’è”¬èœã€å€’è°ƒæ–™å“ã€ç¿»ç‚’ç­‰æ­¥éª¤ã€‚ç°é€šè¿‡æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ¥ç”¨ä»£ç æ¨¡æ‹Ÿã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/æ¨¡æ¿æ–¹æ³•æ¨¡å¼.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractClass</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">cookProcess</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€æ­¥ï¼šå€’æ²¹</span></span><br><span class="line">        <span class="keyword">this</span>.pourOil();</span><br><span class="line">        <span class="comment">//ç¬¬äºŒæ­¥ï¼šçƒ­æ²¹</span></span><br><span class="line">        <span class="keyword">this</span>.heatOil();</span><br><span class="line">        <span class="comment">//ç¬¬ä¸‰æ­¥ï¼šå€’è”¬èœ</span></span><br><span class="line">        <span class="keyword">this</span>.pourVegetable();</span><br><span class="line">        <span class="comment">//ç¬¬å››æ­¥ï¼šå€’è°ƒå‘³æ–™</span></span><br><span class="line">        <span class="keyword">this</span>.pourSauce();</span><br><span class="line">        <span class="comment">//ç¬¬äº”æ­¥ï¼šç¿»ç‚’</span></span><br><span class="line">        <span class="keyword">this</span>.fry();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pourOil</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å€’æ²¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬äºŒæ­¥ï¼šçƒ­æ²¹æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ç›´æ¥å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">heatOil</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;çƒ­æ²¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬ä¸‰æ­¥ï¼šå€’è”¬èœæ˜¯ä¸ä¸€æ ·çš„ï¼ˆä¸€ä¸ªä¸‹åŒ…èœï¼Œä¸€ä¸ªæ˜¯ä¸‹èœå¿ƒï¼‰</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">pourVegetable</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬å››æ­¥ï¼šå€’è°ƒå‘³æ–™æ˜¯ä¸ä¸€æ ·</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">pourSauce</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬äº”æ­¥ï¼šç¿»ç‚’æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ç›´æ¥å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fry</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç‚’å•Šç‚’å•Šç‚’åˆ°ç†Ÿå•Š&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteClass_BaoCai</span> <span class="keyword">extends</span> <span class="title">AbstractClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pourVegetable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸‹é”…çš„è”¬èœæ˜¯åŒ…èœ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pourSauce</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸‹é”…çš„é…±æ–™æ˜¯è¾£æ¤’&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteClass_CaiXin</span> <span class="keyword">extends</span> <span class="title">AbstractClass</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pourVegetable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸‹é”…çš„è”¬èœæ˜¯èœå¿ƒ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pourSauce</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸‹é”…çš„é…±æ–™æ˜¯è’œè“‰&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ç‚’æ‰‹æ’•åŒ…èœ</span></span><br><span class="line">        ConcreteClass_BaoCai baoCai = <span class="keyword">new</span> ConcreteClass_BaoCai();</span><br><span class="line">        baoCai.cookProcess();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç‚’è’œè“‰èœå¿ƒ</span></span><br><span class="line">        ConcreteClass_CaiXin caiXin = <span class="keyword">new</span> ConcreteClass_CaiXin();</span><br><span class="line">        caiXin.cookProcess();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šä¸ºé˜²æ­¢æ¶æ„æ“ä½œï¼Œä¸€èˆ¬æ¨¡æ¿æ–¹æ³•éƒ½åŠ ä¸Š final å…³é”®è¯ã€‚</p></blockquote><h3 id="6-1-3-ä¼˜ç¼ºç‚¹"><a href="#6-1-3-ä¼˜ç¼ºç‚¹" class="headerlink" title="6.1.3 ä¼˜ç¼ºç‚¹"></a>6.1.3 ä¼˜ç¼ºç‚¹</h3><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li><p>æé«˜ä»£ç å¤ç”¨æ€§</p><p>å°†ç›¸åŒéƒ¨åˆ†çš„ä»£ç æ”¾åœ¨æŠ½è±¡çš„çˆ¶ç±»ä¸­ï¼Œè€Œå°†ä¸åŒçš„ä»£ç æ”¾å…¥ä¸åŒçš„å­ç±»ä¸­ã€‚</p></li><li><p>å®ç°äº†åå‘æ§åˆ¶</p><p>é€šè¿‡ä¸€ä¸ªçˆ¶ç±»è°ƒç”¨å…¶å­ç±»çš„æ“ä½œï¼Œé€šè¿‡å¯¹å­ç±»çš„å…·ä½“å®ç°æ‰©å±•ä¸åŒçš„è¡Œä¸ºï¼Œå®ç°äº†åå‘æ§åˆ¶ ï¼Œå¹¶ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</p></li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å¯¹æ¯ä¸ªä¸åŒçš„å®ç°éƒ½éœ€è¦å®šä¹‰ä¸€ä¸ªå­ç±»ï¼Œè¿™ä¼šå¯¼è‡´ç±»çš„ä¸ªæ•°å¢åŠ ï¼Œç³»ç»Ÿæ›´åŠ åºå¤§ï¼Œè®¾è®¡ä¹Ÿæ›´åŠ æŠ½è±¡ã€‚</li><li>çˆ¶ç±»ä¸­çš„æŠ½è±¡æ–¹æ³•ç”±å­ç±»å®ç°ï¼Œå­ç±»æ‰§è¡Œçš„ç»“æœä¼šå½±å“çˆ¶ç±»çš„ç»“æœï¼Œè¿™å¯¼è‡´ä¸€ç§åå‘çš„æ§åˆ¶ç»“æ„ï¼Œå®ƒæé«˜äº†ä»£ç é˜…è¯»çš„éš¾åº¦ã€‚</li></ul><h3 id="6-1-4-é€‚ç”¨åœºæ™¯"><a href="#6-1-4-é€‚ç”¨åœºæ™¯" class="headerlink" title="6.1.4 é€‚ç”¨åœºæ™¯"></a>6.1.4 é€‚ç”¨åœºæ™¯</h3><ul><li>ç®—æ³•çš„æ•´ä½“æ­¥éª¤å¾ˆå›ºå®šï¼Œä½†å…¶ä¸­ä¸ªåˆ«éƒ¨åˆ†æ˜“å˜æ—¶ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œå°†å®¹æ˜“å˜çš„éƒ¨åˆ†æŠ½è±¡å‡ºæ¥ï¼Œä¾›å­ç±»å®ç°ã€‚</li><li>éœ€è¦é€šè¿‡å­ç±»æ¥å†³å®šçˆ¶ç±»ç®—æ³•ä¸­æŸä¸ªæ­¥éª¤æ˜¯å¦æ‰§è¡Œï¼Œå®ç°å­ç±»å¯¹çˆ¶ç±»çš„åå‘æ§åˆ¶ã€‚</li></ul><h3 id="6-1-5-JDKæºç è§£æ"><a href="#6-1-5-JDKæºç è§£æ" class="headerlink" title="6.1.5 JDKæºç è§£æ"></a>6.1.5 JDKæºç è§£æ</h3><p>InputStreamç±»å°±ä½¿ç”¨äº†æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚åœ¨InputStreamç±»ä¸­å®šä¹‰äº†å¤šä¸ª <code>read()</code> æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">InputStream</span> <span class="keyword">implements</span> <span class="title">Closeable</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æŠ½è±¡æ–¹æ³•ï¼Œè¦æ±‚å­ç±»å¿…é¡»é‡å†™</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">byte</span> b[])</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> read(b, <span class="number">0</span>, b.length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">byte</span> b[], <span class="keyword">int</span> off, <span class="keyword">int</span> len)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (b == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (off &lt; <span class="number">0</span> || len &lt; <span class="number">0</span> || len &gt; b.length - off) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (len == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> c = read(); <span class="comment">//è°ƒç”¨äº†æ— å‚çš„readæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯æ¯æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚æ•°æ®</span></span><br><span class="line">        <span class="keyword">if</span> (c == -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        b[off] = (<span class="keyword">byte</span>)c;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (; i &lt; len ; i++) &#123;</span><br><span class="line">                c = read();</span><br><span class="line">                <span class="keyword">if</span> (c == -<span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                b[off + i] = (<span class="keyword">byte</span>)c;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException ee) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œæ— å‚çš„ <code>read()</code> æ–¹æ³•æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œè¦æ±‚å­ç±»å¿…é¡»å®ç°ã€‚è€Œ <code>read(byte b[])</code> æ–¹æ³•è°ƒç”¨äº† <code>read(byte b[], int off, int len)</code> æ–¹æ³•ï¼Œæ‰€ä»¥åœ¨æ­¤å¤„é‡ç‚¹çœ‹çš„æ–¹æ³•æ˜¯å¸¦ä¸‰ä¸ªå‚æ•°çš„æ–¹æ³•ã€‚ </p><p>åœ¨è¯¥æ–¹æ³•ä¸­ç¬¬18è¡Œã€27è¡Œï¼Œå¯ä»¥çœ‹åˆ°è°ƒç”¨äº†æ— å‚çš„æŠ½è±¡çš„ <code>read()</code> æ–¹æ³•ã€‚</p><p>æ€»ç»“å¦‚ä¸‹ï¼š åœ¨InputStreamçˆ¶ç±»ä¸­å·²ç»å®šä¹‰å¥½äº†è¯»å–ä¸€ä¸ªå­—èŠ‚æ•°ç»„æ•°æ®çš„æ–¹æ³•æ˜¯æ¯æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œå¹¶å°†å…¶å­˜å‚¨åˆ°æ•°ç»„çš„ç¬¬ä¸€ä¸ªç´¢å¼•ä½ç½®ï¼Œè¯»å–lenä¸ªå­—èŠ‚æ•°æ®ã€‚å…·ä½“å¦‚ä½•è¯»å–ä¸€ä¸ªå­—èŠ‚æ•°æ®å‘¢ï¼Ÿç”±å­ç±»å®ç°ã€‚</p><h2 id="6-2-ç­–ç•¥æ¨¡å¼"><a href="#6-2-ç­–ç•¥æ¨¡å¼" class="headerlink" title="6.2 ç­–ç•¥æ¨¡å¼"></a>6.2 ç­–ç•¥æ¨¡å¼</h2><h3 id="6-2-1-æ¦‚è¿°"><a href="#6-2-1-æ¦‚è¿°" class="headerlink" title="6.2.1 æ¦‚è¿°"></a>6.2.1 æ¦‚è¿°</h3><p>å…ˆçœ‹ä¸‹é¢çš„å›¾ç‰‡ï¼Œæˆ‘ä»¬å»æ—…æ¸¸é€‰æ‹©å‡ºè¡Œæ¨¡å¼æœ‰å¾ˆå¤šç§ï¼Œå¯ä»¥éª‘è‡ªè¡Œè½¦ã€å¯ä»¥åæ±½è½¦ã€å¯ä»¥åç«è½¦ã€å¯ä»¥åé£æœºã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200210143039168.png" style="zoom:80%;" /><p>ä½œä¸ºä¸€ä¸ªç¨‹åºçŒ¿ï¼Œå¼€å‘éœ€è¦é€‰æ‹©ä¸€æ¬¾å¼€å‘å·¥å…·ï¼Œå½“ç„¶å¯ä»¥è¿›è¡Œä»£ç å¼€å‘çš„å·¥å…·æœ‰å¾ˆå¤šï¼Œå¯ä»¥é€‰æ‹©Ideaè¿›è¡Œå¼€å‘ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨eclipseè¿›è¡Œå¼€å‘ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„ä¸€äº›å¼€å‘å·¥å…·ã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200210144457478.png" style="zoom:70%;" /><p><strong>å®šä¹‰ï¼š</strong></p><p>â€‹    è¯¥æ¨¡å¼å®šä¹‰äº†ä¸€ç³»åˆ—ç®—æ³•ï¼Œå¹¶å°†æ¯ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œä¸”ç®—æ³•çš„å˜åŒ–ä¸ä¼šå½±å“ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚ç­–ç•¥æ¨¡å¼å±äºå¯¹è±¡è¡Œä¸ºæ¨¡å¼ï¼Œå®ƒé€šè¿‡å¯¹ç®—æ³•è¿›è¡Œå°è£…ï¼ŒæŠŠä½¿ç”¨ç®—æ³•çš„è´£ä»»å’Œç®—æ³•çš„å®ç°åˆ†å‰²å¼€æ¥ï¼Œå¹¶å§”æ´¾ç»™ä¸åŒçš„å¯¹è±¡å¯¹è¿™äº›ç®—æ³•è¿›è¡Œç®¡ç†ã€‚</p><h3 id="6-2-2-ç»“æ„"><a href="#6-2-2-ç»“æ„" class="headerlink" title="6.2.2 ç»“æ„"></a>6.2.2 ç»“æ„</h3><p>ç­–ç•¥æ¨¡å¼çš„ä¸»è¦è§’è‰²å¦‚ä¸‹ï¼š</p><ul><li>æŠ½è±¡ç­–ç•¥ï¼ˆStrategyï¼‰ç±»ï¼šè¿™æ˜¯ä¸€ä¸ªæŠ½è±¡è§’è‰²ï¼Œé€šå¸¸ç”±ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»å®ç°ã€‚æ­¤è§’è‰²ç»™å‡ºæ‰€æœ‰çš„å…·ä½“ç­–ç•¥ç±»æ‰€éœ€çš„æ¥å£ã€‚</li><li>å…·ä½“ç­–ç•¥ï¼ˆConcrete Strategyï¼‰ç±»ï¼šå®ç°äº†æŠ½è±¡ç­–ç•¥å®šä¹‰çš„æ¥å£ï¼Œæä¾›å…·ä½“çš„ç®—æ³•å®ç°æˆ–è¡Œä¸ºã€‚</li><li>ç¯å¢ƒï¼ˆContextï¼‰ç±»ï¼šæŒæœ‰ä¸€ä¸ªç­–ç•¥ç±»çš„å¼•ç”¨ï¼Œæœ€ç»ˆç»™å®¢æˆ·ç«¯è°ƒç”¨ã€‚</li></ul><h3 id="6-2-3-æ¡ˆä¾‹å®ç°"><a href="#6-2-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="6.2.3 æ¡ˆä¾‹å®ç°"></a>6.2.3 æ¡ˆä¾‹å®ç°</h3><p>ã€ä¾‹ã€‘ä¿ƒé”€æ´»åŠ¨</p><p>ä¸€å®¶ç™¾è´§å…¬å¸åœ¨å®šå¹´åº¦çš„ä¿ƒé”€æ´»åŠ¨ã€‚é’ˆå¯¹ä¸åŒçš„èŠ‚æ—¥ï¼ˆæ˜¥èŠ‚ã€ä¸­ç§‹èŠ‚ã€åœ£è¯èŠ‚ï¼‰æ¨å‡ºä¸åŒçš„ä¿ƒé”€æ´»åŠ¨ï¼Œç”±ä¿ƒé”€å‘˜å°†ä¿ƒé”€æ´»åŠ¨å±•ç¤ºç»™å®¢æˆ·ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/ç­–ç•¥æ¨¡å¼.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><p>å®šä¹‰ç™¾è´§å…¬å¸æ‰€æœ‰ä¿ƒé”€æ´»åŠ¨çš„å…±åŒæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰å…·ä½“ç­–ç•¥è§’è‰²ï¼ˆConcrete Strategyï¼‰ï¼šæ¯ä¸ªèŠ‚æ—¥å…·ä½“çš„ä¿ƒé”€æ´»åŠ¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸ºæ˜¥èŠ‚å‡†å¤‡çš„ä¿ƒé”€æ´»åŠ¨A</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyA</span> <span class="keyword">implements</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¹°ä¸€é€ä¸€&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸ºä¸­ç§‹å‡†å¤‡çš„ä¿ƒé”€æ´»åŠ¨B</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyB</span> <span class="keyword">implements</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ»¡200å…ƒå‡50å…ƒ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸ºåœ£è¯å‡†å¤‡çš„ä¿ƒé”€æ´»åŠ¨C</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyC</span> <span class="keyword">implements</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ»¡1000å…ƒåŠ ä¸€å…ƒæ¢è´­ä»»æ„200å…ƒä»¥ä¸‹å•†å“&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰ç¯å¢ƒè§’è‰²ï¼ˆContextï¼‰ï¼šç”¨äºè¿æ¥ä¸Šä¸‹æ–‡ï¼Œå³æŠŠä¿ƒé”€æ´»åŠ¨æ¨é”€ç»™å®¢æˆ·ï¼Œè¿™é‡Œå¯ä»¥ç†è§£ä¸ºé”€å”®å‘˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SalesMan</span> </span>&#123;                        </span><br><span class="line">    <span class="comment">//æŒæœ‰æŠ½è±¡ç­–ç•¥è§’è‰²çš„å¼•ç”¨                              </span></span><br><span class="line">    <span class="keyword">private</span> Strategy strategy;                 </span><br><span class="line">                                               </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SalesMan</span><span class="params">(Strategy strategy)</span> </span>&#123;       </span><br><span class="line">        <span class="keyword">this</span>.strategy = strategy;              </span><br><span class="line">    &#125;                                          </span><br><span class="line">                                               </span><br><span class="line">    <span class="comment">//å‘å®¢æˆ·å±•ç¤ºä¿ƒé”€æ´»åŠ¨                                </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">salesManShow</span><span class="params">()</span></span>&#123;                </span><br><span class="line">        strategy.show();                       </span><br><span class="line">    &#125;                                          </span><br><span class="line">&#125;                                              </span><br></pre></td></tr></table></figure><h3 id="6-2-4-ä¼˜ç¼ºç‚¹"><a href="#6-2-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="6.2.4 ä¼˜ç¼ºç‚¹"></a>6.2.4 ä¼˜ç¼ºç‚¹</h3><p><strong>1ï¼Œä¼˜ç‚¹ï¼š</strong></p><ul><li><p>ç­–ç•¥ç±»ä¹‹é—´å¯ä»¥è‡ªç”±åˆ‡æ¢</p><p>ç”±äºç­–ç•¥ç±»éƒ½å®ç°åŒä¸€ä¸ªæ¥å£ï¼Œæ‰€ä»¥ä½¿å®ƒä»¬ä¹‹é—´å¯ä»¥è‡ªç”±åˆ‡æ¢ã€‚</p></li><li><p>æ˜“äºæ‰©å±•</p><p>å¢åŠ ä¸€ä¸ªæ–°çš„ç­–ç•¥åªéœ€è¦æ·»åŠ ä¸€ä¸ªå…·ä½“çš„ç­–ç•¥ç±»å³å¯ï¼ŒåŸºæœ¬ä¸éœ€è¦æ”¹å˜åŸæœ‰çš„ä»£ç ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€œ</p></li><li><p>é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶é€‰æ‹©è¯­å¥ï¼ˆif elseï¼‰ï¼Œå……åˆ†ä½“ç°é¢å‘å¯¹è±¡è®¾è®¡æ€æƒ³ã€‚</p></li></ul><p><strong>2ï¼Œç¼ºç‚¹ï¼š</strong></p><ul><li>å®¢æˆ·ç«¯å¿…é¡»çŸ¥é“æ‰€æœ‰çš„ç­–ç•¥ç±»ï¼Œå¹¶è‡ªè¡Œå†³å®šä½¿ç”¨å“ªä¸€ä¸ªç­–ç•¥ç±»ã€‚</li><li>ç­–ç•¥æ¨¡å¼å°†é€ æˆäº§ç”Ÿå¾ˆå¤šç­–ç•¥ç±»ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨äº«å…ƒæ¨¡å¼åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘å¯¹è±¡çš„æ•°é‡ã€‚</li></ul><h3 id="6-2-5-ä½¿ç”¨åœºæ™¯"><a href="#6-2-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="6.2.5 ä½¿ç”¨åœºæ™¯"></a>6.2.5 ä½¿ç”¨åœºæ™¯</h3><ul><li>ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§æ—¶ï¼Œå¯å°†æ¯ä¸ªç®—æ³•å°è£…åˆ°ç­–ç•¥ç±»ä¸­ã€‚</li><li>ä¸€ä¸ªç±»å®šä¹‰äº†å¤šç§è¡Œä¸ºï¼Œå¹¶ä¸”è¿™äº›è¡Œä¸ºåœ¨è¿™ä¸ªç±»çš„æ“ä½œä¸­ä»¥å¤šä¸ªæ¡ä»¶è¯­å¥çš„å½¢å¼å‡ºç°ï¼Œå¯å°†æ¯ä¸ªæ¡ä»¶åˆ†æ”¯ç§»å…¥å®ƒä»¬å„è‡ªçš„ç­–ç•¥ç±»ä¸­ä»¥ä»£æ›¿è¿™äº›æ¡ä»¶è¯­å¥ã€‚</li><li>ç³»ç»Ÿä¸­å„ç®—æ³•å½¼æ­¤å®Œå…¨ç‹¬ç«‹ï¼Œä¸”è¦æ±‚å¯¹å®¢æˆ·éšè—å…·ä½“ç®—æ³•çš„å®ç°ç»†èŠ‚æ—¶ã€‚</li><li>ç³»ç»Ÿè¦æ±‚ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ä¸åº”è¯¥çŸ¥é“å…¶æ“ä½œçš„æ•°æ®æ—¶ï¼Œå¯ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥éšè—ä¸ç®—æ³•ç›¸å…³çš„æ•°æ®ç»“æ„ã€‚</li><li>å¤šä¸ªç±»åªåŒºåˆ«åœ¨è¡¨ç°è¡Œä¸ºä¸åŒï¼Œå¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€é€‰æ‹©å…·ä½“è¦æ‰§è¡Œçš„è¡Œä¸ºã€‚</li></ul><h3 id="6-2-6-JDKæºç è§£æ"><a href="#6-2-6-JDKæºç è§£æ" class="headerlink" title="6.2.6 JDKæºç è§£æ"></a>6.2.6 JDKæºç è§£æ</h3><p><code>Comparator</code> ä¸­çš„ç­–ç•¥æ¨¡å¼ã€‚åœ¨Arraysç±»ä¸­æœ‰ä¸€ä¸ª <code>sort()</code> æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Arrays</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] a, Comparator&lt;? <span class="keyword">super</span> T&gt; c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="keyword">null</span>) &#123;</span><br><span class="line">            sort(a);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (LegacyMergeSort.userRequested)</span><br><span class="line">                legacyMergeSort(a, c);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                TimSort.sort(a, <span class="number">0</span>, a.length, c, <span class="keyword">null</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Arrayså°±æ˜¯ä¸€ä¸ªç¯å¢ƒè§’è‰²ç±»ï¼Œè¿™ä¸ªsortæ–¹æ³•å¯ä»¥ä¼ ä¸€ä¸ªæ–°ç­–ç•¥è®©Arraysæ ¹æ®è¿™ä¸ªç­–ç•¥æ¥è¿›è¡Œæ’åºã€‚å°±æ¯”å¦‚ä¸‹é¢çš„æµ‹è¯•ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Integer[] data = &#123;<span class="number">12</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>&#125;;</span><br><span class="line">        <span class="comment">// å®ç°é™åºæ’åº</span></span><br><span class="line">        Arrays.sort(data, <span class="keyword">new</span> Comparator&lt;Integer&gt;() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(Integer o1, Integer o2)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> o2 - o1;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        System.out.println(Arrays.toString(data)); <span class="comment">//[12, 5, 4, 3, 2, 2, 1]</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬åœ¨è°ƒç”¨Arraysçš„sortæ–¹æ³•æ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ é€’çš„æ˜¯Comparatoræ¥å£çš„å­å®ç°ç±»å¯¹è±¡ã€‚æ‰€ä»¥Comparatorå……å½“çš„æ˜¯æŠ½è±¡ç­–ç•¥è§’è‰²ï¼Œè€Œå…·ä½“çš„å­å®ç°ç±»å……å½“çš„æ˜¯å…·ä½“ç­–ç•¥è§’è‰²ã€‚ç¯å¢ƒè§’è‰²ç±»ï¼ˆArraysï¼‰åº”è¯¥æŒæœ‰æŠ½è±¡ç­–ç•¥çš„å¼•ç”¨æ¥è°ƒç”¨ã€‚é‚£ä¹ˆï¼ŒArraysç±»çš„sortæ–¹æ³•åˆ°åº•æœ‰æ²¡æœ‰ä½¿ç”¨Comparatorå­å®ç°ç±»ä¸­çš„ <code>compare()</code> æ–¹æ³•å—ï¼Ÿè®©æˆ‘ä»¬ç»§ç»­æŸ¥çœ‹TimSortç±»çš„ <code>sort()</code> æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TimSort</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">(T[] a, <span class="keyword">int</span> lo, <span class="keyword">int</span> hi, Comparator&lt;? <span class="keyword">super</span> T&gt; c,</span></span></span><br><span class="line"><span class="params"><span class="function">                         T[] work, <span class="keyword">int</span> workBase, <span class="keyword">int</span> workLen)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">assert</span> c != <span class="keyword">null</span> &amp;&amp; a != <span class="keyword">null</span> &amp;&amp; lo &gt;= <span class="number">0</span> &amp;&amp; lo &lt;= hi &amp;&amp; hi &lt;= a.length;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> nRemaining  = hi - lo;</span><br><span class="line">        <span class="keyword">if</span> (nRemaining &lt; <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">return</span>;  <span class="comment">// Arrays of size 0 and 1 are always sorted</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// If array is small, do a &quot;mini-TimSort&quot; with no merges</span></span><br><span class="line">        <span class="keyword">if</span> (nRemaining &lt; MIN_MERGE) &#123;</span><br><span class="line">            <span class="keyword">int</span> initRunLen = countRunAndMakeAscending(a, lo, hi, c);</span><br><span class="line">            binarySort(a, lo, hi, lo + initRunLen, c);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;   </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">int</span> <span class="title">countRunAndMakeAscending</span><span class="params">(T[] a, <span class="keyword">int</span> lo, <span class="keyword">int</span> hi,Comparator&lt;? <span class="keyword">super</span> T&gt; c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">assert</span> lo &lt; hi;</span><br><span class="line">        <span class="keyword">int</span> runHi = lo + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (runHi == hi)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Find end of run, and reverse range if descending</span></span><br><span class="line">        <span class="keyword">if</span> (c.compare(a[runHi++], a[lo]) &lt; <span class="number">0</span>) &#123; <span class="comment">// Descending</span></span><br><span class="line">            <span class="keyword">while</span> (runHi &lt; hi &amp;&amp; c.compare(a[runHi], a[runHi - <span class="number">1</span>]) &lt; <span class="number">0</span>)</span><br><span class="line">                runHi++;</span><br><span class="line">            reverseRange(a, lo, runHi);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;                              <span class="comment">// Ascending</span></span><br><span class="line">            <span class="keyword">while</span> (runHi &lt; hi &amp;&amp; c.compare(a[runHi], a[runHi - <span class="number">1</span>]) &gt;= <span class="number">0</span>)</span><br><span class="line">                runHi++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> runHi - lo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ä¸­æœ€ç»ˆä¼šè·‘åˆ° <code>countRunAndMakeAscending()</code> è¿™ä¸ªæ–¹æ³•ä¸­ã€‚æˆ‘ä»¬å¯ä»¥çœ‹è§ï¼Œåªç”¨äº†compareæ–¹æ³•ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨Arrays.sortæ–¹æ³•åªä¼ å…·ä½“compareé‡å†™æ–¹æ³•çš„ç±»å¯¹è±¡å°±è¡Œï¼Œè¿™ä¹Ÿæ˜¯Comparatoræ¥å£ä¸­å¿…é¡»è¦å­ç±»å®ç°çš„ä¸€ä¸ªæ–¹æ³•ã€‚</p><h2 id="6-3-å‘½ä»¤æ¨¡å¼"><a href="#6-3-å‘½ä»¤æ¨¡å¼" class="headerlink" title="6.3 å‘½ä»¤æ¨¡å¼"></a>6.3 å‘½ä»¤æ¨¡å¼</h2><h3 id="6-3-1-æ¦‚è¿°"><a href="#6-3-1-æ¦‚è¿°" class="headerlink" title="6.3.1 æ¦‚è¿°"></a>6.3.1 æ¦‚è¿°</h3><p>æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬å‡ºå»åƒé¥­éƒ½ä¼šé‡åˆ°ä¸‹é¢çš„åœºæ™¯ã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200211130313251.png" style="zoom:60%;" /><p><strong>å®šä¹‰ï¼š</strong></p><p>å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä½¿å‘å‡ºè¯·æ±‚çš„è´£ä»»å’Œæ‰§è¡Œè¯·æ±‚çš„è´£ä»»åˆ†å‰²å¼€ã€‚è¿™æ ·ä¸¤è€…ä¹‹é—´é€šè¿‡å‘½ä»¤å¯¹è±¡è¿›è¡Œæ²Ÿé€šï¼Œè¿™æ ·æ–¹ä¾¿å°†å‘½ä»¤å¯¹è±¡è¿›è¡Œå­˜å‚¨ã€ä¼ é€’ã€è°ƒç”¨ã€å¢åŠ ä¸ç®¡ç†ã€‚</p><h3 id="6-3-2-ç»“æ„"><a href="#6-3-2-ç»“æ„" class="headerlink" title="6.3.2 ç»“æ„"></a>6.3.2 ç»“æ„</h3><p>å‘½ä»¤æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²ï¼š</p><ul><li>æŠ½è±¡å‘½ä»¤ç±»ï¼ˆCommandï¼‰è§’è‰²ï¼š å®šä¹‰å‘½ä»¤çš„æ¥å£ï¼Œå£°æ˜æ‰§è¡Œçš„æ–¹æ³•ã€‚</li><li>å…·ä½“å‘½ä»¤ï¼ˆConcrete  Commandï¼‰è§’è‰²ï¼šå…·ä½“çš„å‘½ä»¤ï¼Œå®ç°å‘½ä»¤æ¥å£ï¼›é€šå¸¸ä¼šæŒæœ‰æ¥æ”¶è€…ï¼Œå¹¶è°ƒç”¨æ¥æ”¶è€…çš„åŠŸèƒ½æ¥å®Œæˆå‘½ä»¤è¦æ‰§è¡Œçš„æ“ä½œã€‚</li><li>å®ç°è€…/æ¥æ”¶è€…ï¼ˆReceiverï¼‰è§’è‰²ï¼š æ¥æ”¶è€…ï¼ŒçœŸæ­£æ‰§è¡Œå‘½ä»¤çš„å¯¹è±¡ã€‚ä»»ä½•ç±»éƒ½å¯èƒ½æˆä¸ºä¸€ä¸ªæ¥æ”¶è€…ï¼Œåªè¦å®ƒèƒ½å¤Ÿå®ç°å‘½ä»¤è¦æ±‚å®ç°çš„ç›¸åº”åŠŸèƒ½ã€‚</li><li>è°ƒç”¨è€…/è¯·æ±‚è€…ï¼ˆInvokerï¼‰è§’è‰²ï¼š è¦æ±‚å‘½ä»¤å¯¹è±¡æ‰§è¡Œè¯·æ±‚ï¼Œé€šå¸¸ä¼šæŒæœ‰å‘½ä»¤å¯¹è±¡ï¼Œå¯ä»¥æŒæœ‰å¾ˆå¤šçš„å‘½ä»¤å¯¹è±¡ã€‚è¿™ä¸ªæ˜¯å®¢æˆ·ç«¯çœŸæ­£è§¦å‘å‘½ä»¤å¹¶è¦æ±‚å‘½ä»¤æ‰§è¡Œç›¸åº”æ“ä½œçš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯è¯´ç›¸å½“äºä½¿ç”¨å‘½ä»¤å¯¹è±¡çš„å…¥å£ã€‚</li></ul><h3 id="6-3-3-æ¡ˆä¾‹å®ç°"><a href="#6-3-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="6.3.3 æ¡ˆä¾‹å®ç°"></a>6.3.3 æ¡ˆä¾‹å®ç°</h3><p>å°†ä¸Šé¢çš„æ¡ˆä¾‹ç”¨ä»£ç å®ç°ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦åˆ†æå‘½ä»¤æ¨¡å¼çš„è§’è‰²åœ¨è¯¥æ¡ˆä¾‹ä¸­ç”±è°æ¥å……å½“ã€‚</p><p>æœåŠ¡å‘˜ï¼š å°±æ˜¯è°ƒç”¨è€…è§’è‰²ï¼Œç”±å¥¹æ¥å‘èµ·å‘½ä»¤ã€‚</p><p>èµ„æ·±å¤§å¨ï¼š å°±æ˜¯æ¥æ”¶è€…è§’è‰²ï¼ŒçœŸæ­£å‘½ä»¤æ‰§è¡Œçš„å¯¹è±¡ã€‚</p><p>è®¢å•ï¼š å‘½ä»¤ä¸­åŒ…å«è®¢å•ã€‚</p><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å‘½ä»¤æ¨¡å¼.png" style="zoom:75%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span></span>;<span class="comment">//åªéœ€è¦å®šä¹‰ä¸€ä¸ªç»Ÿä¸€çš„æ‰§è¡Œæ–¹æ³•</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderCommand</span> <span class="keyword">implements</span> <span class="title">Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŒæœ‰æ¥å—è€…å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> SeniorChef receiver;</span><br><span class="line">    <span class="keyword">private</span> Order order;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OrderCommand</span><span class="params">(SeniorChef receiver, Order order)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.receiver = receiver;</span><br><span class="line">        <span class="keyword">this</span>.order = order;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span>  </span>&#123;</span><br><span class="line">        System.out.println(order.getDiningTable() + <span class="string">&quot;æ¡Œçš„è®¢å•ï¼š&quot;</span>);</span><br><span class="line">        Set&lt;String&gt; keys = order.getFoodDic().keySet();</span><br><span class="line">        <span class="keyword">for</span> (String key : keys) &#123;</span><br><span class="line">            receiver.makeFood(order.getFoodDic().get(key),key);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">100</span>);<span class="comment">//åœé¡¿ä¸€ä¸‹ æ¨¡æ‹Ÿåšé¥­çš„è¿‡ç¨‹</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        System.out.println(order.getDiningTable() + <span class="string">&quot;æ¡Œçš„é¥­å¼„å¥½äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span> </span>&#123;</span><br><span class="line">    <span class="comment">// é¤æ¡Œå·ç </span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> diningTable;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨æ¥å­˜å‚¨é¤åå¹¶è®°å½•ä»½æ•°</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Integer&gt; foodDic = <span class="keyword">new</span> HashMap&lt;String, Integer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDiningTable</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> diningTable;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDiningTable</span><span class="params">(<span class="keyword">int</span> diningTable)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.diningTable = diningTable;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;String, Integer&gt; <span class="title">getFoodDic</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> foodDic;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFoodDic</span><span class="params">(String name, <span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">        foodDic.put(name,num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// èµ„æ·±å¤§å¨ç±» æ˜¯å‘½ä»¤çš„Receiver</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SeniorChef</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeFood</span><span class="params">(<span class="keyword">int</span> num,String foodName)</span> </span>&#123;</span><br><span class="line">        System.out.println(num + <span class="string">&quot;ä»½&quot;</span> + foodName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Waitor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Command&gt; commands;<span class="comment">//å¯ä»¥æŒæœ‰å¾ˆå¤šçš„å‘½ä»¤å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Waitor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        commands = <span class="keyword">new</span> ArrayList();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCommand</span><span class="params">(Command cmd)</span></span>&#123;</span><br><span class="line">        commands.add(cmd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘å‡ºå‘½ä»¤ å–Š è®¢å•æ¥äº†ï¼Œå¨å¸ˆå¼€å§‹æ‰§è¡Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">orderUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¾å¥³æœåŠ¡å‘˜ï¼šå®å’šï¼Œå¤§å¨ï¼Œæ–°è®¢å•æ¥äº†.......&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; commands.size(); i++) &#123;</span><br><span class="line">            Command cmd = commands.get(i);</span><br><span class="line">            <span class="keyword">if</span> (cmd != <span class="keyword">null</span>) &#123;</span><br><span class="line">                cmd.execute();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»º2ä¸ªorder</span></span><br><span class="line">        Order order1 = <span class="keyword">new</span> Order();</span><br><span class="line">        order1.setDiningTable(<span class="number">1</span>);</span><br><span class="line">        order1.getFoodDic().put(<span class="string">&quot;è¥¿çº¢æŸ¿é¸¡è›‹é¢&quot;</span>,<span class="number">1</span>);</span><br><span class="line">        order1.getFoodDic().put(<span class="string">&quot;å°æ¯å¯ä¹&quot;</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        Order order2 = <span class="keyword">new</span> Order();</span><br><span class="line">        order2.setDiningTable(<span class="number">3</span>);</span><br><span class="line">        order2.getFoodDic().put(<span class="string">&quot;å°–æ¤’è‚‰ä¸ç›–é¥­&quot;</span>,<span class="number">1</span>);</span><br><span class="line">        order2.getFoodDic().put(<span class="string">&quot;å°æ¯é›ªç¢§&quot;</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºæ¥æ”¶è€…</span></span><br><span class="line">        SeniorChef receiver=<span class="keyword">new</span> SeniorChef();</span><br><span class="line">        <span class="comment">//å°†è®¢å•å’Œæ¥æ”¶è€…å°è£…æˆå‘½ä»¤å¯¹è±¡</span></span><br><span class="line">        OrderCommand cmd1 = <span class="keyword">new</span> OrderCommand(receiver, order1);</span><br><span class="line">        OrderCommand cmd2 = <span class="keyword">new</span> OrderCommand(receiver, order2);</span><br><span class="line">        <span class="comment">//åˆ›å»ºè°ƒç”¨è€… waitor</span></span><br><span class="line">        Waitor invoker = <span class="keyword">new</span> Waitor();</span><br><span class="line">        invoker.setCommand(cmd1);</span><br><span class="line">        invoker.setCommand(cmd2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å°†è®¢å•å¸¦åˆ°æŸœå° å¹¶å‘å¨å¸ˆå–Š è®¢å•æ¥äº†</span></span><br><span class="line">        invoker.orderUp();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-3-4-ä¼˜ç¼ºç‚¹"><a href="#6-3-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="6.3.4 ä¼˜ç¼ºç‚¹"></a>6.3.4 ä¼˜ç¼ºç‚¹</h3><p><strong>1ï¼Œä¼˜ç‚¹ï¼š</strong></p><ul><li>é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦ã€‚å‘½ä»¤æ¨¡å¼èƒ½å°†è°ƒç”¨æ“ä½œçš„å¯¹è±¡ä¸å®ç°è¯¥æ“ä½œçš„å¯¹è±¡è§£è€¦ã€‚</li><li>å¢åŠ æˆ–åˆ é™¤å‘½ä»¤éå¸¸æ–¹ä¾¿ã€‚é‡‡ç”¨å‘½ä»¤æ¨¡å¼å¢åŠ ä¸åˆ é™¤å‘½ä»¤ä¸ä¼šå½±å“å…¶ä»–ç±»ï¼Œå®ƒæ»¡è¶³â€œå¼€é—­åŸåˆ™â€ï¼Œå¯¹æ‰©å±•æ¯”è¾ƒçµæ´»ã€‚</li><li>å¯ä»¥å®ç°å®å‘½ä»¤ã€‚å‘½ä»¤æ¨¡å¼å¯ä»¥ä¸ç»„åˆæ¨¡å¼ç»“åˆï¼Œå°†å¤šä¸ªå‘½ä»¤è£…é…æˆä¸€ä¸ªç»„åˆå‘½ä»¤ï¼Œå³å®å‘½ä»¤ã€‚</li><li>æ–¹ä¾¿å®ç° Undo å’Œ Redo æ“ä½œã€‚å‘½ä»¤æ¨¡å¼å¯ä»¥ä¸åé¢ä»‹ç»çš„å¤‡å¿˜å½•æ¨¡å¼ç»“åˆï¼Œå®ç°å‘½ä»¤çš„æ’¤é”€ä¸æ¢å¤ã€‚</li></ul><p><strong>2ï¼Œç¼ºç‚¹ï¼š</strong></p><ul><li>ä½¿ç”¨å‘½ä»¤æ¨¡å¼å¯èƒ½ä¼šå¯¼è‡´æŸäº›ç³»ç»Ÿæœ‰è¿‡å¤šçš„å…·ä½“å‘½ä»¤ç±»ã€‚</li><li>ç³»ç»Ÿç»“æ„æ›´åŠ å¤æ‚ã€‚</li></ul><h3 id="6-3-5-ä½¿ç”¨åœºæ™¯"><a href="#6-3-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="6.3.5 ä½¿ç”¨åœºæ™¯"></a>6.3.5 ä½¿ç”¨åœºæ™¯</h3><ul><li>ç³»ç»Ÿéœ€è¦å°†è¯·æ±‚è°ƒç”¨è€…å’Œè¯·æ±‚æ¥æ”¶è€…è§£è€¦ï¼Œä½¿å¾—è°ƒç”¨è€…å’Œæ¥æ”¶è€…ä¸ç›´æ¥äº¤äº’ã€‚</li><li>ç³»ç»Ÿéœ€è¦åœ¨ä¸åŒçš„æ—¶é—´æŒ‡å®šè¯·æ±‚ã€å°†è¯·æ±‚æ’é˜Ÿå’Œæ‰§è¡Œè¯·æ±‚ã€‚</li><li>ç³»ç»Ÿéœ€è¦æ”¯æŒå‘½ä»¤çš„æ’¤é”€(Undo)æ“ä½œå’Œæ¢å¤(Redo)æ“ä½œã€‚</li></ul><h3 id="6-3-6-JDKæºç è§£æ"><a href="#6-3-6-JDKæºç è§£æ" class="headerlink" title="6.3.6 JDKæºç è§£æ"></a>6.3.6 JDKæºç è§£æ</h3><p>Runableæ˜¯ä¸€ä¸ªå…¸å‹å‘½ä»¤æ¨¡å¼ï¼ŒRunnableæ‹…å½“å‘½ä»¤çš„è§’è‰²ï¼ŒThreadå……å½“çš„æ˜¯è°ƒç”¨è€…ï¼Œstartæ–¹æ³•å°±æ˜¯å…¶æ‰§è¡Œæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‘½ä»¤æ¥å£(æŠ½è±¡å‘½ä»¤è§’è‰²)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Thread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Runnable target;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (threadStatus != <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalThreadStateException();</span><br><span class="line"></span><br><span class="line">        group.add(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> started = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            start0();</span><br><span class="line">            started = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!started) &#123;</span><br><span class="line">                    group.threadStartFailed(<span class="keyword">this</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Throwable ignore) &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">start0</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼šè°ƒç”¨ä¸€ä¸ªnativeæ–¹æ³•start0(),è°ƒç”¨ç³»ç»Ÿæ–¹æ³•ï¼Œå¼€å¯ä¸€ä¸ªçº¿ç¨‹ã€‚è€Œæ¥æ”¶è€…æ˜¯å¯¹ç¨‹åºå‘˜å¼€æ”¾çš„ï¼Œå¯ä»¥è‡ªå·±å®šä¹‰æ¥æ”¶è€…ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * jdk Runnable å‘½ä»¤æ¨¡å¼</span></span><br><span class="line"><span class="comment"> *TurnOffThread ï¼š å±äºå…·ä½“</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TurnOffThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">     <span class="keyword">private</span> Receiver receiver;</span><br><span class="line">    </span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="title">TurnOffThread</span><span class="params">(Receiver receiver)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">this</span>.receiver = receiver;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     receiver.turnOFF();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">         Receiver receiver = <span class="keyword">new</span> Receiver();</span><br><span class="line">         TurnOffThread turnOffThread = <span class="keyword">new</span> TurnOffThread(receiver);</span><br><span class="line">         Thread thread = <span class="keyword">new</span> Thread(turnOffThread);</span><br><span class="line">         thread.start();</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-4-è´£ä»»é“¾æ¨¡å¼"><a href="#6-4-è´£ä»»é“¾æ¨¡å¼" class="headerlink" title="6.4 è´£ä»»é“¾æ¨¡å¼"></a>6.4 è´£ä»»é“¾æ¨¡å¼</h2><h3 id="6-4-1-æ¦‚è¿°"><a href="#6-4-1-æ¦‚è¿°" class="headerlink" title="6.4.1 æ¦‚è¿°"></a>6.4.1 æ¦‚è¿°</h3><p>åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œå¸¸å¸¸ä¼šå‡ºç°è¿™æ ·çš„äº‹ä¾‹ï¼šä¸€ä¸ªè¯·æ±‚æœ‰å¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†ï¼Œä½†æ¯ä¸ªå¯¹è±¡çš„å¤„ç†æ¡ä»¶æˆ–æƒé™ä¸åŒã€‚ä¾‹å¦‚ï¼Œå…¬å¸å‘˜å·¥è¯·å‡ï¼Œå¯æ‰¹å‡çš„é¢†å¯¼æœ‰éƒ¨é—¨è´Ÿè´£äººã€å‰¯æ€»ç»ç†ã€æ€»ç»ç†ç­‰ï¼Œä½†æ¯ä¸ªé¢†å¯¼èƒ½æ‰¹å‡†çš„å¤©æ•°ä¸åŒï¼Œå‘˜å·¥å¿…é¡»æ ¹æ®è‡ªå·±è¦è¯·å‡çš„å¤©æ•°å»æ‰¾ä¸åŒçš„é¢†å¯¼ç­¾åï¼Œä¹Ÿå°±æ˜¯è¯´å‘˜å·¥å¿…é¡»è®°ä½æ¯ä¸ªé¢†å¯¼çš„å§“åã€ç”µè¯å’Œåœ°å€ç­‰ä¿¡æ¯ï¼Œè¿™å¢åŠ äº†éš¾åº¦ã€‚è¿™æ ·çš„ä¾‹å­è¿˜æœ‰å¾ˆå¤šï¼Œå¦‚æ‰¾é¢†å¯¼å‡ºå·®æŠ¥é”€ã€ç”Ÿæ´»ä¸­çš„â€œå‡»é¼“ä¼ èŠ±â€æ¸¸æˆç­‰ã€‚</p><p><strong>å®šä¹‰ï¼š</strong></p><p>åˆåèŒè´£é“¾æ¨¡å¼ï¼Œä¸ºäº†é¿å…è¯·æ±‚å‘é€è€…ä¸å¤šä¸ªè¯·æ±‚å¤„ç†è€…è€¦åˆåœ¨ä¸€èµ·ï¼Œå°†æ‰€æœ‰è¯·æ±‚çš„å¤„ç†è€…é€šè¿‡å‰ä¸€å¯¹è±¡è®°ä½å…¶ä¸‹ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨è€Œè¿æˆä¸€æ¡é“¾ï¼›å½“æœ‰è¯·æ±‚å‘ç”Ÿæ—¶ï¼Œå¯å°†è¯·æ±‚æ²¿ç€è¿™æ¡é“¾ä¼ é€’ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p><h3 id="6-4-2-ç»“æ„"><a href="#6-4-2-ç»“æ„" class="headerlink" title="6.4.2 ç»“æ„"></a>6.4.2 ç»“æ„</h3><p>èŒè´£é“¾æ¨¡å¼ä¸»è¦åŒ…å«ä»¥ä¸‹è§’è‰²:</p><ul><li>æŠ½è±¡å¤„ç†è€…ï¼ˆHandlerï¼‰è§’è‰²ï¼šå®šä¹‰ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¥å£ï¼ŒåŒ…å«æŠ½è±¡å¤„ç†æ–¹æ³•å’Œä¸€ä¸ªåç»§è¿æ¥ã€‚</li><li>å…·ä½“å¤„ç†è€…ï¼ˆConcrete Handlerï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡å¤„ç†è€…çš„å¤„ç†æ–¹æ³•ï¼Œåˆ¤æ–­èƒ½å¦å¤„ç†æœ¬æ¬¡è¯·æ±‚ï¼Œå¦‚æœå¯ä»¥å¤„ç†è¯·æ±‚åˆ™å¤„ç†ï¼Œå¦åˆ™å°†è¯¥è¯·æ±‚è½¬ç»™å®ƒçš„åç»§è€…ã€‚</li><li>å®¢æˆ·ç±»ï¼ˆClientï¼‰è§’è‰²ï¼šåˆ›å»ºå¤„ç†é“¾ï¼Œå¹¶å‘é“¾å¤´çš„å…·ä½“å¤„ç†è€…å¯¹è±¡æäº¤è¯·æ±‚ï¼Œå®ƒä¸å…³å¿ƒå¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’è¿‡ç¨‹ã€‚</li></ul><h3 id="6-4-3-æ¡ˆä¾‹å®ç°"><a href="#6-4-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="6.4.3 æ¡ˆä¾‹å®ç°"></a>6.4.3 æ¡ˆä¾‹å®ç°</h3><p>ç°éœ€è¦å¼€å‘ä¸€ä¸ªè¯·å‡æµç¨‹æ§åˆ¶ç³»ç»Ÿã€‚è¯·å‡ä¸€å¤©ä»¥ä¸‹çš„å‡åªéœ€è¦å°ç»„é•¿åŒæ„å³å¯ï¼›è¯·å‡1å¤©åˆ°3å¤©çš„å‡è¿˜éœ€è¦éƒ¨é—¨ç»ç†åŒæ„ï¼›è¯·æ±‚3å¤©åˆ°7å¤©è¿˜éœ€è¦æ€»ç»ç†åŒæ„æ‰è¡Œã€‚</p><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/è´£ä»»é“¾æ¨¡å¼.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¯·å‡æ¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LeaveRequest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;<span class="comment">//å§“å</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> num;<span class="comment">//è¯·å‡å¤©æ•°</span></span><br><span class="line">    <span class="keyword">private</span> String content;<span class="comment">//è¯·å‡å†…å®¹</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LeaveRequest</span><span class="params">(String name, <span class="keyword">int</span> num, String content)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.num = num;</span><br><span class="line">        <span class="keyword">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getNum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¤„ç†è€…æŠ½è±¡ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> NUM_ONE = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> NUM_THREE = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> NUM_SEVEN = <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¯¥é¢†å¯¼å¤„ç†çš„è¯·å‡å¤©æ•°åŒºé—´</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> numStart;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> numEnd;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é¢†å¯¼ä¸Šé¢è¿˜æœ‰é¢†å¯¼</span></span><br><span class="line">    <span class="keyword">private</span> Handler nextHandler;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®è¯·å‡å¤©æ•°èŒƒå›´ ä¸Šä¸å°é¡¶</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Handler</span><span class="params">(<span class="keyword">int</span> numStart)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.numStart = numStart;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®è¯·å‡å¤©æ•°èŒƒå›´</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Handler</span><span class="params">(<span class="keyword">int</span> numStart, <span class="keyword">int</span> numEnd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.numStart = numStart;</span><br><span class="line">        <span class="keyword">this</span>.numEnd = numEnd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®ä¸Šçº§é¢†å¯¼</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNextHandler</span><span class="params">(Handler nextHandler)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.nextHandler = nextHandler;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æäº¤è¯·å‡æ¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">submit</span><span class="params">(LeaveRequest leave)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">0</span> == <span class="keyword">this</span>.numStart)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœè¯·å‡å¤©æ•°è¾¾åˆ°è¯¥é¢†å¯¼è€…çš„å¤„ç†è¦æ±‚</span></span><br><span class="line">        <span class="keyword">if</span>(leave.getNum() &gt;= <span class="keyword">this</span>.numStart)&#123;</span><br><span class="line">            <span class="keyword">this</span>.handleLeave(leave);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//å¦‚æœè¿˜æœ‰ä¸Šçº§ å¹¶ä¸”è¯·å‡å¤©æ•°è¶…è¿‡äº†å½“å‰é¢†å¯¼çš„å¤„ç†èŒƒå›´</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">null</span> != <span class="keyword">this</span>.nextHandler &amp;&amp; leave.getNum() &gt; numEnd)&#123;</span><br><span class="line">                <span class="keyword">this</span>.nextHandler.submit(leave);<span class="comment">//ç»§ç»­æäº¤</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æµç¨‹ç»“æŸ&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å„çº§é¢†å¯¼å¤„ç†è¯·å‡æ¡æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">handleLeave</span><span class="params">(LeaveRequest leave)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å°ç»„é•¿</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GroupLeader</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GroupLeader</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å°ç»„é•¿å¤„ç†1-3å¤©çš„è¯·å‡</span></span><br><span class="line">        <span class="keyword">super</span>(Handler.NUM_ONE, Handler.NUM_THREE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">handleLeave</span><span class="params">(LeaveRequest leave)</span> </span>&#123;</span><br><span class="line">        System.out.println(leave.getName() + <span class="string">&quot;è¯·å‡&quot;</span> + leave.getNum() + <span class="string">&quot;å¤©,&quot;</span> + leave.getContent() + <span class="string">&quot;ã€‚&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å°ç»„é•¿å®¡æ‰¹ï¼šåŒæ„ã€‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éƒ¨é—¨ç»ç†</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Manager</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Manager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//éƒ¨é—¨ç»ç†å¤„ç†3-7å¤©çš„è¯·å‡</span></span><br><span class="line">        <span class="keyword">super</span>(Handler.NUM_THREE, Handler.NUM_SEVEN);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">handleLeave</span><span class="params">(LeaveRequest leave)</span> </span>&#123;</span><br><span class="line">        System.out.println(leave.getName() + <span class="string">&quot;è¯·å‡&quot;</span> + leave.getNum() + <span class="string">&quot;å¤©,&quot;</span> + leave.getContent() + <span class="string">&quot;ã€‚&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;éƒ¨é—¨ç»ç†å®¡æ‰¹ï¼šåŒæ„ã€‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ€»ç»ç†</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneralManager</span> <span class="keyword">extends</span> <span class="title">Handler</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GeneralManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//éƒ¨é—¨ç»ç†å¤„ç†7å¤©ä»¥ä¸Šçš„è¯·å‡</span></span><br><span class="line">        <span class="keyword">super</span>(Handler.NUM_SEVEN);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">handleLeave</span><span class="params">(LeaveRequest leave)</span> </span>&#123;</span><br><span class="line">        System.out.println(leave.getName() + <span class="string">&quot;è¯·å‡&quot;</span> + leave.getNum() + <span class="string">&quot;å¤©,&quot;</span> + leave.getContent() + <span class="string">&quot;ã€‚&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;æ€»ç»ç†å®¡æ‰¹ï¼šåŒæ„ã€‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è¯·å‡æ¡æ¥ä¸€å¼ </span></span><br><span class="line">        LeaveRequest leave = <span class="keyword">new</span> LeaveRequest(<span class="string">&quot;å°èŠ±&quot;</span>,<span class="number">5</span>,<span class="string">&quot;èº«ä½“ä¸é€‚&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å„ä½é¢†å¯¼</span></span><br><span class="line">        GroupLeader groupLeader = <span class="keyword">new</span> GroupLeader();</span><br><span class="line">        Manager manager = <span class="keyword">new</span> Manager();</span><br><span class="line">        GeneralManager generalManager = <span class="keyword">new</span> GeneralManager();</span><br><span class="line"></span><br><span class="line">        groupLeader.setNextHandler(manager);<span class="comment">//å°ç»„é•¿çš„é¢†å¯¼æ˜¯éƒ¨é—¨ç»ç†</span></span><br><span class="line">        manager.setNextHandler(generalManager);<span class="comment">//éƒ¨é—¨ç»ç†çš„é¢†å¯¼æ˜¯æ€»ç»ç†</span></span><br><span class="line">        <span class="comment">//ä¹‹æ‰€ä»¥åœ¨è¿™é‡Œè®¾ç½®ä¸Šçº§é¢†å¯¼ï¼Œæ˜¯å› ä¸ºå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚æ¥æ›´æ”¹è®¾ç½®ï¼Œå¦‚æœå®æˆ˜ä¸­ä¸Šçº§é¢†å¯¼äººéƒ½æ˜¯å›ºå®šçš„ï¼Œåˆ™å¯ä»¥ç§»åˆ°é¢†å¯¼å®ç°ç±»ä¸­ã€‚</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//æäº¤ç”³è¯·</span></span><br><span class="line">        groupLeader.submit(leave);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-4-4-ä¼˜ç¼ºç‚¹"><a href="#6-4-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="6.4.4 ä¼˜ç¼ºç‚¹"></a>6.4.4 ä¼˜ç¼ºç‚¹</h3><p><strong>1ï¼Œä¼˜ç‚¹ï¼š</strong></p><ul><li><p>é™ä½äº†å¯¹è±¡ä¹‹é—´çš„è€¦åˆåº¦</p><p>è¯¥æ¨¡å¼é™ä½äº†è¯·æ±‚å‘é€è€…å’Œæ¥æ”¶è€…çš„è€¦åˆåº¦ã€‚</p></li><li><p>å¢å¼ºäº†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§</p><p>å¯ä»¥æ ¹æ®éœ€è¦å¢åŠ æ–°çš„è¯·æ±‚å¤„ç†ç±»ï¼Œæ»¡è¶³å¼€é—­åŸåˆ™ã€‚</p></li><li><p>å¢å¼ºäº†ç»™å¯¹è±¡æŒ‡æ´¾èŒè´£çš„çµæ´»æ€§</p><p>å½“å·¥ä½œæµç¨‹å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥åŠ¨æ€åœ°æ”¹å˜é“¾å†…çš„æˆå‘˜æˆ–è€…ä¿®æ”¹å®ƒä»¬çš„æ¬¡åºï¼Œä¹Ÿå¯åŠ¨æ€åœ°æ–°å¢æˆ–è€…åˆ é™¤è´£ä»»ã€‚</p></li><li><p>è´£ä»»é“¾ç®€åŒ–äº†å¯¹è±¡ä¹‹é—´çš„è¿æ¥</p><p>ä¸€ä¸ªå¯¹è±¡åªéœ€ä¿æŒä¸€ä¸ªæŒ‡å‘å…¶åç»§è€…çš„å¼•ç”¨ï¼Œä¸éœ€ä¿æŒå…¶ä»–æ‰€æœ‰å¤„ç†è€…çš„å¼•ç”¨ï¼Œè¿™é¿å…äº†ä½¿ç”¨ä¼—å¤šçš„ if æˆ–è€… ifÂ·Â·Â·else è¯­å¥ã€‚</p></li><li><p>è´£ä»»åˆ†æ‹…</p><p>æ¯ä¸ªç±»åªéœ€è¦å¤„ç†è‡ªå·±è¯¥å¤„ç†çš„å·¥ä½œï¼Œä¸èƒ½å¤„ç†çš„ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¯¹è±¡å®Œæˆï¼Œæ˜ç¡®å„ç±»çš„è´£ä»»èŒƒå›´ï¼Œç¬¦åˆç±»çš„å•ä¸€èŒè´£åŸåˆ™ã€‚</p></li></ul><p><strong>2ï¼Œç¼ºç‚¹ï¼š</strong></p><ul><li>ä¸èƒ½ä¿è¯æ¯ä¸ªè¯·æ±‚ä¸€å®šè¢«å¤„ç†ã€‚ç”±äºä¸€ä¸ªè¯·æ±‚æ²¡æœ‰æ˜ç¡®çš„æ¥æ”¶è€…ï¼Œæ‰€ä»¥ä¸èƒ½ä¿è¯å®ƒä¸€å®šä¼šè¢«å¤„ç†ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¸€ç›´ä¼ åˆ°é“¾çš„æœ«ç«¯éƒ½å¾—ä¸åˆ°å¤„ç†ã€‚</li><li>å¯¹æ¯”è¾ƒé•¿çš„èŒè´£é“¾ï¼Œè¯·æ±‚çš„å¤„ç†å¯èƒ½æ¶‰åŠå¤šä¸ªå¤„ç†å¯¹è±¡ï¼Œç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä¸€å®šå½±å“ã€‚</li><li>èŒè´£é“¾å»ºç«‹çš„åˆç†æ€§è¦é å®¢æˆ·ç«¯æ¥ä¿è¯ï¼Œå¢åŠ äº†å®¢æˆ·ç«¯çš„å¤æ‚æ€§ï¼Œå¯èƒ½ä¼šç”±äºèŒè´£é“¾çš„é”™è¯¯è®¾ç½®è€Œå¯¼è‡´ç³»ç»Ÿå‡ºé”™ï¼Œå¦‚å¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨ã€‚</li></ul><h3 id="6-4-5-æºç è§£æ"><a href="#6-4-5-æºç è§£æ" class="headerlink" title="6.4.5 æºç è§£æ"></a>6.4.5 æºç è§£æ</h3><p>åœ¨javaWebåº”ç”¨å¼€å‘ä¸­ï¼ŒFilterChainæ˜¯èŒè´£é“¾ï¼ˆè¿‡æ»¤å™¨ï¼‰æ¨¡å¼çš„å…¸å‹åº”ç”¨ï¼Œä»¥ä¸‹æ˜¯Filterçš„æ¨¡æ‹Ÿå®ç°åˆ†æ:</p><ul><li><p>æ¨¡æ‹Ÿwebè¯·æ±‚Requestä»¥åŠwebå“åº”Response</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Request</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Response</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ¨¡æ‹Ÿwebè¿‡æ»¤å™¨Filter</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(Request req,Response res,FilterChain c)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ¨¡æ‹Ÿå®ç°å…·ä½“è¿‡æ»¤å™¨  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FirstFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(Request request, Response response, FilterChain chain)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;è¿‡æ»¤å™¨1 å‰ç½®å¤„ç†&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…ˆæ‰§è¡Œæ‰€æœ‰requestå†å€’åºæ‰§è¡Œæ‰€æœ‰response</span></span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;è¿‡æ»¤å™¨1 åç½®å¤„ç†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecondFilter</span>  <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(Request request, Response response, FilterChain chain)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;è¿‡æ»¤å™¨2 å‰ç½®å¤„ç†&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å…ˆæ‰§è¡Œæ‰€æœ‰requestå†å€’åºæ‰§è¡Œæ‰€æœ‰response</span></span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;è¿‡æ»¤å™¨2 åç½®å¤„ç†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ¨¡æ‹Ÿå®ç°è¿‡æ»¤å™¨é“¾FilterChain  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FilterChain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Filter&gt; filters = <span class="keyword">new</span> ArrayList&lt;Filter&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é“¾å¼è°ƒç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FilterChain <span class="title">addFilter</span><span class="params">(Filter filter)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.filters.add(filter);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(Request request, Response response)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index == filters.size()) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Filter filter = filters.get(index);</span><br><span class="line">        index++;</span><br><span class="line">        filter.doFilter(request, response, <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æµ‹è¯•ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Request  req = <span class="keyword">null</span>;</span><br><span class="line">        Response res = <span class="keyword">null</span> ;</span><br><span class="line"></span><br><span class="line">        FilterChain filterChain = <span class="keyword">new</span> FilterChain();</span><br><span class="line">        filterChain.addFilter(<span class="keyword">new</span> FirstFilter()).addFilter(<span class="keyword">new</span> SecondFilter());</span><br><span class="line">        filterChain.doFilter(req,res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="6-5-çŠ¶æ€æ¨¡å¼"><a href="#6-5-çŠ¶æ€æ¨¡å¼" class="headerlink" title="6.5 çŠ¶æ€æ¨¡å¼"></a>6.5 çŠ¶æ€æ¨¡å¼</h2><h3 id="6-5-1-æ¦‚è¿°"><a href="#6-5-1-æ¦‚è¿°" class="headerlink" title="6.5.1 æ¦‚è¿°"></a>6.5.1 æ¦‚è¿°</h3><p>ã€ä¾‹ã€‘é€šè¿‡æŒ‰é’®æ¥æ§åˆ¶ä¸€ä¸ªç”µæ¢¯çš„çŠ¶æ€ï¼Œä¸€ä¸ªç”µæ¢¯æœ‰å¼€é—¨çŠ¶æ€ï¼Œå…³é—¨çŠ¶æ€ï¼Œåœæ­¢çŠ¶æ€ï¼Œè¿è¡ŒçŠ¶æ€ã€‚æ¯ä¸€ç§çŠ¶æ€æ”¹å˜ï¼Œéƒ½æœ‰å¯èƒ½è¦æ ¹æ®å…¶ä»–çŠ¶æ€æ¥æ›´æ–°å¤„ç†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”µæ¢¯é—¨ç°åœ¨å¤„äºè¿è¡Œæ—¶çŠ¶æ€ï¼Œå°±ä¸èƒ½è¿›è¡Œå¼€é—¨æ“ä½œï¼Œè€Œå¦‚æœç”µæ¢¯é—¨æ˜¯åœæ­¢çŠ¶æ€ï¼Œå°±å¯ä»¥æ‰§è¡Œå¼€é—¨æ“ä½œã€‚</p><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/çŠ¶æ€æ¨¡å¼å‰.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ILift</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ç”µæ¢¯çš„4ä¸ªçŠ¶æ€</span></span><br><span class="line">    <span class="comment">//å¼€é—¨çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> OPENING_STATE = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//å…³é—¨çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> CLOSING_STATE = <span class="number">2</span>;</span><br><span class="line">    <span class="comment">//è¿è¡ŒçŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> RUNNING_STATE = <span class="number">3</span>;</span><br><span class="line">    <span class="comment">//åœæ­¢çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> STOPPING_STATE = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è®¾ç½®ç”µæ¢¯çš„çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(<span class="keyword">int</span> state)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯çš„åŠ¨ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Lift</span> <span class="keyword">implements</span> <span class="title">ILift</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> state;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setState</span><span class="params">(<span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = state;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œå…³é—¨åŠ¨ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">this</span>.state) &#123;</span><br><span class="line">            <span class="keyword">case</span> OPENING_STATE:</span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯å…³é—¨äº†ã€‚ã€‚ã€‚&quot;</span>);<span class="comment">//åªæœ‰å¼€é—¨çŠ¶æ€å¯ä»¥å…³é—­ç”µæ¢¯é—¨ï¼Œå¯ä»¥å¯¹åº”ç”µæ¢¯çŠ¶æ€è¡¨æ¥çœ‹</span></span><br><span class="line">                <span class="keyword">this</span>.setState(CLOSING_STATE);<span class="comment">//å…³é—¨ä¹‹åç”µæ¢¯å°±æ˜¯å…³é—­çŠ¶æ€äº†</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CLOSING_STATE:</span><br><span class="line">                <span class="comment">//do nothing //å·²ç»æ˜¯å…³é—¨çŠ¶æ€ï¼Œä¸èƒ½å…³é—¨</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RUNNING_STATE:</span><br><span class="line">                <span class="comment">//do nothing //è¿è¡Œæ—¶ç”µæ¢¯é—¨æ˜¯å…³ç€çš„ï¼Œä¸èƒ½å…³é—¨</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STOPPING_STATE:</span><br><span class="line">                <span class="comment">//do nothing //åœæ­¢æ—¶ç”µæ¢¯ä¹Ÿæ˜¯å…³ç€çš„ï¼Œä¸èƒ½å…³é—¨</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œå¼€é—¨åŠ¨ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">this</span>.state) &#123;</span><br><span class="line">            <span class="keyword">case</span> OPENING_STATE:<span class="comment">//é—¨å·²ç»å¼€äº†ï¼Œä¸èƒ½å†å¼€é—¨äº†</span></span><br><span class="line">                <span class="comment">//do nothing</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CLOSING_STATE:<span class="comment">//å…³é—¨çŠ¶æ€ï¼Œé—¨æ‰“å¼€:</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯é—¨æ‰“å¼€äº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="keyword">this</span>.setState(OPENING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RUNNING_STATE:</span><br><span class="line">                <span class="comment">//do nothing è¿è¡Œæ—¶ç”µæ¢¯ä¸èƒ½å¼€é—¨</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STOPPING_STATE:</span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯é—¨å¼€äº†ã€‚ã€‚ã€‚&quot;</span>);<span class="comment">//ç”µæ¢¯åœäº†ï¼Œå¯ä»¥å¼€é—¨äº†</span></span><br><span class="line">                <span class="keyword">this</span>.setState(OPENING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œè¿è¡ŒåŠ¨ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">this</span>.state) &#123;</span><br><span class="line">            <span class="keyword">case</span> OPENING_STATE:<span class="comment">//ç”µæ¢¯ä¸èƒ½å¼€ç€é—¨å°±èµ°</span></span><br><span class="line">                <span class="comment">//do nothing</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CLOSING_STATE:<span class="comment">//é—¨å…³äº†ï¼Œå¯ä»¥è¿è¡Œäº†</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯å¼€å§‹è¿è¡Œäº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="keyword">this</span>.setState(RUNNING_STATE);<span class="comment">//ç°åœ¨æ˜¯è¿è¡ŒçŠ¶æ€</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RUNNING_STATE:</span><br><span class="line">                <span class="comment">//do nothing å·²ç»æ˜¯è¿è¡ŒçŠ¶æ€äº†</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STOPPING_STATE:</span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯å¼€å§‹è¿è¡Œäº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="keyword">this</span>.setState(RUNNING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œåœæ­¢åŠ¨ä½œ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (<span class="keyword">this</span>.state) &#123;</span><br><span class="line">            <span class="keyword">case</span> OPENING_STATE: <span class="comment">//å¼€é—¨çš„ç”µæ¢¯å·²ç»æ˜¯æ˜¯åœæ­¢çš„äº†(æ­£å¸¸æƒ…å†µä¸‹)</span></span><br><span class="line">                <span class="comment">//do nothing</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CLOSING_STATE:<span class="comment">//å…³é—¨æ—¶æ‰å¯ä»¥åœæ­¢</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯åœæ­¢äº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="keyword">this</span>.setState(STOPPING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RUNNING_STATE:<span class="comment">//è¿è¡Œæ—¶å½“ç„¶å¯ä»¥åœæ­¢äº†</span></span><br><span class="line">                System.out.println(<span class="string">&quot;ç”µæ¢¯åœæ­¢äº†ã€‚ã€‚ã€‚&quot;</span>);</span><br><span class="line">                <span class="keyword">this</span>.setState(STOPPING_STATE);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> STOPPING_STATE:</span><br><span class="line">                <span class="comment">//do nothing</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Lift lift = <span class="keyword">new</span> Lift();</span><br><span class="line">        lift.setState(ILift.STOPPING_STATE);<span class="comment">//ç”µæ¢¯æ˜¯åœæ­¢çš„</span></span><br><span class="line">        lift.open();<span class="comment">//å¼€é—¨</span></span><br><span class="line">        lift.close();<span class="comment">//å…³é—¨</span></span><br><span class="line">        lift.run();<span class="comment">//è¿è¡Œ</span></span><br><span class="line">        lift.stop();<span class="comment">//åœæ­¢</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é—®é¢˜åˆ†æï¼š</p><ul><li>ä½¿ç”¨äº†å¤§é‡çš„switchâ€¦caseè¿™æ ·çš„åˆ¤æ–­ï¼ˆifâ€¦elseä¹Ÿæ˜¯ä¸€æ ·)ï¼Œä½¿ç¨‹åºçš„å¯é˜…è¯»æ€§å˜å·®ã€‚</li><li>æ‰©å±•æ€§å¾ˆå·®ã€‚å¦‚æœæ–°åŠ äº†æ–­ç”µçš„çŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸Šé¢åˆ¤æ–­é€»è¾‘</li></ul><p><strong>å®šä¹‰ï¼š</strong></p><p>å¯¹æœ‰çŠ¶æ€çš„å¯¹è±¡ï¼ŒæŠŠå¤æ‚çš„â€œåˆ¤æ–­é€»è¾‘â€æå–åˆ°ä¸åŒçš„çŠ¶æ€å¯¹è±¡ä¸­ï¼Œå…è®¸çŠ¶æ€å¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æ”¹å˜å…¶è¡Œä¸ºã€‚</p><h3 id="6-5-2-ç»“æ„"><a href="#6-5-2-ç»“æ„" class="headerlink" title="6.5.2 ç»“æ„"></a>6.5.2 ç»“æ„</h3><p>çŠ¶æ€æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²ã€‚</p><ul><li>ç¯å¢ƒï¼ˆContextï¼‰è§’è‰²ï¼šä¹Ÿç§°ä¸ºä¸Šä¸‹æ–‡ï¼Œå®ƒå®šä¹‰äº†å®¢æˆ·ç¨‹åºéœ€è¦çš„æ¥å£ï¼Œç»´æŠ¤ä¸€ä¸ªå½“å‰çŠ¶æ€ï¼Œå¹¶å°†ä¸çŠ¶æ€ç›¸å…³çš„æ“ä½œå§”æ‰˜ç»™å½“å‰çŠ¶æ€å¯¹è±¡æ¥å¤„ç†ã€‚</li><li>æŠ½è±¡çŠ¶æ€ï¼ˆStateï¼‰è§’è‰²ï¼šå®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œç”¨ä»¥å°è£…ç¯å¢ƒå¯¹è±¡ä¸­çš„ç‰¹å®šçŠ¶æ€æ‰€å¯¹åº”çš„è¡Œä¸ºã€‚</li><li>å…·ä½“çŠ¶æ€ï¼ˆConcrete  Stateï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡çŠ¶æ€æ‰€å¯¹åº”çš„è¡Œä¸ºã€‚</li></ul><h3 id="6-5-3-æ¡ˆä¾‹å®ç°"><a href="#6-5-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="6.5.3 æ¡ˆä¾‹å®ç°"></a>6.5.3 æ¡ˆä¾‹å®ç°</h3><p>å¯¹ä¸Šè¿°ç”µæ¢¯çš„æ¡ˆä¾‹ä½¿ç”¨çŠ¶æ€æ¨¡å¼è¿›è¡Œæ”¹è¿›ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/çŠ¶æ€æ¨¡å¼.png" style="zoom:70%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡çŠ¶æ€ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">LiftState</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªç¯å¢ƒè§’è‰²ï¼Œä¹Ÿå°±æ˜¯å°è£…çŠ¶æ€çš„å˜åŒ–å¼•èµ·çš„åŠŸèƒ½å˜åŒ–</span></span><br><span class="line">    <span class="keyword">protected</span> Context context;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContext</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.context = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯å¼€é—¨åŠ¨ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯å…³é—¨åŠ¨ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯è¿è¡ŒåŠ¨ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯åœæ­¢åŠ¨ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¼€å¯çŠ¶æ€</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OpenningState</span> <span class="keyword">extends</span> <span class="title">LiftState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¼€å¯å½“ç„¶å¯ä»¥å…³é—­äº†ï¼Œæˆ‘å°±æƒ³æµ‹è¯•ä¸€ä¸‹ç”µæ¢¯é—¨å¼€å…³åŠŸèƒ½</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µæ¢¯é—¨å¼€å¯...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//çŠ¶æ€ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.closeingState);</span><br><span class="line">        <span class="comment">//åŠ¨ä½œå§”æ‰˜ä¸ºCloseStateæ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å§”æ‰˜ç»™äº†ClosingStateå­ç±»æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œ</span></span><br><span class="line">        <span class="keyword">super</span>.context.getLiftState().close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨ä¸èƒ½å¼€ç€å°±è·‘ï¼Œè¿™é‡Œä»€ä¹ˆä¹Ÿä¸åš</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¼€é—¨çŠ¶æ€å·²ç»æ˜¯åœæ­¢çš„äº†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿è¡ŒçŠ¶æ€</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RunningState</span> <span class="keyword">extends</span> <span class="title">LiftState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿è¡Œçš„æ—¶å€™å¼€ç”µæ¢¯é—¨ï¼Ÿä½ ç–¯äº†ï¼ç”µæ¢¯ä¸ä¼šç»™ä½ å¼€çš„</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³é—­ï¼Ÿè¿™æ˜¯è‚¯å®šäº†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;<span class="comment">//è™½ç„¶å¯ä»¥å…³é—¨ï¼Œä½†è¿™ä¸ªåŠ¨ä½œä¸å½’æˆ‘æ‰§è¡Œ</span></span><br><span class="line">        <span class="comment">//do nothing</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿™æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸‹è¦å®ç°çš„æ–¹æ³•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µæ¢¯æ­£åœ¨è¿è¡Œ...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿™ä¸ªäº‹ç»å¯¹æ˜¯åˆç†çš„ï¼Œå…‰è¿è¡Œä¸åœæ­¢è¿˜æœ‰è°æ•¢åšè¿™ä¸ªç”µæ¢¯ï¼Ÿï¼ä¼°è®¡åªæœ‰ä¸Šå¸äº†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.stoppingState);</span><br><span class="line">        <span class="keyword">super</span>.context.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœæ­¢çŠ¶æ€</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StoppingState</span> <span class="keyword">extends</span> <span class="title">LiftState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœæ­¢çŠ¶æ€ï¼Œå¼€é—¨ï¼Œé‚£æ˜¯è¦çš„ï¼</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//çŠ¶æ€ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.openningState);</span><br><span class="line">        <span class="comment">//åŠ¨ä½œå§”æ‰˜ä¸ºCloseStateæ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å§”æ‰˜ç»™äº†ClosingStateå­ç±»æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œ</span></span><br><span class="line">        <span class="keyword">super</span>.context.getLiftState().open();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;<span class="comment">//è™½ç„¶å¯ä»¥å…³é—¨ï¼Œä½†è¿™ä¸ªåŠ¨ä½œä¸å½’æˆ‘æ‰§è¡Œ</span></span><br><span class="line">        <span class="comment">//çŠ¶æ€ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.closeingState);</span><br><span class="line">        <span class="comment">//åŠ¨ä½œå§”æ‰˜ä¸ºCloseStateæ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å§”æ‰˜ç»™äº†ClosingStateå­ç±»æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œ</span></span><br><span class="line">        <span class="keyword">super</span>.context.getLiftState().close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœæ­¢çŠ¶æ€å†è·‘èµ·æ¥ï¼Œæ­£å¸¸çš„å¾ˆ</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//çŠ¶æ€ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.runningState);</span><br><span class="line">        <span class="comment">//åŠ¨ä½œå§”æ‰˜ä¸ºCloseStateæ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å§”æ‰˜ç»™äº†ClosingStateå­ç±»æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œ</span></span><br><span class="line">        <span class="keyword">super</span>.context.getLiftState().run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœæ­¢çŠ¶æ€æ˜¯æ€ä¹ˆå‘ç”Ÿçš„å‘¢ï¼Ÿå½“ç„¶æ˜¯åœæ­¢æ–¹æ³•æ‰§è¡Œäº†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µæ¢¯åœæ­¢äº†...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…³é—­çŠ¶æ€</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClosingState</span> <span class="keyword">extends</span> <span class="title">LiftState</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³é—­ï¼Œè¿™æ˜¯å…³é—­çŠ¶æ€è¦å®ç°çš„åŠ¨ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”µæ¢¯é—¨å…³é—­...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³äº†å†æ‰“å¼€ï¼Œé€—ä½ ç©å‘¢ï¼Œé‚£è¿™ä¸ªå…è®¸å‘€</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.openningState);</span><br><span class="line">        <span class="keyword">super</span>.context.open();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³äº†å°±è·‘ï¼Œè¿™æ˜¯å†æ­£å¸¸ä¸è¿‡äº†</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.runningState);</span><br><span class="line">        <span class="keyword">super</span>.context.run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç”µæ¢¯é—¨å…³ç€ï¼Œæˆ‘å°±ä¸æŒ‰æ¥¼å±‚</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.context.setLiftState(Context.stoppingState);</span><br><span class="line">        <span class="keyword">super</span>.context.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¯å¢ƒè§’è‰²</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰å‡ºæ‰€æœ‰çš„ç”µæ¢¯çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> OpenningState openningState = <span class="keyword">new</span> OpenningState();<span class="comment">//å¼€é—¨çŠ¶æ€ï¼Œè¿™æ—¶å€™ç”µæ¢¯åªèƒ½å…³é—­</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> ClosingState closeingState = <span class="keyword">new</span> ClosingState();<span class="comment">//å…³é—­çŠ¶æ€ï¼Œè¿™æ—¶å€™ç”µæ¢¯å¯ä»¥è¿è¡Œã€åœæ­¢å’Œå¼€é—¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> RunningState runningState = <span class="keyword">new</span> RunningState();<span class="comment">//è¿è¡ŒçŠ¶æ€ï¼Œè¿™æ—¶å€™ç”µæ¢¯åªèƒ½åœæ­¢</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> StoppingState stoppingState = <span class="keyword">new</span> StoppingState();<span class="comment">//åœæ­¢çŠ¶æ€ï¼Œè¿™æ—¶å€™ç”µæ¢¯å¯ä»¥å¼€é—¨ã€è¿è¡Œ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®šä¹‰ä¸€ä¸ªå½“å‰ç”µæ¢¯çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">private</span> LiftState liftState;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LiftState <span class="title">getLiftState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.liftState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLiftState</span><span class="params">(LiftState liftState)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å½“å‰ç¯å¢ƒæ”¹å˜</span></span><br><span class="line">        <span class="keyword">this</span>.liftState = liftState;</span><br><span class="line">        <span class="comment">//æŠŠå½“å‰çš„ç¯å¢ƒé€šçŸ¥åˆ°å„ä¸ªå®ç°ç±»ä¸­</span></span><br><span class="line">        <span class="keyword">this</span>.liftState.setContext(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.liftState.open();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.liftState.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.liftState.run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.liftState.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Context context = <span class="keyword">new</span> Context();</span><br><span class="line">        context.setLiftState(<span class="keyword">new</span> ClosingState());</span><br><span class="line"></span><br><span class="line">        context.open();</span><br><span class="line">        context.close();</span><br><span class="line">        context.run();</span><br><span class="line">        context.stop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-5-4-ä¼˜ç¼ºç‚¹"><a href="#6-5-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="6.5.4 ä¼˜ç¼ºç‚¹"></a>6.5.4 ä¼˜ç¼ºç‚¹</h3><p><strong>1ï¼Œä¼˜ç‚¹ï¼š</strong></p><ul><li>å°†æ‰€æœ‰ä¸æŸä¸ªçŠ¶æ€æœ‰å…³çš„è¡Œä¸ºæ”¾åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œå¹¶ä¸”å¯ä»¥æ–¹ä¾¿åœ°å¢åŠ æ–°çš„çŠ¶æ€ï¼Œåªéœ€è¦æ”¹å˜å¯¹è±¡çŠ¶æ€å³å¯æ”¹å˜å¯¹è±¡çš„è¡Œä¸ºã€‚</li><li>å…è®¸çŠ¶æ€è½¬æ¢é€»è¾‘ä¸çŠ¶æ€å¯¹è±¡åˆæˆä¸€ä½“ï¼Œè€Œä¸æ˜¯æŸä¸€ä¸ªå·¨å¤§çš„æ¡ä»¶è¯­å¥å—ã€‚</li></ul><p><strong>2ï¼Œç¼ºç‚¹ï¼š</strong></p><ul><li>çŠ¶æ€æ¨¡å¼çš„ä½¿ç”¨å¿…ç„¶ä¼šå¢åŠ ç³»ç»Ÿç±»å’Œå¯¹è±¡çš„ä¸ªæ•°ã€‚ </li><li>çŠ¶æ€æ¨¡å¼çš„ç»“æ„ä¸å®ç°éƒ½è¾ƒä¸ºå¤æ‚ï¼Œå¦‚æœä½¿ç”¨ä¸å½“å°†å¯¼è‡´ç¨‹åºç»“æ„å’Œä»£ç çš„æ··ä¹±ã€‚</li><li>çŠ¶æ€æ¨¡å¼å¯¹â€å¼€é—­åŸåˆ™â€çš„æ”¯æŒå¹¶ä¸å¤ªå¥½ã€‚</li></ul><h3 id="6-5-5-ä½¿ç”¨åœºæ™¯"><a href="#6-5-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="6.5.5 ä½¿ç”¨åœºæ™¯"></a>6.5.5 ä½¿ç”¨åœºæ™¯</h3><ul><li>å½“ä¸€ä¸ªå¯¹è±¡çš„è¡Œä¸ºå–å†³äºå®ƒçš„çŠ¶æ€ï¼Œå¹¶ä¸”å®ƒå¿…é¡»åœ¨è¿è¡Œæ—¶æ ¹æ®çŠ¶æ€æ”¹å˜å®ƒçš„è¡Œä¸ºæ—¶ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨çŠ¶æ€æ¨¡å¼ã€‚</li><li>ä¸€ä¸ªæ“ä½œä¸­å«æœ‰åºå¤§çš„åˆ†æ”¯ç»“æ„ï¼Œå¹¶ä¸”è¿™äº›åˆ†æ”¯å†³å®šäºå¯¹è±¡çš„çŠ¶æ€æ—¶ã€‚</li></ul><h2 id="6-6-è§‚å¯Ÿè€…æ¨¡å¼"><a href="#6-6-è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="6.6 è§‚å¯Ÿè€…æ¨¡å¼"></a>6.6 è§‚å¯Ÿè€…æ¨¡å¼</h2><h3 id="6-6-1-æ¦‚è¿°"><a href="#6-6-1-æ¦‚è¿°" class="headerlink" title="6.6.1 æ¦‚è¿°"></a>6.6.1 æ¦‚è¿°</h3><p><strong>å®šä¹‰ï¼š</strong></p><p>åˆè¢«ç§°ä¸ºå‘å¸ƒ-è®¢é˜…ï¼ˆPublish/Subscribeï¼‰æ¨¡å¼ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…å¯¹è±¡åŒæ—¶ç›‘å¬æŸä¸€ä¸ªä¸»é¢˜å¯¹è±¡ã€‚è¿™ä¸ªä¸»é¢˜å¯¹è±¡åœ¨çŠ¶æ€å˜åŒ–æ—¶ï¼Œä¼šé€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä½¿ä»–ä»¬èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°è‡ªå·±ã€‚</p><h3 id="6-6-2-ç»“æ„"><a href="#6-6-2-ç»“æ„" class="headerlink" title="6.6.2 ç»“æ„"></a>6.6.2 ç»“æ„</h3><p>åœ¨è§‚å¯Ÿè€…æ¨¡å¼ä¸­æœ‰å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li>Subjectï¼šæŠ½è±¡ä¸»é¢˜ï¼ˆæŠ½è±¡è¢«è§‚å¯Ÿè€…ï¼‰ï¼ŒæŠ½è±¡ä¸»é¢˜è§’è‰²æŠŠæ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡ä¿å­˜åœ¨ä¸€ä¸ªé›†åˆé‡Œï¼Œæ¯ä¸ªä¸»é¢˜éƒ½å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„è§‚å¯Ÿè€…ï¼ŒæŠ½è±¡ä¸»é¢˜æä¾›ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥å¢åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡ã€‚</li><li>ConcreteSubjectï¼šå…·ä½“ä¸»é¢˜ï¼ˆå…·ä½“è¢«è§‚å¯Ÿè€…ï¼‰ï¼Œè¯¥è§’è‰²å°†æœ‰å…³çŠ¶æ€å­˜å…¥å…·ä½“è§‚å¯Ÿè€…å¯¹è±¡ï¼Œåœ¨å…·ä½“ä¸»é¢˜çš„å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œç»™æ‰€æœ‰æ³¨å†Œè¿‡çš„è§‚å¯Ÿè€…å‘é€é€šçŸ¥ã€‚</li><li>Observerï¼šæŠ½è±¡è§‚å¯Ÿè€…ï¼Œæ˜¯è§‚å¯Ÿè€…çš„æŠ½è±¡ç±»ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªæ›´æ–°æ¥å£ï¼Œä½¿å¾—åœ¨å¾—åˆ°ä¸»é¢˜æ›´æ”¹é€šçŸ¥æ—¶æ›´æ–°è‡ªå·±ã€‚</li><li>ConcrereObserverï¼šå…·ä½“è§‚å¯Ÿè€…ï¼Œå®ç°æŠ½è±¡è§‚å¯Ÿè€…å®šä¹‰çš„æ›´æ–°æ¥å£ï¼Œä»¥ä¾¿åœ¨å¾—åˆ°ä¸»é¢˜æ›´æ”¹é€šçŸ¥æ—¶æ›´æ–°è‡ªèº«çš„çŠ¶æ€ã€‚</li></ul><h3 id="6-6-3-æ¡ˆä¾‹å®ç°"><a href="#6-6-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="6.6.3 æ¡ˆä¾‹å®ç°"></a>6.6.3 æ¡ˆä¾‹å®ç°</h3><p>ã€ä¾‹ã€‘å¾®ä¿¡å…¬ä¼—å·</p><p>åœ¨ä½¿ç”¨å¾®ä¿¡å…¬ä¼—å·æ—¶ï¼Œå¤§å®¶éƒ½ä¼šæœ‰è¿™æ ·çš„ä½“éªŒï¼Œå½“ä½ å…³æ³¨çš„å…¬ä¼—å·ä¸­æœ‰æ–°å†…å®¹æ›´æ–°çš„è¯ï¼Œå®ƒå°±ä¼šæ¨é€ç»™å…³æ³¨å…¬ä¼—å·çš„å¾®ä¿¡ç”¨æˆ·ç«¯ã€‚æˆ‘ä»¬ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ¥æ¨¡æ‹Ÿè¿™æ ·çš„åœºæ™¯ï¼Œå¾®ä¿¡ç”¨æˆ·å°±æ˜¯è§‚å¯Ÿè€…ï¼Œå¾®ä¿¡å…¬ä¼—å·æ˜¯è¢«è§‚å¯Ÿè€…ï¼Œæœ‰å¤šä¸ªçš„å¾®ä¿¡ç”¨æˆ·å…³æ³¨äº†ç¨‹åºçŒ¿è¿™ä¸ªå…¬ä¼—å·ã€‚</p><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/è§‚å¯Ÿè€…æ¨¡å¼.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><p>å®šä¹‰æŠ½è±¡è§‚å¯Ÿè€…ç±»ï¼Œé‡Œé¢å®šä¹‰ä¸€ä¸ªæ›´æ–°çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(String message)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰å…·ä½“è§‚å¯Ÿè€…ç±»ï¼Œå¾®ä¿¡ç”¨æˆ·æ˜¯è§‚å¯Ÿè€…ï¼Œé‡Œé¢å®ç°äº†æ›´æ–°çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeixinUser</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¾®ä¿¡ç”¨æˆ·å</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WeixinUser</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        System.out.println(name + <span class="string">&quot;-&quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰æŠ½è±¡ä¸»é¢˜ç±»ï¼Œæä¾›äº†attachã€detachã€notifyä¸‰ä¸ªæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å¢åŠ è®¢é˜…è€…</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Observer observer)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ é™¤è®¢é˜…è€…</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">detach</span><span class="params">(Observer observer)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//é€šçŸ¥è®¢é˜…è€…æ›´æ–°æ¶ˆæ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">(String message)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¾®ä¿¡å…¬ä¼—å·æ˜¯å…·ä½“ä¸»é¢˜ï¼ˆå…·ä½“è¢«è§‚å¯Ÿè€…ï¼‰ï¼Œé‡Œé¢å­˜å‚¨äº†è®¢é˜…è¯¥å…¬ä¼—å·çš„å¾®ä¿¡ç”¨æˆ·ï¼Œå¹¶å®ç°äº†æŠ½è±¡ä¸»é¢˜ä¸­çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubscriptionSubject</span> <span class="keyword">implements</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å‚¨å­˜è®¢é˜…å…¬ä¼—å·çš„å¾®ä¿¡ç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Observer&gt; weixinUserlist = <span class="keyword">new</span> ArrayList&lt;Observer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        weixinUserlist.add(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">detach</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        weixinUserlist.remove(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Observer observer : weixinUserlist) &#123;</span><br><span class="line">            observer.update(message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯ç¨‹åº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SubscriptionSubject mSubscriptionSubject=<span class="keyword">new</span> SubscriptionSubject();</span><br><span class="line">        <span class="comment">//åˆ›å»ºå¾®ä¿¡ç”¨æˆ·</span></span><br><span class="line">        WeixinUser user1=<span class="keyword">new</span> WeixinUser(<span class="string">&quot;å­™æ‚Ÿç©º&quot;</span>);</span><br><span class="line">        WeixinUser user2=<span class="keyword">new</span> WeixinUser(<span class="string">&quot;çŒªæ‚Ÿèƒ½&quot;</span>);</span><br><span class="line">        WeixinUser user3=<span class="keyword">new</span> WeixinUser(<span class="string">&quot;æ²™æ‚Ÿå‡€&quot;</span>);</span><br><span class="line">        <span class="comment">//è®¢é˜…å…¬ä¼—å·</span></span><br><span class="line">        mSubscriptionSubject.attach(user1);</span><br><span class="line">        mSubscriptionSubject.attach(user2);</span><br><span class="line">        mSubscriptionSubject.attach(user3);</span><br><span class="line">        <span class="comment">//å…¬ä¼—å·æ›´æ–°å‘å‡ºæ¶ˆæ¯ç»™è®¢é˜…çš„å¾®ä¿¡ç”¨æˆ·</span></span><br><span class="line">        mSubscriptionSubject.notify(<span class="string">&quot;ä¼ æ™ºé»‘é©¬çš„ä¸“æ æ›´æ–°äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="6-6-4-ä¼˜ç¼ºç‚¹"><a href="#6-6-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="6.6.4 ä¼˜ç¼ºç‚¹"></a>6.6.4 ä¼˜ç¼ºç‚¹</h3><p><strong>1ï¼Œä¼˜ç‚¹ï¼š</strong></p><ul><li>é™ä½äº†ç›®æ ‡ä¸è§‚å¯Ÿè€…ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œä¸¤è€…ä¹‹é—´æ˜¯æŠ½è±¡è€¦åˆå…³ç³»ã€‚</li><li>è¢«è§‚å¯Ÿè€…å‘é€é€šçŸ¥ï¼Œæ‰€æœ‰æ³¨å†Œçš„è§‚å¯Ÿè€…éƒ½ä¼šæ”¶åˆ°ä¿¡æ¯ã€å¯ä»¥å®ç°å¹¿æ’­æœºåˆ¶ã€‘</li></ul><p><strong>2ï¼Œç¼ºç‚¹ï¼š</strong></p><ul><li>å¦‚æœè§‚å¯Ÿè€…éå¸¸å¤šçš„è¯ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„è§‚å¯Ÿè€…æ”¶åˆ°è¢«è§‚å¯Ÿè€…å‘é€çš„é€šçŸ¥ä¼šè€—æ—¶</li><li>å¦‚æœè¢«è§‚å¯Ÿè€…æœ‰å¾ªç¯ä¾èµ–çš„è¯ï¼Œé‚£ä¹ˆè¢«è§‚å¯Ÿè€…å‘é€é€šçŸ¥ä¼šä½¿è§‚å¯Ÿè€…å¾ªç¯è°ƒç”¨ï¼Œä¼šå¯¼è‡´ç³»ç»Ÿå´©æºƒ</li></ul><h3 id="6-6-5-ä½¿ç”¨åœºæ™¯"><a href="#6-6-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="6.6.5 ä½¿ç”¨åœºæ™¯"></a>6.6.5 ä½¿ç”¨åœºæ™¯</h3><ul><li>å¯¹è±¡é—´å­˜åœ¨ä¸€å¯¹å¤šå…³ç³»ï¼Œä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ä¼šå½±å“å…¶ä»–å¯¹è±¡ã€‚</li><li>å½“ä¸€ä¸ªæŠ½è±¡æ¨¡å‹æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹é¢ä¾èµ–äºå¦ä¸€æ–¹é¢æ—¶ã€‚</li></ul><h3 id="6-6-6-JDKä¸­æä¾›çš„å®ç°"><a href="#6-6-6-JDKä¸­æä¾›çš„å®ç°" class="headerlink" title="6.6.6 JDKä¸­æä¾›çš„å®ç°"></a>6.6.6 JDKä¸­æä¾›çš„å®ç°</h3><p>åœ¨ Java ä¸­ï¼Œé€šè¿‡ java.util.Observable ç±»å’Œ java.util.Observer æ¥å£å®šä¹‰äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œåªè¦å®ç°å®ƒä»¬çš„å­ç±»å°±å¯ä»¥ç¼–å†™è§‚å¯Ÿè€…æ¨¡å¼å®ä¾‹ã€‚</p><p><strong>1ï¼ŒObservableç±»</strong></p><p>Observable ç±»æ˜¯æŠ½è±¡ç›®æ ‡ç±»ï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰ï¼Œå®ƒæœ‰ä¸€ä¸ª Vector é›†åˆæˆå‘˜å˜é‡ï¼Œç”¨äºä¿å­˜æ‰€æœ‰è¦é€šçŸ¥çš„è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä¸‹é¢æ¥ä»‹ç»å®ƒæœ€é‡è¦çš„ 3 ä¸ªæ–¹æ³•ã€‚</p><ul><li><p>void addObserver(Observer o) æ–¹æ³•ï¼šç”¨äºå°†æ–°çš„è§‚å¯Ÿè€…å¯¹è±¡æ·»åŠ åˆ°é›†åˆä¸­ã€‚</p></li><li><p>void notifyObservers(Object arg) æ–¹æ³•ï¼šè°ƒç”¨é›†åˆä¸­çš„æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡çš„ updateæ–¹æ³•ï¼Œé€šçŸ¥å®ƒä»¬æ•°æ®å‘ç”Ÿæ”¹å˜ã€‚é€šå¸¸è¶Šæ™šåŠ å…¥é›†åˆçš„è§‚å¯Ÿè€…è¶Šå…ˆå¾—åˆ°é€šçŸ¥ã€‚</p></li><li><p>void setChange() æ–¹æ³•ï¼šç”¨æ¥è®¾ç½®ä¸€ä¸ª boolean ç±»å‹çš„å†…éƒ¨æ ‡å¿—ï¼Œæ³¨æ˜ç›®æ ‡å¯¹è±¡å‘ç”Ÿäº†å˜åŒ–ã€‚å½“å®ƒä¸ºtrueæ—¶ï¼ŒnotifyObservers() æ‰ä¼šé€šçŸ¥è§‚å¯Ÿè€…ã€‚</p></li></ul><p><strong>2ï¼ŒObserver æ¥å£</strong></p><p>Observer æ¥å£æ˜¯æŠ½è±¡è§‚å¯Ÿè€…ï¼Œå®ƒç›‘è§†ç›®æ ‡å¯¹è±¡çš„å˜åŒ–ï¼Œå½“ç›®æ ‡å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè§‚å¯Ÿè€…å¾—åˆ°é€šçŸ¥ï¼Œå¹¶è°ƒç”¨ update æ–¹æ³•ï¼Œè¿›è¡Œç›¸åº”çš„å·¥ä½œã€‚</p><p>ã€ä¾‹ã€‘è­¦å¯ŸæŠ“å°å·</p><p>è­¦å¯ŸæŠ“å°å·ä¹Ÿå¯ä»¥ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ¥å®ç°ï¼Œè­¦å¯Ÿæ˜¯è§‚å¯Ÿè€…ï¼Œå°å·æ˜¯è¢«è§‚å¯Ÿè€…ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><p>å°å·æ˜¯ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ï¼Œæ‰€ä»¥éœ€è¦ç»§æ‰¿Observableç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Thief</span> <span class="keyword">extends</span> <span class="title">Observable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Thief</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">steal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å°å·ï¼šæˆ‘å·ä¸œè¥¿äº†ï¼Œæœ‰æ²¡æœ‰äººæ¥æŠ“æˆ‘ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">super</span>.setChanged(); <span class="comment">//changed  = true</span></span><br><span class="line">        <span class="keyword">super</span>.notifyObservers();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è­¦å¯Ÿæ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…ï¼Œæ‰€ä»¥éœ€è¦è®©å…¶å®ç°Observeræ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Policemen</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Policemen</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Observable o, Object arg)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è­¦å¯Ÿï¼š&quot;</span> + ((Thief) o).getName() + <span class="string">&quot;ï¼Œæˆ‘å·²ç»ç›¯ä½ å¾ˆä¹…äº†ï¼Œä½ å¯ä»¥ä¿æŒæ²‰é»˜ï¼Œä½†ä½ æ‰€è¯´çš„å°†æˆä¸ºå‘ˆå ‚è¯ä¾›ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºå°å·å¯¹è±¡</span></span><br><span class="line">        Thief t = <span class="keyword">new</span> Thief(<span class="string">&quot;éš”å£è€ç‹&quot;</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºè­¦å¯Ÿå¯¹è±¡</span></span><br><span class="line">        Policemen p = <span class="keyword">new</span> Policemen(<span class="string">&quot;å°æ&quot;</span>);</span><br><span class="line">        <span class="comment">//è®©è­¦å¯Ÿç›¯ç€å°å·</span></span><br><span class="line">        t.addObserver(p);</span><br><span class="line">        <span class="comment">//å°å·å·ä¸œè¥¿</span></span><br><span class="line">        t.steal();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-7-ä¸­ä»‹è€…æ¨¡å¼"><a href="#6-7-ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="6.7 ä¸­ä»‹è€…æ¨¡å¼"></a>6.7 ä¸­ä»‹è€…æ¨¡å¼</h2><h3 id="6-7-1-æ¦‚è¿°"><a href="#6-7-1-æ¦‚è¿°" class="headerlink" title="6.7.1 æ¦‚è¿°"></a>6.7.1 æ¦‚è¿°</h3><p>ä¸€èˆ¬æ¥è¯´ï¼ŒåŒäº‹ç±»ä¹‹é—´çš„å…³ç³»æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå¤šä¸ªåŒäº‹ç±»ä¹‹é—´äº’ç›¸å…³è”æ—¶ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»ä¼šå‘ˆç°ä¸ºå¤æ‚çš„ç½‘çŠ¶ç»“æ„ï¼Œè¿™æ˜¯ä¸€ç§è¿‡åº¦è€¦åˆçš„æ¶æ„ï¼Œå³ä¸åˆ©äºç±»çš„å¤ç”¨ï¼Œä¹Ÿä¸ç¨³å®šã€‚ä¾‹å¦‚åœ¨ä¸‹å·¦å›¾ä¸­ï¼Œæœ‰å…­ä¸ªåŒäº‹ç±»å¯¹è±¡ï¼Œå‡å¦‚å¯¹è±¡1å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆå°†ä¼šæœ‰4ä¸ªå¯¹è±¡å—åˆ°å½±å“ã€‚å¦‚æœå¯¹è±¡2å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆå°†ä¼šæœ‰5ä¸ªå¯¹è±¡å—åˆ°å½±å“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒäº‹ç±»ä¹‹é—´ç›´æ¥å…³è”çš„è®¾è®¡æ˜¯ä¸å¥½çš„ã€‚</p><p>å¦‚æœå¼•å…¥ä¸­ä»‹è€…æ¨¡å¼ï¼Œé‚£ä¹ˆåŒäº‹ç±»ä¹‹é—´çš„å…³ç³»å°†å˜ä¸ºæ˜Ÿå‹ç»“æ„ï¼Œä»ä¸‹å³å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä»»ä½•ä¸€ä¸ªç±»çš„å˜åŠ¨ï¼Œåªä¼šå½±å“çš„ç±»æœ¬èº«ï¼Œä»¥åŠä¸­ä»‹è€…ï¼Œè¿™æ ·å°±å‡å°äº†ç³»ç»Ÿçš„è€¦åˆã€‚ä¸€ä¸ªå¥½çš„è®¾è®¡ï¼Œå¿…å®šä¸ä¼šæŠŠæ‰€æœ‰çš„å¯¹è±¡å…³ç³»å¤„ç†é€»è¾‘å°è£…åœ¨æœ¬ç±»ä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªä¸“é—¨çš„ç±»æ¥ç®¡ç†é‚£äº›ä¸å±äºè‡ªå·±çš„è¡Œä¸ºã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200214110924010.png" style="zoom:60%;" /><p><strong>å®šä¹‰ï¼š</strong></p><p>åˆå«è°ƒåœæ¨¡å¼ï¼Œå®šä¹‰ä¸€ä¸ªä¸­ä»‹è§’è‰²æ¥å°è£…ä¸€ç³»åˆ—å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œä½¿åŸæœ‰å¯¹è±¡ä¹‹é—´çš„è€¦åˆæ¾æ•£ï¼Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚</p><h3 id="6-7-2-ç»“æ„"><a href="#6-7-2-ç»“æ„" class="headerlink" title="6.7.2 ç»“æ„"></a>6.7.2 ç»“æ„</h3><p>ä¸­ä»‹è€…æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²ï¼š</p><ul><li><p>æŠ½è±¡ä¸­ä»‹è€…ï¼ˆMediatorï¼‰è§’è‰²ï¼šå®ƒæ˜¯ä¸­ä»‹è€…çš„æ¥å£ï¼Œæä¾›äº†åŒäº‹å¯¹è±¡æ³¨å†Œä¸è½¬å‘åŒäº‹å¯¹è±¡ä¿¡æ¯çš„æŠ½è±¡æ–¹æ³•ã€‚</p></li><li><p>å…·ä½“ä¸­ä»‹è€…ï¼ˆConcreteMediatorï¼‰è§’è‰²ï¼šå®ç°ä¸­ä»‹è€…æ¥å£ï¼Œå®šä¹‰ä¸€ä¸ª List æ¥ç®¡ç†åŒäº‹å¯¹è±¡ï¼Œåè°ƒå„ä¸ªåŒäº‹è§’è‰²ä¹‹é—´çš„äº¤äº’å…³ç³»ï¼Œå› æ­¤å®ƒä¾èµ–äºåŒäº‹è§’è‰²ã€‚</p></li><li><p>æŠ½è±¡åŒäº‹ç±»ï¼ˆColleagueï¼‰è§’è‰²ï¼šå®šä¹‰åŒäº‹ç±»çš„æ¥å£ï¼Œä¿å­˜ä¸­ä»‹è€…å¯¹è±¡ï¼Œæä¾›åŒäº‹å¯¹è±¡äº¤äº’çš„æŠ½è±¡æ–¹æ³•ï¼Œå®ç°æ‰€æœ‰ç›¸äº’å½±å“çš„åŒäº‹ç±»çš„å…¬å…±åŠŸèƒ½ã€‚</p></li><li><p>å…·ä½“åŒäº‹ç±»ï¼ˆConcrete Colleagueï¼‰è§’è‰²ï¼šæ˜¯æŠ½è±¡åŒäº‹ç±»çš„å®ç°è€…ï¼Œå½“éœ€è¦ä¸å…¶ä»–åŒäº‹å¯¹è±¡äº¤äº’æ—¶ï¼Œç”±ä¸­ä»‹è€…å¯¹è±¡è´Ÿè´£åç»­çš„äº¤äº’ã€‚</p></li></ul><h3 id="6-7-3-æ¡ˆä¾‹å®ç°"><a href="#6-7-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="6.7.3 æ¡ˆä¾‹å®ç°"></a>6.7.3 æ¡ˆä¾‹å®ç°</h3><p>ã€ä¾‹ã€‘ç§Ÿæˆ¿</p><p>ç°åœ¨ç§Ÿæˆ¿åŸºæœ¬éƒ½æ˜¯é€šè¿‡æˆ¿å±‹ä¸­ä»‹ï¼Œæˆ¿ä¸»å°†æˆ¿å±‹æ‰˜ç®¡ç»™æˆ¿å±‹ä¸­ä»‹ï¼Œè€Œç§Ÿæˆ¿è€…ä»æˆ¿å±‹ä¸­ä»‹è·å–æˆ¿å±‹ä¿¡æ¯ã€‚æˆ¿å±‹ä¸­ä»‹å……å½“ç§Ÿæˆ¿è€…ä¸æˆ¿å±‹æ‰€æœ‰è€…ä¹‹é—´çš„ä¸­ä»‹è€…ã€‚</p><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/ä¸­ä»‹è€…æ¨¡å¼.png" style="zoom:70%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡ä¸­ä»‹è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Mediator</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ç”³æ˜ä¸€ä¸ªè”ç»œæ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">constact</span><span class="params">(String message,Person person)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŠ½è±¡åŒäº‹ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> String name;</span><br><span class="line">    <span class="keyword">protected</span> Mediator mediator;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name,Mediator mediator)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.mediator = mediator;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…·ä½“åŒäº‹ç±» æˆ¿å±‹æ‹¥æœ‰è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HouseOwner</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HouseOwner</span><span class="params">(String name, Mediator mediator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name, mediator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸ä¸­ä»‹è€…è”ç³»</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">constact</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        mediator.constact(message, <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getMessage</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æˆ¿ä¸»&quot;</span> + name +<span class="string">&quot;è·å–åˆ°çš„ä¿¡æ¯ï¼š&quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å…·ä½“åŒäº‹ç±» æ‰¿ç§Ÿäºº</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tenant</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Tenant</span><span class="params">(String name, Mediator mediator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name, mediator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¸ä¸­ä»‹è€…è”ç³»</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">constact</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        mediator.constact(message, <span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getMessage</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç§Ÿæˆ¿è€…&quot;</span> + name +<span class="string">&quot;è·å–åˆ°çš„ä¿¡æ¯ï¼š&quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸­ä»‹æœºæ„</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MediatorStructure</span> <span class="keyword">extends</span> <span class="title">Mediator</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é¦–å…ˆä¸­ä»‹ç»“æ„å¿…é¡»çŸ¥é“æ‰€æœ‰æˆ¿ä¸»å’Œç§Ÿæˆ¿è€…çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">private</span> HouseOwner houseOwner;</span><br><span class="line">    <span class="keyword">private</span> Tenant tenant;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HouseOwner <span class="title">getHouseOwner</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> houseOwner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHouseOwner</span><span class="params">(HouseOwner houseOwner)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.houseOwner = houseOwner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Tenant <span class="title">getTenant</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> tenant;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTenant</span><span class="params">(Tenant tenant)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.tenant = tenant;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">constact</span><span class="params">(String message, Person person)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (person == houseOwner) &#123;          <span class="comment">//å¦‚æœæ˜¯æˆ¿ä¸»ï¼Œåˆ™ç§Ÿæˆ¿è€…è·å¾—ä¿¡æ¯</span></span><br><span class="line">            tenant.getMessage(message);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;       <span class="comment">//åæ­£åˆ™æ˜¯æˆ¿ä¸»è·å¾—ä¿¡æ¯</span></span><br><span class="line">            houseOwner.getMessage(message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ä¸€ä¸ªæˆ¿ä¸»ã€ä¸€ä¸ªç§Ÿæˆ¿è€…ã€ä¸€ä¸ªä¸­ä»‹æœºæ„</span></span><br><span class="line">        MediatorStructure mediator = <span class="keyword">new</span> MediatorStructure();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æˆ¿ä¸»å’Œç§Ÿæˆ¿è€…åªéœ€è¦çŸ¥é“ä¸­ä»‹æœºæ„å³å¯</span></span><br><span class="line">        HouseOwner houseOwner = <span class="keyword">new</span> HouseOwner(<span class="string">&quot;å¼ ä¸‰&quot;</span>, mediator);</span><br><span class="line">        Tenant tenant = <span class="keyword">new</span> Tenant(<span class="string">&quot;æå››&quot;</span>, mediator);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¸­ä»‹ç»“æ„è¦çŸ¥é“æˆ¿ä¸»å’Œç§Ÿæˆ¿è€…</span></span><br><span class="line">        mediator.setHouseOwner(houseOwner);</span><br><span class="line">        mediator.setTenant(tenant);</span><br><span class="line"></span><br><span class="line">        tenant.constact(<span class="string">&quot;éœ€è¦ç§Ÿä¸‰å®¤çš„æˆ¿å­&quot;</span>);</span><br><span class="line">        houseOwner.constact(<span class="string">&quot;æˆ‘è¿™æœ‰ä¸‰å®¤çš„æˆ¿å­ï¼Œä½ éœ€è¦ç§Ÿå—ï¼Ÿ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-7-4-ä¼˜ç¼ºç‚¹"><a href="#6-7-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="6.7.4 ä¼˜ç¼ºç‚¹"></a>6.7.4 ä¼˜ç¼ºç‚¹</h3><p><strong>1ï¼Œä¼˜ç‚¹ï¼š</strong></p><ul><li><p>æ¾æ•£è€¦åˆ</p><p>ä¸­ä»‹è€…æ¨¡å¼é€šè¿‡æŠŠå¤šä¸ªåŒäº‹å¯¹è±¡ä¹‹é—´çš„äº¤äº’å°è£…åˆ°ä¸­ä»‹è€…å¯¹è±¡é‡Œé¢ï¼Œä»è€Œä½¿å¾—åŒäº‹å¯¹è±¡ä¹‹é—´æ¾æ•£è€¦åˆï¼ŒåŸºæœ¬ä¸Šå¯ä»¥åšåˆ°äº’è¡¥ä¾èµ–ã€‚è¿™æ ·ä¸€æ¥ï¼ŒåŒäº‹å¯¹è±¡å°±å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–å’Œå¤ç”¨ï¼Œè€Œä¸å†åƒä»¥å‰é‚£æ ·â€œç‰µä¸€å¤„è€ŒåŠ¨å…¨èº«â€äº†ã€‚</p></li><li><p>é›†ä¸­æ§åˆ¶äº¤äº’</p><p>å¤šä¸ªåŒäº‹å¯¹è±¡çš„äº¤äº’ï¼Œè¢«å°è£…åœ¨ä¸­ä»‹è€…å¯¹è±¡é‡Œé¢é›†ä¸­ç®¡ç†ï¼Œä½¿å¾—è¿™äº›äº¤äº’è¡Œä¸ºå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œåªéœ€è¦ä¿®æ”¹ä¸­ä»‹è€…å¯¹è±¡å°±å¯ä»¥äº†ï¼Œå½“ç„¶å¦‚æœæ˜¯å·²ç»åšå¥½çš„ç³»ç»Ÿï¼Œé‚£ä¹ˆå°±æ‰©å±•ä¸­ä»‹è€…å¯¹è±¡ï¼Œè€Œå„ä¸ªåŒäº‹ç±»ä¸éœ€è¦åšä¿®æ”¹ã€‚</p></li><li><p>ä¸€å¯¹å¤šå…³è”è½¬å˜ä¸ºä¸€å¯¹ä¸€çš„å…³è”</p><p>æ²¡æœ‰ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼çš„æ—¶å€™ï¼ŒåŒäº‹å¯¹è±¡ä¹‹é—´çš„å…³ç³»é€šå¸¸æ˜¯ä¸€å¯¹å¤šçš„ï¼Œå¼•å…¥ä¸­ä»‹è€…å¯¹è±¡ä»¥åï¼Œä¸­ä»‹è€…å¯¹è±¡å’ŒåŒäº‹å¯¹è±¡çš„å…³ç³»é€šå¸¸å˜æˆåŒå‘çš„ä¸€å¯¹ä¸€ï¼Œè¿™ä¼šè®©å¯¹è±¡çš„å…³ç³»æ›´å®¹æ˜“ç†è§£å’Œå®ç°ã€‚</p></li></ul><p><strong>2ï¼Œç¼ºç‚¹ï¼š</strong></p><p>å½“åŒäº‹ç±»å¤ªå¤šæ—¶ï¼Œä¸­ä»‹è€…çš„èŒè´£å°†å¾ˆå¤§ï¼Œå®ƒä¼šå˜å¾—å¤æ‚è€Œåºå¤§ï¼Œä»¥è‡³äºç³»ç»Ÿéš¾ä»¥ç»´æŠ¤ã€‚</p><h3 id="6-7-5-ä½¿ç”¨åœºæ™¯"><a href="#6-7-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="6.7.5 ä½¿ç”¨åœºæ™¯"></a>6.7.5 ä½¿ç”¨åœºæ™¯</h3><ul><li>ç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´å­˜åœ¨å¤æ‚çš„å¼•ç”¨å…³ç³»ï¼Œç³»ç»Ÿç»“æ„æ··ä¹±ä¸”éš¾ä»¥ç†è§£ã€‚</li><li>å½“æƒ³åˆ›å»ºä¸€ä¸ªè¿è¡Œäºå¤šä¸ªç±»ä¹‹é—´çš„å¯¹è±¡ï¼Œåˆä¸æƒ³ç”Ÿæˆæ–°çš„å­ç±»æ—¶ã€‚</li></ul><h2 id="6-8-è¿­ä»£å™¨æ¨¡å¼"><a href="#6-8-è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="6.8 è¿­ä»£å™¨æ¨¡å¼"></a>6.8 è¿­ä»£å™¨æ¨¡å¼</h2><h3 id="6-8-1-æ¦‚è¿°"><a href="#6-8-1-æ¦‚è¿°" class="headerlink" title="6.8.1 æ¦‚è¿°"></a>6.8.1 æ¦‚è¿°</h3><p><strong>å®šä¹‰ï¼š</strong></p><p>æä¾›ä¸€ä¸ªå¯¹è±¡æ¥é¡ºåºè®¿é—®èšåˆå¯¹è±¡ä¸­çš„ä¸€ç³»åˆ—æ•°æ®ï¼Œè€Œä¸æš´éœ²èšåˆå¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚ </p><h3 id="6-8-2-ç»“æ„"><a href="#6-8-2-ç»“æ„" class="headerlink" title="6.8.2 ç»“æ„"></a>6.8.2 ç»“æ„</h3><p>è¿­ä»£å™¨æ¨¡å¼ä¸»è¦åŒ…å«ä»¥ä¸‹è§’è‰²ï¼š</p><ul><li><p>æŠ½è±¡èšåˆï¼ˆAggregateï¼‰è§’è‰²ï¼šå®šä¹‰å­˜å‚¨ã€æ·»åŠ ã€åˆ é™¤èšåˆå…ƒç´ ä»¥åŠåˆ›å»ºè¿­ä»£å™¨å¯¹è±¡çš„æ¥å£ã€‚</p></li><li><p>å…·ä½“èšåˆï¼ˆConcreteAggregateï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡èšåˆç±»ï¼Œè¿”å›ä¸€ä¸ªå…·ä½“è¿­ä»£å™¨çš„å®ä¾‹ã€‚</p></li><li><p>æŠ½è±¡è¿­ä»£å™¨ï¼ˆIteratorï¼‰è§’è‰²ï¼šå®šä¹‰è®¿é—®å’Œéå†èšåˆå…ƒç´ çš„æ¥å£ï¼Œé€šå¸¸åŒ…å« hasNext()ã€next() ç­‰æ–¹æ³•ã€‚</p></li><li><p>å…·ä½“è¿­ä»£å™¨ï¼ˆConcretelteratorï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡è¿­ä»£å™¨æ¥å£ä¸­æ‰€å®šä¹‰çš„æ–¹æ³•ï¼Œå®Œæˆå¯¹èšåˆå¯¹è±¡çš„éå†ï¼Œè®°å½•éå†çš„å½“å‰ä½ç½®ã€‚</p></li></ul><h3 id="6-8-3-æ¡ˆä¾‹å®ç°"><a href="#6-8-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="6.8.3 æ¡ˆä¾‹å®ç°"></a>6.8.3 æ¡ˆä¾‹å®ç°</h3><p>ã€ä¾‹ã€‘å®šä¹‰ä¸€ä¸ªå¯ä»¥å­˜å‚¨å­¦ç”Ÿå¯¹è±¡çš„å®¹å™¨å¯¹è±¡ï¼Œå°†éå†è¯¥å®¹å™¨çš„åŠŸèƒ½äº¤ç”±è¿­ä»£å™¨å®ç°ï¼Œæ¶‰åŠåˆ°çš„ç±»å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/è¿­ä»£å™¨æ¨¡å¼.png" style="zoom:90%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><p>å®šä¹‰è¿­ä»£å™¨æ¥å£ï¼Œå£°æ˜hasNextã€nextæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentIterator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">Student <span class="title">next</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰å…·ä½“çš„è¿­ä»£å™¨ç±»ï¼Œé‡å†™æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentIteratorImpl</span> <span class="keyword">implements</span> <span class="title">StudentIterator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; list;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> position = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StudentIteratorImpl</span><span class="params">(List&lt;Student&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.list = list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> position &lt; list.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Student currentStudent = list.get(position);</span><br><span class="line">        position ++;</span><br><span class="line">        <span class="keyword">return</span> currentStudent;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰æŠ½è±¡å®¹å™¨ç±»ï¼ŒåŒ…å«æ·»åŠ å…ƒç´ ï¼Œåˆ é™¤å…ƒç´ ï¼Œè·å–è¿­ä»£å™¨å¯¹è±¡çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentAggregate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addStudent</span><span class="params">(Student student)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">removeStudent</span><span class="params">(Student student)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">StudentIterator <span class="title">getStudentIterator</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰å…·ä½“çš„å®¹å™¨ç±»ï¼Œé‡å†™æ‰€æœ‰çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentAggregateImpl</span> <span class="keyword">implements</span> <span class="title">StudentAggregate</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; list = <span class="keyword">new</span> ArrayList&lt;Student&gt;();  <span class="comment">// å­¦ç”Ÿåˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addStudent</span><span class="params">(Student student)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.list.add(student);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeStudent</span><span class="params">(Student student)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.list.remove(student);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> StudentIterator <span class="title">getStudentIterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> StudentIteratorImpl(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-8-4-ä¼˜ç¼ºç‚¹"><a href="#6-8-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="6.8.4 ä¼˜ç¼ºç‚¹"></a>6.8.4 ä¼˜ç¼ºç‚¹</h3><p><strong>1ï¼Œä¼˜ç‚¹ï¼š</strong></p><ul><li>å®ƒæ”¯æŒä»¥ä¸åŒçš„æ–¹å¼éå†ä¸€ä¸ªèšåˆå¯¹è±¡ï¼Œåœ¨åŒä¸€ä¸ªèšåˆå¯¹è±¡ä¸Šå¯ä»¥å®šä¹‰å¤šç§éå†æ–¹å¼ã€‚åœ¨è¿­ä»£å™¨æ¨¡å¼ä¸­åªéœ€è¦ç”¨ä¸€ä¸ªä¸åŒçš„è¿­ä»£å™¨æ¥æ›¿æ¢åŸæœ‰è¿­ä»£å™¨å³å¯æ”¹å˜éå†ç®—æ³•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±å®šä¹‰è¿­ä»£å™¨çš„å­ç±»ä»¥æ”¯æŒæ–°çš„éå†æ–¹å¼ã€‚</li><li>è¿­ä»£å™¨ç®€åŒ–äº†èšåˆç±»ã€‚ç”±äºå¼•å…¥äº†è¿­ä»£å™¨ï¼Œåœ¨åŸæœ‰çš„èšåˆå¯¹è±¡ä¸­ä¸éœ€è¦å†è‡ªè¡Œæä¾›æ•°æ®éå†ç­‰æ–¹æ³•ï¼Œè¿™æ ·å¯ä»¥ç®€åŒ–èšåˆç±»çš„è®¾è®¡ã€‚</li><li>åœ¨è¿­ä»£å™¨æ¨¡å¼ä¸­ï¼Œç”±äºå¼•å…¥äº†æŠ½è±¡å±‚ï¼Œå¢åŠ æ–°çš„èšåˆç±»å’Œè¿­ä»£å™¨ç±»éƒ½å¾ˆæ–¹ä¾¿ï¼Œæ— é¡»ä¿®æ”¹åŸæœ‰ä»£ç ï¼Œæ»¡è¶³ â€œå¼€é—­åŸåˆ™â€ çš„è¦æ±‚ã€‚</li></ul><p><strong>2ï¼Œç¼ºç‚¹ï¼š</strong></p><p>å¢åŠ äº†ç±»çš„ä¸ªæ•°ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</p><h3 id="6-8-5-ä½¿ç”¨åœºæ™¯"><a href="#6-8-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="6.8.5 ä½¿ç”¨åœºæ™¯"></a>6.8.5 ä½¿ç”¨åœºæ™¯</h3><ul><li>å½“éœ€è¦ä¸ºèšåˆå¯¹è±¡æä¾›å¤šç§éå†æ–¹å¼æ—¶ã€‚</li><li>å½“éœ€è¦ä¸ºéå†ä¸åŒçš„èšåˆç»“æ„æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£æ—¶ã€‚</li><li>å½“è®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡çš„å†…å®¹è€Œæ— é¡»æš´éœ²å…¶å†…éƒ¨ç»†èŠ‚çš„è¡¨ç¤ºæ—¶ã€‚</li></ul><h3 id="6-8-6-JDKæºç è§£æ"><a href="#6-8-6-JDKæºç è§£æ" class="headerlink" title="6.8.6 JDKæºç è§£æ"></a>6.8.6 JDKæºç è§£æ</h3><p>è¿­ä»£å™¨æ¨¡å¼åœ¨JAVAçš„å¾ˆå¤šé›†åˆç±»ä¸­è¢«å¹¿æ³›åº”ç”¨ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹JAVAæºç ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">Iterator&lt;String&gt; iterator = list.iterator(); <span class="comment">//list.iterator()æ–¹æ³•è¿”å›çš„è‚¯å®šæ˜¯Iteratoræ¥å£çš„å­å®ç°ç±»å¯¹è±¡</span></span><br><span class="line"><span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">    System.out.println(iterator.next());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹å®Œè¿™æ®µä»£ç æ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œä¸æˆ‘ä»¬ä¸Šé¢ä»£ç åŸºæœ¬ç±»ä¼¼ã€‚å•åˆ—é›†åˆéƒ½ä½¿ç”¨åˆ°äº†è¿­ä»£å™¨ï¼Œæˆ‘ä»¬ä»¥ArrayListä¸¾ä¾‹æ¥è¯´æ˜</p><ul><li>Listï¼šæŠ½è±¡èšåˆç±»</li><li>ArrayListï¼šå…·ä½“çš„èšåˆç±»</li><li>Iteratorï¼šæŠ½è±¡è¿­ä»£å™¨</li><li>list.iterator()ï¼šè¿”å›çš„æ˜¯å®ç°äº† <code>Iterator</code> æ¥å£çš„å…·ä½“è¿­ä»£å™¨å¯¹è±¡</li></ul><p>å…·ä½“çš„æ¥çœ‹çœ‹ ArrayListçš„ä»£ç å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArrayList</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">AbstractList</span>&lt;<span class="title">E</span>&gt;</span></span><br><span class="line"><span class="class">        <span class="keyword">implements</span> <span class="title">List</span>&lt;<span class="title">E</span>&gt;, <span class="title">RandomAccess</span>, <span class="title">Cloneable</span>, <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;E&gt; <span class="title">iterator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Itr();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Itr</span> <span class="keyword">implements</span> <span class="title">Iterator</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cursor;       <span class="comment">// ä¸‹ä¸€ä¸ªè¦è¿”å›å…ƒç´ çš„ç´¢å¼•</span></span><br><span class="line">        <span class="keyword">int</span> lastRet = -<span class="number">1</span>; <span class="comment">// ä¸Šä¸€ä¸ªè¿”å›å…ƒç´ çš„ç´¢å¼•</span></span><br><span class="line">        <span class="keyword">int</span> expectedModCount = modCount;</span><br><span class="line"></span><br><span class="line">        Itr() &#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ˜¯å¦è¿˜æœ‰å…ƒç´ </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> cursor != size;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–ä¸‹ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> E <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            checkForComodification();</span><br><span class="line">            <span class="keyword">int</span> i = cursor;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= size)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException();</span><br><span class="line">            Object[] elementData = ArrayList.<span class="keyword">this</span>.elementData;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= elementData.length)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ConcurrentModificationException();</span><br><span class="line">            cursor = i + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> (E) elementData[lastRet = i];</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™éƒ¨åˆ†ä»£ç è¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼Œå¤§è‡´å°±æ˜¯åœ¨ <code>iterator</code> æ–¹æ³•ä¸­è¿”å›äº†ä¸€ä¸ªå®ä¾‹åŒ–çš„ <code>Iterator</code> å¯¹è±¡ã€‚Itræ˜¯ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œå®ƒå®ç°äº† <code>Iterator</code> æ¥å£å¹¶é‡å†™äº†å…¶ä¸­çš„æŠ½è±¡æ–¹æ³•ã€‚</p><blockquote><p>æ³¨æ„ï¼š </p><p>â€‹    å½“æˆ‘ä»¬åœ¨ä½¿ç”¨JAVAå¼€å‘çš„æ—¶å€™ï¼Œæƒ³ä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼çš„è¯ï¼Œåªè¦è®©æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å®¹å™¨ç±»å®ç°<code>java.util.Iterable</code>å¹¶å®ç°å…¶ä¸­çš„iterator()æ–¹æ³•ä½¿å…¶è¿”å›ä¸€ä¸ª <code>java.util.Iterator</code> çš„å®ç°ç±»å°±å¯ä»¥äº†ã€‚</p><p>ç±»æ¯”æœ¬æ¡ˆä¾‹ï¼š</p><p>è¿”å›ä¸€ä¸ª <code>java.util.Iterator</code> çš„å®ç°ç±»å°±ç›¸å½“äºè¿”å›ä¸€ä¸ªStudentIteratorï¼ˆå…·ä½“è¿­ä»£å™¨ç±»ï¼‰</p><p>è€Œ Iterator å°±æ˜¯æŠ½è±¡è¿­ä»£å™¨æ¥å£</p></blockquote><h2 id="6-9-è®¿é—®è€…æ¨¡å¼"><a href="#6-9-è®¿é—®è€…æ¨¡å¼" class="headerlink" title="6.9 è®¿é—®è€…æ¨¡å¼"></a>6.9 è®¿é—®è€…æ¨¡å¼</h2><h3 id="6-9-1-æ¦‚è¿°"><a href="#6-9-1-æ¦‚è¿°" class="headerlink" title="6.9.1 æ¦‚è¿°"></a>6.9.1 æ¦‚è¿°</h3><p><strong>å®šä¹‰ï¼š</strong></p><p>å°è£…ä¸€äº›ä½œç”¨äºæŸç§æ•°æ®ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œï¼Œå®ƒå¯ä»¥åœ¨ä¸æ”¹å˜è¿™ä¸ªæ•°æ®ç»“æ„çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°çš„æ“ä½œã€‚</p><h3 id="6-9-2-ç»“æ„"><a href="#6-9-2-ç»“æ„" class="headerlink" title="6.9.2 ç»“æ„"></a>6.9.2 ç»“æ„</h3><p>è®¿é—®è€…æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²:</p><ul><li>æŠ½è±¡è®¿é—®è€…ï¼ˆVisitorï¼‰è§’è‰²ï¼šå®šä¹‰äº†å¯¹æ¯ä¸€ä¸ªå…ƒç´ <code>ï¼ˆElementï¼‰</code>è®¿é—®çš„è¡Œä¸ºï¼Œå®ƒçš„å‚æ•°å°±æ˜¯å¯ä»¥è®¿é—®çš„å…ƒç´ ï¼Œå®ƒçš„æ–¹æ³•ä¸ªæ•°ç†è®ºä¸Šæ¥è®²ä¸å…ƒç´ ç±»ä¸ªæ•°ï¼ˆElementçš„å®ç°ç±»ä¸ªæ•°ï¼‰æ˜¯ä¸€æ ·çš„ï¼Œä»è¿™ç‚¹ä¸éš¾çœ‹å‡ºï¼Œè®¿é—®è€…æ¨¡å¼è¦æ±‚å…ƒç´ ç±»çš„ä¸ªæ•°ä¸èƒ½æ”¹å˜ã€‚</li><li>å…·ä½“è®¿é—®è€…ï¼ˆConcreteVisitorï¼‰è§’è‰²ï¼šç»™å‡ºå¯¹æ¯ä¸€ä¸ªå…ƒç´ ç±»è®¿é—®æ—¶æ‰€äº§ç”Ÿçš„å…·ä½“è¡Œä¸ºã€‚</li><li>æŠ½è±¡å…ƒç´ ï¼ˆElementï¼‰è§’è‰²ï¼šå®šä¹‰äº†ä¸€ä¸ªæ¥å—è®¿é—®è€…çš„æ–¹æ³•ï¼ˆ<code>accept</code>ï¼‰ï¼Œå…¶æ„ä¹‰æ˜¯æŒ‡ï¼Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½è¦å¯ä»¥è¢«è®¿é—®è€…è®¿é—®ã€‚</li><li>å…·ä½“å…ƒç´ ï¼ˆConcreteElementï¼‰è§’è‰²ï¼š æä¾›æ¥å—è®¿é—®æ–¹æ³•çš„å…·ä½“å®ç°ï¼Œè€Œè¿™ä¸ªå…·ä½“çš„å®ç°ï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯ä½¿ç”¨è®¿é—®è€…æä¾›çš„è®¿é—®è¯¥å…ƒç´ ç±»çš„æ–¹æ³•ã€‚</li><li>å¯¹è±¡ç»“æ„ï¼ˆObject Structureï¼‰è§’è‰²ï¼šå®šä¹‰å½“ä¸­æ‰€æåˆ°çš„å¯¹è±¡ç»“æ„ï¼Œå¯¹è±¡ç»“æ„æ˜¯ä¸€ä¸ªæŠ½è±¡è¡¨è¿°ï¼Œå…·ä½“ç‚¹å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå…·æœ‰å®¹å™¨æ€§è´¨æˆ–è€…å¤åˆå¯¹è±¡ç‰¹æ€§çš„ç±»ï¼Œå®ƒä¼šå«æœ‰ä¸€ç»„å…ƒç´ ï¼ˆ<code>Element</code>ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥è¿­ä»£è¿™äº›å…ƒç´ ï¼Œä¾›è®¿é—®è€…è®¿é—®ã€‚</li></ul><h3 id="6-9-3-æ¡ˆä¾‹å®ç°"><a href="#6-9-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="6.9.3 æ¡ˆä¾‹å®ç°"></a>6.9.3 æ¡ˆä¾‹å®ç°</h3><p>ã€ä¾‹ã€‘ç»™å® ç‰©å–‚é£Ÿ</p><p>ç°åœ¨å…»å® ç‰©çš„äººç‰¹åˆ«å¤šï¼Œæˆ‘ä»¬å°±ä»¥è¿™ä¸ªä¸ºä¾‹ï¼Œå½“ç„¶å® ç‰©è¿˜åˆ†ä¸ºç‹—ï¼ŒçŒ«ç­‰ï¼Œè¦ç»™å® ç‰©å–‚é£Ÿçš„è¯ï¼Œä¸»äººå¯ä»¥å–‚ï¼Œå…¶ä»–äººä¹Ÿå¯ä»¥å–‚é£Ÿã€‚</p><ul><li>è®¿é—®è€…è§’è‰²ï¼šç»™å® ç‰©å–‚é£Ÿçš„äºº</li><li>å…·ä½“è®¿é—®è€…è§’è‰²ï¼šä¸»äººã€å…¶ä»–äºº</li><li>æŠ½è±¡å…ƒç´ è§’è‰²ï¼šåŠ¨ç‰©æŠ½è±¡ç±»</li><li>å…·ä½“å…ƒç´ è§’è‰²ï¼šå® ç‰©ç‹—ã€å® ç‰©çŒ«</li><li>ç»“æ„å¯¹è±¡è§’è‰²ï¼šä¸»äººå®¶</li></ul><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F.png"></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><p>åˆ›å»ºæŠ½è±¡è®¿é—®è€…æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">feed</span><span class="params">(Cat cat)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">feed</span><span class="params">(Dog dog)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸åŒçš„å…·ä½“è®¿é—®è€…è§’è‰²ï¼ˆä¸»äººå’Œå…¶ä»–äººï¼‰ï¼Œéƒ½éœ€è¦å®ç° <code>Person</code>æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Owner</span> <span class="keyword">implements</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">feed</span><span class="params">(Cat cat)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸»äººå–‚é£ŸçŒ«&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">feed</span><span class="params">(Dog dog)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¸»äººå–‚é£Ÿç‹—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Someone</span> <span class="keyword">implements</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">feed</span><span class="params">(Cat cat)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…¶ä»–äººå–‚é£ŸçŒ«&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">feed</span><span class="params">(Dog dog)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…¶ä»–äººå–‚é£Ÿç‹—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰æŠ½è±¡èŠ‚ç‚¹ â€“ å® ç‰©</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">accept</span><span class="params">(Person person)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰å®ç°<code>Animal</code>æ¥å£çš„ å…·ä½“èŠ‚ç‚¹ï¼ˆå…ƒç´ ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">implements</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Person person)</span> </span>&#123;</span><br><span class="line">        person.feed(<span class="keyword">this</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å¥½å¥½åƒï¼Œæ±ªæ±ªæ±ªï¼ï¼ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">implements</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Person person)</span> </span>&#123;</span><br><span class="line">        person.feed(<span class="keyword">this</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å¥½å¥½åƒï¼Œå–µå–µå–µï¼ï¼ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰å¯¹è±¡ç»“æ„ï¼Œæ­¤æ¡ˆä¾‹ä¸­å°±æ˜¯ä¸»äººçš„å®¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Home</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Animal&gt; nodeList = <span class="keyword">new</span> ArrayList&lt;Animal&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">action</span><span class="params">(Person person)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Animal node : nodeList) &#123;</span><br><span class="line">            node.accept(person);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ·»åŠ æ“ä½œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Animal animal)</span> </span>&#123;</span><br><span class="line">        nodeList.add(animal);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Home home = <span class="keyword">new</span> Home();</span><br><span class="line">        home.add(<span class="keyword">new</span> Dog());</span><br><span class="line">        home.add(<span class="keyword">new</span> Cat());</span><br><span class="line"></span><br><span class="line">        Owner owner = <span class="keyword">new</span> Owner();</span><br><span class="line">        home.action(owner);</span><br><span class="line"></span><br><span class="line">        Someone someone = <span class="keyword">new</span> Someone();</span><br><span class="line">        home.action(someone);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-9-4-ä¼˜ç¼ºç‚¹"><a href="#6-9-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="6.9.4 ä¼˜ç¼ºç‚¹"></a>6.9.4 ä¼˜ç¼ºç‚¹</h3><p><strong>1ï¼Œä¼˜ç‚¹ï¼š</strong></p><ul><li><p>æ‰©å±•æ€§å¥½</p><p>åœ¨ä¸ä¿®æ”¹å¯¹è±¡ç»“æ„ä¸­çš„å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œä¸ºå¯¹è±¡ç»“æ„ä¸­çš„å…ƒç´ æ·»åŠ æ–°çš„åŠŸèƒ½ã€‚</p></li><li><p>å¤ç”¨æ€§å¥½</p><p>é€šè¿‡è®¿é—®è€…æ¥å®šä¹‰æ•´ä¸ªå¯¹è±¡ç»“æ„é€šç”¨çš„åŠŸèƒ½ï¼Œä»è€Œæé«˜å¤ç”¨ç¨‹åº¦ã€‚</p></li><li><p>åˆ†ç¦»æ— å…³è¡Œä¸º</p><p>é€šè¿‡è®¿é—®è€…æ¥åˆ†ç¦»æ— å…³çš„è¡Œä¸ºï¼ŒæŠŠç›¸å…³çš„è¡Œä¸ºå°è£…åœ¨ä¸€èµ·ï¼Œæ„æˆä¸€ä¸ªè®¿é—®è€…ï¼Œè¿™æ ·æ¯ä¸€ä¸ªè®¿é—®è€…çš„åŠŸèƒ½éƒ½æ¯”è¾ƒå•ä¸€ã€‚</p></li></ul><p><strong>2ï¼Œç¼ºç‚¹ï¼š</strong></p><ul><li><p>å¯¹è±¡ç»“æ„å˜åŒ–å¾ˆå›°éš¾</p><p>åœ¨è®¿é—®è€…æ¨¡å¼ä¸­ï¼Œæ¯å¢åŠ ä¸€ä¸ªæ–°çš„å…ƒç´ ç±»ï¼Œéƒ½è¦åœ¨æ¯ä¸€ä¸ªå…·ä½“è®¿é—®è€…ç±»ä¸­å¢åŠ ç›¸åº”çš„å…·ä½“æ“ä½œï¼Œè¿™è¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€ã€‚</p></li><li><p>è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™</p><p>è®¿é—®è€…æ¨¡å¼ä¾èµ–äº†å…·ä½“ç±»ï¼Œè€Œæ²¡æœ‰ä¾èµ–æŠ½è±¡ç±»ã€‚</p></li></ul><h3 id="6-9-5-ä½¿ç”¨åœºæ™¯"><a href="#6-9-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="6.9.5  ä½¿ç”¨åœºæ™¯"></a>6.9.5  ä½¿ç”¨åœºæ™¯</h3><ul><li><p>å¯¹è±¡ç»“æ„ç›¸å¯¹ç¨³å®šï¼Œä½†å…¶æ“ä½œç®—æ³•ç»å¸¸å˜åŒ–çš„ç¨‹åºã€‚</p></li><li><p>å¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡éœ€è¦æä¾›å¤šç§ä¸åŒä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œä¸”è¦é¿å…è®©è¿™äº›æ“ä½œçš„å˜åŒ–å½±å“å¯¹è±¡çš„ç»“æ„ã€‚</p></li></ul><h3 id="6-9-6-æ‰©å±•"><a href="#6-9-6-æ‰©å±•" class="headerlink" title="6.9.6 æ‰©å±•"></a>6.9.6 æ‰©å±•</h3><p>è®¿é—®è€…æ¨¡å¼ç”¨åˆ°äº†ä¸€ç§åŒåˆ†æ´¾çš„æŠ€æœ¯ã€‚</p><p><strong>1ï¼Œåˆ†æ´¾ï¼š</strong></p><p>å˜é‡è¢«å£°æ˜æ—¶çš„ç±»å‹å«åšå˜é‡çš„é™æ€ç±»å‹ï¼Œæœ‰äº›äººåˆæŠŠé™æ€ç±»å‹å«åšæ˜æ˜¾ç±»å‹ï¼›è€Œå˜é‡æ‰€å¼•ç”¨çš„å¯¹è±¡çš„çœŸå®ç±»å‹åˆå«åšå˜é‡çš„å®é™…ç±»å‹ã€‚æ¯”å¦‚ <code>Map map = new HashMap()</code> ï¼Œmapå˜é‡çš„é™æ€ç±»å‹æ˜¯ <code>Map</code> ï¼Œå®é™…ç±»å‹æ˜¯ <code>HashMap</code> ã€‚æ ¹æ®å¯¹è±¡çš„ç±»å‹è€Œå¯¹æ–¹æ³•è¿›è¡Œçš„é€‰æ‹©ï¼Œå°±æ˜¯åˆ†æ´¾(Dispatch)ï¼Œåˆ†æ´¾(Dispatch)åˆåˆ†ä¸ºä¸¤ç§ï¼Œå³é™æ€åˆ†æ´¾å’ŒåŠ¨æ€åˆ†æ´¾ã€‚</p><p><strong>é™æ€åˆ†æ´¾(Static Dispatch)</strong> å‘ç”Ÿåœ¨ç¼–è¯‘æ—¶æœŸï¼Œåˆ†æ´¾æ ¹æ®é™æ€ç±»å‹ä¿¡æ¯å‘ç”Ÿã€‚é™æ€åˆ†æ´¾å¯¹äºæˆ‘ä»¬æ¥è¯´å¹¶ä¸é™Œç”Ÿï¼Œæ–¹æ³•é‡è½½å°±æ˜¯é™æ€åˆ†æ´¾ã€‚</p><p><strong>åŠ¨æ€åˆ†æ´¾(Dynamic Dispatch)</strong> å‘ç”Ÿåœ¨è¿è¡Œæ—¶æœŸï¼ŒåŠ¨æ€åˆ†æ´¾åŠ¨æ€åœ°ç½®æ¢æ‰æŸä¸ªæ–¹æ³•ã€‚Javaé€šè¿‡æ–¹æ³•çš„é‡å†™æ”¯æŒåŠ¨æ€åˆ†æ´¾ã€‚</p><p><strong>2ï¼ŒåŠ¨æ€åˆ†æ´¾ï¼š</strong></p><p>é€šè¿‡æ–¹æ³•çš„é‡å†™æ”¯æŒåŠ¨æ€åˆ†æ´¾ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Animal&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dog&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;cat&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Animal a = <span class="keyword">new</span> Dog();</span><br><span class="line">        a.execute();</span><br><span class="line">        </span><br><span class="line">        Animal a1 = <span class="keyword">new</span> Cat();</span><br><span class="line">        a1.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„ç»“æœå¤§å®¶åº”è¯¥ç›´æ¥å¯ä»¥è¯´å‡ºæ¥ï¼Œè¿™ä¸å°±æ˜¯å¤šæ€å—ï¼è¿è¡Œæ‰§è¡Œçš„æ˜¯å­ç±»ä¸­çš„æ–¹æ³•ã€‚</p><p>Javaç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶æœŸå¹¶ä¸æ€»æ˜¯çŸ¥é“å“ªäº›ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œå› ä¸ºç¼–è¯‘å™¨ä»…ä»…çŸ¥é“å¯¹è±¡çš„é™æ€ç±»å‹ï¼Œè€Œä¸çŸ¥é“å¯¹è±¡çš„çœŸå®ç±»å‹ï¼›è€Œæ–¹æ³•çš„è°ƒç”¨åˆ™æ˜¯æ ¹æ®å¯¹è±¡çš„çœŸå®ç±»å‹ï¼Œè€Œä¸æ˜¯é™æ€ç±»å‹ã€‚</p><p><strong>3ï¼Œé™æ€åˆ†æ´¾ï¼š</strong></p><p>é€šè¿‡æ–¹æ³•é‡è½½æ”¯æŒé™æ€åˆ†æ´¾ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Execute</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Animal a)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Animal&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Dog d)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dog&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Cat c)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;cat&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Animal a = <span class="keyword">new</span> Animal();</span><br><span class="line">        Animal a1 = <span class="keyword">new</span> Dog();</span><br><span class="line">        Animal a2 = <span class="keyword">new</span> Cat();</span><br><span class="line"></span><br><span class="line">        Execute exe = <span class="keyword">new</span> Execute();</span><br><span class="line">        exe.execute(a);</span><br><span class="line">        exe.execute(a1);</span><br><span class="line">        exe.execute(a2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200214215446638.png" style="zoom:70%;" /><p>è¿™ä¸ªç»“æœå¯èƒ½å‡ºä¹ä¸€äº›äººçš„æ„æ–™äº†ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p><strong>é‡è½½æ–¹æ³•çš„åˆ†æ´¾æ˜¯æ ¹æ®é™æ€ç±»å‹è¿›è¡Œçš„ï¼Œè¿™ä¸ªåˆ†æ´¾è¿‡ç¨‹åœ¨ç¼–è¯‘æ—¶æœŸå°±å®Œæˆäº†ã€‚</strong></p><p><strong>4ï¼ŒåŒåˆ†æ´¾ï¼š</strong></p><p>æ‰€è°“åŒåˆ†æ´¾æŠ€æœ¯å°±æ˜¯åœ¨é€‰æ‹©ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œä¸ä»…ä»…è¦æ ¹æ®æ¶ˆæ¯æ¥æ”¶è€…ï¼ˆreceiverï¼‰çš„è¿è¡Œæ—¶åŒºåˆ«ï¼Œè¿˜è¦æ ¹æ®å‚æ•°çš„è¿è¡Œæ—¶åŒºåˆ«ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Execute exe)</span> </span>&#123;</span><br><span class="line">        exe.execute(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Execute exe)</span> </span>&#123;</span><br><span class="line">        exe.execute(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Execute exe)</span> </span>&#123;</span><br><span class="line">        exe.execute(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Execute</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Animal a)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;animal&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Dog d)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dog&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">(Cat c)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;cat&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Animal a = <span class="keyword">new</span> Animal();</span><br><span class="line">        Animal d = <span class="keyword">new</span> Dog();</span><br><span class="line">        Animal c = <span class="keyword">new</span> Cat();</span><br><span class="line"></span><br><span class="line">        Execute exe = <span class="keyword">new</span> Execute();</span><br><span class="line">        a.accept(exe);</span><br><span class="line">        d.accept(exe);</span><br><span class="line">        c.accept(exe);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢ä»£ç ä¸­ï¼Œå®¢æˆ·ç«¯å°†Executeå¯¹è±¡åšä¸ºå‚æ•°ä¼ é€’ç»™Animalç±»å‹çš„å˜é‡è°ƒç”¨çš„æ–¹æ³•ï¼Œè¿™é‡Œå®Œæˆç¬¬ä¸€æ¬¡åˆ†æ´¾ï¼Œè¿™é‡Œæ˜¯æ–¹æ³•é‡å†™ï¼Œæ‰€ä»¥æ˜¯åŠ¨æ€åˆ†æ´¾ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œå®é™…ç±»å‹ä¸­çš„æ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿ<code>å°†è‡ªå·±thisä½œä¸ºå‚æ•°ä¼ é€’è¿›å»ï¼Œè¿™é‡Œå°±å®Œæˆäº†ç¬¬äºŒæ¬¡åˆ†æ´¾</code>ï¼Œè¿™é‡Œçš„Executeç±»ä¸­æœ‰å¤šä¸ªé‡è½½çš„æ–¹æ³•ï¼Œè€Œä¼ é€’è¿›è¡Œçš„æ˜¯thisï¼Œå°±æ˜¯å…·ä½“çš„å®é™…ç±»å‹çš„å¯¹è±¡ã€‚</p><p>è¯´åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»æ˜ç™½åŒåˆ†æ´¾æ˜¯æ€ä¹ˆå›äº‹äº†ï¼Œä½†æ˜¯å®ƒæœ‰ä»€ä¹ˆæ•ˆæœå‘¢ï¼Ÿå°±æ˜¯å¯ä»¥å®ç°æ–¹æ³•çš„åŠ¨æ€ç»‘å®šï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ä¸Šé¢çš„ç¨‹åºè¿›è¡Œä¿®æ”¹ã€‚</p><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200426233931693.png" style="zoom:67%;" /><p><strong>åŒåˆ†æ´¾å®ç°åŠ¨æ€ç»‘å®šçš„æœ¬è´¨ï¼Œå°±æ˜¯åœ¨é‡è½½æ–¹æ³•å§”æ´¾çš„å‰é¢åŠ ä¸Šäº†ç»§æ‰¿ä½“ç³»ä¸­è¦†ç›–çš„ç¯èŠ‚ï¼Œç”±äºè¦†ç›–æ˜¯åŠ¨æ€çš„ï¼Œæ‰€ä»¥é‡è½½å°±æ˜¯åŠ¨æ€çš„äº†ã€‚</strong></p><h2 id="6-10-å¤‡å¿˜å½•æ¨¡å¼"><a href="#6-10-å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="6.10 å¤‡å¿˜å½•æ¨¡å¼"></a>6.10 å¤‡å¿˜å½•æ¨¡å¼</h2><h3 id="6-10-1-æ¦‚è¿°"><a href="#6-10-1-æ¦‚è¿°" class="headerlink" title="6.10.1 æ¦‚è¿°"></a>6.10.1 æ¦‚è¿°</h3><p>å¤‡å¿˜å½•æ¨¡å¼æä¾›äº†ä¸€ç§çŠ¶æ€æ¢å¤çš„å®ç°æœºåˆ¶ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°å›åˆ°ä¸€ä¸ªç‰¹å®šçš„å†å²æ­¥éª¤ï¼Œå½“æ–°çš„çŠ¶æ€æ— æ•ˆæˆ–è€…å­˜åœ¨é—®é¢˜æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æš‚æ—¶å­˜å‚¨èµ·æ¥çš„å¤‡å¿˜å½•å°†çŠ¶æ€å¤åŸï¼Œå¾ˆå¤šè½¯ä»¶éƒ½æä¾›äº†æ’¤é”€ï¼ˆUndoï¼‰æ“ä½œï¼Œå¦‚ Wordã€è®°äº‹æœ¬ã€Photoshopã€IDEAç­‰è½¯ä»¶åœ¨ç¼–è¾‘æ—¶æŒ‰ Ctrl+Z ç»„åˆé”®æ—¶èƒ½æ’¤é”€å½“å‰æ“ä½œï¼Œä½¿æ–‡æ¡£æ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼›è¿˜æœ‰åœ¨ æµè§ˆå™¨ ä¸­çš„åé€€é”®ã€æ•°æ®åº“äº‹åŠ¡ç®¡ç†ä¸­çš„å›æ»šæ“ä½œã€ç©æ¸¸æˆæ—¶çš„ä¸­é—´ç»“æœå­˜æ¡£åŠŸèƒ½ã€æ•°æ®åº“ä¸æ“ä½œç³»ç»Ÿçš„å¤‡ä»½æ“ä½œã€æ£‹ç±»æ¸¸æˆä¸­çš„æ‚”æ£‹åŠŸèƒ½ç­‰éƒ½å±äºè¿™ç±»ã€‚</p><p><strong>å®šä¹‰ï¼š</strong></p><p>åˆå«å¿«ç…§æ¨¡å¼ï¼Œåœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ï¼Œä»¥ä¾¿ä»¥åå½“éœ€è¦æ—¶èƒ½å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚</p><h3 id="6-10-2-ç»“æ„"><a href="#6-10-2-ç»“æ„" class="headerlink" title="6.10.2 ç»“æ„"></a>6.10.2 ç»“æ„</h3><p>å¤‡å¿˜å½•æ¨¡å¼çš„ä¸»è¦è§’è‰²å¦‚ä¸‹ï¼š</p><ul><li>å‘èµ·äººï¼ˆOriginatorï¼‰è§’è‰²ï¼šè®°å½•å½“å‰æ—¶åˆ»çš„å†…éƒ¨çŠ¶æ€ä¿¡æ¯ï¼Œæä¾›åˆ›å»ºå¤‡å¿˜å½•å’Œæ¢å¤å¤‡å¿˜å½•æ•°æ®çš„åŠŸèƒ½ï¼Œå®ç°å…¶ä»–ä¸šåŠ¡åŠŸèƒ½ï¼Œå®ƒå¯ä»¥è®¿é—®å¤‡å¿˜å½•é‡Œçš„æ‰€æœ‰ä¿¡æ¯ã€‚</li><li>å¤‡å¿˜å½•ï¼ˆMementoï¼‰è§’è‰²ï¼šè´Ÿè´£å­˜å‚¨å‘èµ·äººçš„å†…éƒ¨çŠ¶æ€ï¼Œåœ¨éœ€è¦çš„æ—¶å€™æä¾›è¿™äº›å†…éƒ¨çŠ¶æ€ç»™å‘èµ·äººã€‚</li><li>ç®¡ç†è€…ï¼ˆCaretakerï¼‰è§’è‰²ï¼šå¯¹å¤‡å¿˜å½•è¿›è¡Œç®¡ç†ï¼Œæä¾›ä¿å­˜ä¸è·å–å¤‡å¿˜å½•çš„åŠŸèƒ½ï¼Œä½†å…¶ä¸èƒ½å¯¹å¤‡å¿˜å½•çš„å†…å®¹è¿›è¡Œè®¿é—®ä¸ä¿®æ”¹ã€‚</li></ul><blockquote><p>å¤‡å¿˜å½•æœ‰ä¸¤ä¸ªç­‰æ•ˆçš„æ¥å£ï¼š</p><ul><li><strong>çª„æ¥å£</strong>ï¼šç®¡ç†è€…(Caretaker)å¯¹è±¡ï¼ˆå’Œå…¶ä»–å‘èµ·äººå¯¹è±¡ä¹‹å¤–çš„ä»»ä½•å¯¹è±¡ï¼‰çœ‹åˆ°çš„æ˜¯å¤‡å¿˜å½•çš„çª„æ¥å£(narror Interface)ï¼Œè¿™ä¸ªçª„æ¥å£åªå…è®¸ä»–æŠŠå¤‡å¿˜å½•å¯¹è±¡ä¼ ç»™å…¶ä»–çš„å¯¹è±¡ã€‚</li><li><strong>å®½æ¥å£</strong>ï¼šä¸ç®¡ç†è€…çœ‹åˆ°çš„çª„æ¥å£ç›¸åï¼Œå‘èµ·äººå¯¹è±¡å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå®½æ¥å£(wide Interface)ï¼Œè¿™ä¸ªå®½æ¥å£å…è®¸å®ƒè¯»å–æ‰€æœ‰çš„æ•°æ®ï¼Œä»¥ä¾¿æ ¹æ®è¿™äº›æ•°æ®æ¢å¤è¿™ä¸ªå‘èµ·äººå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ã€‚</li></ul></blockquote><h3 id="6-10-3-æ¡ˆä¾‹å®ç°"><a href="#6-10-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="6.10.3 æ¡ˆä¾‹å®ç°"></a>6.10.3 æ¡ˆä¾‹å®ç°</h3><p>ã€ä¾‹ã€‘æ¸¸æˆæŒ‘æˆ˜BOSS</p><p>æ¸¸æˆä¸­çš„æŸä¸ªåœºæ™¯ï¼Œä¸€æ¸¸æˆè§’è‰²æœ‰ç”Ÿå‘½åŠ›ã€æ”»å‡»åŠ›ã€é˜²å¾¡åŠ›ç­‰æ•°æ®ï¼Œåœ¨æ‰“Bosså‰å’Œåä¸€å®šä¼šä¸ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å…è®¸ç©å®¶å¦‚æœæ„Ÿè§‰ä¸Bosså†³æ–—çš„æ•ˆæœä¸ç†æƒ³å¯ä»¥è®©æ¸¸æˆæ¢å¤åˆ°å†³æ–—ä¹‹å‰çš„çŠ¶æ€ã€‚</p><p>è¦å®ç°ä¸Šè¿°æ¡ˆä¾‹ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>â€œç™½ç®±â€å¤‡å¿˜å½•æ¨¡å¼</li><li>â€œé»‘ç®±â€å¤‡å¿˜å½•æ¨¡å¼</li></ul><h4 id="6-10-3-1-â€œç™½ç®±â€å¤‡å¿˜å½•æ¨¡å¼"><a href="#6-10-3-1-â€œç™½ç®±â€å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="6.10.3.1 â€œç™½ç®±â€å¤‡å¿˜å½•æ¨¡å¼"></a>6.10.3.1 â€œç™½ç®±â€å¤‡å¿˜å½•æ¨¡å¼</h4><p>å¤‡å¿˜å½•è§’è‰²å¯¹ä»»ä½•å¯¹è±¡éƒ½æä¾›ä¸€ä¸ªæ¥å£ï¼Œå³å®½æ¥å£ï¼Œå¤‡å¿˜å½•è§’è‰²çš„å†…éƒ¨æ‰€å­˜å‚¨çš„çŠ¶æ€å°±å¯¹æ‰€æœ‰å¯¹è±¡å…¬å¼€ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/ç™½ç®±å¤‡å¿˜å½•æ¨¡å¼.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ¸¸æˆè§’è‰²ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GameRole</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> vit; <span class="comment">//ç”Ÿå‘½åŠ›</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> atk; <span class="comment">//æ”»å‡»åŠ›</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> def; <span class="comment">//é˜²å¾¡åŠ›</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.atk = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.def = <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æˆ˜æ–—</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.atk = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.def = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¿å­˜è§’è‰²çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RoleStateMemento <span class="title">saveState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RoleStateMemento(vit, atk, def);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å›å¤è§’è‰²çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">recoverState</span><span class="params">(RoleStateMemento roleStateMemento)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = roleStateMemento.getVit();</span><br><span class="line">        <span class="keyword">this</span>.atk = roleStateMemento.getAtk();</span><br><span class="line">        <span class="keyword">this</span>.def = roleStateMemento.getDef();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stateDisplay</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²ç”Ÿå‘½åŠ›ï¼š&quot;</span> + vit);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²æ”»å‡»åŠ›ï¼š&quot;</span> + atk);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²é˜²å¾¡åŠ›ï¼š&quot;</span> + def);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getVit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVit</span><span class="params">(<span class="keyword">int</span> vit)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAtk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAtk</span><span class="params">(<span class="keyword">int</span> atk)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.atk = atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDef</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDef</span><span class="params">(<span class="keyword">int</span> def)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.def = def;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¸¸æˆçŠ¶æ€å­˜å‚¨ç±»(å¤‡å¿˜å½•ç±»)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RoleStateMemento</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> vit;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> atk;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> def;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RoleStateMemento</span><span class="params">(<span class="keyword">int</span> vit, <span class="keyword">int</span> atk, <span class="keyword">int</span> def)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = vit;</span><br><span class="line">        <span class="keyword">this</span>.atk = atk;</span><br><span class="line">        <span class="keyword">this</span>.def = def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getVit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVit</span><span class="params">(<span class="keyword">int</span> vit)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAtk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAtk</span><span class="params">(<span class="keyword">int</span> atk)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.atk = atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDef</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDef</span><span class="params">(<span class="keyword">int</span> def)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.def = def;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è§’è‰²çŠ¶æ€ç®¡ç†è€…ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RoleStateCaretaker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> RoleStateMemento roleStateMemento;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RoleStateMemento <span class="title">getRoleStateMemento</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> roleStateMemento;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoleStateMemento</span><span class="params">(RoleStateMemento roleStateMemento)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.roleStateMemento = roleStateMemento;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;------------å¤§æˆ˜Bosså‰------------&quot;</span>);</span><br><span class="line">        <span class="comment">//å¤§æˆ˜Bosså‰</span></span><br><span class="line">        GameRole gameRole = <span class="keyword">new</span> GameRole();</span><br><span class="line">        gameRole.initState();</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¿å­˜è¿›åº¦</span></span><br><span class="line">        RoleStateCaretaker roleStateCaretaker = <span class="keyword">new</span> RoleStateCaretaker();</span><br><span class="line">        roleStateCaretaker.setRoleStateMemento(gameRole.saveState());</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------å¤§æˆ˜Bosså------------&quot;</span>);</span><br><span class="line">        <span class="comment">//å¤§æˆ˜Bossæ—¶ï¼ŒæŸè€—ä¸¥é‡</span></span><br><span class="line">        gameRole.fight();</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line">        System.out.println(<span class="string">&quot;------------æ¢å¤ä¹‹å‰çŠ¶æ€------------&quot;</span>);</span><br><span class="line">        <span class="comment">//æ¢å¤ä¹‹å‰çŠ¶æ€</span></span><br><span class="line">        gameRole.recoverState(roleStateCaretaker.getRoleStateMemento());</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åˆ†æï¼šç™½ç®±å¤‡å¿˜å½•æ¨¡å¼æ˜¯ç ´åå°è£…æ€§çš„ã€‚ä½†æ˜¯é€šè¿‡ç¨‹åºå‘˜è‡ªå¾‹ï¼ŒåŒæ ·å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šå®ç°æ¨¡å¼çš„å¤§éƒ¨åˆ†ç”¨æ„ã€‚</p></blockquote><h4 id="6-10-3-2-â€œé»‘ç®±â€å¤‡å¿˜å½•æ¨¡å¼"><a href="#6-10-3-2-â€œé»‘ç®±â€å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="6.10.3.2 â€œé»‘ç®±â€å¤‡å¿˜å½•æ¨¡å¼"></a>6.10.3.2 â€œé»‘ç®±â€å¤‡å¿˜å½•æ¨¡å¼</h4><p>å¤‡å¿˜å½•è§’è‰²å¯¹å‘èµ·äººå¯¹è±¡æä¾›ä¸€ä¸ªå®½æ¥å£ï¼Œè€Œä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ä¸ªçª„æ¥å£ã€‚åœ¨Javaè¯­è¨€ä¸­ï¼Œå®ç°åŒé‡æ¥å£çš„åŠæ³•å°±æ˜¯å°†<strong>å¤‡å¿˜å½•ç±»</strong>è®¾è®¡æˆ<strong>å‘èµ·äººç±»</strong>çš„å†…éƒ¨æˆå‘˜ç±»ã€‚</p><p>å°† <code>RoleStateMemento</code> è®¾ä¸º <code>GameRole</code> çš„å†…éƒ¨ç±»ï¼Œä»è€Œå°† <code>RoleStateMemento</code> å¯¹è±¡å°è£…åœ¨ <code>GameRole</code> é‡Œé¢ï¼›åœ¨å¤–é¢æä¾›ä¸€ä¸ªæ ‡è¯†æ¥å£ <code>Memento</code> ç»™ <code>RoleStateCaretaker</code> åŠå…¶ä»–å¯¹è±¡ä½¿ç”¨ã€‚è¿™æ · <code>GameRole</code> ç±»çœ‹åˆ°çš„æ˜¯ <code>RoleStateMemento</code> æ‰€æœ‰çš„æ¥å£ï¼Œè€Œ<code>RoleStateCaretaker</code>  åŠå…¶ä»–å¯¹è±¡çœ‹åˆ°çš„ä»…ä»…æ˜¯æ ‡è¯†æ¥å£ <code>Memento</code> æ‰€æš´éœ²å‡ºæ¥çš„æ¥å£ï¼Œä»è€Œç»´æŠ¤äº†å°è£…å‹ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼.png" style="zoom:70%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><p>çª„æ¥å£<code>Memento</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªæ ‡è¯†æ¥å£ï¼Œå› æ­¤æ²¡æœ‰å®šä¹‰å‡ºä»»ä½•çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Memento</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰å‘èµ·äººç±» <code>GameRole</code>ï¼Œå¹¶åœ¨å†…éƒ¨å®šä¹‰å¤‡å¿˜å½•å†…éƒ¨ç±» <code>RoleStateMemento</code>ï¼ˆè¯¥å†…éƒ¨ç±»è®¾ç½®ä¸ºç§æœ‰çš„ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">/æ¸¸æˆè§’è‰²ç±»</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GameRole</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> vit; <span class="comment">//ç”Ÿå‘½åŠ›</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> atk; <span class="comment">//æ”»å‡»åŠ›</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> def; <span class="comment">//é˜²å¾¡åŠ›</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.atk = <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">this</span>.def = <span class="number">100</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æˆ˜æ–—</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.atk = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">this</span>.def = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¿å­˜è§’è‰²çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memento <span class="title">saveState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RoleStateMemento(vit, atk, def);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å›å¤è§’è‰²çŠ¶æ€</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">recoverState</span><span class="params">(Memento memento)</span> </span>&#123;</span><br><span class="line">        RoleStateMemento roleStateMemento = (RoleStateMemento) memento;</span><br><span class="line">        <span class="keyword">this</span>.vit = roleStateMemento.getVit();</span><br><span class="line">        <span class="keyword">this</span>.atk = roleStateMemento.getAtk();</span><br><span class="line">        <span class="keyword">this</span>.def = roleStateMemento.getDef();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stateDisplay</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²ç”Ÿå‘½åŠ›ï¼š&quot;</span> + vit);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²æ”»å‡»åŠ›ï¼š&quot;</span> + atk);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§’è‰²é˜²å¾¡åŠ›ï¼š&quot;</span> + def);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getVit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVit</span><span class="params">(<span class="keyword">int</span> vit)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.vit = vit;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAtk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAtk</span><span class="params">(<span class="keyword">int</span> atk)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.atk = atk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDef</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDef</span><span class="params">(<span class="keyword">int</span> def)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.def = def;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">RoleStateMemento</span> <span class="keyword">implements</span> <span class="title">Memento</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> vit;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> atk;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">int</span> def;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">RoleStateMemento</span><span class="params">(<span class="keyword">int</span> vit, <span class="keyword">int</span> atk, <span class="keyword">int</span> def)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.vit = vit;</span><br><span class="line">            <span class="keyword">this</span>.atk = atk;</span><br><span class="line">            <span class="keyword">this</span>.def = def;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getVit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> vit;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVit</span><span class="params">(<span class="keyword">int</span> vit)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.vit = vit;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAtk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> atk;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAtk</span><span class="params">(<span class="keyword">int</span> atk)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.atk = atk;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getDef</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> def;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDef</span><span class="params">(<span class="keyword">int</span> def)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.def = def;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è´Ÿè´£äººè§’è‰²ç±» <code>RoleStateCaretaker</code> èƒ½å¤Ÿå¾—åˆ°çš„å¤‡å¿˜å½•å¯¹è±¡æ˜¯ä»¥ <code>Memento</code> ä¸ºæ¥å£çš„ï¼Œç”±äºè¿™ä¸ªæ¥å£ä»…ä»…æ˜¯ä¸€ä¸ªæ ‡è¯†æ¥å£ï¼Œå› æ­¤è´Ÿè´£äººè§’è‰²ä¸å¯èƒ½æ”¹å˜è¿™ä¸ªå¤‡å¿˜å½•å¯¹è±¡çš„å†…å®¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è§’è‰²çŠ¶æ€ç®¡ç†è€…ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RoleStateCaretaker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Memento memento;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memento <span class="title">getMemento</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> memento;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMemento</span><span class="params">(Memento memento)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.memento = memento;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯æµ‹è¯•ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;------------å¤§æˆ˜Bosså‰------------&quot;</span>);</span><br><span class="line">        <span class="comment">//å¤§æˆ˜Bosså‰</span></span><br><span class="line">        GameRole gameRole = <span class="keyword">new</span> GameRole();</span><br><span class="line">        gameRole.initState();</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¿å­˜è¿›åº¦</span></span><br><span class="line">        RoleStateCaretaker roleStateCaretaker = <span class="keyword">new</span> RoleStateCaretaker();</span><br><span class="line">        roleStateCaretaker.setMemento(gameRole.saveState());</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;------------å¤§æˆ˜Bosså------------&quot;</span>);</span><br><span class="line">        <span class="comment">//å¤§æˆ˜Bossæ—¶ï¼ŒæŸè€—ä¸¥é‡</span></span><br><span class="line">        gameRole.fight();</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line">        System.out.println(<span class="string">&quot;------------æ¢å¤ä¹‹å‰çŠ¶æ€------------&quot;</span>);</span><br><span class="line">        <span class="comment">//æ¢å¤ä¹‹å‰çŠ¶æ€</span></span><br><span class="line">        gameRole.recoverState(roleStateCaretaker.getMemento());</span><br><span class="line">        gameRole.stateDisplay();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="6-10-4-ä¼˜ç¼ºç‚¹"><a href="#6-10-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="6.10.4 ä¼˜ç¼ºç‚¹"></a>6.10.4 ä¼˜ç¼ºç‚¹</h3><p><strong>1ï¼Œä¼˜ç‚¹ï¼š</strong></p><ul><li>æä¾›äº†ä¸€ç§å¯ä»¥æ¢å¤çŠ¶æ€çš„æœºåˆ¶ã€‚å½“ç”¨æˆ·éœ€è¦æ—¶èƒ½å¤Ÿæ¯”è¾ƒæ–¹ä¾¿åœ°å°†æ•°æ®æ¢å¤åˆ°æŸä¸ªå†å²çš„çŠ¶æ€ã€‚</li><li>å®ç°äº†å†…éƒ¨çŠ¶æ€çš„å°è£…ã€‚é™¤äº†åˆ›å»ºå®ƒçš„å‘èµ·äººä¹‹å¤–ï¼Œå…¶ä»–å¯¹è±¡éƒ½ä¸èƒ½å¤Ÿè®¿é—®è¿™äº›çŠ¶æ€ä¿¡æ¯ã€‚</li><li>ç®€åŒ–äº†å‘èµ·äººç±»ã€‚å‘èµ·äººä¸éœ€è¦ç®¡ç†å’Œä¿å­˜å…¶å†…éƒ¨çŠ¶æ€çš„å„ä¸ªå¤‡ä»½ï¼Œæ‰€æœ‰çŠ¶æ€ä¿¡æ¯éƒ½ä¿å­˜åœ¨å¤‡å¿˜å½•ä¸­ï¼Œå¹¶ç”±ç®¡ç†è€…è¿›è¡Œç®¡ç†ï¼Œè¿™ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚</li></ul><p><strong>2ï¼Œç¼ºç‚¹ï¼š</strong></p><ul><li>èµ„æºæ¶ˆè€—å¤§ã€‚å¦‚æœè¦ä¿å­˜çš„å†…éƒ¨çŠ¶æ€ä¿¡æ¯è¿‡å¤šæˆ–è€…ç‰¹åˆ«é¢‘ç¹ï¼Œå°†ä¼šå ç”¨æ¯”è¾ƒå¤§çš„å†…å­˜èµ„æºã€‚</li></ul><h3 id="6-10-5-ä½¿ç”¨åœºæ™¯"><a href="#6-10-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="6.10.5 ä½¿ç”¨åœºæ™¯"></a>6.10.5 ä½¿ç”¨åœºæ™¯</h3><ul><li><p>éœ€è¦ä¿å­˜ä¸æ¢å¤æ•°æ®çš„åœºæ™¯ï¼Œå¦‚ç©æ¸¸æˆæ—¶çš„ä¸­é—´ç»“æœçš„å­˜æ¡£åŠŸèƒ½ã€‚</p></li><li><p>éœ€è¦æä¾›ä¸€ä¸ªå¯å›æ»šæ“ä½œçš„åœºæ™¯ï¼Œå¦‚ Wordã€è®°äº‹æœ¬ã€Photoshopï¼Œideaç­‰è½¯ä»¶åœ¨ç¼–è¾‘æ—¶æŒ‰ Ctrl+Z ç»„åˆé”®ï¼Œè¿˜æœ‰æ•°æ®åº“ä¸­äº‹åŠ¡æ“ä½œã€‚</p></li></ul><h2 id="6-11-è§£é‡Šå™¨æ¨¡å¼"><a href="#6-11-è§£é‡Šå™¨æ¨¡å¼" class="headerlink" title="6.11 è§£é‡Šå™¨æ¨¡å¼"></a>6.11 è§£é‡Šå™¨æ¨¡å¼</h2><h3 id="6-11-1-æ¦‚è¿°"><a href="#6-11-1-æ¦‚è¿°" class="headerlink" title="6.11.1 æ¦‚è¿°"></a>6.11.1 æ¦‚è¿°</h3><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200215220322641.png" style="zoom:60%;" /><p>å¦‚ä¸Šå›¾ï¼Œè®¾è®¡ä¸€ä¸ªè½¯ä»¶ç”¨æ¥è¿›è¡ŒåŠ å‡è®¡ç®—ã€‚æˆ‘ä»¬ç¬¬ä¸€æƒ³æ³•å°±æ˜¯ä½¿ç”¨å·¥å…·ç±»ï¼Œæä¾›å¯¹åº”çš„åŠ æ³•å’Œå‡æ³•çš„å·¥å…·æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç”¨äºä¸¤ä¸ªæ•´æ•°ç›¸åŠ </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”¨äºä¸¤ä¸ªæ•´æ•°ç›¸åŠ </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”¨äºnä¸ªæ•´æ•°ç›¸åŠ </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(Integer ... arr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (Integer i : arr) &#123;</span><br><span class="line">        sum += i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„å½¢å¼æ¯”è¾ƒå•ä¸€ã€æœ‰é™ï¼Œå¦‚æœå½¢å¼å˜åŒ–éå¸¸å¤šï¼Œè¿™å°±ä¸ç¬¦åˆè¦æ±‚ï¼Œå› ä¸ºåŠ æ³•å’Œå‡æ³•è¿ç®—ï¼Œä¸¤ä¸ªè¿ç®—ç¬¦ä¸æ•°å€¼å¯ä»¥æœ‰æ— é™ç§ç»„åˆæ–¹å¼ã€‚æ¯”å¦‚ 1+2+3+4+5ã€1+2+3-4ç­‰ç­‰ã€‚   </p><p>æ˜¾ç„¶ï¼Œç°åœ¨éœ€è¦ä¸€ç§ç¿»è¯‘è¯†åˆ«æœºå™¨ï¼Œèƒ½å¤Ÿè§£æç”±æ•°å­—ä»¥åŠ + - ç¬¦å·æ„æˆçš„åˆæ³•çš„è¿ç®—åºåˆ—ã€‚å¦‚æœæŠŠè¿ç®—ç¬¦å’Œæ•°å­—éƒ½çœ‹ä½œèŠ‚ç‚¹çš„è¯ï¼Œèƒ½å¤Ÿé€ä¸ªèŠ‚ç‚¹çš„è¿›è¡Œè¯»å–è§£æè¿ç®—ï¼Œè¿™å°±æ˜¯è§£é‡Šå™¨æ¨¡å¼çš„æ€ç»´ã€‚</p><p><strong>å®šä¹‰ï¼š</strong></p><blockquote><p>ç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¿™ä¸ªè§£é‡Šå™¨ä½¿ç”¨è¯¥æ ‡è¯†æ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚</p></blockquote><p>åœ¨è§£é‡Šå™¨æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†å¾…è§£å†³çš„é—®é¢˜ï¼Œæå–å‡ºè§„åˆ™ï¼ŒæŠ½è±¡ä¸ºä¸€ç§â€œè¯­è¨€â€ã€‚æ¯”å¦‚åŠ å‡æ³•è¿ç®—ï¼Œè§„åˆ™ä¸ºï¼šç”±æ•°å€¼å’Œ+-ç¬¦å·ç»„æˆçš„åˆæ³•åºåˆ—ï¼Œâ€œ1+3-2â€ å°±æ˜¯è¿™ç§è¯­è¨€çš„å¥å­ã€‚</p><p>è§£é‡Šå™¨å°±æ˜¯è¦è§£æå‡ºæ¥è¯­å¥çš„å«ä¹‰ã€‚ä½†æ˜¯å¦‚ä½•æè¿°è§„åˆ™å‘¢ï¼Ÿ</p><p><strong>æ–‡æ³•ï¼ˆè¯­æ³•ï¼‰è§„åˆ™ï¼š</strong></p><p>æ–‡æ³•æ˜¯ç”¨äºæè¿°è¯­è¨€çš„è¯­æ³•ç»“æ„çš„å½¢å¼è§„åˆ™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">expression ::= value | plus | minus</span><br><span class="line">plus ::= expression â€˜+â€™ expression   </span><br><span class="line">minus ::= expression â€˜-â€™ expression  </span><br><span class="line">value ::= integer</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼š è¿™é‡Œçš„ç¬¦å·â€œ::=â€è¡¨ç¤ºâ€œå®šä¹‰ä¸ºâ€çš„æ„æ€ï¼Œç«–çº¿ | è¡¨ç¤ºæˆ–ï¼Œå·¦å³çš„å…¶ä¸­ä¸€ä¸ªï¼Œå¼•å·å†…ä¸ºå­—ç¬¦æœ¬èº«ï¼Œå¼•å·å¤–ä¸ºè¯­æ³•ã€‚</p></blockquote><p>ä¸Šé¢è§„åˆ™æè¿°ä¸º ï¼š</p><p>è¡¨è¾¾å¼å¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯plusæˆ–è€…minusè¿ç®—ï¼Œè€Œpluså’Œminusåˆæ˜¯ç”±è¡¨è¾¾å¼ç»“åˆè¿ç®—ç¬¦æ„æˆï¼Œå€¼çš„ç±»å‹ä¸ºæ•´å‹æ•°ã€‚</p><p><strong>æŠ½è±¡è¯­æ³•æ ‘ï¼š</strong></p><p>åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒæŠ½è±¡è¯­æ³•æ ‘ï¼ˆAbstractSyntaxTreeï¼ŒASTï¼‰ï¼Œæˆ–ç®€ç§°è¯­æ³•æ ‘ï¼ˆSyntax treeï¼‰ï¼Œæ˜¯æºä»£ç è¯­æ³•ç»“æ„çš„ä¸€ç§æŠ½è±¡è¡¨ç¤ºã€‚å®ƒä»¥æ ‘çŠ¶çš„å½¢å¼è¡¨ç°ç¼–ç¨‹è¯­è¨€çš„è¯­æ³•ç»“æ„ï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºæºä»£ç ä¸­çš„ä¸€ç§ç»“æ„ã€‚</p><p>ç”¨æ ‘å½¢æ¥è¡¨ç¤ºç¬¦åˆæ–‡æ³•è§„åˆ™çš„å¥å­ã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200215225227616.png" style="zoom:50%;" /><h3 id="6-11-2-ç»“æ„"><a href="#6-11-2-ç»“æ„" class="headerlink" title="6.11.2 ç»“æ„"></a>6.11.2 ç»“æ„</h3><p>è§£é‡Šå™¨æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²ã€‚</p><ul><li><p>æŠ½è±¡è¡¨è¾¾å¼ï¼ˆAbstract Expressionï¼‰è§’è‰²ï¼šå®šä¹‰è§£é‡Šå™¨çš„æ¥å£ï¼Œçº¦å®šè§£é‡Šå™¨çš„è§£é‡Šæ“ä½œï¼Œä¸»è¦åŒ…å«è§£é‡Šæ–¹æ³• interpret()ã€‚</p></li><li><p>ç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼ˆTerminal  Expressionï¼‰è§’è‰²ï¼šæ˜¯æŠ½è±¡è¡¨è¾¾å¼çš„å­ç±»ï¼Œç”¨æ¥å®ç°æ–‡æ³•ä¸­ä¸ç»ˆç»“ç¬¦ç›¸å…³çš„æ“ä½œï¼Œæ–‡æ³•ä¸­çš„æ¯ä¸€ä¸ªç»ˆç»“ç¬¦éƒ½æœ‰ä¸€ä¸ªå…·ä½“ç»ˆç»“è¡¨è¾¾å¼ä¸ä¹‹ç›¸å¯¹åº”ã€‚</p></li><li><p>éç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼ˆNonterminal Expressionï¼‰è§’è‰²ï¼šä¹Ÿæ˜¯æŠ½è±¡è¡¨è¾¾å¼çš„å­ç±»ï¼Œç”¨æ¥å®ç°æ–‡æ³•ä¸­ä¸éç»ˆç»“ç¬¦ç›¸å…³çš„æ“ä½œï¼Œæ–‡æ³•ä¸­çš„æ¯æ¡è§„åˆ™éƒ½å¯¹åº”äºä¸€ä¸ªéç»ˆç»“ç¬¦è¡¨è¾¾å¼ã€‚</p></li><li><p>ç¯å¢ƒï¼ˆContextï¼‰è§’è‰²ï¼šé€šå¸¸åŒ…å«å„ä¸ªè§£é‡Šå™¨éœ€è¦çš„æ•°æ®æˆ–æ˜¯å…¬å…±çš„åŠŸèƒ½ï¼Œä¸€èˆ¬ç”¨æ¥ä¼ é€’è¢«æ‰€æœ‰è§£é‡Šå™¨å…±äº«çš„æ•°æ®ï¼Œåé¢çš„è§£é‡Šå™¨å¯ä»¥ä»è¿™é‡Œè·å–è¿™äº›å€¼ã€‚</p></li><li><p>å®¢æˆ·ç«¯ï¼ˆClientï¼‰ï¼šä¸»è¦ä»»åŠ¡æ˜¯å°†éœ€è¦åˆ†æçš„å¥å­æˆ–è¡¨è¾¾å¼è½¬æ¢æˆä½¿ç”¨è§£é‡Šå™¨å¯¹è±¡æè¿°çš„æŠ½è±¡è¯­æ³•æ ‘ï¼Œç„¶åè°ƒç”¨è§£é‡Šå™¨çš„è§£é‡Šæ–¹æ³•ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒè§’è‰²é—´æ¥è®¿é—®è§£é‡Šå™¨çš„è§£é‡Šæ–¹æ³•ã€‚</p></li></ul><h3 id="6-11-3-æ¡ˆä¾‹å®ç°"><a href="#6-11-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="6.11.3 æ¡ˆä¾‹å®ç°"></a>6.11.3 æ¡ˆä¾‹å®ç°</h3><p>ã€ä¾‹ã€‘è®¾è®¡å®ç°åŠ å‡æ³•çš„è½¯ä»¶</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/è§£é‡Šå™¨æ¨¡å¼.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŠ½è±¡è§’è‰²AbstractExpression</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">(Context context)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»ˆç»“ç¬¦è¡¨è¾¾å¼è§’è‰²</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Value</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> value;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Value</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Integer(value).toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éç»ˆç»“ç¬¦è¡¨è¾¾å¼è§’è‰²  åŠ æ³•è¡¨è¾¾å¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Plus</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression left;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression right;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Plus</span><span class="params">(AbstractExpression left, AbstractExpression right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.left = left;</span><br><span class="line">        <span class="keyword">this</span>.right = right;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> left.interpret(context) + right.interpret(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;(&quot;</span> + left.toString() + <span class="string">&quot; + &quot;</span> + right.toString() + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">///éç»ˆç»“ç¬¦è¡¨è¾¾å¼è§’è‰² å‡æ³•è¡¨è¾¾å¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Minus</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression left;</span><br><span class="line">    <span class="keyword">private</span> AbstractExpression right;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Minus</span><span class="params">(AbstractExpression left, AbstractExpression right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.left = left;</span><br><span class="line">        <span class="keyword">this</span>.right = right;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> left.interpret(context) - right.interpret(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;(&quot;</span> + left.toString() + <span class="string">&quot; - &quot;</span> + right.toString() + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»ˆç»“ç¬¦è¡¨è¾¾å¼è§’è‰² å˜é‡è¡¨è¾¾å¼</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Variable</span> <span class="keyword">extends</span> <span class="title">AbstractExpression</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Variable</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">interpret</span><span class="params">(Context ctx)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ctx.getValue(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¯å¢ƒç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;Variable, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;Variable, Integer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">assign</span><span class="params">(Variable <span class="keyword">var</span>, Integer value)</span> </span>&#123;</span><br><span class="line">        map.put(<span class="keyword">var</span>, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getValue</span><span class="params">(Variable <span class="keyword">var</span>)</span> </span>&#123;</span><br><span class="line">        Integer value = map.get(<span class="keyword">var</span>);</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Context context = <span class="keyword">new</span> Context();</span><br><span class="line"></span><br><span class="line">        Variable a = <span class="keyword">new</span> Variable(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        Variable b = <span class="keyword">new</span> Variable(<span class="string">&quot;b&quot;</span>);</span><br><span class="line">        Variable c = <span class="keyword">new</span> Variable(<span class="string">&quot;c&quot;</span>);</span><br><span class="line">        Variable d = <span class="keyword">new</span> Variable(<span class="string">&quot;d&quot;</span>);</span><br><span class="line">        Variable e = <span class="keyword">new</span> Variable(<span class="string">&quot;e&quot;</span>);</span><br><span class="line">        <span class="comment">//Value v = new Value(1);</span></span><br><span class="line"></span><br><span class="line">        context.assign(a, <span class="number">1</span>);</span><br><span class="line">        context.assign(b, <span class="number">2</span>);</span><br><span class="line">        context.assign(c, <span class="number">3</span>);</span><br><span class="line">        context.assign(d, <span class="number">4</span>);</span><br><span class="line">        context.assign(e, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">        AbstractExpression expression = <span class="keyword">new</span> Minus(<span class="keyword">new</span> Plus(<span class="keyword">new</span> Plus(<span class="keyword">new</span> Plus(a, b), c), d), e);</span><br><span class="line"></span><br><span class="line">        System.out.println(expression + <span class="string">&quot;= &quot;</span> + expression.interpret(context));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-11-4-ä¼˜ç¼ºç‚¹"><a href="#6-11-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="6.11.4 ä¼˜ç¼ºç‚¹"></a>6.11.4 ä¼˜ç¼ºç‚¹</h3><p><strong>1ï¼Œä¼˜ç‚¹ï¼š</strong></p><ul><li><p>æ˜“äºæ”¹å˜å’Œæ‰©å±•æ–‡æ³•ã€‚</p><p>ç”±äºåœ¨è§£é‡Šå™¨æ¨¡å¼ä¸­ä½¿ç”¨ç±»æ¥è¡¨ç¤ºè¯­è¨€çš„æ–‡æ³•è§„åˆ™ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ç»§æ‰¿ç­‰æœºåˆ¶æ¥æ”¹å˜æˆ–æ‰©å±•æ–‡æ³•ã€‚æ¯ä¸€æ¡æ–‡æ³•è§„åˆ™éƒ½å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªç±»ï¼Œå› æ­¤å¯ä»¥æ–¹ä¾¿åœ°å®ç°ä¸€ä¸ªç®€å•çš„è¯­è¨€ã€‚</p></li><li><p>å®ç°æ–‡æ³•è¾ƒä¸ºå®¹æ˜“ã€‚</p><p>åœ¨æŠ½è±¡è¯­æ³•æ ‘ä¸­æ¯ä¸€ä¸ªè¡¨è¾¾å¼èŠ‚ç‚¹ç±»çš„å®ç°æ–¹å¼éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œè¿™äº›ç±»çš„ä»£ç ç¼–å†™éƒ½ä¸ä¼šç‰¹åˆ«å¤æ‚ã€‚</p></li><li><p>å¢åŠ æ–°çš„è§£é‡Šè¡¨è¾¾å¼è¾ƒä¸ºæ–¹ä¾¿ã€‚</p><p>å¦‚æœç”¨æˆ·éœ€è¦å¢åŠ æ–°çš„è§£é‡Šè¡¨è¾¾å¼åªéœ€è¦å¯¹åº”å¢åŠ ä¸€ä¸ªæ–°çš„ç»ˆç»“ç¬¦è¡¨è¾¾å¼æˆ–éç»ˆç»“ç¬¦è¡¨è¾¾å¼ç±»ï¼ŒåŸæœ‰è¡¨è¾¾å¼ç±»ä»£ç æ— é¡»ä¿®æ”¹ï¼Œç¬¦åˆ â€œå¼€é—­åŸåˆ™â€ã€‚</p></li></ul><p><strong>2ï¼Œç¼ºç‚¹ï¼š</strong></p><ul><li><p>å¯¹äºå¤æ‚æ–‡æ³•éš¾ä»¥ç»´æŠ¤ã€‚</p><p>åœ¨è§£é‡Šå™¨æ¨¡å¼ä¸­ï¼Œæ¯ä¸€æ¡è§„åˆ™è‡³å°‘éœ€è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œå› æ­¤å¦‚æœä¸€ä¸ªè¯­è¨€åŒ…å«å¤ªå¤šæ–‡æ³•è§„åˆ™ï¼Œç±»çš„ä¸ªæ•°å°†ä¼šæ€¥å‰§å¢åŠ ï¼Œå¯¼è‡´ç³»ç»Ÿéš¾ä»¥ç®¡ç†å’Œç»´æŠ¤ã€‚</p></li></ul><ul><li><p>æ‰§è¡Œæ•ˆç‡è¾ƒä½ã€‚</p><p>ç”±äºåœ¨è§£é‡Šå™¨æ¨¡å¼ä¸­ä½¿ç”¨äº†å¤§é‡çš„å¾ªç¯å’Œé€’å½’è°ƒç”¨ï¼Œå› æ­¤åœ¨è§£é‡Šè¾ƒä¸ºå¤æ‚çš„å¥å­æ—¶å…¶é€Ÿåº¦å¾ˆæ…¢ï¼Œè€Œä¸”ä»£ç çš„è°ƒè¯•è¿‡ç¨‹ä¹Ÿæ¯”è¾ƒéº»çƒ¦ã€‚</p></li></ul><h3 id="6-11-5-ä½¿ç”¨åœºæ™¯"><a href="#6-11-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="6.11.5 ä½¿ç”¨åœºæ™¯"></a>6.11.5 ä½¿ç”¨åœºæ™¯</h3><ul><li><p>å½“è¯­è¨€çš„æ–‡æ³•è¾ƒä¸ºç®€å•ï¼Œä¸”æ‰§è¡Œæ•ˆç‡ä¸æ˜¯å…³é”®é—®é¢˜æ—¶ã€‚</p></li><li><p>å½“é—®é¢˜é‡å¤å‡ºç°ï¼Œä¸”å¯ä»¥ç”¨ä¸€ç§ç®€å•çš„è¯­è¨€æ¥è¿›è¡Œè¡¨è¾¾æ—¶ã€‚</p></li><li><p>å½“ä¸€ä¸ªè¯­è¨€éœ€è¦è§£é‡Šæ‰§è¡Œï¼Œå¹¶ä¸”è¯­è¨€ä¸­çš„å¥å­å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘çš„æ—¶å€™ã€‚</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;6ï¼Œè¡Œä¸ºå‹æ¨¡å¼&quot;&gt;&lt;a href=&quot;#6ï¼Œè¡Œä¸ºå‹æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;6ï¼Œè¡Œä¸ºå‹æ¨¡å¼&quot;&gt;&lt;/a&gt;6ï¼Œè¡Œä¸ºå‹æ¨¡å¼&lt;/h1&gt;&lt;p&gt;è¡Œä¸ºå‹æ¨¡å¼ç”¨äºæè¿°ç¨‹åºåœ¨è¿è¡Œæ—¶å¤æ‚çš„æµç¨‹æ§åˆ¶ï¼Œå³æè¿°å¤šä¸ªç±»æˆ–å¯¹è±¡ä¹‹é—´æ€æ ·ç›¸äº’åä½œå…±åŒå®Œæˆå•ä¸ªå¯¹è±¡éƒ½æ— </summary>
      
    
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/categories/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/tags/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="æ¨¡æ¿æ–¹æ³•æ¨¡å¼" scheme="http://example.com/tags/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="ç­–ç•¥æ¨¡å¼" scheme="http://example.com/tags/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="å‘½ä»¤æ¨¡å¼" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="èŒè´£é“¾æ¨¡å¼" scheme="http://example.com/tags/%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="çŠ¶æ€æ¨¡å¼" scheme="http://example.com/tags/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="è§‚å¯Ÿè€…æ¨¡å¼" scheme="http://example.com/tags/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="ä¸­ä»‹è€…æ¨¡å¼" scheme="http://example.com/tags/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="è¿­ä»£å™¨æ¨¡å¼" scheme="http://example.com/tags/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="è®¿é—®è€…æ¨¡å¼" scheme="http://example.com/tags/%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="å¤‡å¿˜å½•æ¨¡å¼" scheme="http://example.com/tags/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="è§£é‡Šå™¨æ¨¡å¼" scheme="http://example.com/tags/%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>javaè®¾è®¡æ¨¡å¼--ç»“æ„å‹</title>
    <link href="http://example.com/2024/09/02/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B/"/>
    <id>http://example.com/2024/09/02/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%93%E6%9E%84%E5%9E%8B/</id>
    <published>2024-09-02T15:19:39.000Z</published>
    <updated>2024-09-02T15:55:42.899Z</updated>
    
    <content type="html"><![CDATA[<h1 id="5ï¼Œç»“æ„å‹æ¨¡å¼"><a href="#5ï¼Œç»“æ„å‹æ¨¡å¼" class="headerlink" title="5ï¼Œç»“æ„å‹æ¨¡å¼"></a>5ï¼Œç»“æ„å‹æ¨¡å¼</h1><p>ç»“æ„å‹æ¨¡å¼æè¿°å¦‚ä½•å°†ç±»æˆ–å¯¹è±¡æŒ‰æŸç§å¸ƒå±€ç»„æˆæ›´å¤§çš„ç»“æ„ã€‚å®ƒåˆ†ä¸ºç±»ç»“æ„å‹æ¨¡å¼å’Œå¯¹è±¡ç»“æ„å‹æ¨¡å¼ï¼Œå‰è€…é‡‡ç”¨ç»§æ‰¿æœºåˆ¶æ¥ç»„ç»‡æ¥å£å’Œç±»ï¼Œåè€…é‡†ç”¨ç»„åˆæˆ–èšåˆæ¥ç»„åˆå¯¹è±¡ã€‚</p><p>ç”±äºç»„åˆå…³ç³»æˆ–èšåˆå…³ç³»æ¯”ç»§æ‰¿å…³ç³»è€¦åˆåº¦ä½ï¼Œæ»¡è¶³â€œåˆæˆå¤ç”¨åŸåˆ™â€ï¼Œæ‰€ä»¥å¯¹è±¡ç»“æ„å‹æ¨¡å¼æ¯”ç±»ç»“æ„å‹æ¨¡å¼å…·æœ‰æ›´å¤§çš„çµæ´»æ€§ã€‚</p><p>ç»“æ„å‹æ¨¡å¼åˆ†ä¸ºä»¥ä¸‹ 7 ç§ï¼š</p><ul><li>ä»£ç†æ¨¡å¼</li><li>é€‚é…å™¨æ¨¡å¼</li><li>è£…é¥°è€…æ¨¡å¼</li><li>æ¡¥æ¥æ¨¡å¼</li><li>å¤–è§‚æ¨¡å¼</li><li>ç»„åˆæ¨¡å¼</li><li>äº«å…ƒæ¨¡å¼</li></ul><h2 id="5-1-ä»£ç†æ¨¡å¼"><a href="#5-1-ä»£ç†æ¨¡å¼" class="headerlink" title="5.1 ä»£ç†æ¨¡å¼"></a>5.1 ä»£ç†æ¨¡å¼</h2><h3 id="5-1-1-æ¦‚è¿°"><a href="#5-1-1-æ¦‚è¿°" class="headerlink" title="5.1.1 æ¦‚è¿°"></a>5.1.1 æ¦‚è¿°</h3><p>ç”±äºæŸäº›åŸå› éœ€è¦ç»™æŸå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†ä»¥æ§åˆ¶å¯¹è¯¥å¯¹è±¡çš„è®¿é—®ã€‚è¿™æ—¶ï¼Œè®¿é—®å¯¹è±¡ä¸é€‚åˆæˆ–è€…ä¸èƒ½ç›´æ¥å¼•ç”¨ç›®æ ‡å¯¹è±¡ï¼Œä»£ç†å¯¹è±¡ä½œä¸ºè®¿é—®å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´çš„ä¸­ä»‹ã€‚</p><p>Javaä¸­çš„ä»£ç†æŒ‰ç…§ä»£ç†ç±»ç”Ÿæˆæ—¶æœºä¸åŒåˆåˆ†ä¸ºé™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ã€‚é™æ€ä»£ç†ä»£ç†ç±»åœ¨ç¼–è¯‘æœŸå°±ç”Ÿæˆï¼Œè€ŒåŠ¨æ€ä»£ç†ä»£ç†ç±»åˆ™æ˜¯åœ¨Javaè¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆã€‚åŠ¨æ€ä»£ç†åˆæœ‰JDKä»£ç†å’ŒCGLibä»£ç†ä¸¤ç§ã€‚</p><h3 id="5-1-2-ç»“æ„"><a href="#5-1-2-ç»“æ„" class="headerlink" title="5.1.2 ç»“æ„"></a>5.1.2 ç»“æ„</h3><p>ä»£ç†ï¼ˆProxyï¼‰æ¨¡å¼åˆ†ä¸ºä¸‰ç§è§’è‰²ï¼š</p><ul><li>æŠ½è±¡ä¸»é¢˜ï¼ˆSubjectï¼‰ç±»ï¼š é€šè¿‡æ¥å£æˆ–æŠ½è±¡ç±»å£°æ˜çœŸå®ä¸»é¢˜å’Œä»£ç†å¯¹è±¡å®ç°çš„ä¸šåŠ¡æ–¹æ³•ã€‚</li><li>çœŸå®ä¸»é¢˜ï¼ˆReal Subjectï¼‰ç±»ï¼š å®ç°äº†æŠ½è±¡ä¸»é¢˜ä¸­çš„å…·ä½“ä¸šåŠ¡ï¼Œæ˜¯ä»£ç†å¯¹è±¡æ‰€ä»£è¡¨çš„çœŸå®å¯¹è±¡ï¼Œæ˜¯æœ€ç»ˆè¦å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li>ä»£ç†ï¼ˆProxyï¼‰ç±» ï¼š æä¾›äº†ä¸çœŸå®ä¸»é¢˜ç›¸åŒçš„æ¥å£ï¼Œå…¶å†…éƒ¨å«æœ‰å¯¹çœŸå®ä¸»é¢˜çš„å¼•ç”¨ï¼Œå®ƒå¯ä»¥è®¿é—®ã€æ§åˆ¶æˆ–æ‰©å±•çœŸå®ä¸»é¢˜çš„åŠŸèƒ½ã€‚</li></ul><h3 id="5-1-3-é™æ€ä»£ç†"><a href="#5-1-3-é™æ€ä»£ç†" class="headerlink" title="5.1.3 é™æ€ä»£ç†"></a>5.1.3 é™æ€ä»£ç†</h3><p>æˆ‘ä»¬é€šè¿‡æ¡ˆä¾‹æ¥æ„Ÿå—ä¸€ä¸‹é™æ€ä»£ç†ã€‚</p><p>ã€ä¾‹ã€‘ç«è½¦ç«™å–ç¥¨</p><p>å¦‚æœè¦ä¹°ç«è½¦ç¥¨çš„è¯ï¼Œéœ€è¦å»ç«è½¦ç«™ä¹°ç¥¨ï¼Œåè½¦åˆ°ç«è½¦ç«™ï¼Œæ’é˜Ÿç­‰ä¸€ç³»åˆ—çš„æ“ä½œï¼Œæ˜¾ç„¶æ¯”è¾ƒéº»çƒ¦ã€‚è€Œç«è½¦ç«™åœ¨å¤šä¸ªåœ°æ–¹éƒ½æœ‰ä»£å”®ç‚¹ï¼Œæˆ‘ä»¬å»ä»£å”®ç‚¹ä¹°ç¥¨å°±æ–¹ä¾¿å¾ˆå¤šäº†ã€‚è¿™ä¸ªä¾‹å­å…¶å®å°±æ˜¯å…¸å‹çš„ä»£ç†æ¨¡å¼ï¼Œç«è½¦ç«™æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œä»£å”®ç‚¹æ˜¯ä»£ç†å¯¹è±¡ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/é™æ€ä»£ç†.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å–ç¥¨æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç«è½¦ç«™  ç«è½¦ç«™å…·æœ‰å–ç¥¨åŠŸèƒ½ï¼Œæ‰€ä»¥éœ€è¦å®ç°SellTicketsæ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TrainStation</span> <span class="keyword">implements</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç«è½¦ç«™å–ç¥¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»£å”®ç‚¹</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyPoint</span> <span class="keyword">implements</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TrainStation station = <span class="keyword">new</span> TrainStation();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä»£ç†ç‚¹æ”¶å–ä¸€äº›æœåŠ¡è´¹ç”¨&quot;</span>);</span><br><span class="line">        station.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        ProxyPoint pp = <span class="keyword">new</span> ProxyPoint();</span><br><span class="line">        pp.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢ä»£ç ä¸­å¯ä»¥çœ‹å‡ºæµ‹è¯•ç±»ç›´æ¥è®¿é—®çš„æ˜¯ProxyPointç±»å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ProxyPointä½œä¸ºè®¿é—®å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡çš„ä¸­ä»‹ã€‚åŒæ—¶ä¹Ÿå¯¹sellæ–¹æ³•è¿›è¡Œäº†å¢å¼ºï¼ˆä»£ç†ç‚¹æ”¶å–ä¸€äº›æœåŠ¡è´¹ç”¨ï¼‰ã€‚</p><h3 id="5-1-4-JDKåŠ¨æ€ä»£ç†"><a href="#5-1-4-JDKåŠ¨æ€ä»£ç†" class="headerlink" title="5.1.4 JDKåŠ¨æ€ä»£ç†"></a>5.1.4 JDKåŠ¨æ€ä»£ç†</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨åŠ¨æ€ä»£ç†å®ç°ä¸Šé¢æ¡ˆä¾‹ï¼Œå…ˆè¯´è¯´JDKæä¾›çš„åŠ¨æ€ä»£ç†ã€‚Javaä¸­æä¾›äº†ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»Proxyï¼ŒProxyå¹¶ä¸æ˜¯æˆ‘ä»¬ä¸Šè¿°æ‰€è¯´çš„ä»£ç†å¯¹è±¡çš„ç±»ï¼Œè€Œæ˜¯æä¾›äº†ä¸€ä¸ªåˆ›å»ºä»£ç†å¯¹è±¡çš„é™æ€æ–¹æ³•ï¼ˆnewProxyInstanceæ–¹æ³•ï¼‰æ¥è·å–ä»£ç†å¯¹è±¡ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å–ç¥¨æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç«è½¦ç«™  ç«è½¦ç«™å…·æœ‰å–ç¥¨åŠŸèƒ½ï¼Œæ‰€ä»¥éœ€è¦å®ç°SellTicketsæ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TrainStation</span> <span class="keyword">implements</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç«è½¦ç«™å–ç¥¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»£ç†å·¥å‚ï¼Œç”¨æ¥åˆ›å»ºä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TrainStation station = <span class="keyword">new</span> TrainStation();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SellTickets <span class="title">getProxyObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨Proxyè·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            newProxyInstance()æ–¹æ³•å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">                ClassLoader loader ï¼š ç±»åŠ è½½å™¨ï¼Œç”¨äºåŠ è½½ä»£ç†ç±»ï¼Œä½¿ç”¨çœŸå®å¯¹è±¡çš„ç±»åŠ è½½å™¨å³å¯</span></span><br><span class="line"><span class="comment">                Class&lt;?&gt;[] interfaces ï¼š çœŸå®å¯¹è±¡æ‰€å®ç°çš„æ¥å£ï¼Œä»£ç†æ¨¡å¼çœŸå®å¯¹è±¡å’Œä»£ç†å¯¹è±¡å®ç°ç›¸åŒçš„æ¥å£</span></span><br><span class="line"><span class="comment">                InvocationHandler h ï¼š ä»£ç†å¯¹è±¡çš„è°ƒç”¨å¤„ç†ç¨‹åº</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        SellTickets sellTickets = (SellTickets) Proxy.newProxyInstance(station.getClass().getClassLoader(),</span><br><span class="line">                station.getClass().getInterfaces(),</span><br><span class="line">                <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                        InvocationHandlerä¸­invokeæ–¹æ³•å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">                            proxy ï¼š ä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">                            method ï¼š å¯¹åº”äºåœ¨ä»£ç†å¯¹è±¡ä¸Šè°ƒç”¨çš„æ¥å£æ–¹æ³•çš„ Method å®ä¾‹</span></span><br><span class="line"><span class="comment">                            args ï¼š ä»£ç†å¯¹è±¡è°ƒç”¨æ¥å£æ–¹æ³•æ—¶ä¼ é€’çš„å®é™…å‚æ•°</span></span><br><span class="line"><span class="comment">                     */</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"></span><br><span class="line">                        System.out.println(<span class="string">&quot;ä»£ç†ç‚¹æ”¶å–ä¸€äº›æœåŠ¡è´¹ç”¨(JDKåŠ¨æ€ä»£ç†æ–¹å¼)&quot;</span>);</span><br><span class="line">                        <span class="comment">//æ‰§è¡ŒçœŸå®å¯¹è±¡</span></span><br><span class="line">                        Object result = method.invoke(station, args);</span><br><span class="line">                        <span class="keyword">return</span> result;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="keyword">return</span> sellTickets;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line">        ProxyFactory factory = <span class="keyword">new</span> ProxyFactory();</span><br><span class="line">        </span><br><span class="line">        SellTickets proxyObject = factory.getProxyObject();</span><br><span class="line">        proxyObject.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color="red">ä½¿ç”¨äº†åŠ¨æ€ä»£ç†ï¼Œæˆ‘ä»¬æ€è€ƒä¸‹é¢é—®é¢˜ï¼š</font></p><ul><li><p>ProxyFactoryæ˜¯ä»£ç†ç±»å—ï¼Ÿ</p><p>ProxyFactoryä¸æ˜¯ä»£ç†æ¨¡å¼ä¸­æ‰€è¯´çš„ä»£ç†ç±»ï¼Œè€Œä»£ç†ç±»æ˜¯ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€çš„åœ¨å†…å­˜ä¸­ç”Ÿæˆçš„ç±»ã€‚é€šè¿‡é˜¿é‡Œå·´å·´å¼€æºçš„ Java è¯Šæ–­å·¥å…·ï¼ˆArthasã€é˜¿å°”è¨æ–¯ã€‘ï¼‰æŸ¥çœ‹ä»£ç†ç±»çš„ç»“æ„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sun.proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.itheima.proxy.dynamic.jdk.SellTickets;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.UndeclaredThrowableException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> $<span class="title">Proxy0</span> <span class="keyword">extends</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m1;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m2;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m3;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m0;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $Proxy0(InvocationHandler invocationHandler) &#123;</span><br><span class="line">        <span class="keyword">super</span>(invocationHandler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            m1 = Class.forName(<span class="string">&quot;java.lang.Object&quot;</span>).getMethod(<span class="string">&quot;equals&quot;</span>, Class.forName(<span class="string">&quot;java.lang.Object&quot;</span>));</span><br><span class="line">            m2 = Class.forName(<span class="string">&quot;java.lang.Object&quot;</span>).getMethod(<span class="string">&quot;toString&quot;</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]);</span><br><span class="line">            m3 = Class.forName(<span class="string">&quot;com.itheima.proxy.dynamic.jdk.SellTickets&quot;</span>).getMethod(<span class="string">&quot;sell&quot;</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]);</span><br><span class="line">            m0 = Class.forName(<span class="string">&quot;java.lang.Object&quot;</span>).getMethod(<span class="string">&quot;hashCode&quot;</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (NoSuchMethodException noSuchMethodException) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchMethodError(noSuchMethodException.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (ClassNotFoundException classNotFoundException) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoClassDefFoundError(classNotFoundException.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Boolean)<span class="keyword">this</span>.h.invoke(<span class="keyword">this</span>, m1, <span class="keyword">new</span> Object[]&#123;object&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Error | RuntimeException throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> throwable;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(throwable);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (String)<span class="keyword">this</span>.h.invoke(<span class="keyword">this</span>, m2, <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Error | RuntimeException throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> throwable;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(throwable);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Integer)<span class="keyword">this</span>.h.invoke(<span class="keyword">this</span>, m0, <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Error | RuntimeException throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> throwable;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(throwable);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.h.invoke(<span class="keyword">this</span>, m3, <span class="keyword">null</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Error | RuntimeException throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> throwable;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(throwable);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ç±»ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»¥ä¸‹å‡ ä¸ªä¿¡æ¯ï¼š</p><ul><li>ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰å®ç°äº†SellTicketsã€‚è¿™ä¹Ÿå°±å°è¯äº†æˆ‘ä»¬ä¹‹å‰è¯´çš„çœŸå®ç±»å’Œä»£ç†ç±»å®ç°åŒæ ·çš„æ¥å£ã€‚</li><li>ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰å°†æˆ‘ä»¬æä¾›äº†çš„åŒ¿åå†…éƒ¨ç±»å¯¹è±¡ä¼ é€’ç»™äº†çˆ¶ç±»ã€‚</li></ul></li><li><p>åŠ¨æ€ä»£ç†çš„æ‰§è¡Œæµç¨‹æ˜¯ä»€ä¹ˆæ ·ï¼Ÿ</p><p>ä¸‹é¢æ˜¯æ‘˜å–çš„é‡ç‚¹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> $<span class="title">Proxy0</span> <span class="keyword">extends</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">SellTickets</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m3;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $Proxy0(InvocationHandler invocationHandler) &#123;</span><br><span class="line">        <span class="keyword">super</span>(invocationHandler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        m3 = Class.forName(<span class="string">&quot;com.itheima.proxy.dynamic.jdk.SellTickets&quot;</span>).getMethod(<span class="string">&quot;sell&quot;</span>, <span class="keyword">new</span> Class[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.h.invoke(<span class="keyword">this</span>, m3, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Javaæä¾›çš„åŠ¨æ€ä»£ç†ç›¸å…³ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"><span class="keyword">protected</span> InvocationHandler h;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="title">Proxy</span><span class="params">(InvocationHandler h)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.h = h;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»£ç†å·¥å‚ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TrainStation station = <span class="keyword">new</span> TrainStation();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SellTickets <span class="title">getProxyObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        SellTickets sellTickets = (SellTickets) Proxy.newProxyInstance(station.getClass().getClassLoader(),</span><br><span class="line">                station.getClass().getInterfaces(),</span><br><span class="line">                <span class="keyword">new</span> InvocationHandler() &#123;</span><br><span class="line">                    </span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"></span><br><span class="line">                        System.out.println(<span class="string">&quot;ä»£ç†ç‚¹æ”¶å–ä¸€äº›æœåŠ¡è´¹ç”¨(JDKåŠ¨æ€ä»£ç†æ–¹å¼)&quot;</span>);</span><br><span class="line">                        Object result = method.invoke(station, args);</span><br><span class="line">                        <span class="keyword">return</span> result;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">        <span class="keyword">return</span> sellTickets;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•è®¿é—®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line">        ProxyFactory factory = <span class="keyword">new</span> ProxyFactory();</span><br><span class="line">        SellTickets proxyObject = factory.getProxyObject();</span><br><span class="line">        proxyObject.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š</p><pre><code>1. åœ¨æµ‹è¯•ç±»ä¸­é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨sell()æ–¹æ³•2. æ ¹æ®å¤šæ€çš„ç‰¹æ€§ï¼Œæ‰§è¡Œçš„æ˜¯ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰ä¸­çš„sell()æ–¹æ³•3. ä»£ç†ç±»ï¼ˆ$Proxy0ï¼‰ä¸­çš„sell()æ–¹æ³•ä¸­åˆè°ƒç”¨äº†InvocationHandleræ¥å£çš„å­å®ç°ç±»å¯¹è±¡çš„invokeæ–¹æ³•4. invokeæ–¹æ³•é€šè¿‡åå°„æ‰§è¡Œäº†çœŸå®å¯¹è±¡æ‰€å±ç±»(TrainStation)ä¸­çš„sell()æ–¹æ³•</code></pre><h3 id="5-1-5-CGLIBåŠ¨æ€ä»£ç†"><a href="#5-1-5-CGLIBåŠ¨æ€ä»£ç†" class="headerlink" title="5.1.5 CGLIBåŠ¨æ€ä»£ç†"></a>5.1.5 CGLIBåŠ¨æ€ä»£ç†</h3><p>åŒæ ·æ˜¯ä¸Šé¢çš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨CGLIBä»£ç†å®ç°ã€‚</p><p>å¦‚æœæ²¡æœ‰å®šä¹‰SellTicketsæ¥å£ï¼Œåªå®šä¹‰äº†TrainStation(ç«è½¦ç«™ç±»)ã€‚å¾ˆæ˜¾ç„¶JDKä»£ç†æ˜¯æ— æ³•ä½¿ç”¨äº†ï¼Œå› ä¸ºJDKåŠ¨æ€ä»£ç†è¦æ±‚å¿…é¡»å®šä¹‰æ¥å£ï¼Œå¯¹æ¥å£è¿›è¡Œä»£ç†ã€‚</p><p>CGLIBæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ï¼Œé«˜æ€§èƒ½çš„ä»£ç ç”ŸæˆåŒ…ã€‚å®ƒä¸ºæ²¡æœ‰å®ç°æ¥å£çš„ç±»æä¾›ä»£ç†ï¼Œä¸ºJDKçš„åŠ¨æ€ä»£ç†æä¾›äº†å¾ˆå¥½çš„è¡¥å……ã€‚</p><p>CGLIBæ˜¯ç¬¬ä¸‰æ–¹æä¾›çš„åŒ…ï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥jaråŒ…çš„åæ ‡ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç«è½¦ç«™</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TrainStation</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç«è½¦ç«™å–ç¥¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»£ç†å·¥å‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyFactory</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TrainStation target = <span class="keyword">new</span> TrainStation();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> TrainStation <span class="title">getProxyObject</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºEnhancerå¯¹è±¡ï¼Œç±»ä¼¼äºJDKåŠ¨æ€ä»£ç†çš„Proxyç±»ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯è®¾ç½®å‡ ä¸ªå‚æ•°</span></span><br><span class="line">        Enhancer enhancer =<span class="keyword">new</span> Enhancer();</span><br><span class="line">        <span class="comment">//è®¾ç½®çˆ¶ç±»çš„å­—èŠ‚ç å¯¹è±¡</span></span><br><span class="line">        enhancer.setSuperclass(target.getClass());</span><br><span class="line">        <span class="comment">//è®¾ç½®å›è°ƒå‡½æ•°</span></span><br><span class="line">        enhancer.setCallback(<span class="keyword">this</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºä»£ç†å¯¹è±¡</span></span><br><span class="line">        TrainStation obj = (TrainStation) enhancer.create();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        interceptæ–¹æ³•å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment">            o ï¼š ä»£ç†å¯¹è±¡</span></span><br><span class="line"><span class="comment">            method ï¼š çœŸå®å¯¹è±¡ä¸­çš„æ–¹æ³•çš„Methodå®ä¾‹</span></span><br><span class="line"><span class="comment">            args ï¼š å®é™…å‚æ•°</span></span><br><span class="line"><span class="comment">            methodProxy ï¼šä»£ç†å¯¹è±¡ä¸­çš„æ–¹æ³•çš„methodå®ä¾‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> TrainStation <span class="title">intercept</span><span class="params">(Object o, Method method, Object[] args, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä»£ç†ç‚¹æ”¶å–ä¸€äº›æœåŠ¡è´¹ç”¨(CGLIBåŠ¨æ€ä»£ç†æ–¹å¼)&quot;</span>);</span><br><span class="line">        TrainStation result = (TrainStation) methodProxy.invokeSuper(o, args);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºä»£ç†å·¥å‚å¯¹è±¡</span></span><br><span class="line">        ProxyFactory factory = <span class="keyword">new</span> ProxyFactory();</span><br><span class="line">        <span class="comment">//è·å–ä»£ç†å¯¹è±¡</span></span><br><span class="line">        TrainStation proxyObject = factory.getProxyObject();</span><br><span class="line"></span><br><span class="line">        proxyObject.sell();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-1-6-ä¸‰ç§ä»£ç†çš„å¯¹æ¯”"><a href="#5-1-6-ä¸‰ç§ä»£ç†çš„å¯¹æ¯”" class="headerlink" title="5.1.6 ä¸‰ç§ä»£ç†çš„å¯¹æ¯”"></a>5.1.6 ä¸‰ç§ä»£ç†çš„å¯¹æ¯”</h3><ul><li><p>jdkä»£ç†å’ŒCGLIBä»£ç†</p><p>ä½¿ç”¨CGLibå®ç°åŠ¨æ€ä»£ç†ï¼ŒCGLibåº•å±‚é‡‡ç”¨ASMå­—èŠ‚ç ç”Ÿæˆæ¡†æ¶ï¼Œä½¿ç”¨å­—èŠ‚ç æŠ€æœ¯ç”Ÿæˆä»£ç†ç±»ï¼Œåœ¨JDK1.6ä¹‹å‰æ¯”ä½¿ç”¨Javaåå°„æ•ˆç‡è¦é«˜ã€‚å”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCGLibä¸èƒ½å¯¹å£°æ˜ä¸ºfinalçš„ç±»æˆ–è€…æ–¹æ³•è¿›è¡Œä»£ç†ï¼Œå› ä¸ºCGLibåŸç†æ˜¯åŠ¨æ€ç”Ÿæˆè¢«ä»£ç†ç±»çš„å­ç±»ã€‚</p><p>åœ¨JDK1.6ã€JDK1.7ã€JDK1.8é€æ­¥å¯¹JDKåŠ¨æ€ä»£ç†ä¼˜åŒ–ä¹‹åï¼Œåœ¨è°ƒç”¨æ¬¡æ•°è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ŒJDKä»£ç†æ•ˆç‡é«˜äºCGLibä»£ç†æ•ˆç‡ï¼Œåªæœ‰å½“è¿›è¡Œå¤§é‡è°ƒç”¨çš„æ—¶å€™ï¼ŒJDK1.6å’ŒJDK1.7æ¯”CGLibä»£ç†æ•ˆç‡ä½ä¸€ç‚¹ï¼Œä½†æ˜¯åˆ°JDK1.8çš„æ—¶å€™ï¼ŒJDKä»£ç†æ•ˆç‡é«˜äºCGLibä»£ç†ã€‚æ‰€ä»¥å¦‚æœæœ‰æ¥å£ä½¿ç”¨JDKåŠ¨æ€ä»£ç†ï¼Œå¦‚æœæ²¡æœ‰æ¥å£ä½¿ç”¨CGLIBä»£ç†ã€‚</p></li><li><p>åŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†</p><p>åŠ¨æ€ä»£ç†ä¸é™æ€ä»£ç†ç›¸æ¯”è¾ƒï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯æ¥å£ä¸­å£°æ˜çš„æ‰€æœ‰æ–¹æ³•éƒ½è¢«è½¬ç§»åˆ°è°ƒç”¨å¤„ç†å™¨ä¸€ä¸ªé›†ä¸­çš„æ–¹æ³•ä¸­å¤„ç†ï¼ˆInvocationHandler.invokeï¼‰ã€‚è¿™æ ·ï¼Œåœ¨æ¥å£æ–¹æ³•æ•°é‡æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œçµæ´»å¤„ç†ï¼Œè€Œä¸éœ€è¦åƒé™æ€ä»£ç†é‚£æ ·æ¯ä¸€ä¸ªæ–¹æ³•è¿›è¡Œä¸­è½¬ã€‚</p><p>å¦‚æœæ¥å£å¢åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œé™æ€ä»£ç†æ¨¡å¼é™¤äº†æ‰€æœ‰å®ç°ç±»éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•å¤–ï¼Œæ‰€æœ‰ä»£ç†ç±»ä¹Ÿéœ€è¦å®ç°æ­¤æ–¹æ³•ã€‚å¢åŠ äº†ä»£ç ç»´æŠ¤çš„å¤æ‚åº¦ã€‚è€ŒåŠ¨æ€ä»£ç†ä¸ä¼šå‡ºç°è¯¥é—®é¢˜</p></li></ul><h3 id="5-1-7-ä¼˜ç¼ºç‚¹"><a href="#5-1-7-ä¼˜ç¼ºç‚¹" class="headerlink" title="5.1.7 ä¼˜ç¼ºç‚¹"></a>5.1.7 ä¼˜ç¼ºç‚¹</h3><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>ä»£ç†æ¨¡å¼åœ¨å®¢æˆ·ç«¯ä¸ç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸€ä¸ªä¸­ä»‹ä½œç”¨å’Œä¿æŠ¤ç›®æ ‡å¯¹è±¡çš„ä½œç”¨ï¼›</li><li>ä»£ç†å¯¹è±¡å¯ä»¥æ‰©å±•ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½ï¼›</li><li>ä»£ç†æ¨¡å¼èƒ½å°†å®¢æˆ·ç«¯ä¸ç›®æ ‡å¯¹è±¡åˆ†ç¦»ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šé™ä½äº†ç³»ç»Ÿçš„è€¦åˆåº¦ï¼›</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼›</li></ul><h3 id="5-1-8-ä½¿ç”¨åœºæ™¯"><a href="#5-1-8-ä½¿ç”¨åœºæ™¯" class="headerlink" title="5.1.8 ä½¿ç”¨åœºæ™¯"></a>5.1.8 ä½¿ç”¨åœºæ™¯</h3><ul><li><p>è¿œç¨‹ï¼ˆRemoteï¼‰ä»£ç†</p><p>æœ¬åœ°æœåŠ¡é€šè¿‡ç½‘ç»œè¯·æ±‚è¿œç¨‹æœåŠ¡ã€‚ä¸ºäº†å®ç°æœ¬åœ°åˆ°è¿œç¨‹çš„é€šä¿¡ï¼Œæˆ‘ä»¬éœ€è¦å®ç°ç½‘ç»œé€šä¿¡ï¼Œå¤„ç†å…¶ä¸­å¯èƒ½çš„å¼‚å¸¸ã€‚ä¸ºè‰¯å¥½çš„ä»£ç è®¾è®¡å’Œå¯ç»´æŠ¤æ€§ï¼Œæˆ‘ä»¬å°†ç½‘ç»œé€šä¿¡éƒ¨åˆ†éšè—èµ·æ¥ï¼Œåªæš´éœ²ç»™æœ¬åœ°æœåŠ¡ä¸€ä¸ªæ¥å£ï¼Œé€šè¿‡è¯¥æ¥å£å³å¯è®¿é—®è¿œç¨‹æœåŠ¡æä¾›çš„åŠŸèƒ½ï¼Œè€Œä¸å¿…è¿‡å¤šå…³å¿ƒé€šä¿¡éƒ¨åˆ†çš„ç»†èŠ‚ã€‚</p></li><li><p>é˜²ç«å¢™ï¼ˆFirewallï¼‰ä»£ç†</p><p>å½“ä½ å°†æµè§ˆå™¨é…ç½®æˆä½¿ç”¨ä»£ç†åŠŸèƒ½æ—¶ï¼Œé˜²ç«å¢™å°±å°†ä½ çš„æµè§ˆå™¨çš„è¯·æ±‚è½¬ç»™äº’è”ç½‘ï¼›å½“äº’è”ç½‘è¿”å›å“åº”æ—¶ï¼Œä»£ç†æœåŠ¡å™¨å†æŠŠå®ƒè½¬ç»™ä½ çš„æµè§ˆå™¨ã€‚</p></li><li><p>ä¿æŠ¤ï¼ˆProtect or Accessï¼‰ä»£ç†</p><p>æ§åˆ¶å¯¹ä¸€ä¸ªå¯¹è±¡çš„è®¿é—®ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥ç»™ä¸åŒçš„ç”¨æˆ·æä¾›ä¸åŒçº§åˆ«çš„ä½¿ç”¨æƒé™ã€‚</p></li></ul><h2 id="5-2-é€‚é…å™¨æ¨¡å¼"><a href="#5-2-é€‚é…å™¨æ¨¡å¼" class="headerlink" title="5.2 é€‚é…å™¨æ¨¡å¼"></a>5.2 é€‚é…å™¨æ¨¡å¼</h2><h3 id="5-2-1-æ¦‚è¿°"><a href="#5-2-1-æ¦‚è¿°" class="headerlink" title="5.2.1 æ¦‚è¿°"></a>5.2.1 æ¦‚è¿°</h3><p>å¦‚æœå»æ¬§æ´²å›½å®¶å»æ—…æ¸¸çš„è¯ï¼Œä»–ä»¬çš„æ’åº§å¦‚ä¸‹å›¾æœ€å·¦è¾¹ï¼Œæ˜¯æ¬§æ´²æ ‡å‡†ã€‚è€Œæˆ‘ä»¬ä½¿ç”¨çš„æ’å¤´å¦‚ä¸‹å›¾æœ€å³è¾¹çš„ã€‚å› æ­¤æˆ‘ä»¬çš„ç¬”è®°æœ¬ç”µè„‘ï¼Œæ‰‹æœºåœ¨å½“åœ°ä¸èƒ½ç›´æ¥å……ç”µã€‚æ‰€ä»¥å°±éœ€è¦ä¸€ä¸ªæ’åº§è½¬æ¢å™¨ï¼Œè½¬æ¢å™¨ç¬¬1é¢æ’å…¥å½“åœ°çš„æ’åº§ï¼Œç¬¬2é¢ä¾›æˆ‘ä»¬å……ç”µï¼Œè¿™æ ·ä½¿å¾—æˆ‘ä»¬çš„æ’å¤´åœ¨å½“åœ°èƒ½ä½¿ç”¨ã€‚ç”Ÿæ´»ä¸­è¿™æ ·çš„ä¾‹å­å¾ˆå¤šï¼Œæ‰‹æœºå……ç”µå™¨ï¼ˆå°†220vè½¬æ¢ä¸º5vçš„ç”µå‹ï¼‰ï¼Œè¯»å¡å™¨ç­‰ï¼Œå…¶å®å°±æ˜¯ä½¿ç”¨åˆ°äº†é€‚é…å™¨æ¨¡å¼ã€‚</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E8%BD%AC%E6%8E%A5%E5%A4%B4.png"></p><p><strong>å®šä¹‰ï¼š</strong></p><p>â€‹    å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»èƒ½ä¸€èµ·å·¥ä½œã€‚</p><p>â€‹    é€‚é…å™¨æ¨¡å¼åˆ†ä¸ºç±»é€‚é…å™¨æ¨¡å¼å’Œå¯¹è±¡é€‚é…å™¨æ¨¡å¼ï¼Œå‰è€…ç±»ä¹‹é—´çš„è€¦åˆåº¦æ¯”åè€…é«˜ï¼Œä¸”è¦æ±‚ç¨‹åºå‘˜äº†è§£ç°æœ‰ç»„ä»¶åº“ä¸­çš„ç›¸å…³ç»„ä»¶çš„å†…éƒ¨ç»“æ„ï¼Œæ‰€ä»¥åº”ç”¨ç›¸å¯¹è¾ƒå°‘äº›ã€‚</p><h3 id="5-2-2-ç»“æ„"><a href="#5-2-2-ç»“æ„" class="headerlink" title="5.2.2 ç»“æ„"></a>5.2.2 ç»“æ„</h3><p>é€‚é…å™¨æ¨¡å¼ï¼ˆAdapterï¼‰åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²ï¼š</p><ul><li>ç›®æ ‡ï¼ˆTargetï¼‰æ¥å£ï¼šå½“å‰ç³»ç»Ÿä¸šåŠ¡æ‰€æœŸå¾…çš„æ¥å£ï¼Œå®ƒå¯ä»¥æ˜¯æŠ½è±¡ç±»æˆ–æ¥å£ã€‚</li><li>é€‚é…è€…ï¼ˆAdapteeï¼‰ç±»ï¼šå®ƒæ˜¯è¢«è®¿é—®å’Œé€‚é…çš„ç°å­˜ç»„ä»¶åº“ä¸­çš„ç»„ä»¶æ¥å£ã€‚</li><li>é€‚é…å™¨ï¼ˆAdapterï¼‰ç±»ï¼šå®ƒæ˜¯ä¸€ä¸ªè½¬æ¢å™¨ï¼Œé€šè¿‡ç»§æ‰¿æˆ–å¼•ç”¨é€‚é…è€…çš„å¯¹è±¡ï¼ŒæŠŠé€‚é…è€…æ¥å£è½¬æ¢æˆç›®æ ‡æ¥å£ï¼Œè®©å®¢æˆ·æŒ‰ç›®æ ‡æ¥å£çš„æ ¼å¼è®¿é—®é€‚é…è€…ã€‚</li></ul><h3 id="5-2-3-ç±»é€‚é…å™¨æ¨¡å¼"><a href="#5-2-3-ç±»é€‚é…å™¨æ¨¡å¼" class="headerlink" title="5.2.3 ç±»é€‚é…å™¨æ¨¡å¼"></a>5.2.3 ç±»é€‚é…å™¨æ¨¡å¼</h3><p>å®ç°æ–¹å¼ï¼šå®šä¹‰ä¸€ä¸ªé€‚é…å™¨ç±»æ¥å®ç°å½“å‰ç³»ç»Ÿçš„ä¸šåŠ¡æ¥å£ï¼ŒåŒæ—¶åˆç»§æ‰¿ç°æœ‰ç»„ä»¶åº“ä¸­å·²ç»å­˜åœ¨çš„ç»„ä»¶ã€‚</p><p>ã€ä¾‹ã€‘è¯»å¡å™¨</p><p>ç°æœ‰ä¸€å°ç”µè„‘åªèƒ½è¯»å–SDå¡ï¼Œè€Œè¦è¯»å–TFå¡ä¸­çš„å†…å®¹çš„è¯å°±éœ€è¦ä½¿ç”¨åˆ°é€‚é…å™¨æ¨¡å¼ã€‚åˆ›å»ºä¸€ä¸ªè¯»å¡å™¨ï¼Œå°†TFå¡ä¸­çš„å†…å®¹è¯»å–å‡ºæ¥ã€‚</p><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/é€‚é…å™¨æ¨¡å¼.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SDå¡çš„æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SDCard</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è¯»å–SDå¡æ–¹æ³•</span></span><br><span class="line">    <span class="function">String <span class="title">readSD</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//å†™å…¥SDå¡åŠŸèƒ½</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">writeSD</span><span class="params">(String msg)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//SDå¡å®ç°ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SDCardImpl</span> <span class="keyword">implements</span> <span class="title">SDCard</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">readSD</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String msg = <span class="string">&quot;sd card read a msg :hello word SD&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeSD</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;sd card write msg : &quot;</span> + msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”µè„‘ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Computer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">readSD</span><span class="params">(SDCard sdCard)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(sdCard == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">&quot;sd card null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sdCard.readSD();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//TFå¡æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TFCard</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è¯»å–TFå¡æ–¹æ³•</span></span><br><span class="line">    <span class="function">String <span class="title">readTF</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//å†™å…¥TFå¡åŠŸèƒ½</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">writeTF</span><span class="params">(String msg)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//TFå¡å®ç°ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TFCardImpl</span> <span class="keyword">implements</span> <span class="title">TFCard</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">readTF</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String msg =<span class="string">&quot;tf card read msg : hello word tf card&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeTF</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;tf card write a msg : &quot;</span> + msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®šä¹‰é€‚é…å™¨ç±»ï¼ˆSDå…¼å®¹TFï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SDAdapterTF</span> <span class="keyword">extends</span> <span class="title">TFCardImpl</span> <span class="keyword">implements</span> <span class="title">SDCard</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">readSD</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;adapter read tf card &quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> readTF();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeSD</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;adapter write tf card&quot;</span>);</span><br><span class="line">        writeTF(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Computer computer = <span class="keyword">new</span> Computer();</span><br><span class="line">        SDCard sdCard = <span class="keyword">new</span> SDCardImpl();</span><br><span class="line">        System.out.println(computer.readSD(sdCard));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        SDAdapterTF adapter = <span class="keyword">new</span> SDAdapterTF();</span><br><span class="line">        System.out.println(computer.readSD(adapter));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»é€‚é…å™¨æ¨¡å¼è¿èƒŒäº†åˆæˆå¤ç”¨åŸåˆ™ã€‚ç±»é€‚é…å™¨æ˜¯å®¢æˆ·ç±»æœ‰ä¸€ä¸ªæ¥å£è§„èŒƒçš„æƒ…å†µä¸‹å¯ç”¨ï¼Œåä¹‹ä¸å¯ç”¨ã€‚</p><h3 id="5-2-4-å¯¹è±¡é€‚é…å™¨æ¨¡å¼"><a href="#5-2-4-å¯¹è±¡é€‚é…å™¨æ¨¡å¼" class="headerlink" title="5.2.4 å¯¹è±¡é€‚é…å™¨æ¨¡å¼"></a>5.2.4 å¯¹è±¡é€‚é…å™¨æ¨¡å¼</h3><p>å®ç°æ–¹å¼ï¼šå¯¹è±¡é€‚é…å™¨æ¨¡å¼å¯é‡†ç”¨å°†ç°æœ‰ç»„ä»¶åº“ä¸­å·²ç»å®ç°çš„ç»„ä»¶å¼•å…¥é€‚é…å™¨ç±»ä¸­ï¼Œè¯¥ç±»åŒæ—¶å®ç°å½“å‰ç³»ç»Ÿçš„ä¸šåŠ¡æ¥å£ã€‚</p><p>ã€ä¾‹ã€‘è¯»å¡å™¨</p><p>æˆ‘ä»¬ä½¿ç”¨å¯¹è±¡é€‚é…å™¨æ¨¡å¼å°†è¯»å¡å™¨çš„æ¡ˆä¾‹è¿›è¡Œæ”¹å†™ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å¯¹è±¡é€‚é…å™¨æ¨¡å¼.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><p>ç±»é€‚é…å™¨æ¨¡å¼çš„ä»£ç ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹é€‚é…å™¨ç±»ï¼ˆSDAdapterTFï¼‰å’Œæµ‹è¯•ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºé€‚é…å™¨å¯¹è±¡ï¼ˆSDå…¼å®¹TFï¼‰</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SDAdapterTF</span>  <span class="keyword">implements</span> <span class="title">SDCard</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> TFCard tfCard;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SDAdapterTF</span><span class="params">(TFCard tfCard)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.tfCard = tfCard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">readSD</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;adapter read tf card &quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> tfCard.readTF();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeSD</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;adapter write tf card&quot;</span>);</span><br><span class="line">        tfCard.writeTF(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Computer computer = <span class="keyword">new</span> Computer();</span><br><span class="line">        SDCard sdCard = <span class="keyword">new</span> SDCardImpl();</span><br><span class="line">        System.out.println(computer.readSD(sdCard));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        TFCard tfCard = <span class="keyword">new</span> TFCardImpl();</span><br><span class="line">        SDAdapterTF adapter = <span class="keyword">new</span> SDAdapterTF(tfCard);</span><br><span class="line">        System.out.println(computer.readSD(adapter));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šè¿˜æœ‰ä¸€ä¸ªé€‚é…å™¨æ¨¡å¼æ˜¯æ¥å£é€‚é…å™¨æ¨¡å¼ã€‚å½“ä¸å¸Œæœ›å®ç°ä¸€ä¸ªæ¥å£ä¸­æ‰€æœ‰çš„æ–¹æ³•æ—¶ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæŠ½è±¡ç±»Adapter ï¼Œå®ç°æ‰€æœ‰æ–¹æ³•ã€‚è€Œæ­¤æ—¶æˆ‘ä»¬åªéœ€è¦ç»§æ‰¿è¯¥æŠ½è±¡ç±»å³å¯ã€‚</p></blockquote><h3 id="5-2-5-åº”ç”¨åœºæ™¯"><a href="#5-2-5-åº”ç”¨åœºæ™¯" class="headerlink" title="5.2.5 åº”ç”¨åœºæ™¯"></a>5.2.5 åº”ç”¨åœºæ™¯</h3><ul><li>ä»¥å‰å¼€å‘çš„ç³»ç»Ÿå­˜åœ¨æ»¡è¶³æ–°ç³»ç»ŸåŠŸèƒ½éœ€æ±‚çš„ç±»ï¼Œä½†å…¶æ¥å£åŒæ–°ç³»ç»Ÿçš„æ¥å£ä¸ä¸€è‡´ã€‚</li><li>ä½¿ç”¨ç¬¬ä¸‰æ–¹æä¾›çš„ç»„ä»¶ï¼Œä½†ç»„ä»¶æ¥å£å®šä¹‰å’Œè‡ªå·±è¦æ±‚çš„æ¥å£å®šä¹‰ä¸åŒã€‚</li></ul><h3 id="5-2-6-JDKæºç è§£æ"><a href="#5-2-6-JDKæºç è§£æ" class="headerlink" title="5.2.6 JDKæºç è§£æ"></a>5.2.6 JDKæºç è§£æ</h3><p>Readerï¼ˆå­—ç¬¦æµï¼‰ã€InputStreamï¼ˆå­—èŠ‚æµï¼‰çš„é€‚é…ä½¿ç”¨çš„æ˜¯InputStreamReaderã€‚</p><p>InputStreamReaderç»§æ‰¿è‡ªjava.ioåŒ…ä¸­çš„Readerï¼Œå¯¹ä»–ä¸­çš„æŠ½è±¡çš„æœªå®ç°çš„æ–¹æ³•ç»™å‡ºå®ç°ã€‚å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sd.read();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">(<span class="keyword">char</span> cbuf[], <span class="keyword">int</span> offset, <span class="keyword">int</span> length)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sd.read(cbuf, offset, length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šä»£ç ä¸­çš„sdï¼ˆStreamDecoderç±»å¯¹è±¡ï¼‰ï¼Œåœ¨Sunçš„JDKå®ç°ä¸­ï¼Œå®é™…çš„æ–¹æ³•å®ç°æ˜¯å¯¹sun.nio.cs.StreamDecoderç±»çš„åŒåæ–¹æ³•çš„è°ƒç”¨å°è£…ã€‚ç±»ç»“æ„å›¾å¦‚ä¸‹ï¼š</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F-jdk%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90.png"></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼š</p><ul><li>InputStreamReaderæ˜¯å¯¹åŒæ ·å®ç°äº†Readerçš„StreamDecoderçš„å°è£…ã€‚</li><li>StreamDecoderä¸æ˜¯Java SE APIä¸­çš„å†…å®¹ï¼Œæ˜¯Sun  JDKç»™å‡ºçš„è‡ªèº«å®ç°ã€‚ä½†æˆ‘ä»¬çŸ¥é“ä»–ä»¬å¯¹æ„é€ æ–¹æ³•ä¸­çš„å­—èŠ‚æµç±»ï¼ˆInputStreamï¼‰è¿›è¡Œå°è£…ï¼Œå¹¶é€šè¿‡è¯¥ç±»è¿›è¡Œäº†å­—èŠ‚æµå’Œå­—ç¬¦æµä¹‹é—´çš„è§£ç è½¬æ¢ã€‚</li></ul><p><font color="red">ç»“è®ºï¼š</font></p><p>â€‹    ä»è¡¨å±‚æ¥çœ‹ï¼ŒInputStreamReaderåšäº†InputStreamå­—èŠ‚æµç±»åˆ°Readerå­—ç¬¦æµä¹‹é—´çš„è½¬æ¢ã€‚è€Œä»å¦‚ä¸ŠSun JDKä¸­çš„å®ç°ç±»å…³ç³»ç»“æ„ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ˜¯StreamDecoderçš„è®¾è®¡å®ç°åœ¨å®é™…ä¸Šé‡‡ç”¨äº†é€‚é…å™¨æ¨¡å¼ã€‚</p><h2 id="5-3-è£…é¥°è€…æ¨¡å¼"><a href="#5-3-è£…é¥°è€…æ¨¡å¼" class="headerlink" title="5.3 è£…é¥°è€…æ¨¡å¼"></a>5.3 è£…é¥°è€…æ¨¡å¼</h2><h3 id="5-3-1-æ¦‚è¿°"><a href="#5-3-1-æ¦‚è¿°" class="headerlink" title="5.3.1 æ¦‚è¿°"></a>5.3.1 æ¦‚è¿°</h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªå¿«é¤åº—çš„ä¾‹å­ã€‚</p><p>å¿«é¤åº—æœ‰ç‚’é¢ã€ç‚’é¥­è¿™äº›å¿«é¤ï¼Œå¯ä»¥é¢å¤–é™„åŠ é¸¡è›‹ã€ç«è…¿ã€åŸ¹æ ¹è¿™äº›é…èœï¼Œå½“ç„¶åŠ é…èœéœ€è¦é¢å¤–åŠ é’±ï¼Œæ¯ä¸ªé…èœçš„ä»·é’±é€šå¸¸ä¸å¤ªä¸€æ ·ï¼Œé‚£ä¹ˆè®¡ç®—æ€»ä»·å°±ä¼šæ˜¾å¾—æ¯”è¾ƒéº»çƒ¦ã€‚</p><img src="D:/ä¼ æ™ºæ’­å®¢/ä¸“é¢˜/è®¾è®¡æ¨¡å¼/æˆå“/ç¬”è®°/assets/è£…é¥°è€…æ¨¡å¼-ä½¿ç”¨å‰.png" style="zoom:80%;" /><p>ä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼å­˜åœ¨çš„é—®é¢˜ï¼š</p><ul><li><p>æ‰©å±•æ€§ä¸å¥½</p><p>å¦‚æœè¦å†åŠ ä¸€ç§é…æ–™ï¼ˆç«è…¿è‚ ï¼‰ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°éœ€è¦ç»™FriedRiceå’ŒFriedNoodlesåˆ†åˆ«å®šä¹‰ä¸€ä¸ªå­ç±»ã€‚å¦‚æœè¦æ–°å¢ä¸€ä¸ªå¿«é¤å“ç±»ï¼ˆç‚’æ²³ç²‰ï¼‰çš„è¯ï¼Œå°±éœ€è¦å®šä¹‰æ›´å¤šçš„å­ç±»ã€‚</p></li><li><p>äº§ç”Ÿè¿‡å¤šçš„å­ç±»</p></li></ul><p><strong>å®šä¹‰ï¼š</strong></p><p>â€‹    æŒ‡åœ¨ä¸æ”¹å˜ç°æœ‰å¯¹è±¡ç»“æ„çš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€åœ°ç»™è¯¥å¯¹è±¡å¢åŠ ä¸€äº›èŒè´£ï¼ˆå³å¢åŠ å…¶é¢å¤–åŠŸèƒ½ï¼‰çš„æ¨¡å¼ã€‚</p><h3 id="5-3-2-ç»“æ„"><a href="#5-3-2-ç»“æ„" class="headerlink" title="5.3.2 ç»“æ„"></a>5.3.2 ç»“æ„</h3><p>è£…é¥°ï¼ˆDecoratorï¼‰æ¨¡å¼ä¸­çš„è§’è‰²ï¼š</p><ul><li>æŠ½è±¡æ„ä»¶ï¼ˆComponentï¼‰è§’è‰² ï¼šå®šä¹‰ä¸€ä¸ªæŠ½è±¡æ¥å£ä»¥è§„èŒƒå‡†å¤‡æ¥æ”¶é™„åŠ è´£ä»»çš„å¯¹è±¡ã€‚</li><li>å…·ä½“æ„ä»¶ï¼ˆConcrete  Componentï¼‰è§’è‰² ï¼šå®ç°æŠ½è±¡æ„ä»¶ï¼Œé€šè¿‡è£…é¥°è§’è‰²ä¸ºå…¶æ·»åŠ ä¸€äº›èŒè´£ã€‚</li><li>æŠ½è±¡è£…é¥°ï¼ˆDecoratorï¼‰è§’è‰² ï¼š ç»§æ‰¿æˆ–å®ç°æŠ½è±¡æ„ä»¶ï¼Œå¹¶åŒ…å«å…·ä½“æ„ä»¶çš„å®ä¾‹ï¼Œå¯ä»¥é€šè¿‡å…¶å­ç±»æ‰©å±•å…·ä½“æ„ä»¶çš„åŠŸèƒ½ã€‚</li><li>å…·ä½“è£…é¥°ï¼ˆConcreteDecoratorï¼‰è§’è‰² ï¼šå®ç°æŠ½è±¡è£…é¥°çš„ç›¸å…³æ–¹æ³•ï¼Œå¹¶ç»™å…·ä½“æ„ä»¶å¯¹è±¡æ·»åŠ é™„åŠ çš„è´£ä»»ã€‚</li></ul><h3 id="5-3-3-æ¡ˆä¾‹"><a href="#5-3-3-æ¡ˆä¾‹" class="headerlink" title="5.3.3 æ¡ˆä¾‹"></a>5.3.3 æ¡ˆä¾‹</h3><p>æˆ‘ä»¬ä½¿ç”¨è£…é¥°è€…æ¨¡å¼å¯¹å¿«é¤åº—æ¡ˆä¾‹è¿›è¡Œæ”¹è¿›ï¼Œä½“ä¼šè£…é¥°è€…æ¨¡å¼çš„ç²¾é«“ã€‚</p><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/è£…é¥°è€…æ¨¡å¼.png" style="zoom:75%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¿«é¤æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">FastFood</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> price;</span><br><span class="line">    <span class="keyword">private</span> String desc;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FastFood</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FastFood</span><span class="params">(<span class="keyword">float</span> price, String desc)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">        <span class="keyword">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">float</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDesc</span><span class="params">(String desc)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span></span>;  <span class="comment">//è·å–ä»·æ ¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç‚’é¥­</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FriedRice</span> <span class="keyword">extends</span> <span class="title">FastFood</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FriedRice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="number">10</span>, <span class="string">&quot;ç‚’é¥­&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getPrice();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç‚’é¢</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FriedNoodles</span> <span class="keyword">extends</span> <span class="title">FastFood</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FriedNoodles</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="number">12</span>, <span class="string">&quot;ç‚’é¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getPrice();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é…æ–™ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Garnish</span> <span class="keyword">extends</span> <span class="title">FastFood</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> FastFood fastFood;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> FastFood <span class="title">getFastFood</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fastFood;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFastFood</span><span class="params">(FastFood fastFood)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.fastFood = fastFood;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Garnish</span><span class="params">(FastFood fastFood, <span class="keyword">float</span> price, String desc)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(price,desc);</span><br><span class="line">        <span class="keyword">this</span>.fastFood = fastFood;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é¸¡è›‹é…æ–™</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Egg</span> <span class="keyword">extends</span> <span class="title">Garnish</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Egg</span><span class="params">(FastFood fastFood)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(fastFood,<span class="number">1</span>,<span class="string">&quot;é¸¡è›‹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getPrice() + getFastFood().getPrice();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getDesc() + getFastFood().getDesc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŸ¹æ ¹é…æ–™</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bacon</span> <span class="keyword">extends</span> <span class="title">Garnish</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Bacon</span><span class="params">(FastFood fastFood)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">super</span>(fastFood,<span class="number">2</span>,<span class="string">&quot;åŸ¹æ ¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">float</span> <span class="title">cost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> getPrice() + getFastFood().getPrice();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDesc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getDesc() + getFastFood().getDesc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ç‚¹ä¸€ä»½ç‚’é¥­</span></span><br><span class="line">        FastFood food = <span class="keyword">new</span> FriedRice();</span><br><span class="line">        <span class="comment">//èŠ±è´¹çš„ä»·æ ¼</span></span><br><span class="line">        System.out.println(food.getDesc() + <span class="string">&quot; &quot;</span> + food.cost() + <span class="string">&quot;å…ƒ&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;========&quot;</span>);</span><br><span class="line">        <span class="comment">//ç‚¹ä¸€ä»½åŠ é¸¡è›‹çš„ç‚’é¥­</span></span><br><span class="line">        FastFood food1 = <span class="keyword">new</span> FriedRice();</span><br><span class="line"></span><br><span class="line">        food1 = <span class="keyword">new</span> Egg(food1);</span><br><span class="line">        <span class="comment">//èŠ±è´¹çš„ä»·æ ¼</span></span><br><span class="line">        System.out.println(food1.getDesc() + <span class="string">&quot; &quot;</span> + food1.cost() + <span class="string">&quot;å…ƒ&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;========&quot;</span>);</span><br><span class="line">        <span class="comment">//ç‚¹ä¸€ä»½åŠ åŸ¹æ ¹çš„ç‚’é¢</span></span><br><span class="line">        FastFood food2 = <span class="keyword">new</span> FriedNoodles();</span><br><span class="line">        food2 = <span class="keyword">new</span> Bacon(food2);</span><br><span class="line">        <span class="comment">//èŠ±è´¹çš„ä»·æ ¼</span></span><br><span class="line">        System.out.println(food2.getDesc() + <span class="string">&quot; &quot;</span> + food2.cost() + <span class="string">&quot;å…ƒ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¥½å¤„ï¼š</strong></p><ul><li><p>é¥°è€…æ¨¡å¼å¯ä»¥å¸¦æ¥æ¯”ç»§æ‰¿æ›´åŠ çµæ´»æ€§çš„æ‰©å±•åŠŸèƒ½ï¼Œä½¿ç”¨æ›´åŠ æ–¹ä¾¿ï¼Œå¯ä»¥é€šè¿‡ç»„åˆä¸åŒçš„è£…é¥°è€…å¯¹è±¡æ¥è·å–å…·æœ‰ä¸åŒè¡Œä¸ºçŠ¶æ€çš„å¤šæ ·åŒ–çš„ç»“æœã€‚è£…é¥°è€…æ¨¡å¼æ¯”ç»§æ‰¿æ›´å…·è‰¯å¥½çš„æ‰©å±•æ€§ï¼Œå®Œç¾çš„éµå¾ªå¼€é—­åŸåˆ™ï¼Œç»§æ‰¿æ˜¯é™æ€çš„é™„åŠ è´£ä»»ï¼Œè£…é¥°è€…åˆ™æ˜¯åŠ¨æ€çš„é™„åŠ è´£ä»»ã€‚</p></li><li><p>è£…é¥°ç±»å’Œè¢«è£…é¥°ç±»å¯ä»¥ç‹¬ç«‹å‘å±•ï¼Œä¸ä¼šç›¸äº’è€¦åˆï¼Œè£…é¥°æ¨¡å¼æ˜¯ç»§æ‰¿çš„ä¸€ä¸ªæ›¿ä»£æ¨¡å¼ï¼Œè£…é¥°æ¨¡å¼å¯ä»¥åŠ¨æ€æ‰©å±•ä¸€ä¸ªå®ç°ç±»çš„åŠŸèƒ½ã€‚</p></li></ul><h3 id="5-3-4-ä½¿ç”¨åœºæ™¯"><a href="#5-3-4-ä½¿ç”¨åœºæ™¯" class="headerlink" title="5.3.4 ä½¿ç”¨åœºæ™¯"></a>5.3.4 ä½¿ç”¨åœºæ™¯</h3><ul><li><p>å½“ä¸èƒ½é‡‡ç”¨ç»§æ‰¿çš„æ–¹å¼å¯¹ç³»ç»Ÿè¿›è¡Œæ‰©å……æˆ–è€…é‡‡ç”¨ç»§æ‰¿ä¸åˆ©äºç³»ç»Ÿæ‰©å±•å’Œç»´æŠ¤æ—¶ã€‚</p><p>ä¸èƒ½é‡‡ç”¨ç»§æ‰¿çš„æƒ…å†µä¸»è¦æœ‰ä¸¤ç±»ï¼š</p><ul><li>ç¬¬ä¸€ç±»æ˜¯ç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡ç‹¬ç«‹çš„æ‰©å±•ï¼Œä¸ºæ”¯æŒæ¯ä¸€ç§ç»„åˆå°†äº§ç”Ÿå¤§é‡çš„å­ç±»ï¼Œä½¿å¾—å­ç±»æ•°ç›®å‘ˆçˆ†ç‚¸æ€§å¢é•¿ï¼›</li><li>ç¬¬äºŒç±»æ˜¯å› ä¸ºç±»å®šä¹‰ä¸èƒ½ç»§æ‰¿ï¼ˆå¦‚finalç±»ï¼‰</li></ul></li><li><p>åœ¨ä¸å½±å“å…¶ä»–å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œä»¥åŠ¨æ€ã€é€æ˜çš„æ–¹å¼ç»™å•ä¸ªå¯¹è±¡æ·»åŠ èŒè´£ã€‚</p></li><li><p>å½“å¯¹è±¡çš„åŠŸèƒ½è¦æ±‚å¯ä»¥åŠ¨æ€åœ°æ·»åŠ ï¼Œä¹Ÿå¯ä»¥å†åŠ¨æ€åœ°æ’¤é”€æ—¶ã€‚</p></li></ul><h3 id="5-3-5-JDKæºç è§£æ"><a href="#5-3-5-JDKæºç è§£æ" class="headerlink" title="5.3.5 JDKæºç è§£æ"></a>5.3.5 JDKæºç è§£æ</h3><p>IOæµä¸­çš„åŒ…è£…ç±»ä½¿ç”¨åˆ°äº†è£…é¥°è€…æ¨¡å¼ã€‚BufferedInputStreamï¼ŒBufferedOutputStreamï¼ŒBufferedReaderï¼ŒBufferedWriterã€‚</p><p>æˆ‘ä»¬ä»¥BufferedWriterä¸¾ä¾‹æ¥è¯´æ˜ï¼Œå…ˆçœ‹çœ‹å¦‚ä½•ä½¿ç”¨BufferedWriter</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºBufferedWriterå¯¹è±¡</span></span><br><span class="line">        <span class="comment">//åˆ›å»ºFileWriterå¯¹è±¡</span></span><br><span class="line">        FileWriter fw = <span class="keyword">new</span> FileWriter(<span class="string">&quot;C:\\Users\\Think\\Desktop\\a.txt&quot;</span>);</span><br><span class="line">        BufferedWriter bw = <span class="keyword">new</span> BufferedWriter(fw);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å†™æ•°æ®</span></span><br><span class="line">        bw.write(<span class="string">&quot;hello Buffered&quot;</span>);</span><br><span class="line"></span><br><span class="line">        bw.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨èµ·æ¥æ„Ÿè§‰ç¡®å®åƒæ˜¯è£…é¥°è€…æ¨¡å¼ï¼Œæ¥ä¸‹æ¥çœ‹å®ƒä»¬çš„ç»“æ„ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/è£…é¥°è€…æ¨¡å¼-jdkæºç .png" style="zoom:80%;" /><blockquote><p><font color="red">å°ç»“ï¼š</font></p><p>â€‹    BufferedWriterä½¿ç”¨è£…é¥°è€…æ¨¡å¼å¯¹Writerå­å®ç°ç±»è¿›è¡Œäº†å¢å¼ºï¼Œæ·»åŠ äº†ç¼“å†²åŒºï¼Œæé«˜äº†å†™æ•°æ®çš„æ•ˆç‡ã€‚</p></blockquote><h3 id="5-3-6-ä»£ç†å’Œè£…é¥°è€…çš„åŒºåˆ«"><a href="#5-3-6-ä»£ç†å’Œè£…é¥°è€…çš„åŒºåˆ«" class="headerlink" title="5.3.6 ä»£ç†å’Œè£…é¥°è€…çš„åŒºåˆ«"></a>5.3.6 ä»£ç†å’Œè£…é¥°è€…çš„åŒºåˆ«</h3><p>é™æ€ä»£ç†å’Œè£…é¥°è€…æ¨¡å¼çš„åŒºåˆ«ï¼š</p><ul><li>ç›¸åŒç‚¹ï¼š<ul><li>éƒ½è¦å®ç°ä¸ç›®æ ‡ç±»ç›¸åŒçš„ä¸šåŠ¡æ¥å£</li><li>åœ¨ä¸¤ä¸ªç±»ä¸­éƒ½è¦å£°æ˜ç›®æ ‡å¯¹è±¡</li><li>éƒ½å¯ä»¥åœ¨ä¸ä¿®æ”¹ç›®æ ‡ç±»çš„å‰æä¸‹å¢å¼ºç›®æ ‡æ–¹æ³•</li></ul></li><li>ä¸åŒç‚¹ï¼š<ul><li>ç›®çš„ä¸åŒ<br>è£…é¥°è€…æ˜¯ä¸ºäº†å¢å¼ºç›®æ ‡å¯¹è±¡<br>é™æ€ä»£ç†æ˜¯ä¸ºäº†ä¿æŠ¤å’Œéšè—ç›®æ ‡å¯¹è±¡</li><li>è·å–ç›®æ ‡å¯¹è±¡æ„å»ºçš„åœ°æ–¹ä¸åŒ<br>è£…é¥°è€…æ˜¯ç”±å¤–ç•Œä¼ é€’è¿›æ¥ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ–¹æ³•ä¼ é€’<br>é™æ€ä»£ç†æ˜¯åœ¨ä»£ç†ç±»å†…éƒ¨åˆ›å»ºï¼Œä»¥æ­¤æ¥éšè—ç›®æ ‡å¯¹è±¡</li></ul></li></ul><h2 id="5-4-æ¡¥æ¥æ¨¡å¼"><a href="#5-4-æ¡¥æ¥æ¨¡å¼" class="headerlink" title="5.4 æ¡¥æ¥æ¨¡å¼"></a>5.4 æ¡¥æ¥æ¨¡å¼</h2><h3 id="5-4-1-æ¦‚è¿°"><a href="#5-4-1-æ¦‚è¿°" class="headerlink" title="5.4.1 æ¦‚è¿°"></a>5.4.1 æ¦‚è¿°</h3><p>ç°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦åˆ›å»ºä¸åŒçš„å›¾å½¢ï¼Œå¹¶ä¸”æ¯ä¸ªå›¾å½¢éƒ½æœ‰å¯èƒ½ä¼šæœ‰ä¸åŒçš„é¢œè‰²ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç»§æ‰¿çš„æ–¹å¼æ¥è®¾è®¡ç±»çš„å…³ç³»ï¼š</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20200207194617620.png"></p><p>æˆ‘ä»¬å¯ä»¥å‘ç°æœ‰å¾ˆå¤šçš„ç±»ï¼Œå‡å¦‚æˆ‘ä»¬å†å¢åŠ ä¸€ä¸ªå½¢çŠ¶æˆ–å†å¢åŠ ä¸€ç§é¢œè‰²ï¼Œå°±éœ€è¦åˆ›å»ºæ›´å¤šçš„ç±»ã€‚</p><p>è¯•æƒ³ï¼Œåœ¨ä¸€ä¸ªæœ‰å¤šç§å¯èƒ½ä¼šå˜åŒ–çš„ç»´åº¦çš„ç³»ç»Ÿä¸­ï¼Œç”¨ç»§æ‰¿æ–¹å¼ä¼šé€ æˆç±»çˆ†ç‚¸ï¼Œæ‰©å±•èµ·æ¥ä¸çµæ´»ã€‚æ¯æ¬¡åœ¨ä¸€ä¸ªç»´åº¦ä¸Šæ–°å¢ä¸€ä¸ªå…·ä½“å®ç°éƒ½è¦å¢åŠ å¤šä¸ªå­ç±»ã€‚ä¸ºäº†æ›´åŠ çµæ´»çš„è®¾è®¡ç³»ç»Ÿï¼Œæˆ‘ä»¬æ­¤æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨æ¡¥æ¥æ¨¡å¼ã€‚</p><p><strong>å®šä¹‰ï¼š</strong></p><p>â€‹    å°†æŠ½è±¡ä¸å®ç°åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚å®ƒæ˜¯ç”¨ç»„åˆå…³ç³»ä»£æ›¿ç»§æ‰¿å…³ç³»æ¥å®ç°ï¼Œä»è€Œé™ä½äº†æŠ½è±¡å’Œå®ç°è¿™ä¸¤ä¸ªå¯å˜ç»´åº¦çš„è€¦åˆåº¦ã€‚</p><h3 id="5-4-2-ç»“æ„"><a href="#5-4-2-ç»“æ„" class="headerlink" title="5.4.2 ç»“æ„"></a>5.4.2 ç»“æ„</h3><p>æ¡¥æ¥ï¼ˆBridgeï¼‰æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²ï¼š</p><ul><li>æŠ½è±¡åŒ–ï¼ˆAbstractionï¼‰è§’è‰² ï¼šå®šä¹‰æŠ½è±¡ç±»ï¼Œå¹¶åŒ…å«ä¸€ä¸ªå¯¹å®ç°åŒ–å¯¹è±¡çš„å¼•ç”¨ã€‚</li><li>æ‰©å±•æŠ½è±¡åŒ–ï¼ˆRefined  Abstractionï¼‰è§’è‰² ï¼šæ˜¯æŠ½è±¡åŒ–è§’è‰²çš„å­ç±»ï¼Œå®ç°çˆ¶ç±»ä¸­çš„ä¸šåŠ¡æ–¹æ³•ï¼Œå¹¶é€šè¿‡ç»„åˆå…³ç³»è°ƒç”¨å®ç°åŒ–è§’è‰²ä¸­çš„ä¸šåŠ¡æ–¹æ³•ã€‚</li><li>å®ç°åŒ–ï¼ˆImplementorï¼‰è§’è‰² ï¼šå®šä¹‰å®ç°åŒ–è§’è‰²çš„æ¥å£ï¼Œä¾›æ‰©å±•æŠ½è±¡åŒ–è§’è‰²è°ƒç”¨ã€‚</li><li>å…·ä½“å®ç°åŒ–ï¼ˆConcrete Implementorï¼‰è§’è‰² ï¼šç»™å‡ºå®ç°åŒ–è§’è‰²æ¥å£çš„å…·ä½“å®ç°ã€‚</li></ul><h3 id="5-4-3-æ¡ˆä¾‹"><a href="#5-4-3-æ¡ˆä¾‹" class="headerlink" title="5.4.3 æ¡ˆä¾‹"></a>5.4.3 æ¡ˆä¾‹</h3><p>ã€ä¾‹ã€‘è§†é¢‘æ’­æ”¾å™¨</p><p>éœ€è¦å¼€å‘ä¸€ä¸ªè·¨å¹³å°è§†é¢‘æ’­æ”¾å™¨ï¼Œå¯ä»¥åœ¨ä¸åŒæ“ä½œç³»ç»Ÿå¹³å°ï¼ˆå¦‚Windowsã€Macã€Linuxç­‰ï¼‰ä¸Šæ’­æ”¾å¤šç§æ ¼å¼çš„è§†é¢‘æ–‡ä»¶ï¼Œå¸¸è§çš„è§†é¢‘æ ¼å¼åŒ…æ‹¬RMVBã€AVIã€WMVç­‰ã€‚è¯¥æ’­æ”¾å™¨åŒ…å«äº†ä¸¤ä¸ªç»´åº¦ï¼Œé€‚åˆä½¿ç”¨æ¡¥æ¥æ¨¡å¼ã€‚</p><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/æ¡¥æ¥æ¨¡å¼.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è§†é¢‘æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">VideoFile</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">decode</span><span class="params">(String fileName)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//aviæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AVIFile</span> <span class="keyword">implements</span> <span class="title">VideoFile</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">decode</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;aviè§†é¢‘æ–‡ä»¶ï¼š&quot;</span>+ fileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//rmvbæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">REVBBFile</span> <span class="keyword">implements</span> <span class="title">VideoFile</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">decode</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;rmvbæ–‡ä»¶ï¼š&quot;</span> + fileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ“ä½œç³»ç»Ÿç‰ˆæœ¬</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">OperatingSystemVersion</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> VideoFile videoFile;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OperatingSystemVersion</span><span class="params">(VideoFile videoFile)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.videoFile = videoFile;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(String fileName)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Windowsç‰ˆæœ¬</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Windows</span> <span class="keyword">extends</span> <span class="title">OperatingSystem</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Windows</span><span class="params">(VideoFile videoFile)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(videoFile);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">        videoFile.decode(fileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//macç‰ˆæœ¬</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mac</span> <span class="keyword">extends</span> <span class="title">OperatingSystemVersion</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Mac</span><span class="params">(VideoFile videoFile)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(videoFile);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">play</span><span class="params">(String fileName)</span> </span>&#123;</span><br><span class="line">videoFile.decode(fileName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        OperatingSystem os = <span class="keyword">new</span> Windows(<span class="keyword">new</span> AVIFile());</span><br><span class="line">        os.play(<span class="string">&quot;æˆ˜ç‹¼3&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¥½å¤„ï¼š</strong></p><ul><li><p>æ¡¥æ¥æ¨¡å¼æé«˜äº†ç³»ç»Ÿçš„å¯æ‰©å……æ€§ï¼Œåœ¨ä¸¤ä¸ªå˜åŒ–ç»´åº¦ä¸­ä»»æ„æ‰©å±•ä¸€ä¸ªç»´åº¦ï¼Œéƒ½ä¸éœ€è¦ä¿®æ”¹åŸæœ‰ç³»ç»Ÿã€‚</p><p>å¦‚ï¼šå¦‚æœç°åœ¨è¿˜æœ‰ä¸€ç§è§†é¢‘æ–‡ä»¶ç±»å‹wmvï¼Œæˆ‘ä»¬åªéœ€è¦å†å®šä¹‰ä¸€ä¸ªç±»å®ç°VideoFileæ¥å£å³å¯ï¼Œå…¶ä»–ç±»ä¸éœ€è¦å‘ç”Ÿå˜åŒ–ã€‚</p></li><li><p>å®ç°ç»†èŠ‚å¯¹å®¢æˆ·é€æ˜</p></li></ul><h3 id="5-4-4-ä½¿ç”¨åœºæ™¯"><a href="#5-4-4-ä½¿ç”¨åœºæ™¯" class="headerlink" title="5.4.4 ä½¿ç”¨åœºæ™¯"></a>5.4.4 ä½¿ç”¨åœºæ™¯</h3><ul><li>å½“ä¸€ä¸ªç±»å­˜åœ¨ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œä¸”è¿™ä¸¤ä¸ªç»´åº¦éƒ½éœ€è¦è¿›è¡Œæ‰©å±•æ—¶ã€‚</li><li>å½“ä¸€ä¸ªç³»ç»Ÿä¸å¸Œæœ›ä½¿ç”¨ç»§æ‰¿æˆ–å› ä¸ºå¤šå±‚æ¬¡ç»§æ‰¿å¯¼è‡´ç³»ç»Ÿç±»çš„ä¸ªæ•°æ€¥å‰§å¢åŠ æ—¶ã€‚</li><li>å½“ä¸€ä¸ªç³»ç»Ÿéœ€è¦åœ¨æ„ä»¶çš„æŠ½è±¡åŒ–è§’è‰²å’Œå…·ä½“åŒ–è§’è‰²ä¹‹é—´å¢åŠ æ›´å¤šçš„çµæ´»æ€§æ—¶ã€‚é¿å…åœ¨ä¸¤ä¸ªå±‚æ¬¡ä¹‹é—´å»ºç«‹é™æ€çš„ç»§æ‰¿è”ç³»ï¼Œé€šè¿‡æ¡¥æ¥æ¨¡å¼å¯ä»¥ä½¿å®ƒä»¬åœ¨æŠ½è±¡å±‚å»ºç«‹ä¸€ä¸ªå…³è”å…³ç³»ã€‚</li></ul><h2 id="5-5-å¤–è§‚æ¨¡å¼"><a href="#5-5-å¤–è§‚æ¨¡å¼" class="headerlink" title="5.5 å¤–è§‚æ¨¡å¼"></a>5.5 å¤–è§‚æ¨¡å¼</h2><h3 id="5-5-1-æ¦‚è¿°"><a href="#5-5-1-æ¦‚è¿°" class="headerlink" title="5.5.1 æ¦‚è¿°"></a>5.5.1 æ¦‚è¿°</h3><p>æœ‰äº›äººå¯èƒ½ç‚’è¿‡è‚¡ç¥¨ï¼Œä½†å…¶å®å¤§éƒ¨åˆ†äººéƒ½ä¸å¤ªæ‡‚ï¼Œè¿™ç§æ²¡æœ‰è¶³å¤Ÿäº†è§£è¯åˆ¸çŸ¥è¯†çš„æƒ…å†µä¸‹åšè‚¡ç¥¨æ˜¯å¾ˆå®¹æ˜“äºé’±çš„ï¼Œåˆšå¼€å§‹ç‚’è‚¡è‚¯å®šéƒ½ä¼šæƒ³ï¼Œå¦‚æœæœ‰ä¸ªæ‡‚è¡Œçš„å¸®å¸®æ‰‹å°±å¥½ï¼Œå…¶å®åŸºé‡‘å°±æ˜¯ä¸ªå¥½å¸®æ‰‹ï¼Œæ”¯ä»˜å®é‡Œå°±æœ‰è®¸å¤šçš„åŸºé‡‘ï¼Œå®ƒå°†æŠ•èµ„è€…åˆ†æ•£çš„èµ„é‡‘é›†ä¸­èµ·æ¥ï¼Œäº¤ç”±ä¸“ä¸šçš„ç»ç†äººè¿›è¡Œç®¡ç†ï¼ŒæŠ•èµ„äºè‚¡ç¥¨ã€å€ºåˆ¸ã€å¤–æ±‡ç­‰é¢†åŸŸï¼Œè€ŒåŸºé‡‘æŠ•èµ„çš„æ”¶ç›Šå½’æŒæœ‰è€…æ‰€æœ‰ï¼Œç®¡ç†æœºæ„æ”¶å–ä¸€å®šæ¯”ä¾‹çš„æ‰˜ç®¡ç®¡ç†è´¹ç”¨ã€‚</p><p><strong>å®šä¹‰ï¼š</strong></p><p>â€‹    åˆåé—¨é¢æ¨¡å¼ï¼Œæ˜¯ä¸€ç§é€šè¿‡ä¸ºå¤šä¸ªå¤æ‚çš„å­ç³»ç»Ÿæä¾›ä¸€ä¸ªä¸€è‡´çš„æ¥å£ï¼Œè€Œä½¿è¿™äº›å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“è¢«è®¿é—®çš„æ¨¡å¼ã€‚è¯¥æ¨¡å¼å¯¹å¤–æœ‰ä¸€ä¸ªç»Ÿä¸€æ¥å£ï¼Œå¤–éƒ¨åº”ç”¨ç¨‹åºä¸ç”¨å…³å¿ƒå†…éƒ¨å­ç³»ç»Ÿçš„å…·ä½“çš„ç»†èŠ‚ï¼Œè¿™æ ·ä¼šå¤§å¤§é™ä½åº”ç”¨ç¨‹åºçš„å¤æ‚åº¦ï¼Œæé«˜äº†ç¨‹åºçš„å¯ç»´æŠ¤æ€§ã€‚</p><p>â€‹    å¤–è§‚ï¼ˆFacadeï¼‰æ¨¡å¼æ˜¯â€œè¿ªç±³ç‰¹æ³•åˆ™â€çš„å…¸å‹åº”ç”¨</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E5%BC%95%E5%85%A5.jpg"></p><h3 id="5-5-2-ç»“æ„"><a href="#5-5-2-ç»“æ„" class="headerlink" title="5.5.2 ç»“æ„"></a>5.5.2 ç»“æ„</h3><p>å¤–è§‚ï¼ˆFacadeï¼‰æ¨¡å¼åŒ…å«ä»¥ä¸‹ä¸»è¦è§’è‰²ï¼š</p><ul><li>å¤–è§‚ï¼ˆFacadeï¼‰è§’è‰²ï¼šä¸ºå¤šä¸ªå­ç³»ç»Ÿå¯¹å¤–æä¾›ä¸€ä¸ªå…±åŒçš„æ¥å£ã€‚</li><li>å­ç³»ç»Ÿï¼ˆSub Systemï¼‰è§’è‰²ï¼šå®ç°ç³»ç»Ÿçš„éƒ¨åˆ†åŠŸèƒ½ï¼Œå®¢æˆ·å¯ä»¥é€šè¿‡å¤–è§‚è§’è‰²è®¿é—®å®ƒã€‚</li></ul><h3 id="5-5-3-æ¡ˆä¾‹"><a href="#5-5-3-æ¡ˆä¾‹" class="headerlink" title="5.5.3 æ¡ˆä¾‹"></a>5.5.3 æ¡ˆä¾‹</h3><p>ã€ä¾‹ã€‘æ™ºèƒ½å®¶ç”µæ§åˆ¶</p><p>å°æ˜çš„çˆ·çˆ·å·²ç»60å²äº†ï¼Œä¸€ä¸ªäººåœ¨å®¶ç”Ÿæ´»ï¼šæ¯æ¬¡éƒ½éœ€è¦æ‰“å¼€ç¯ã€æ‰“å¼€ç”µè§†ã€æ‰“å¼€ç©ºè°ƒï¼›ç¡è§‰æ—¶å…³é—­ç¯ã€å…³é—­ç”µè§†ã€å…³é—­ç©ºè°ƒï¼›æ“ä½œèµ·æ¥éƒ½æ¯”è¾ƒéº»çƒ¦ã€‚æ‰€ä»¥å°æ˜ç»™çˆ·çˆ·ä¹°äº†æ™ºèƒ½éŸ³ç®±ï¼Œå¯ä»¥é€šè¿‡è¯­éŸ³ç›´æ¥æ§åˆ¶è¿™äº›æ™ºèƒ½å®¶ç”µçš„å¼€å¯å’Œå…³é—­ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å¤–è§‚æ¨¡å¼.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¯ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Light</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰“å¼€äº†ç¯....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…³é—­äº†ç¯....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”µè§†ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TV</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰“å¼€äº†ç”µè§†....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…³é—­äº†ç”µè§†....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ§åˆ¶ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AirCondition</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰“å¼€äº†ç©ºè°ƒ....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…³é—­äº†ç©ºè°ƒ....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ™ºèƒ½éŸ³ç®±</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SmartAppliancesFacade</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Light light;</span><br><span class="line">    <span class="keyword">private</span> TV tv;</span><br><span class="line">    <span class="keyword">private</span> AirCondition airCondition;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SmartAppliancesFacade</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        light = <span class="keyword">new</span> Light();</span><br><span class="line">        tv = <span class="keyword">new</span> TV();</span><br><span class="line">        airCondition = <span class="keyword">new</span> AirCondition();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(message.contains(<span class="string">&quot;æ‰“å¼€&quot;</span>)) &#123;</span><br><span class="line">            on();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(message.contains(<span class="string">&quot;å…³é—­&quot;</span>)) &#123;</span><br><span class="line">            off();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æˆ‘è¿˜å¬ä¸æ‡‚ä½ è¯´çš„ï¼ï¼ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//èµ·åºŠåä¸€é”®å¼€ç”µå™¨</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;èµ·åºŠäº†&quot;</span>);</span><br><span class="line">        light.on();</span><br><span class="line">        tv.on();</span><br><span class="line">        airCondition.on();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¡è§‰ä¸€é”®å…³ç”µå™¨</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">off</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ç¡è§‰äº†&quot;</span>);</span><br><span class="line">        light.off();</span><br><span class="line">        tv.off();</span><br><span class="line">        airCondition.off();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºå¤–è§‚å¯¹è±¡</span></span><br><span class="line">        SmartAppliancesFacade facade = <span class="keyword">new</span> SmartAppliancesFacade();</span><br><span class="line">        <span class="comment">//å®¢æˆ·ç«¯ç›´æ¥ä¸å¤–è§‚å¯¹è±¡è¿›è¡Œäº¤äº’</span></span><br><span class="line">        facade.say(<span class="string">&quot;æ‰“å¼€å®¶ç”µ&quot;</span>);</span><br><span class="line">        facade.say(<span class="string">&quot;å…³é—­å®¶ç”µ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¥½å¤„ï¼š</strong></p><ul><li>é™ä½äº†å­ç³»ç»Ÿä¸å®¢æˆ·ç«¯ä¹‹é—´çš„è€¦åˆåº¦ï¼Œä½¿å¾—å­ç³»ç»Ÿçš„å˜åŒ–ä¸ä¼šå½±å“è°ƒç”¨å®ƒçš„å®¢æˆ·ç±»ã€‚</li><li>å¯¹å®¢æˆ·å±è”½äº†å­ç³»ç»Ÿç»„ä»¶ï¼Œå‡å°‘äº†å®¢æˆ·å¤„ç†çš„å¯¹è±¡æ•°ç›®ï¼Œå¹¶ä½¿å¾—å­ç³»ç»Ÿä½¿ç”¨èµ·æ¥æ›´åŠ å®¹æ˜“ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>ä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œä¿®æ”¹å¾ˆéº»çƒ¦</li></ul><h3 id="5-5-4-ä½¿ç”¨åœºæ™¯"><a href="#5-5-4-ä½¿ç”¨åœºæ™¯" class="headerlink" title="5.5.4 ä½¿ç”¨åœºæ™¯"></a>5.5.4 ä½¿ç”¨åœºæ™¯</h3><ul><li>å¯¹åˆ†å±‚ç»“æ„ç³»ç»Ÿæ„å»ºæ—¶ï¼Œä½¿ç”¨å¤–è§‚æ¨¡å¼å®šä¹‰å­ç³»ç»Ÿä¸­æ¯å±‚çš„å…¥å£ç‚¹å¯ä»¥ç®€åŒ–å­ç³»ç»Ÿä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li><li>å½“ä¸€ä¸ªå¤æ‚ç³»ç»Ÿçš„å­ç³»ç»Ÿå¾ˆå¤šæ—¶ï¼Œå¤–è§‚æ¨¡å¼å¯ä»¥ä¸ºç³»ç»Ÿè®¾è®¡ä¸€ä¸ªç®€å•çš„æ¥å£ä¾›å¤–ç•Œè®¿é—®ã€‚</li><li>å½“å®¢æˆ·ç«¯ä¸å¤šä¸ªå­ç³»ç»Ÿä¹‹é—´å­˜åœ¨å¾ˆå¤§çš„è”ç³»æ—¶ï¼Œå¼•å…¥å¤–è§‚æ¨¡å¼å¯å°†å®ƒä»¬åˆ†ç¦»ï¼Œä»è€Œæé«˜å­ç³»ç»Ÿçš„ç‹¬ç«‹æ€§å’Œå¯ç§»æ¤æ€§ã€‚</li></ul><h3 id="5-5-5-æºç è§£æ"><a href="#5-5-5-æºç è§£æ" class="headerlink" title="5.5.5 æºç è§£æ"></a>5.5.5 æºç è§£æ</h3><p>ä½¿ç”¨tomcatä½œä¸ºwebå®¹å™¨æ—¶ï¼Œæ¥æ”¶æµè§ˆå™¨å‘é€è¿‡æ¥çš„è¯·æ±‚ï¼Œtomcatä¼šå°†è¯·æ±‚ä¿¡æ¯å°è£…æˆServletRequestå¯¹è±¡ï¼Œå¦‚ä¸‹å›¾â‘ å¤„å¯¹è±¡ã€‚ä½†æ˜¯å¤§å®¶æƒ³æƒ³ServletRequestæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒè¿˜æœ‰ä¸€ä¸ªå­æ¥å£HttpServletRequestï¼Œè€Œæˆ‘ä»¬çŸ¥é“è¯¥requestå¯¹è±¡è‚¯å®šæ˜¯ä¸€ä¸ªHttpServletRequestå¯¹è±¡çš„å­å®ç°ç±»å¯¹è±¡ï¼Œåˆ°åº•æ˜¯å“ªä¸ªç±»çš„å¯¹è±¡å‘¢ï¼Ÿå¯ä»¥é€šè¿‡è¾“å‡ºrequestå¯¹è±¡ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç°æ˜¯ä¸€ä¸ªåä¸ºRequestFacadeçš„ç±»çš„å¯¹è±¡ã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200207234545691.png" style="zoom:60%;" /><p>RequestFacadeç±»å°±ä½¿ç”¨äº†å¤–è§‚æ¨¡å¼ã€‚å…ˆçœ‹ç»“æ„å›¾ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å¤–è§‚æ¨¡å¼-jdkæºç è§£æ.png" style="zoom:70%;" /><p><strong>ä¸ºä»€ä¹ˆåœ¨æ­¤å¤„ä½¿ç”¨å¤–è§‚æ¨¡å¼å‘¢ï¼Ÿ</strong></p><p>â€‹    å®šä¹‰ RequestFacade ç±»ï¼Œåˆ†åˆ«å®ç° ServletRequest ï¼ŒåŒæ—¶å®šä¹‰ç§æœ‰æˆå‘˜å˜é‡ Request ï¼Œå¹¶ä¸”æ–¹æ³•çš„å®ç°è°ƒç”¨ Request  çš„å®ç°ã€‚ç„¶åï¼Œå°† RequestFacadeä¸Šè½¬ä¸º ServletRequest  ä¼ ç»™ servlet çš„ service æ–¹æ³•ï¼Œè¿™æ ·å³ä½¿åœ¨ servlet ä¸­è¢«ä¸‹è½¬ä¸º RequestFacade ï¼Œä¹Ÿä¸èƒ½è®¿é—®ç§æœ‰æˆå‘˜å˜é‡å¯¹è±¡ä¸­çš„æ–¹æ³•ã€‚æ—¢ç”¨äº† Request ï¼Œåˆèƒ½é˜²æ­¢å…¶ä¸­æ–¹æ³•è¢«ä¸åˆç†çš„è®¿é—®ã€‚</p><h2 id="5-6-ç»„åˆæ¨¡å¼"><a href="#5-6-ç»„åˆæ¨¡å¼" class="headerlink" title="5.6 ç»„åˆæ¨¡å¼"></a>5.6 ç»„åˆæ¨¡å¼</h2><h3 id="5-6-1-æ¦‚è¿°"><a href="#5-6-1-æ¦‚è¿°" class="headerlink" title="5.6.1 æ¦‚è¿°"></a>5.6.1 æ¦‚è¿°</h3><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200208180417291.png" style="zoom:60%;" /><p>â€‹    å¯¹äºè¿™ä¸ªå›¾ç‰‡è‚¯å®šä¼šéå¸¸ç†Ÿæ‚‰ï¼Œä¸Šå›¾æˆ‘ä»¬å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå¯¹äºè¿™æ ·çš„ç»“æ„æˆ‘ä»¬ç§°ä¹‹ä¸ºæ ‘å½¢ç»“æ„ã€‚åœ¨æ ‘å½¢ç»“æ„ä¸­å¯ä»¥é€šè¿‡è°ƒç”¨æŸä¸ªæ–¹æ³•æ¥éå†æ•´ä¸ªæ ‘ï¼Œå½“æˆ‘ä»¬æ‰¾åˆ°æŸä¸ªå¶å­èŠ‚ç‚¹åï¼Œå°±å¯ä»¥å¯¹å¶å­èŠ‚ç‚¹è¿›è¡Œç›¸å…³çš„æ“ä½œã€‚å¯ä»¥å°†è¿™é¢—æ ‘ç†è§£æˆä¸€ä¸ªå¤§çš„å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢åŒ…å«å¾ˆå¤šçš„æˆå‘˜å¯¹è±¡ï¼Œè¿™äº›æˆå‘˜å¯¹è±¡å³å¯æ˜¯å®¹å™¨å¯¹è±¡ä¹Ÿå¯ä»¥æ˜¯å¶å­å¯¹è±¡ã€‚ä½†æ˜¯ç”±äºå®¹å™¨å¯¹è±¡å’Œå¶å­å¯¹è±¡åœ¨åŠŸèƒ½ä¸Šé¢çš„åŒºåˆ«ï¼Œä½¿å¾—æˆ‘ä»¬åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­å¿…é¡»è¦åŒºåˆ†å®¹å™¨å¯¹è±¡å’Œå¶å­å¯¹è±¡ï¼Œä½†æ˜¯è¿™æ ·å°±ä¼šç»™å®¢æˆ·å¸¦æ¥ä¸å¿…è¦çš„éº»çƒ¦ï¼Œä½œä¸ºå®¢æˆ·è€Œå·²ï¼Œå®ƒå§‹ç»ˆå¸Œæœ›èƒ½å¤Ÿä¸€è‡´çš„å¯¹å¾…å®¹å™¨å¯¹è±¡å’Œå¶å­å¯¹è±¡ã€‚</p><p><strong>å®šä¹‰ï¼š</strong></p><p>â€‹    åˆåéƒ¨åˆ†æ•´ä½“æ¨¡å¼ï¼Œæ˜¯ç”¨äºæŠŠä¸€ç»„ç›¸ä¼¼çš„å¯¹è±¡å½“ä½œä¸€ä¸ªå•ä¸€çš„å¯¹è±¡ã€‚ç»„åˆæ¨¡å¼ä¾æ®æ ‘å½¢ç»“æ„æ¥ç»„åˆå¯¹è±¡ï¼Œç”¨æ¥è¡¨ç¤ºéƒ¨åˆ†ä»¥åŠæ•´ä½“å±‚æ¬¡ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºç»“æ„å‹æ¨¡å¼ï¼Œå®ƒåˆ›å»ºäº†å¯¹è±¡ç»„çš„æ ‘å½¢ç»“æ„ã€‚</p><h3 id="5-6-2-ç»“æ„"><a href="#5-6-2-ç»“æ„" class="headerlink" title="5.6.2 ç»“æ„"></a>5.6.2 ç»“æ„</h3><p>ç»„åˆæ¨¡å¼ä¸»è¦åŒ…å«ä¸‰ç§è§’è‰²ï¼š</p><ul><li>æŠ½è±¡æ ¹èŠ‚ç‚¹ï¼ˆComponentï¼‰ï¼šå®šä¹‰ç³»ç»Ÿå„å±‚æ¬¡å¯¹è±¡çš„å…±æœ‰æ–¹æ³•å’Œå±æ€§ï¼Œå¯ä»¥é¢„å…ˆå®šä¹‰ä¸€äº›é»˜è®¤è¡Œä¸ºå’Œå±æ€§ã€‚</li><li>æ ‘æèŠ‚ç‚¹ï¼ˆCompositeï¼‰ï¼šå®šä¹‰æ ‘æèŠ‚ç‚¹çš„è¡Œä¸ºï¼Œå­˜å‚¨å­èŠ‚ç‚¹ï¼Œç»„åˆæ ‘æèŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹å½¢æˆä¸€ä¸ªæ ‘å½¢ç»“æ„ã€‚</li><li>å¶å­èŠ‚ç‚¹ï¼ˆLeafï¼‰ï¼šå¶å­èŠ‚ç‚¹å¯¹è±¡ï¼Œå…¶ä¸‹å†æ— åˆ†æ”¯ï¼Œæ˜¯ç³»ç»Ÿå±‚æ¬¡éå†çš„æœ€å°å•ä½ã€‚</li></ul><h3 id="5-6-3-æ¡ˆä¾‹å®ç°"><a href="#5-6-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="5.6.3 æ¡ˆä¾‹å®ç°"></a>5.6.3 æ¡ˆä¾‹å®ç°</h3><p>ã€ä¾‹ã€‘è½¯ä»¶èœå•</p><p>å¦‚ä¸‹å›¾ï¼Œæˆ‘ä»¬åœ¨è®¿é—®åˆ«çš„ä¸€äº›ç®¡ç†ç³»ç»Ÿæ—¶ï¼Œç»å¸¸å¯ä»¥çœ‹åˆ°ç±»ä¼¼çš„èœå•ã€‚ä¸€ä¸ªèœå•å¯ä»¥åŒ…å«èœå•é¡¹ï¼ˆèœå•é¡¹æ˜¯æŒ‡ä¸å†åŒ…å«å…¶ä»–å†…å®¹çš„èœå•æ¡ç›®ï¼‰ï¼Œä¹Ÿå¯ä»¥åŒ…å«å¸¦æœ‰å…¶ä»–èœå•é¡¹çš„èœå•ï¼Œå› æ­¤ä½¿ç”¨ç»„åˆæ¨¡å¼æè¿°èœå•å°±å¾ˆæ°å½“ï¼Œæˆ‘ä»¬çš„éœ€æ±‚æ˜¯é’ˆå¯¹ä¸€ä¸ªèœå•ï¼Œæ‰“å°å‡ºå…¶åŒ…å«çš„æ‰€æœ‰èœå•ä»¥åŠèœå•é¡¹çš„åç§°ã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200208182322313.png" style="zoom:80%;" /><p>è¦å®ç°è¯¥æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å…ˆç”»å‡ºç±»å›¾ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/ç»„åˆæ¨¡å¼.png" style="zoom:80%;" /><p><strong>ä»£ç å®ç°ï¼š</strong></p><p>ä¸ç®¡æ˜¯èœå•è¿˜æ˜¯èœå•é¡¹ï¼Œéƒ½åº”è¯¥ç»§æ‰¿è‡ªç»Ÿä¸€çš„æ¥å£ï¼Œè¿™é‡Œå§‘ä¸”å°†è¿™ä¸ªç»Ÿä¸€çš„æ¥å£ç§°ä¸ºèœå•ç»„ä»¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//èœå•ç»„ä»¶  ä¸ç®¡æ˜¯èœå•è¿˜æ˜¯èœå•é¡¹ï¼Œéƒ½åº”è¯¥ç»§æ‰¿è¯¥ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">MenuComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> String name;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> level;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ·»åŠ èœå•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(MenuComponent menuComponent)</span></span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§»é™¤èœå•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(MenuComponent menuComponent)</span></span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–æŒ‡å®šçš„å­èœå•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MenuComponent <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–èœå•åç§°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„MenuComponentå®šä¹‰ä¸ºæŠ½è±¡ç±»ï¼Œå› ä¸ºæœ‰ä¸€äº›å…±æœ‰çš„å±æ€§å’Œè¡Œä¸ºè¦åœ¨è¯¥ç±»ä¸­å®ç°ï¼ŒMenuå’ŒMenuItemç±»å°±å¯ä»¥åªè¦†ç›–è‡ªå·±æ„Ÿå…´è¶£çš„æ–¹æ³•ï¼Œè€Œä¸ç”¨æ­ç†ä¸éœ€è¦æˆ–è€…ä¸æ„Ÿå…´è¶£çš„æ–¹æ³•ï¼Œä¸¾ä¾‹æ¥è¯´ï¼ŒMenuç±»å¯ä»¥åŒ…å«å­èœå•ï¼Œå› æ­¤éœ€è¦è¦†ç›–add()ã€remove()ã€getChild()æ–¹æ³•ï¼Œä½†æ˜¯MenuItemå°±ä¸åº”è¯¥æœ‰è¿™äº›æ–¹æ³•ã€‚è¿™é‡Œç»™å‡ºçš„é»˜è®¤å®ç°æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦æ”¹å†™é»˜è®¤å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Menu</span> <span class="keyword">extends</span> <span class="title">MenuComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;MenuComponent&gt; menuComponentList;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Menu</span><span class="params">(String name,<span class="keyword">int</span> level)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.level = level;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        menuComponentList = <span class="keyword">new</span> ArrayList&lt;MenuComponent&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(MenuComponent menuComponent)</span> </span>&#123;</span><br><span class="line">        menuComponentList.add(menuComponent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(MenuComponent menuComponent)</span> </span>&#123;</span><br><span class="line">        menuComponentList.remove(menuComponent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MenuComponent <span class="title">getChild</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> menuComponentList.get(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; level; i++) &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;--&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(name);</span><br><span class="line">        <span class="keyword">for</span> (MenuComponent menuComponent : menuComponentList) &#123;</span><br><span class="line">            menuComponent.print();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Menuç±»å·²ç»å®ç°äº†é™¤äº†getNameæ–¹æ³•çš„å…¶ä»–æ‰€æœ‰æ–¹æ³•ï¼Œå› ä¸ºMenuç±»å…·æœ‰æ·»åŠ èœå•ï¼Œç§»é™¤èœå•å’Œè·å–å­èœå•çš„åŠŸèƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MenuItem</span> <span class="keyword">extends</span> <span class="title">MenuComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MenuItem</span><span class="params">(String name,<span class="keyword">int</span> level)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.level = level;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; level; i++) &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;--&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>MenuItemæ˜¯èœå•é¡¹ï¼Œä¸èƒ½å†æœ‰å­èœå•ï¼Œæ‰€ä»¥æ·»åŠ èœå•ï¼Œç§»é™¤èœå•å’Œè·å–å­èœå•çš„åŠŸèƒ½å¹¶ä¸èƒ½å®ç°ã€‚</p><h3 id="5-6-4-ç»„åˆæ¨¡å¼çš„åˆ†ç±»"><a href="#5-6-4-ç»„åˆæ¨¡å¼çš„åˆ†ç±»" class="headerlink" title="5.6.4 ç»„åˆæ¨¡å¼çš„åˆ†ç±»"></a>5.6.4 ç»„åˆæ¨¡å¼çš„åˆ†ç±»</h3><p>åœ¨ä½¿ç”¨ç»„åˆæ¨¡å¼æ—¶ï¼Œæ ¹æ®æŠ½è±¡æ„ä»¶ç±»çš„å®šä¹‰å½¢å¼ï¼Œæˆ‘ä»¬å¯å°†ç»„åˆæ¨¡å¼åˆ†ä¸ºé€æ˜ç»„åˆæ¨¡å¼å’Œå®‰å…¨ç»„åˆæ¨¡å¼ä¸¤ç§å½¢å¼ã€‚</p><ul><li><p>é€æ˜ç»„åˆæ¨¡å¼</p><p>é€æ˜ç»„åˆæ¨¡å¼ä¸­ï¼ŒæŠ½è±¡æ ¹èŠ‚ç‚¹è§’è‰²ä¸­å£°æ˜äº†æ‰€æœ‰ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•ï¼Œæ¯”å¦‚åœ¨ç¤ºä¾‹ä¸­ <code>MenuComponent</code> å£°æ˜äº† <code>add</code>ã€<code>remove</code> ã€<code>getChild</code> æ–¹æ³•ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ç¡®ä¿æ‰€æœ‰çš„æ„ä»¶ç±»éƒ½æœ‰ç›¸åŒçš„æ¥å£ã€‚é€æ˜ç»„åˆæ¨¡å¼ä¹Ÿæ˜¯ç»„åˆæ¨¡å¼çš„æ ‡å‡†å½¢å¼ã€‚</p><p>é€æ˜ç»„åˆæ¨¡å¼çš„ç¼ºç‚¹æ˜¯ä¸å¤Ÿå®‰å…¨ï¼Œå› ä¸ºå¶å­å¯¹è±¡å’Œå®¹å™¨å¯¹è±¡åœ¨æœ¬è´¨ä¸Šæ˜¯æœ‰åŒºåˆ«çš„ï¼Œå¶å­å¯¹è±¡ä¸å¯èƒ½æœ‰ä¸‹ä¸€ä¸ªå±‚æ¬¡çš„å¯¹è±¡ï¼Œå³ä¸å¯èƒ½åŒ…å«æˆå‘˜å¯¹è±¡ï¼Œå› æ­¤ä¸ºå…¶æä¾› add()ã€remove() ç­‰æ–¹æ³•æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œè¿™åœ¨ç¼–è¯‘é˜¶æ®µä¸ä¼šå‡ºé”™ï¼Œä½†åœ¨è¿è¡Œé˜¶æ®µå¦‚æœè°ƒç”¨è¿™äº›æ–¹æ³•å¯èƒ½ä¼šå‡ºé”™ï¼ˆå¦‚æœæ²¡æœ‰æä¾›ç›¸åº”çš„é”™è¯¯å¤„ç†ä»£ç ï¼‰</p></li><li><p>å®‰å…¨ç»„åˆæ¨¡å¼</p><p>åœ¨å®‰å…¨ç»„åˆæ¨¡å¼ä¸­ï¼Œåœ¨æŠ½è±¡æ„ä»¶è§’è‰²ä¸­æ²¡æœ‰å£°æ˜ä»»ä½•ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•ï¼Œè€Œæ˜¯åœ¨æ ‘æèŠ‚ç‚¹ <code>Menu</code> ç±»ä¸­å£°æ˜å¹¶å®ç°è¿™äº›æ–¹æ³•ã€‚å®‰å…¨ç»„åˆæ¨¡å¼çš„ç¼ºç‚¹æ˜¯ä¸å¤Ÿé€æ˜ï¼Œå› ä¸ºå¶å­æ„ä»¶å’Œå®¹å™¨æ„ä»¶å…·æœ‰ä¸åŒçš„æ–¹æ³•ï¼Œä¸”å®¹å™¨æ„ä»¶ä¸­é‚£äº›ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•æ²¡æœ‰åœ¨æŠ½è±¡æ„ä»¶ç±»ä¸­å®šä¹‰ï¼Œå› æ­¤å®¢æˆ·ç«¯ä¸èƒ½å®Œå…¨é’ˆå¯¹æŠ½è±¡ç¼–ç¨‹ï¼Œå¿…é¡»æœ‰åŒºåˆ«åœ°å¯¹å¾…å¶å­æ„ä»¶å’Œå®¹å™¨æ„ä»¶ã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/ç»„åˆæ¨¡å¼-å®‰å…¨æ€§.png" style="zoom:80%;" /></li></ul><h3 id="5-6-5-ä¼˜ç‚¹"><a href="#5-6-5-ä¼˜ç‚¹" class="headerlink" title="5.6.5 ä¼˜ç‚¹"></a>5.6.5 ä¼˜ç‚¹</h3><ul><li>ç»„åˆæ¨¡å¼å¯ä»¥æ¸…æ¥šåœ°å®šä¹‰åˆ†å±‚æ¬¡çš„å¤æ‚å¯¹è±¡ï¼Œè¡¨ç¤ºå¯¹è±¡çš„å…¨éƒ¨æˆ–éƒ¨åˆ†å±‚æ¬¡ï¼Œå®ƒè®©å®¢æˆ·ç«¯å¿½ç•¥äº†å±‚æ¬¡çš„å·®å¼‚ï¼Œæ–¹ä¾¿å¯¹æ•´ä¸ªå±‚æ¬¡ç»“æ„è¿›è¡Œæ§åˆ¶ã€‚</li><li>å®¢æˆ·ç«¯å¯ä»¥ä¸€è‡´åœ°ä½¿ç”¨ä¸€ä¸ªç»„åˆç»“æ„æˆ–å…¶ä¸­å•ä¸ªå¯¹è±¡ï¼Œä¸å¿…å…³å¿ƒå¤„ç†çš„æ˜¯å•ä¸ªå¯¹è±¡è¿˜æ˜¯æ•´ä¸ªç»„åˆç»“æ„ï¼Œç®€åŒ–äº†å®¢æˆ·ç«¯ä»£ç ã€‚</li><li>åœ¨ç»„åˆæ¨¡å¼ä¸­å¢åŠ æ–°çš„æ ‘æèŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹éƒ½å¾ˆæ–¹ä¾¿ï¼Œæ— é¡»å¯¹ç°æœ‰ç±»åº“è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</li><li>ç»„åˆæ¨¡å¼ä¸ºæ ‘å½¢ç»“æ„çš„é¢å‘å¯¹è±¡å®ç°æä¾›äº†ä¸€ç§çµæ´»çš„è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡å¶å­èŠ‚ç‚¹å’Œæ ‘æèŠ‚ç‚¹çš„é€’å½’ç»„åˆï¼Œå¯ä»¥å½¢æˆå¤æ‚çš„æ ‘å½¢ç»“æ„ï¼Œä½†å¯¹æ ‘å½¢ç»“æ„çš„æ§åˆ¶å´éå¸¸ç®€å•ã€‚</li></ul><h3 id="5-6-6-ä½¿ç”¨åœºæ™¯"><a href="#5-6-6-ä½¿ç”¨åœºæ™¯" class="headerlink" title="5.6.6 ä½¿ç”¨åœºæ™¯"></a>5.6.6 ä½¿ç”¨åœºæ™¯</h3><p>ç»„åˆæ¨¡å¼æ­£æ˜¯åº”æ ‘å½¢ç»“æ„è€Œç”Ÿï¼Œæ‰€ä»¥ç»„åˆæ¨¡å¼çš„ä½¿ç”¨åœºæ™¯å°±æ˜¯å‡ºç°æ ‘å½¢ç»“æ„çš„åœ°æ–¹ã€‚æ¯”å¦‚ï¼šæ–‡ä»¶ç›®å½•æ˜¾ç¤ºï¼Œå¤šçº§ç›®å½•å‘ˆç°ç­‰æ ‘å½¢ç»“æ„æ•°æ®çš„æ“ä½œã€‚</p><h2 id="5-7-äº«å…ƒæ¨¡å¼"><a href="#5-7-äº«å…ƒæ¨¡å¼" class="headerlink" title="5.7 äº«å…ƒæ¨¡å¼"></a>5.7 äº«å…ƒæ¨¡å¼</h2><h3 id="5-7-1-æ¦‚è¿°"><a href="#5-7-1-æ¦‚è¿°" class="headerlink" title="5.7.1 æ¦‚è¿°"></a>5.7.1 æ¦‚è¿°</h3><p><strong>å®šä¹‰ï¼š</strong></p><p>â€‹    è¿ç”¨å…±äº«æŠ€æœ¯æ¥æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦å¯¹è±¡çš„å¤ç”¨ã€‚å®ƒé€šè¿‡å…±äº«å·²ç»å­˜åœ¨çš„å¯¹è±¡æ¥å¤§å¹…åº¦å‡å°‘éœ€è¦åˆ›å»ºçš„å¯¹è±¡æ•°é‡ã€é¿å…å¤§é‡ç›¸ä¼¼å¯¹è±¡çš„å¼€é”€ï¼Œä»è€Œæé«˜ç³»ç»Ÿèµ„æºçš„åˆ©ç”¨ç‡ã€‚</p><h3 id="5-7-2-ç»“æ„"><a href="#5-7-2-ç»“æ„" class="headerlink" title="5.7.2 ç»“æ„"></a>5.7.2 ç»“æ„</h3><p>äº«å…ƒï¼ˆFlyweight ï¼‰æ¨¡å¼ä¸­å­˜åœ¨ä»¥ä¸‹ä¸¤ç§çŠ¶æ€ï¼š</p><ol><li>å†…éƒ¨çŠ¶æ€ï¼Œå³ä¸ä¼šéšç€ç¯å¢ƒçš„æ”¹å˜è€Œæ”¹å˜çš„å¯å…±äº«éƒ¨åˆ†ã€‚</li><li>å¤–éƒ¨çŠ¶æ€ï¼ŒæŒ‡éšç¯å¢ƒæ”¹å˜è€Œæ”¹å˜çš„ä¸å¯ä»¥å…±äº«çš„éƒ¨åˆ†ã€‚äº«å…ƒæ¨¡å¼çš„å®ç°è¦é¢†å°±æ˜¯åŒºåˆ†åº”ç”¨ä¸­çš„è¿™ä¸¤ç§çŠ¶æ€ï¼Œå¹¶å°†å¤–éƒ¨çŠ¶æ€å¤–éƒ¨åŒ–ã€‚</li></ol><p>äº«å…ƒæ¨¡å¼çš„ä¸»è¦æœ‰ä»¥ä¸‹è§’è‰²ï¼š</p><ul><li>æŠ½è±¡äº«å…ƒè§’è‰²ï¼ˆFlyweightï¼‰ï¼šé€šå¸¸æ˜¯ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»ï¼Œåœ¨æŠ½è±¡äº«å…ƒç±»ä¸­å£°æ˜äº†å…·ä½“äº«å…ƒç±»å…¬å…±çš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥å‘å¤–ç•Œæä¾›äº«å…ƒå¯¹è±¡çš„å†…éƒ¨æ•°æ®ï¼ˆå†…éƒ¨çŠ¶æ€ï¼‰ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡è¿™äº›æ–¹æ³•æ¥è®¾ç½®å¤–éƒ¨æ•°æ®ï¼ˆå¤–éƒ¨çŠ¶æ€ï¼‰ã€‚</li><li>å…·ä½“äº«å…ƒï¼ˆConcrete Flyweightï¼‰è§’è‰² ï¼šå®ƒå®ç°äº†æŠ½è±¡äº«å…ƒç±»ï¼Œç§°ä¸ºäº«å…ƒå¯¹è±¡ï¼›åœ¨å…·ä½“äº«å…ƒç±»ä¸­ä¸ºå†…éƒ¨çŠ¶æ€æä¾›äº†å­˜å‚¨ç©ºé—´ã€‚é€šå¸¸æˆ‘ä»¬å¯ä»¥ç»“åˆå•ä¾‹æ¨¡å¼æ¥è®¾è®¡å…·ä½“äº«å…ƒç±»ï¼Œä¸ºæ¯ä¸€ä¸ªå…·ä½“äº«å…ƒç±»æä¾›å”¯ä¸€çš„äº«å…ƒå¯¹è±¡ã€‚</li><li>éäº«å…ƒï¼ˆUnsharable Flyweight)è§’è‰² ï¼šå¹¶ä¸æ˜¯æ‰€æœ‰çš„æŠ½è±¡äº«å…ƒç±»çš„å­ç±»éƒ½éœ€è¦è¢«å…±äº«ï¼Œä¸èƒ½è¢«å…±äº«çš„å­ç±»å¯è®¾è®¡ä¸ºéå…±äº«å…·ä½“äº«å…ƒç±»ï¼›å½“éœ€è¦ä¸€ä¸ªéå…±äº«å…·ä½“äº«å…ƒç±»çš„å¯¹è±¡æ—¶å¯ä»¥ç›´æ¥é€šè¿‡å®ä¾‹åŒ–åˆ›å»ºã€‚</li><li>äº«å…ƒå·¥å‚ï¼ˆFlyweight Factoryï¼‰è§’è‰² ï¼šè´Ÿè´£åˆ›å»ºå’Œç®¡ç†äº«å…ƒè§’è‰²ã€‚å½“å®¢æˆ·å¯¹è±¡è¯·æ±‚ä¸€ä¸ªäº«å…ƒå¯¹è±¡æ—¶ï¼Œäº«å…ƒå·¥å‚æ£€æŸ»ç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨ç¬¦åˆè¦æ±‚çš„äº«å…ƒå¯¹è±¡ï¼Œå¦‚æœå­˜åœ¨åˆ™æä¾›ç»™å®¢æˆ·ï¼›å¦‚æœä¸å­˜åœ¨çš„è¯ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„äº«å…ƒå¯¹è±¡ã€‚</li></ul><h3 id="5-7-3-æ¡ˆä¾‹å®ç°"><a href="#5-7-3-æ¡ˆä¾‹å®ç°" class="headerlink" title="5.7.3 æ¡ˆä¾‹å®ç°"></a>5.7.3 æ¡ˆä¾‹å®ç°</h3><p>ã€ä¾‹ã€‘ä¿„ç½—æ–¯æ–¹å—</p><p>ä¸‹é¢çš„å›¾ç‰‡æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ä¿„ç½—æ–¯æ–¹å—ä¸­çš„ä¸€ä¸ªä¸ªæ–¹å—ï¼Œå¦‚æœåœ¨ä¿„ç½—æ–¯æ–¹å—è¿™ä¸ªæ¸¸æˆä¸­ï¼Œæ¯ä¸ªä¸åŒçš„æ–¹å—éƒ½æ˜¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡å°±è¦å ç”¨å¾ˆå¤šçš„å†…å­˜ç©ºé—´ï¼Œä¸‹é¢åˆ©ç”¨äº«å…ƒæ¨¡å¼è¿›è¡Œå®ç°ã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/ä¿„ç½—æ–¯æ–¹å—.jpeg" style="zoom:60%;" /><p><strong>å…ˆæ¥çœ‹ç±»å›¾ï¼š</strong></p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/äº«å…ƒæ¨¡å¼.png" style="zoom:80%;" /><p><strong>ä»£ç å¦‚ä¸‹ï¼š</strong></p><p>ä¿„ç½—æ–¯æ–¹å—æœ‰ä¸åŒçš„å½¢çŠ¶ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™äº›å½¢çŠ¶å‘ä¸ŠæŠ½å–å‡ºAbstractBoxï¼Œç”¨æ¥å®šä¹‰å…±æ€§çš„å±æ€§å’Œè¡Œä¸ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractBox</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title">getShape</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">(String color)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ–¹å—å½¢çŠ¶ï¼š&quot;</span> + <span class="keyword">this</span>.getShape() + <span class="string">&quot; é¢œè‰²ï¼š&quot;</span> + color);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±æ˜¯å®šä¹‰ä¸åŒçš„å½¢çŠ¶äº†ï¼ŒIBoxç±»ã€LBoxç±»ã€OBoxç±»ç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IBox</span> <span class="keyword">extends</span> <span class="title">AbstractBox</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getShape</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;I&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LBox</span> <span class="keyword">extends</span> <span class="title">AbstractBox</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getShape</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;L&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OBox</span> <span class="keyword">extends</span> <span class="title">AbstractBox</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getShape</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;O&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æä¾›äº†ä¸€ä¸ªå·¥å‚ç±»ï¼ˆBoxFactoryï¼‰ï¼Œç”¨æ¥ç®¡ç†äº«å…ƒå¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯AbstractBoxå­ç±»å¯¹è±¡ï¼‰ï¼Œè¯¥å·¥å‚ç±»å¯¹è±¡åªéœ€è¦ä¸€ä¸ªï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚å¹¶ç»™å·¥å‚ç±»æä¾›ä¸€ä¸ªè·å–å½¢çŠ¶çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BoxFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> HashMap&lt;String, AbstractBox&gt; map;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">BoxFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        map = <span class="keyword">new</span> HashMap&lt;String, AbstractBox&gt;();</span><br><span class="line">        AbstractBox iBox = <span class="keyword">new</span> IBox();</span><br><span class="line">        AbstractBox lBox = <span class="keyword">new</span> LBox();</span><br><span class="line">        AbstractBox oBox = <span class="keyword">new</span> OBox();</span><br><span class="line">        map.put(<span class="string">&quot;I&quot;</span>, iBox);</span><br><span class="line">        map.put(<span class="string">&quot;L&quot;</span>, lBox);</span><br><span class="line">        map.put(<span class="string">&quot;O&quot;</span>, oBox);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> BoxFactory <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> BoxFactory INSTANCE = <span class="keyword">new</span> BoxFactory();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AbstractBox <span class="title">getBox</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> map.get(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-7-5-ä¼˜ç¼ºç‚¹å’Œä½¿ç”¨åœºæ™¯"><a href="#5-7-5-ä¼˜ç¼ºç‚¹å’Œä½¿ç”¨åœºæ™¯" class="headerlink" title="5.7.5 ä¼˜ç¼ºç‚¹å’Œä½¿ç”¨åœºæ™¯"></a>5.7.5 ä¼˜ç¼ºç‚¹å’Œä½¿ç”¨åœºæ™¯</h3><p><strong>1ï¼Œä¼˜ç‚¹</strong></p><ul><li>æå¤§å‡å°‘å†…å­˜ä¸­ç›¸ä¼¼æˆ–ç›¸åŒå¯¹è±¡æ•°é‡ï¼ŒèŠ‚çº¦ç³»ç»Ÿèµ„æºï¼Œæä¾›ç³»ç»Ÿæ€§èƒ½</li><li>äº«å…ƒæ¨¡å¼ä¸­çš„å¤–éƒ¨çŠ¶æ€ç›¸å¯¹ç‹¬ç«‹ï¼Œä¸”ä¸å½±å“å†…éƒ¨çŠ¶æ€</li></ul><p><strong>2ï¼Œç¼ºç‚¹ï¼š</strong></p><p>ä¸ºäº†ä½¿å¯¹è±¡å¯ä»¥å…±äº«ï¼Œéœ€è¦å°†äº«å…ƒå¯¹è±¡çš„éƒ¨åˆ†çŠ¶æ€å¤–éƒ¨åŒ–ï¼Œåˆ†ç¦»å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ï¼Œä½¿ç¨‹åºé€»è¾‘å¤æ‚</p><p><strong>3ï¼Œä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>ä¸€ä¸ªç³»ç»Ÿæœ‰å¤§é‡ç›¸åŒæˆ–è€…ç›¸ä¼¼çš„å¯¹è±¡ï¼Œé€ æˆå†…å­˜çš„å¤§é‡è€—è´¹ã€‚</li><li>å¯¹è±¡çš„å¤§éƒ¨åˆ†çŠ¶æ€éƒ½å¯ä»¥å¤–éƒ¨åŒ–ï¼Œå¯ä»¥å°†è¿™äº›å¤–éƒ¨çŠ¶æ€ä¼ å…¥å¯¹è±¡ä¸­ã€‚</li><li>åœ¨ä½¿ç”¨äº«å…ƒæ¨¡å¼æ—¶éœ€è¦ç»´æŠ¤ä¸€ä¸ªå­˜å‚¨äº«å…ƒå¯¹è±¡çš„äº«å…ƒæ± ï¼Œè€Œè¿™éœ€è¦è€—è´¹ä¸€å®šçš„ç³»ç»Ÿèµ„æºï¼Œå› æ­¤ï¼Œåº”å½“åœ¨éœ€è¦å¤šæ¬¡é‡å¤ä½¿ç”¨äº«å…ƒå¯¹è±¡æ—¶æ‰å€¼å¾—ä½¿ç”¨äº«å…ƒæ¨¡å¼ã€‚</li></ul><h3 id="5-7-6-JDKæºç è§£æ"><a href="#5-7-6-JDKæºç è§£æ" class="headerlink" title="5.7.6 JDKæºç è§£æ"></a>5.7.6 JDKæºç è§£æ</h3><p>Integerç±»ä½¿ç”¨äº†äº«å…ƒæ¨¡å¼ã€‚æˆ‘ä»¬å…ˆçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Integer i1 = <span class="number">127</span>;</span><br><span class="line">        Integer i2 = <span class="number">127</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;i1å’Œi2å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ&quot;</span> + (i1 == i2));</span><br><span class="line"></span><br><span class="line">        Integer i3 = <span class="number">128</span>;</span><br><span class="line">        Integer i4 = <span class="number">128</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;i3å’Œi4å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ&quot;</span> + (i3 == i4));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œä¸Šé¢ä»£ç ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200208212930857.png" style="zoom:80%;" /><p>ä¸ºä»€ä¹ˆç¬¬ä¸€ä¸ªè¾“å‡ºè¯­å¥è¾“å‡ºçš„æ˜¯trueï¼Œç¬¬äºŒä¸ªè¾“å‡ºè¯­å¥è¾“å‡ºçš„æ˜¯falseï¼Ÿé€šè¿‡åç¼–è¯‘è½¯ä»¶è¿›è¡Œåç¼–è¯‘ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Integer i1 = Integer.valueOf((<span class="keyword">int</span>)<span class="number">127</span>);</span><br><span class="line">        Integer i2 Integer.valueOf((<span class="keyword">int</span>)<span class="number">127</span>);</span><br><span class="line">        System.out.println((String)<span class="keyword">new</span> StringBuilder().append((String)<span class="string">&quot;i1\u548ci2\u5bf9\u8c61\u662f\u5426\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61\uff1f&quot;</span>).append((<span class="keyword">boolean</span>)(i1 == i2)).toString());</span><br><span class="line">        Integer i3 = Integer.valueOf((<span class="keyword">int</span>)<span class="number">128</span>);</span><br><span class="line">        Integer i4 = Integer.valueOf((<span class="keyword">int</span>)<span class="number">128</span>);</span><br><span class="line">        System.out.println((String)<span class="keyword">new</span> StringBuilder().append((String)<span class="string">&quot;i3\u548ci4\u5bf9\u8c61\u662f\u5426\u662f\u540c\u4e00\u4e2a\u5bf9\u8c61\uff1f&quot;</span>).append((<span class="keyword">boolean</span>)(i3 == i4)).toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œç›´æ¥ç»™Integerç±»å‹çš„å˜é‡èµ‹å€¼åŸºæœ¬æ•°æ®ç±»å‹æ•°æ®çš„æ“ä½œåº•å±‚ä½¿ç”¨çš„æ˜¯ <code>valueOf()</code> ï¼Œæ‰€ä»¥åªéœ€è¦çœ‹è¯¥æ–¹æ³•å³å¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Integer</span> <span class="keyword">extends</span> <span class="title">Number</span> <span class="keyword">implements</span> <span class="title">Comparable</span>&lt;<span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Integer <span class="title">valueOf</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)</span><br><span class="line">            <span class="keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Integer(i);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntegerCache</span> </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> low = -<span class="number">128</span>;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> high;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">final</span> Integer cache[];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">static</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> h = <span class="number">127</span>;</span><br><span class="line">            String integerCacheHighPropValue =</span><br><span class="line">                sun.misc.VM.getSavedProperty(<span class="string">&quot;java.lang.Integer.IntegerCache.high&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (integerCacheHighPropValue != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">int</span> i = parseInt(integerCacheHighPropValue);</span><br><span class="line">                    i = Math.max(i, <span class="number">127</span>);</span><br><span class="line">                    <span class="comment">// Maximum array size is Integer.MAX_VALUE</span></span><br><span class="line">                    h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class="number">1</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span>( NumberFormatException nfe) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            high = h;</span><br><span class="line">            cache = <span class="keyword">new</span> Integer[(high - low) + <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">int</span> j = low;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; cache.length; k++)</span><br><span class="line">                cache[k] = <span class="keyword">new</span> Integer(j++);</span><br><span class="line">            <span class="comment">// range [-128, 127] must be interned (JLS7 5.1.7)</span></span><br><span class="line">            <span class="keyword">assert</span> IntegerCache.high &gt;= <span class="number">127</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">IntegerCache</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° <code>Integer</code> é»˜è®¤å…ˆåˆ›å»ºå¹¶ç¼“å­˜ <code>-128 ~ 127</code> ä¹‹é—´æ•°çš„ <code>Integer</code> å¯¹è±¡ï¼Œå½“è°ƒç”¨ <code>valueOf</code> æ—¶å¦‚æœå‚æ•°åœ¨ <code>-128 ~ 127</code> ä¹‹é—´åˆ™è®¡ç®—ä¸‹æ ‡å¹¶ä»ç¼“å­˜ä¸­è¿”å›ï¼Œå¦åˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Integer</code> å¯¹è±¡ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;5ï¼Œç»“æ„å‹æ¨¡å¼&quot;&gt;&lt;a href=&quot;#5ï¼Œç»“æ„å‹æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;5ï¼Œç»“æ„å‹æ¨¡å¼&quot;&gt;&lt;/a&gt;5ï¼Œç»“æ„å‹æ¨¡å¼&lt;/h1&gt;&lt;p&gt;ç»“æ„å‹æ¨¡å¼æè¿°å¦‚ä½•å°†ç±»æˆ–å¯¹è±¡æŒ‰æŸç§å¸ƒå±€ç»„æˆæ›´å¤§çš„ç»“æ„ã€‚å®ƒåˆ†ä¸ºç±»ç»“æ„å‹æ¨¡å¼å’Œå¯¹è±¡ç»“æ„å‹æ¨¡å¼ï¼Œå‰è€…é‡‡ç”¨ç»§</summary>
      
    
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/categories/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/tags/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="è£…é¥°è€…æ¨¡å¼" scheme="http://example.com/tags/%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="ä»£ç†æ¨¡å¼" scheme="http://example.com/tags/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="é€‚é…å™¨æ¨¡å¼" scheme="http://example.com/tags/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="æ¡¥æ¥æ¨¡å¼" scheme="http://example.com/tags/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="å¤–è§‚æ¨¡å¼" scheme="http://example.com/tags/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="ç»„åˆæ¨¡å¼" scheme="http://example.com/tags/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="äº«å…ƒæ¨¡å¼" scheme="http://example.com/tags/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>javaè®¾è®¡æ¨¡å¼--åŸå‹-åˆ›å»ºè€…æ¨¡å¼</title>
    <link href="http://example.com/2024/09/02/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8E%9F%E5%9E%8B-%E5%88%9B%E5%BB%BA%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    <id>http://example.com/2024/09/02/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8E%9F%E5%9E%8B-%E5%88%9B%E5%BB%BA%E8%80%85%E6%A8%A1%E5%BC%8F/</id>
    <published>2024-09-02T15:08:11.000Z</published>
    <updated>2024-09-02T15:18:57.930Z</updated>
    
    <content type="html"><![CDATA[<h2 id="4-3-åŸå‹æ¨¡å¼"><a href="#4-3-åŸå‹æ¨¡å¼" class="headerlink" title="4.3 åŸå‹æ¨¡å¼"></a>4.3 åŸå‹æ¨¡å¼</h2><h3 id="4-3-1-æ¦‚è¿°"><a href="#4-3-1-æ¦‚è¿°" class="headerlink" title="4.3.1 æ¦‚è¿°"></a>4.3.1 æ¦‚è¿°</h3><p>ç”¨ä¸€ä¸ªå·²ç»åˆ›å»ºçš„å®ä¾‹ä½œä¸ºåŸå‹ï¼Œé€šè¿‡å¤åˆ¶è¯¥åŸå‹å¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªå’ŒåŸå‹å¯¹è±¡ç›¸åŒçš„æ–°å¯¹è±¡ã€‚</p><h3 id="4-3-2-ç»“æ„"><a href="#4-3-2-ç»“æ„" class="headerlink" title="4.3.2 ç»“æ„"></a>4.3.2 ç»“æ„</h3><p>åŸå‹æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li>æŠ½è±¡åŸå‹ç±»ï¼šè§„å®šäº†å…·ä½“åŸå‹å¯¹è±¡å¿…é¡»å®ç°çš„çš„ clone() æ–¹æ³•ã€‚</li><li>å…·ä½“åŸå‹ç±»ï¼šå®ç°æŠ½è±¡åŸå‹ç±»çš„ clone() æ–¹æ³•ï¼Œå®ƒæ˜¯å¯è¢«å¤åˆ¶çš„å¯¹è±¡ã€‚</li><li>è®¿é—®ç±»ï¼šä½¿ç”¨å…·ä½“åŸå‹ç±»ä¸­çš„ clone() æ–¹æ³•æ¥å¤åˆ¶æ–°çš„å¯¹è±¡ã€‚</li></ul><p>æ¥å£ç±»å›¾å¦‚ä¸‹ï¼š</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F.png"></p><h3 id="4-3-3-å®ç°"><a href="#4-3-3-å®ç°" class="headerlink" title="4.3.3 å®ç°"></a>4.3.3 å®ç°</h3><p>åŸå‹æ¨¡å¼çš„å…‹éš†åˆ†ä¸ºæµ…å…‹éš†å’Œæ·±å…‹éš†ã€‚</p><blockquote><p>æµ…å…‹éš†ï¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œæ–°å¯¹è±¡çš„å±æ€§å’ŒåŸæ¥å¯¹è±¡å®Œå…¨ç›¸åŒï¼Œå¯¹äºéåŸºæœ¬ç±»å‹å±æ€§ï¼Œä»æŒ‡å‘åŸæœ‰å±æ€§æ‰€æŒ‡å‘çš„å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚</p><p>æ·±å…‹éš†ï¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå±æ€§ä¸­å¼•ç”¨çš„å…¶ä»–å¯¹è±¡ä¹Ÿä¼šè¢«å…‹éš†ï¼Œä¸å†æŒ‡å‘åŸæœ‰å¯¹è±¡åœ°å€ã€‚</p></blockquote><p>Javaä¸­çš„Objectç±»ä¸­æä¾›äº† <code>clone()</code> æ–¹æ³•æ¥å®ç°æµ…å…‹éš†ã€‚ Cloneable æ¥å£æ˜¯ä¸Šé¢çš„ç±»å›¾ä¸­çš„æŠ½è±¡åŸå‹ç±»ï¼Œè€Œå®ç°äº†Cloneableæ¥å£çš„å­å®ç°ç±»å°±æ˜¯å…·ä½“çš„åŸå‹ç±»ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><p><strong>Realizetypeï¼ˆå…·ä½“çš„åŸå‹ç±»ï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Realizetype</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Realizetype</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…·ä½“çš„åŸå‹å¯¹è±¡åˆ›å»ºå®Œæˆï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Realizetype <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…·ä½“åŸå‹å¤åˆ¶æˆåŠŸï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> (Realizetype) <span class="keyword">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>PrototypeTestï¼ˆæµ‹è¯•è®¿é—®ç±»ï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrototypeTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        Realizetype r1 = <span class="keyword">new</span> Realizetype();</span><br><span class="line">        Realizetype r2 = r1.clone();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;å¯¹è±¡r1å’Œr2æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ&quot;</span> + (r1 == r2));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-3-4-æ¡ˆä¾‹"><a href="#4-3-4-æ¡ˆä¾‹" class="headerlink" title="4.3.4 æ¡ˆä¾‹"></a>4.3.4 æ¡ˆä¾‹</h3><p><strong>ç”¨åŸå‹æ¨¡å¼ç”Ÿæˆâ€œä¸‰å¥½å­¦ç”Ÿâ€å¥–çŠ¶</strong></p><p>åŒä¸€å­¦æ ¡çš„â€œä¸‰å¥½å­¦ç”Ÿâ€å¥–çŠ¶é™¤äº†è·å¥–äººå§“åä¸åŒï¼Œå…¶ä»–éƒ½ç›¸åŒï¼Œå¯ä»¥ä½¿ç”¨åŸå‹æ¨¡å¼å¤åˆ¶å¤šä¸ªâ€œä¸‰å¥½å­¦ç”Ÿâ€å¥–çŠ¶å‡ºæ¥ï¼Œç„¶ååœ¨ä¿®æ”¹å¥–çŠ¶ä¸Šçš„åå­—å³å¯ã€‚</p><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/åŸå‹æ¨¡å¼1.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¥–çŠ¶ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Citation</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(name + <span class="string">&quot;åŒå­¦ï¼šåœ¨2020å­¦å¹´ç¬¬ä¸€å­¦æœŸä¸­è¡¨ç°ä¼˜ç§€ï¼Œè¢«è¯„ä¸ºä¸‰å¥½å­¦ç”Ÿã€‚ç‰¹å‘æ­¤çŠ¶ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Citation <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (Citation) <span class="keyword">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•è®¿é—®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CitationTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        Citation c1 = <span class="keyword">new</span> Citation();</span><br><span class="line">        c1.setName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¤åˆ¶å¥–çŠ¶</span></span><br><span class="line">        Citation c2 = c1.clone();</span><br><span class="line">        <span class="comment">//å°†å¥–çŠ¶çš„åå­—ä¿®æ”¹æå››</span></span><br><span class="line">        c2.setName(<span class="string">&quot;æå››&quot;</span>);</span><br><span class="line"></span><br><span class="line">        c1.show();</span><br><span class="line">        c2.show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-3-5-ä½¿ç”¨åœºæ™¯"><a href="#4-3-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="4.3.5 ä½¿ç”¨åœºæ™¯"></a>4.3.5 ä½¿ç”¨åœºæ™¯</h3><ul><li>å¯¹è±¡çš„åˆ›å»ºéå¸¸å¤æ‚ï¼Œå¯ä»¥ä½¿ç”¨åŸå‹æ¨¡å¼å¿«æ·çš„åˆ›å»ºå¯¹è±¡ã€‚</li><li>æ€§èƒ½å’Œå®‰å…¨è¦æ±‚æ¯”è¾ƒé«˜ã€‚</li></ul><h3 id="4-3-6-æ‰©å±•ï¼ˆæ·±å…‹éš†ï¼‰"><a href="#4-3-6-æ‰©å±•ï¼ˆæ·±å…‹éš†ï¼‰" class="headerlink" title="4.3.6 æ‰©å±•ï¼ˆæ·±å…‹éš†ï¼‰"></a>4.3.6 æ‰©å±•ï¼ˆæ·±å…‹éš†ï¼‰</h3><p>å°†ä¸Šé¢çš„â€œä¸‰å¥½å­¦ç”Ÿâ€å¥–çŠ¶çš„æ¡ˆä¾‹ä¸­Citationç±»çš„nameå±æ€§ä¿®æ”¹ä¸ºStudentç±»å‹çš„å±æ€§ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¥–çŠ¶ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Citation</span> <span class="keyword">implements</span> <span class="title">Cloneable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Student stu;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">getStu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> stu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStu</span><span class="params">(Student stu)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.stu = stu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(stu.getName() + <span class="string">&quot;åŒå­¦ï¼šåœ¨2020å­¦å¹´ç¬¬ä¸€å­¦æœŸä¸­è¡¨ç°ä¼˜ç§€ï¼Œè¢«è¯„ä¸ºä¸‰å¥½å­¦ç”Ÿã€‚ç‰¹å‘æ­¤çŠ¶ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Citation <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (Citation) <span class="keyword">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å­¦ç”Ÿç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name, String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CitationTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line"></span><br><span class="line">        Citation c1 = <span class="keyword">new</span> Citation();</span><br><span class="line">        Student stu = <span class="keyword">new</span> Student(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="string">&quot;è¥¿å®‰&quot;</span>);</span><br><span class="line">        c1.setStu(stu);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¤åˆ¶å¥–çŠ¶</span></span><br><span class="line">        Citation c2 = c1.clone();</span><br><span class="line">        <span class="comment">//è·å–c2å¥–çŠ¶æ‰€å±å­¦ç”Ÿå¯¹è±¡</span></span><br><span class="line">        Student stu1 = c2.getStu();</span><br><span class="line">        stu1.setName(<span class="string">&quot;æå››&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­stuå¯¹è±¡å’Œstu1å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(<span class="string">&quot;stuå’Œstu1æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ&quot;</span> + (stu == stu1));</span><br><span class="line"></span><br><span class="line">        c1.show();</span><br><span class="line">        c2.show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœä¸ºï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/åŸå‹æ¨¡å¼2.png" style="zoom:80%;" /><p><font color="red">è¯´æ˜ï¼š</font></p><p>â€‹    stuå¯¹è±¡å’Œstu1å¯¹è±¡æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šäº§ç”Ÿå°†stu1å¯¹è±¡ä¸­nameå±æ€§å€¼æ”¹ä¸ºâ€œæå››â€ï¼Œä¸¤ä¸ªCitationï¼ˆå¥–çŠ¶ï¼‰å¯¹è±¡ä¸­æ˜¾ç¤ºçš„éƒ½æ˜¯æå››ã€‚è¿™å°±æ˜¯æµ…å…‹éš†çš„æ•ˆæœï¼Œå¯¹å…·ä½“åŸå‹ç±»ï¼ˆCitationï¼‰ä¸­çš„å¼•ç”¨ç±»å‹çš„å±æ€§è¿›è¡Œå¼•ç”¨çš„å¤åˆ¶ã€‚è¿™ç§æƒ…å†µéœ€è¦ä½¿ç”¨æ·±å…‹éš†ï¼Œè€Œè¿›è¡Œæ·±å…‹éš†éœ€è¦ä½¿ç”¨å¯¹è±¡æµã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CitationTest1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Citation c1 = <span class="keyword">new</span> Citation();</span><br><span class="line">        Student stu = <span class="keyword">new</span> Student(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="string">&quot;è¥¿å®‰&quot;</span>);</span><br><span class="line">        c1.setStu(stu);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡è¾“å‡ºæµå¯¹è±¡</span></span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">&quot;C:\\Users\\Think\\Desktop\\b.txt&quot;</span>));</span><br><span class="line">        <span class="comment">//å°†c1å¯¹è±¡å†™å‡ºåˆ°æ–‡ä»¶ä¸­</span></span><br><span class="line">        oos.writeObject(c1);</span><br><span class="line">        oos.close();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡å‡ºå…¥æµå¯¹è±¡</span></span><br><span class="line">        ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">&quot;C:\\Users\\Think\\Desktop\\b.txt&quot;</span>));</span><br><span class="line">        <span class="comment">//è¯»å–å¯¹è±¡</span></span><br><span class="line">        Citation c2 = (Citation) ois.readObject();</span><br><span class="line">        <span class="comment">//è·å–c2å¥–çŠ¶æ‰€å±å­¦ç”Ÿå¯¹è±¡</span></span><br><span class="line">        Student stu1 = c2.getStu();</span><br><span class="line">        stu1.setName(<span class="string">&quot;æå››&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­stuå¯¹è±¡å’Œstu1å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(<span class="string">&quot;stuå’Œstu1æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ&quot;</span> + (stu == stu1));</span><br><span class="line"></span><br><span class="line">        c1.show();</span><br><span class="line">        c2.show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœä¸ºï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/åŸå‹æ¨¡å¼3.png" style="zoom:80%;" /><blockquote><p>æ³¨æ„ï¼šCitationç±»å’ŒStudentç±»å¿…é¡»å®ç°Serializableæ¥å£ï¼Œå¦åˆ™ä¼šæŠ›NotSerializableExceptionå¼‚å¸¸ã€‚</p></blockquote><h2 id="4-5-å»ºé€ è€…æ¨¡å¼"><a href="#4-5-å»ºé€ è€…æ¨¡å¼" class="headerlink" title="4.5 å»ºé€ è€…æ¨¡å¼"></a>4.5 å»ºé€ è€…æ¨¡å¼</h2><h3 id="4-4-1-æ¦‚è¿°"><a href="#4-4-1-æ¦‚è¿°" class="headerlink" title="4.4.1 æ¦‚è¿°"></a>4.4.1 æ¦‚è¿°</h3><p>å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/image-20200413225341516.png" style="zoom:60%;" /><ul><li>åˆ†ç¦»äº†éƒ¨ä»¶çš„æ„é€ (ç”±Builderæ¥è´Ÿè´£)å’Œè£…é…(ç”±Directorè´Ÿè´£)ã€‚ ä»è€Œå¯ä»¥æ„é€ å‡ºå¤æ‚çš„å¯¹è±¡ã€‚è¿™ä¸ªæ¨¡å¼é€‚ç”¨äºï¼šæŸä¸ªå¯¹è±¡çš„æ„å»ºè¿‡ç¨‹å¤æ‚çš„æƒ…å†µã€‚</li><li>ç”±äºå®ç°äº†æ„å»ºå’Œè£…é…çš„è§£è€¦ã€‚ä¸åŒçš„æ„å»ºå™¨ï¼Œç›¸åŒçš„è£…é…ï¼Œä¹Ÿå¯ä»¥åšå‡ºä¸åŒçš„å¯¹è±¡ï¼›ç›¸åŒçš„æ„å»ºå™¨ï¼Œä¸åŒçš„è£…é…é¡ºåºä¹Ÿå¯ä»¥åšå‡ºä¸åŒçš„å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯å®ç°äº†æ„å»ºç®—æ³•ã€è£…é…ç®—æ³•çš„è§£è€¦ï¼Œå®ç°äº†æ›´å¥½çš„å¤ç”¨ã€‚</li><li>å»ºé€ è€…æ¨¡å¼å¯ä»¥å°†éƒ¨ä»¶å’Œå…¶ç»„è£…è¿‡ç¨‹åˆ†å¼€ï¼Œä¸€æ­¥ä¸€æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚ç”¨æˆ·åªéœ€è¦æŒ‡å®šå¤æ‚å¯¹è±¡çš„ç±»å‹å°±å¯ä»¥å¾—åˆ°è¯¥å¯¹è±¡ï¼Œè€Œæ— é¡»çŸ¥é“å…¶å†…éƒ¨çš„å…·ä½“æ„é€ ç»†èŠ‚ã€‚</li></ul><h3 id="4-4-2-ç»“æ„"><a href="#4-4-2-ç»“æ„" class="headerlink" title="4.4.2 ç»“æ„"></a>4.4.2 ç»“æ„</h3><p>å»ºé€ è€…ï¼ˆBuilderï¼‰æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li><p>æŠ½è±¡å»ºé€ è€…ç±»ï¼ˆBuilderï¼‰ï¼šè¿™ä¸ªæ¥å£è§„å®šè¦å®ç°å¤æ‚å¯¹è±¡çš„é‚£äº›éƒ¨åˆ†çš„åˆ›å»ºï¼Œå¹¶ä¸æ¶‰åŠå…·ä½“çš„éƒ¨ä»¶å¯¹è±¡çš„åˆ›å»ºã€‚ </p></li><li><p>å…·ä½“å»ºé€ è€…ç±»ï¼ˆConcreteBuilderï¼‰ï¼šå®ç° Builder æ¥å£ï¼Œå®Œæˆå¤æ‚äº§å“çš„å„ä¸ªéƒ¨ä»¶çš„å…·ä½“åˆ›å»ºæ–¹æ³•ã€‚åœ¨æ„é€ è¿‡ç¨‹å®Œæˆåï¼Œæä¾›äº§å“çš„å®ä¾‹ã€‚ </p></li><li><p>äº§å“ç±»ï¼ˆProductï¼‰ï¼šè¦åˆ›å»ºçš„å¤æ‚å¯¹è±¡ã€‚</p></li><li><p>æŒ‡æŒ¥è€…ç±»ï¼ˆDirectorï¼‰ï¼šè°ƒç”¨å…·ä½“å»ºé€ è€…æ¥åˆ›å»ºå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨åˆ†ï¼Œåœ¨æŒ‡å¯¼è€…ä¸­ä¸æ¶‰åŠå…·ä½“äº§å“çš„ä¿¡æ¯ï¼Œåªè´Ÿè´£ä¿è¯å¯¹è±¡å„éƒ¨åˆ†å®Œæ•´åˆ›å»ºæˆ–æŒ‰æŸç§é¡ºåºåˆ›å»ºã€‚ </p></li></ul><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å»ºé€ è€…æ¨¡å¼.png" style="zoom:80%;" /><h3 id="4-4-3-å®ä¾‹"><a href="#4-4-3-å®ä¾‹" class="headerlink" title="4.4.3 å®ä¾‹"></a>4.4.3 å®ä¾‹</h3><p><strong>åˆ›å»ºå…±äº«å•è½¦</strong></p><p>ç”Ÿäº§è‡ªè¡Œè½¦æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œå®ƒåŒ…å«äº†è½¦æ¶ï¼Œè½¦åº§ç­‰ç»„ä»¶çš„ç”Ÿäº§ã€‚è€Œè½¦æ¶åˆæœ‰ç¢³çº¤ç»´ï¼Œé“åˆé‡‘ç­‰æè´¨çš„ï¼Œè½¦åº§æœ‰æ©¡èƒ¶ï¼ŒçœŸçš®ç­‰æè´¨ã€‚å¯¹äºè‡ªè¡Œè½¦çš„ç”Ÿäº§å°±å¯ä»¥ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ã€‚</p><p>è¿™é‡ŒBikeæ˜¯äº§å“ï¼ŒåŒ…å«è½¦æ¶ï¼Œè½¦åº§ç­‰ç»„ä»¶ï¼›Builderæ˜¯æŠ½è±¡å»ºé€ è€…ï¼ŒMobikeBuilderå’ŒOfoBuilderæ˜¯å…·ä½“çš„å»ºé€ è€…ï¼›Directoræ˜¯æŒ‡æŒ¥è€…ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å»ºé€ è€…æ¨¡å¼1.png" style="zoom:80%;" /><p>å…·ä½“çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è‡ªè¡Œè½¦ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bike</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String frame;</span><br><span class="line">    <span class="keyword">private</span> String seat;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFrame</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> frame;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFrame</span><span class="params">(String frame)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.frame = frame;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSeat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> seat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSeat</span><span class="params">(String seat)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.seat = seat;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ½è±¡ builder ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> Bike mBike = <span class="keyword">new</span> Bike();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildFrame</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildSeat</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Bike <span class="title">createBike</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‘©æ‹œå•è½¦Builderç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MobikeBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildFrame</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mBike.setFrame(<span class="string">&quot;é“åˆé‡‘è½¦æ¶&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildSeat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mBike.setSeat(<span class="string">&quot;çœŸçš®è½¦åº§&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Bike <span class="title">createBike</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mBike;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ofoå•è½¦Builderç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OfoBuilder</span> <span class="keyword">extends</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildFrame</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mBike.setFrame(<span class="string">&quot;ç¢³çº¤ç»´è½¦æ¶&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildSeat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mBike.setSeat(<span class="string">&quot;æ©¡èƒ¶è½¦åº§&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Bike <span class="title">createBike</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mBike;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡æŒ¥è€…ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Director</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Builder mBuilder;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Director</span><span class="params">(Builder builder)</span> </span>&#123;</span><br><span class="line">        mBuilder = builder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Bike <span class="title">construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        mBuilder.buildFrame();</span><br><span class="line">        mBuilder.buildSeat();</span><br><span class="line">        <span class="keyword">return</span> mBuilder.createBike();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        showBike(<span class="keyword">new</span> OfoBuilder());</span><br><span class="line">        showBike(<span class="keyword">new</span> MobikeBuilder());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">showBike</span><span class="params">(Builder builder)</span> </span>&#123;</span><br><span class="line">        Director director = <span class="keyword">new</span> Director(builder);</span><br><span class="line">        Bike bike = director.construct();</span><br><span class="line">        System.out.println(bike.getFrame());</span><br><span class="line">        System.out.println(bike.getSeat());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong></p><p>ä¸Šé¢ç¤ºä¾‹æ˜¯ Builderæ¨¡å¼çš„å¸¸è§„ç”¨æ³•ï¼ŒæŒ‡æŒ¥è€…ç±» Director åœ¨å»ºé€ è€…æ¨¡å¼ä¸­å…·æœ‰å¾ˆé‡è¦çš„ä½œç”¨ï¼Œå®ƒç”¨äºæŒ‡å¯¼å…·ä½“æ„å»ºè€…å¦‚ä½•æ„å»ºäº§å“ï¼Œæ§åˆ¶è°ƒç”¨å…ˆåæ¬¡åºï¼Œå¹¶å‘è°ƒç”¨è€…è¿”å›å®Œæ•´çš„äº§å“ç±»ï¼Œä½†æ˜¯æœ‰äº›æƒ…å†µä¸‹éœ€è¦ç®€åŒ–ç³»ç»Ÿç»“æ„ï¼Œå¯ä»¥æŠŠæŒ‡æŒ¥è€…ç±»å’ŒæŠ½è±¡å»ºé€ è€…è¿›è¡Œç»“åˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŠ½è±¡ builder ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> Bike mBike = <span class="keyword">new</span> Bike();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildFrame</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildSeat</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> Bike <span class="title">createBike</span><span class="params">()</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Bike <span class="title">construct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.buildFrame();</span><br><span class="line">        <span class="keyword">this</span>.BuildSeat();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.createBike();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜ï¼š</strong></p><p>è¿™æ ·åšç¡®å®ç®€åŒ–äº†ç³»ç»Ÿç»“æ„ï¼Œä½†åŒæ—¶ä¹ŸåŠ é‡äº†æŠ½è±¡å»ºé€ è€…ç±»çš„èŒè´£ï¼Œä¹Ÿä¸æ˜¯å¤ªç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ï¼Œå¦‚æœconstruct() è¿‡äºå¤æ‚ï¼Œå»ºè®®è¿˜æ˜¯å°è£…åˆ° Director ä¸­ã€‚</p><h3 id="4-4-4-ä¼˜ç¼ºç‚¹"><a href="#4-4-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="4.4.4 ä¼˜ç¼ºç‚¹"></a>4.4.4 ä¼˜ç¼ºç‚¹</h3><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>å»ºé€ è€…æ¨¡å¼çš„å°è£…æ€§å¾ˆå¥½ã€‚ä½¿ç”¨å»ºé€ è€…æ¨¡å¼å¯ä»¥æœ‰æ•ˆçš„å°è£…å˜åŒ–ï¼Œåœ¨ä½¿ç”¨å»ºé€ è€…æ¨¡å¼çš„åœºæ™¯ä¸­ï¼Œä¸€èˆ¬äº§å“ç±»å’Œå»ºé€ è€…ç±»æ˜¯æ¯”è¾ƒç¨³å®šçš„ï¼Œå› æ­¤ï¼Œå°†ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘å°è£…åœ¨æŒ‡æŒ¥è€…ç±»ä¸­å¯¹æ•´ä½“è€Œè¨€å¯ä»¥å–å¾—æ¯”è¾ƒå¥½çš„ç¨³å®šæ€§ã€‚</li><li>åœ¨å»ºé€ è€…æ¨¡å¼ä¸­ï¼Œå®¢æˆ·ç«¯ä¸å¿…çŸ¥é“äº§å“å†…éƒ¨ç»„æˆçš„ç»†èŠ‚ï¼Œå°†äº§å“æœ¬èº«ä¸äº§å“çš„åˆ›å»ºè¿‡ç¨‹è§£è€¦ï¼Œä½¿å¾—ç›¸åŒçš„åˆ›å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“å¯¹è±¡ã€‚</li><li>å¯ä»¥æ›´åŠ ç²¾ç»†åœ°æ§åˆ¶äº§å“çš„åˆ›å»ºè¿‡ç¨‹ ã€‚å°†å¤æ‚äº§å“çš„åˆ›å»ºæ­¥éª¤åˆ†è§£åœ¨ä¸åŒçš„æ–¹æ³•ä¸­ï¼Œä½¿å¾—åˆ›å»ºè¿‡ç¨‹æ›´åŠ æ¸…æ™°ï¼Œä¹Ÿæ›´æ–¹ä¾¿ä½¿ç”¨ç¨‹åºæ¥æ§åˆ¶åˆ›å»ºè¿‡ç¨‹ã€‚</li><li>å»ºé€ è€…æ¨¡å¼å¾ˆå®¹æ˜“è¿›è¡Œæ‰©å±•ã€‚å¦‚æœæœ‰æ–°çš„éœ€æ±‚ï¼Œé€šè¿‡å®ç°ä¸€ä¸ªæ–°çš„å»ºé€ è€…ç±»å°±å¯ä»¥å®Œæˆï¼ŒåŸºæœ¬ä¸Šä¸ç”¨ä¿®æ”¹ä¹‹å‰å·²ç»æµ‹è¯•é€šè¿‡çš„ä»£ç ï¼Œå› æ­¤ä¹Ÿå°±ä¸ä¼šå¯¹åŸæœ‰åŠŸèƒ½å¼•å…¥é£é™©ã€‚ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>é€ è€…æ¨¡å¼æ‰€åˆ›å»ºçš„äº§å“ä¸€èˆ¬å…·æœ‰è¾ƒå¤šçš„å…±åŒç‚¹ï¼Œå…¶ç»„æˆéƒ¨åˆ†ç›¸ä¼¼ï¼Œå¦‚æœäº§å“ä¹‹é—´çš„å·®å¼‚æ€§å¾ˆå¤§ï¼Œåˆ™ä¸é€‚åˆä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œå› æ­¤å…¶ä½¿ç”¨èŒƒå›´å—åˆ°ä¸€å®šçš„é™åˆ¶ã€‚</p><h3 id="4-4-5-ä½¿ç”¨åœºæ™¯"><a href="#4-4-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="4.4.5 ä½¿ç”¨åœºæ™¯"></a>4.4.5 ä½¿ç”¨åœºæ™¯</h3><p>å»ºé€ è€…ï¼ˆBuilderï¼‰æ¨¡å¼åˆ›å»ºçš„æ˜¯å¤æ‚å¯¹è±¡ï¼Œå…¶äº§å“çš„å„ä¸ªéƒ¨åˆ†ç»å¸¸é¢ä¸´ç€å‰§çƒˆçš„å˜åŒ–ï¼Œä½†å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·çš„ç®—æ³•å´ç›¸å¯¹ç¨³å®šï¼Œæ‰€ä»¥å®ƒé€šå¸¸åœ¨ä»¥ä¸‹åœºåˆä½¿ç”¨ã€‚</p><ul><li>åˆ›å»ºçš„å¯¹è±¡è¾ƒå¤æ‚ï¼Œç”±å¤šä¸ªéƒ¨ä»¶æ„æˆï¼Œå„éƒ¨ä»¶é¢ä¸´ç€å¤æ‚çš„å˜åŒ–ï¼Œä½†æ„ä»¶é—´çš„å»ºé€ é¡ºåºæ˜¯ç¨³å®šçš„ã€‚</li><li>åˆ›å»ºå¤æ‚å¯¹è±¡çš„ç®—æ³•ç‹¬ç«‹äºè¯¥å¯¹è±¡çš„ç»„æˆéƒ¨åˆ†ä»¥åŠå®ƒä»¬çš„è£…é…æ–¹å¼ï¼Œå³äº§å“çš„æ„å»ºè¿‡ç¨‹å’Œæœ€ç»ˆçš„è¡¨ç¤ºæ˜¯ç‹¬ç«‹çš„ã€‚</li></ul><h3 id="4-4-6-æ¨¡å¼æ‰©å±•"><a href="#4-4-6-æ¨¡å¼æ‰©å±•" class="headerlink" title="4.4.6 æ¨¡å¼æ‰©å±•"></a>4.4.6 æ¨¡å¼æ‰©å±•</h3><p>å»ºé€ è€…æ¨¡å¼é™¤äº†ä¸Šé¢çš„ç”¨é€”å¤–ï¼Œåœ¨å¼€å‘ä¸­è¿˜æœ‰ä¸€ä¸ªå¸¸ç”¨çš„ä½¿ç”¨æ–¹å¼ï¼Œå°±æ˜¯å½“ä¸€ä¸ªç±»æ„é€ å™¨éœ€è¦ä¼ å…¥å¾ˆå¤šå‚æ•°æ—¶ï¼Œå¦‚æœåˆ›å»ºè¿™ä¸ªç±»çš„å®ä¾‹ï¼Œä»£ç å¯è¯»æ€§ä¼šéå¸¸å·®ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å¼•å…¥é”™è¯¯ï¼Œæ­¤æ—¶å°±å¯ä»¥åˆ©ç”¨å»ºé€ è€…æ¨¡å¼è¿›è¡Œé‡æ„ã€‚</p><p>é‡æ„å‰ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String cpu;</span><br><span class="line">    <span class="keyword">private</span> String screen;</span><br><span class="line">    <span class="keyword">private</span> String memory;</span><br><span class="line">    <span class="keyword">private</span> String mainboard;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Phone</span><span class="params">(String cpu, String screen, String memory, String mainboard)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.cpu = cpu;</span><br><span class="line">        <span class="keyword">this</span>.screen = screen;</span><br><span class="line">        <span class="keyword">this</span>.memory = memory;</span><br><span class="line">        <span class="keyword">this</span>.mainboard = mainboard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCpu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cpu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCpu</span><span class="params">(String cpu)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.cpu = cpu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getScreen</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> screen;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setScreen</span><span class="params">(String screen)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.screen = screen;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMemory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> memory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMemory</span><span class="params">(String memory)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.memory = memory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMainboard</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mainboard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMainboard</span><span class="params">(String mainboard)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mainboard = mainboard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Phone&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;cpu=&#x27;&quot;</span> + cpu + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, screen=&#x27;&quot;</span> + screen + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, memory=&#x27;&quot;</span> + memory + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, mainboard=&#x27;&quot;</span> + mainboard + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ„å»ºPhoneå¯¹è±¡</span></span><br><span class="line">        Phone phone = <span class="keyword">new</span> Phone(<span class="string">&quot;intel&quot;</span>,<span class="string">&quot;ä¸‰æ˜Ÿå±å¹•&quot;</span>,<span class="string">&quot;é‡‘å£«é¡¿&quot;</span>,<span class="string">&quot;åç¡•&quot;</span>);</span><br><span class="line">        System.out.println(phone);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­æ„å»ºPhoneå¯¹è±¡ï¼Œä¼ é€’äº†å››ä¸ªå‚æ•°ï¼Œå¦‚æœå‚æ•°æ›´å¤šå‘¢ï¼Ÿä»£ç çš„å¯è¯»æ€§åŠä½¿ç”¨çš„æˆæœ¬å°±æ˜¯æ¯”è¾ƒé«˜ã€‚</p><p>é‡æ„åä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String cpu;</span><br><span class="line">    <span class="keyword">private</span> String screen;</span><br><span class="line">    <span class="keyword">private</span> String memory;</span><br><span class="line">    <span class="keyword">private</span> String mainboard;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Phone</span><span class="params">(Builder builder)</span> </span>&#123;</span><br><span class="line">        cpu = builder.cpu;</span><br><span class="line">        screen = builder.screen;</span><br><span class="line">        memory = builder.memory;</span><br><span class="line">        mainboard = builder.mainboard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Builder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String cpu;</span><br><span class="line">        <span class="keyword">private</span> String screen;</span><br><span class="line">        <span class="keyword">private</span> String memory;</span><br><span class="line">        <span class="keyword">private</span> String mainboard;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Builder</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">cpu</span><span class="params">(String val)</span> </span>&#123;</span><br><span class="line">            cpu = val;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">screen</span><span class="params">(String val)</span> </span>&#123;</span><br><span class="line">            screen = val;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">memory</span><span class="params">(String val)</span> </span>&#123;</span><br><span class="line">            memory = val;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Builder <span class="title">mainboard</span><span class="params">(String val)</span> </span>&#123;</span><br><span class="line">            mainboard = val;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> Phone <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Phone(<span class="keyword">this</span>);&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Phone&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;cpu=&#x27;&quot;</span> + cpu + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, screen=&#x27;&quot;</span> + screen + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, memory=&#x27;&quot;</span> + memory + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, mainboard=&#x27;&quot;</span> + mainboard + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Phone phone = <span class="keyword">new</span> Phone.Builder()</span><br><span class="line">                .cpu(<span class="string">&quot;intel&quot;</span>)</span><br><span class="line">                .mainboard(<span class="string">&quot;åç¡•&quot;</span>)</span><br><span class="line">                .memory(<span class="string">&quot;é‡‘å£«é¡¿&quot;</span>)</span><br><span class="line">                .screen(<span class="string">&quot;ä¸‰æ˜Ÿ&quot;</span>)</span><br><span class="line">                .build();</span><br><span class="line">        System.out.println(phone);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡æ„åçš„ä»£ç åœ¨ä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ï¼ŒæŸç§ç¨‹åº¦ä¸Šä¹Ÿå¯ä»¥æé«˜å¼€å‘æ•ˆç‡ã€‚ä»è½¯ä»¶è®¾è®¡ä¸Šï¼Œå¯¹ç¨‹åºå‘˜çš„è¦æ±‚æ¯”è¾ƒé«˜ã€‚</p><h2 id="4-6-åˆ›å»ºè€…æ¨¡å¼å¯¹æ¯”"><a href="#4-6-åˆ›å»ºè€…æ¨¡å¼å¯¹æ¯”" class="headerlink" title="4.6 åˆ›å»ºè€…æ¨¡å¼å¯¹æ¯”"></a>4.6 åˆ›å»ºè€…æ¨¡å¼å¯¹æ¯”</h2><h3 id="4-6-1-å·¥å‚æ–¹æ³•æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼"><a href="#4-6-1-å·¥å‚æ–¹æ³•æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼" class="headerlink" title="4.6.1 å·¥å‚æ–¹æ³•æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼"></a>4.6.1 å·¥å‚æ–¹æ³•æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼</h3><p>å·¥å‚æ–¹æ³•æ¨¡å¼æ³¨é‡çš„æ˜¯æ•´ä½“å¯¹è±¡çš„åˆ›å»ºæ–¹å¼ï¼›è€Œå»ºé€ è€…æ¨¡å¼æ³¨é‡çš„æ˜¯éƒ¨ä»¶æ„å»ºçš„è¿‡ç¨‹ï¼Œæ„åœ¨é€šè¿‡ä¸€æ­¥ä¸€æ­¥åœ°ç²¾ç¡®æ„é€ åˆ›å»ºå‡ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚</p><p>æˆ‘ä»¬ä¸¾ä¸ªç®€å•ä¾‹å­æ¥è¯´æ˜ä¸¤è€…çš„å·®å¼‚ï¼Œå¦‚è¦åˆ¶é€ ä¸€ä¸ªè¶…äººï¼Œå¦‚æœä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œç›´æ¥äº§ç”Ÿå‡ºæ¥çš„å°±æ˜¯ä¸€ä¸ªåŠ›å¤§æ— ç©·ã€èƒ½å¤Ÿé£ç¿”ã€å†…è£¤å¤–ç©¿çš„è¶…äººï¼›è€Œå¦‚æœä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œåˆ™éœ€è¦ç»„è£…æ‰‹ã€å¤´ã€è„šã€èº¯å¹²ç­‰éƒ¨åˆ†ï¼Œç„¶åå†æŠŠå†…è£¤å¤–ç©¿ï¼Œäºæ˜¯ä¸€ä¸ªè¶…äººå°±è¯ç”Ÿäº†ã€‚</p><h3 id="4-6-2-æŠ½è±¡å·¥å‚æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼"><a href="#4-6-2-æŠ½è±¡å·¥å‚æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼" class="headerlink" title="4.6.2 æŠ½è±¡å·¥å‚æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼"></a>4.6.2 æŠ½è±¡å·¥å‚æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼</h3><p>æŠ½è±¡å·¥å‚æ¨¡å¼å®ç°å¯¹äº§å“å®¶æ—çš„åˆ›å»ºï¼Œä¸€ä¸ªäº§å“å®¶æ—æ˜¯è¿™æ ·çš„ä¸€ç³»åˆ—äº§å“ï¼šå…·æœ‰ä¸åŒåˆ†ç±»ç»´åº¦çš„äº§å“ç»„åˆï¼Œé‡‡ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼åˆ™æ˜¯ä¸éœ€è¦å…³å¿ƒæ„å»ºè¿‡ç¨‹ï¼Œåªå…³å¿ƒä»€ä¹ˆäº§å“ç”±ä»€ä¹ˆå·¥å‚ç”Ÿäº§å³å¯ã€‚</p><p>å»ºé€ è€…æ¨¡å¼åˆ™æ˜¯è¦æ±‚æŒ‰ç…§æŒ‡å®šçš„è“å›¾å»ºé€ äº§å“ï¼Œå®ƒçš„ä¸»è¦ç›®çš„æ˜¯é€šè¿‡ç»„è£…é›¶é…ä»¶è€Œäº§ç”Ÿä¸€ä¸ªæ–°äº§å“ã€‚</p><p>å¦‚æœå°†æŠ½è±¡å·¥å‚æ¨¡å¼çœ‹æˆæ±½è½¦é…ä»¶ç”Ÿäº§å·¥å‚ï¼Œç”Ÿäº§ä¸€ä¸ªäº§å“æ—çš„äº§å“ï¼Œé‚£ä¹ˆå»ºé€ è€…æ¨¡å¼å°±æ˜¯ä¸€ä¸ªæ±½è½¦ç»„è£…å·¥å‚ï¼Œé€šè¿‡å¯¹éƒ¨ä»¶çš„ç»„è£…å¯ä»¥è¿”å›ä¸€è¾†å®Œæ•´çš„æ±½è½¦ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;4-3-åŸå‹æ¨¡å¼&quot;&gt;&lt;a href=&quot;#4-3-åŸå‹æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;4.3 åŸå‹æ¨¡å¼&quot;&gt;&lt;/a&gt;4.3 åŸå‹æ¨¡å¼&lt;/h2&gt;&lt;h3 id=&quot;4-3-1-æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#4-3-1-æ¦‚è¿°&quot; class=&quot;head</summary>
      
    
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/categories/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/tags/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="åŸå‹æ¨¡å¼" scheme="http://example.com/tags/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="åˆ›å»ºè€…æ¨¡å¼" scheme="http://example.com/tags/%E5%88%9B%E5%BB%BA%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>javaè®¾è®¡æ¨¡å¼--ç®€å•å·¥å‚-å·¥å‚æ–¹æ³•-æŠ½è±¡å·¥å‚æ¨¡å¼</title>
    <link href="http://example.com/2024/08/28/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82-%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    <id>http://example.com/2024/08/28/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82-%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</id>
    <published>2024-08-28T12:55:49.000Z</published>
    <updated>2024-09-02T15:15:25.164Z</updated>
    
    <content type="html"><![CDATA[<h1 id="4ï¼Œåˆ›å»ºå‹æ¨¡å¼"><a href="#4ï¼Œåˆ›å»ºå‹æ¨¡å¼" class="headerlink" title="4ï¼Œåˆ›å»ºå‹æ¨¡å¼"></a>4ï¼Œåˆ›å»ºå‹æ¨¡å¼</h1><h2 id="4-2-å·¥å‚æ¨¡å¼"><a href="#4-2-å·¥å‚æ¨¡å¼" class="headerlink" title="4.2 å·¥å‚æ¨¡å¼"></a>4.2 å·¥å‚æ¨¡å¼</h2><h3 id="4-2-1-æ¦‚è¿°"><a href="#4-2-1-æ¦‚è¿°" class="headerlink" title="4.2.1 æ¦‚è¿°"></a>4.2.1 æ¦‚è¿°</h3><p>éœ€æ±‚ï¼šè®¾è®¡ä¸€ä¸ªå’–å•¡åº—ç‚¹é¤ç³»ç»Ÿã€‚  </p><p>è®¾è®¡ä¸€ä¸ªå’–å•¡ç±»ï¼ˆCoffeeï¼‰ï¼Œå¹¶å®šä¹‰å…¶ä¸¤ä¸ªå­ç±»ï¼ˆç¾å¼å’–å•¡ã€AmericanCoffeeã€‘å’Œæ‹¿é“å’–å•¡ã€LatteCoffeeã€‘ï¼‰ï¼›å†è®¾è®¡ä¸€ä¸ªå’–å•¡åº—ç±»ï¼ˆCoffeeStoreï¼‰ï¼Œå’–å•¡åº—å…·æœ‰ç‚¹å’–å•¡çš„åŠŸèƒ½ã€‚</p><p>å…·ä½“ç±»çš„è®¾è®¡å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å·¥å‚æ¨¡å¼/å·¥å‚è®¾è®¡æ¨¡å¼å¼•å…¥.png" style="zoom:80%;" /><p>åœ¨javaä¸­ï¼Œä¸‡ç‰©çš†å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡éƒ½éœ€è¦åˆ›å»ºï¼Œå¦‚æœåˆ›å»ºçš„æ—¶å€™ç›´æ¥newè¯¥å¯¹è±¡ï¼Œå°±ä¼šå¯¹è¯¥å¯¹è±¡è€¦åˆä¸¥é‡ï¼Œå‡å¦‚æˆ‘ä»¬è¦æ›´æ¢å¯¹è±¡ï¼Œæ‰€æœ‰newå¯¹è±¡çš„åœ°æ–¹éƒ½éœ€è¦ä¿®æ”¹ä¸€éï¼Œè¿™æ˜¾ç„¶è¿èƒŒäº†è½¯ä»¶è®¾è®¡çš„å¼€é—­åŸåˆ™ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨å·¥å‚æ¥ç”Ÿäº§å¯¹è±¡ï¼Œæˆ‘ä»¬å°±åªå’Œå·¥å‚æ‰“äº¤é“å°±å¯ä»¥äº†ï¼Œå½»åº•å’Œå¯¹è±¡è§£è€¦ï¼Œå¦‚æœè¦æ›´æ¢å¯¹è±¡ï¼Œç›´æ¥åœ¨å·¥å‚é‡Œæ›´æ¢è¯¥å¯¹è±¡å³å¯ï¼Œè¾¾åˆ°äº†ä¸å¯¹è±¡è§£è€¦çš„ç›®çš„ï¼›æ‰€ä»¥è¯´ï¼Œå·¥å‚æ¨¡å¼æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯ï¼š<strong>è§£è€¦</strong>ã€‚</p><p>åœ¨æœ¬æ•™ç¨‹ä¸­ä¼šä»‹ç»ä¸‰ç§å·¥å‚çš„ä½¿ç”¨</p><ul><li>ç®€å•å·¥å‚æ¨¡å¼ï¼ˆä¸å±äºGOFçš„23ç§ç»å…¸è®¾è®¡æ¨¡å¼ï¼‰</li><li>å·¥å‚æ–¹æ³•æ¨¡å¼</li><li>æŠ½è±¡å·¥å‚æ¨¡å¼</li></ul><h3 id="4-2-2-ç®€å•å·¥å‚æ¨¡å¼"><a href="#4-2-2-ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="4.2.2 ç®€å•å·¥å‚æ¨¡å¼"></a>4.2.2 ç®€å•å·¥å‚æ¨¡å¼</h3><p>ç®€å•å·¥å‚ä¸æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œåè€Œæ¯”è¾ƒåƒæ˜¯ä¸€ç§ç¼–ç¨‹ä¹ æƒ¯ã€‚</p><h4 id="4-2-2-1-ç»“æ„"><a href="#4-2-2-1-ç»“æ„" class="headerlink" title="4.2.2.1 ç»“æ„"></a>4.2.2.1 ç»“æ„</h4><p>ç®€å•å·¥å‚åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li>æŠ½è±¡äº§å“ ï¼šå®šä¹‰äº†äº§å“çš„è§„èŒƒï¼Œæè¿°äº†äº§å“çš„ä¸»è¦ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚</li><li>å…·ä½“äº§å“ ï¼šå®ç°æˆ–è€…ç»§æ‰¿æŠ½è±¡äº§å“çš„å­ç±»</li><li>å…·ä½“å·¥å‚ ï¼šæä¾›äº†åˆ›å»ºäº§å“çš„æ–¹æ³•ï¼Œè°ƒç”¨è€…é€šè¿‡è¯¥æ–¹æ³•æ¥è·å–äº§å“ã€‚</li></ul><h4 id="4-2-2-2-å®ç°"><a href="#4-2-2-2-å®ç°" class="headerlink" title="4.2.2.2 å®ç°"></a>4.2.2.2 å®ç°</h4><p>ç°åœ¨ä½¿ç”¨ç®€å•å·¥å‚å¯¹ä¸Šé¢æ¡ˆä¾‹è¿›è¡Œæ”¹è¿›ï¼Œç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å·¥å‚æ¨¡å¼/ç®€å•å·¥å‚æ¨¡å¼.png" style="zoom:70%;" /><p>å·¥å‚ç±»ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleCoffeeFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Coffee <span class="title">createCoffee</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        Coffee coffee = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;americano&quot;</span>.equals(type)) &#123;</span><br><span class="line">            coffee = <span class="keyword">new</span> AmericanoCoffee();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;latte&quot;</span>.equals(type)) &#123;</span><br><span class="line">            coffee = <span class="keyword">new</span> LatteCoffee();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> coffee;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å·¥å‚ï¼ˆfactoryï¼‰å¤„ç†åˆ›å»ºå¯¹è±¡çš„ç»†èŠ‚ï¼Œä¸€æ—¦æœ‰äº†SimpleCoffeeFactoryï¼ŒCoffeeStoreç±»ä¸­çš„orderCoffee()å°±å˜æˆæ­¤å¯¹è±¡çš„å®¢æˆ·ï¼ŒåæœŸå¦‚æœéœ€è¦Coffeeå¯¹è±¡ç›´æ¥ä»å·¥å‚ä¸­è·å–å³å¯ã€‚è¿™æ ·ä¹Ÿå°±è§£é™¤äº†å’ŒCoffeeå®ç°ç±»çš„è€¦åˆï¼ŒåŒæ—¶åˆäº§ç”Ÿäº†æ–°çš„è€¦åˆï¼ŒCoffeeStoreå¯¹è±¡å’ŒSimpleCoffeeFactoryå·¥å‚å¯¹è±¡çš„è€¦åˆï¼Œå·¥å‚å¯¹è±¡å’Œå•†å“å¯¹è±¡çš„è€¦åˆã€‚</p><p>åæœŸå¦‚æœå†åŠ æ–°å“ç§çš„å’–å•¡ï¼Œæˆ‘ä»¬åŠ¿å¿…è¦éœ€æ±‚ä¿®æ”¹SimpleCoffeeFactoryçš„ä»£ç ï¼Œè¿åäº†å¼€é—­åŸåˆ™ã€‚å·¥å‚ç±»çš„å®¢æˆ·ç«¯å¯èƒ½æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚åˆ›å»ºç¾å›¢å¤–å–ç­‰ï¼Œè¿™æ ·åªéœ€è¦ä¿®æ”¹å·¥å‚ç±»çš„ä»£ç ï¼Œçœå»å…¶ä»–çš„ä¿®æ”¹æ“ä½œã€‚</p><h4 id="4-2-2-4-ä¼˜ç¼ºç‚¹"><a href="#4-2-2-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="4.2.2.4 ä¼˜ç¼ºç‚¹"></a>4.2.2.4 ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹ï¼š</strong></p><p>å°è£…äº†åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹ï¼Œå¯ä»¥é€šè¿‡å‚æ•°ç›´æ¥è·å–å¯¹è±¡ã€‚æŠŠå¯¹è±¡çš„åˆ›å»ºå’Œä¸šåŠ¡é€»è¾‘å±‚åˆ†å¼€ï¼Œè¿™æ ·ä»¥åå°±é¿å…äº†ä¿®æ”¹å®¢æˆ·ä»£ç ï¼Œå¦‚æœè¦å®ç°æ–°äº§å“ç›´æ¥ä¿®æ”¹å·¥å‚ç±»ï¼Œè€Œä¸éœ€è¦åœ¨åŸä»£ç ä¸­ä¿®æ”¹ï¼Œè¿™æ ·å°±é™ä½äº†å®¢æˆ·ä»£ç ä¿®æ”¹çš„å¯èƒ½æ€§ï¼Œæ›´åŠ å®¹æ˜“æ‰©å±•ã€‚</p><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>å¢åŠ æ–°äº§å“æ—¶è¿˜æ˜¯éœ€è¦ä¿®æ”¹å·¥å‚ç±»çš„ä»£ç ï¼Œè¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€ã€‚</p><h4 id="4-2-2-3-æ‰©å±•"><a href="#4-2-2-3-æ‰©å±•" class="headerlink" title="4.2.2.3 æ‰©å±•"></a>4.2.2.3 æ‰©å±•</h4><p><strong>é™æ€å·¥å‚</strong></p><p>åœ¨å¼€å‘ä¸­ä¹Ÿæœ‰ä¸€éƒ¨åˆ†äººå°†å·¥å‚ç±»ä¸­çš„åˆ›å»ºå¯¹è±¡çš„åŠŸèƒ½å®šä¹‰ä¸ºé™æ€çš„ï¼Œè¿™ä¸ªå°±æ˜¯é™æ€å·¥å‚æ¨¡å¼ï¼Œå®ƒä¹Ÿä¸æ˜¯23ç§è®¾è®¡æ¨¡å¼ä¸­çš„ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleCoffeeFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Coffee <span class="title">createCoffee</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        Coffee coffee = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;americano&quot;</span>.equals(type)) &#123;</span><br><span class="line">            coffee = <span class="keyword">new</span> AmericanoCoffee();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;latte&quot;</span>.equals(type)) &#123;</span><br><span class="line">            coffee = <span class="keyword">new</span> LatteCoffee();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> coffe;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-2-3-å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#4-2-3-å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="4.2.3 å·¥å‚æ–¹æ³•æ¨¡å¼"></a>4.2.3 å·¥å‚æ–¹æ³•æ¨¡å¼</h3><p>é’ˆå¯¹ä¸Šä¾‹ä¸­çš„ç¼ºç‚¹ï¼Œä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼å°±å¯ä»¥å®Œç¾çš„è§£å†³ï¼Œå®Œå…¨éµå¾ªå¼€é—­åŸåˆ™ã€‚</p><h4 id="4-2-3-1-æ¦‚å¿µ"><a href="#4-2-3-1-æ¦‚å¿µ" class="headerlink" title="4.2.3.1 æ¦‚å¿µ"></a>4.2.3.1 æ¦‚å¿µ</h4><p>å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸ªäº§å“ç±»å¯¹è±¡ã€‚å·¥å‚æ–¹æ³•ä½¿ä¸€ä¸ªäº§å“ç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°å…¶å·¥å‚çš„å­ç±»ã€‚</p><h4 id="4-2-3-2-ç»“æ„"><a href="#4-2-3-2-ç»“æ„" class="headerlink" title="4.2.3.2 ç»“æ„"></a>4.2.3.2 ç»“æ„</h4><p>å·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¸»è¦è§’è‰²ï¼š</p><ul><li>æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰ï¼šæä¾›äº†åˆ›å»ºäº§å“çš„æ¥å£ï¼Œè°ƒç”¨è€…é€šè¿‡å®ƒè®¿é—®å…·ä½“å·¥å‚çš„å·¥å‚æ–¹æ³•æ¥åˆ›å»ºäº§å“ã€‚</li><li>å…·ä½“å·¥å‚ï¼ˆConcreteFactoryï¼‰ï¼šä¸»è¦æ˜¯å®ç°æŠ½è±¡å·¥å‚ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œå®Œæˆå…·ä½“äº§å“çš„åˆ›å»ºã€‚</li><li>æŠ½è±¡äº§å“ï¼ˆProductï¼‰ï¼šå®šä¹‰äº†äº§å“çš„è§„èŒƒï¼Œæè¿°äº†äº§å“çš„ä¸»è¦ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚</li><li>å…·ä½“äº§å“ï¼ˆConcreteProductï¼‰ï¼šå®ç°äº†æŠ½è±¡äº§å“è§’è‰²æ‰€å®šä¹‰çš„æ¥å£ï¼Œç”±å…·ä½“å·¥å‚æ¥åˆ›å»ºï¼Œå®ƒåŒå…·ä½“å·¥å‚ä¹‹é—´ä¸€ä¸€å¯¹åº”ã€‚</li></ul><h4 id="4-2-3-3-å®ç°"><a href="#4-2-3-3-å®ç°" class="headerlink" title="4.2.3.3 å®ç°"></a>4.2.3.3 å®ç°</h4><p>ä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼å¯¹ä¸Šä¾‹è¿›è¡Œæ”¹è¿›ï¼Œç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å·¥å‚æ¨¡å¼/å·¥å‚æ–¹æ³•æ¨¡å¼.png" style="zoom:70%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><p>æŠ½è±¡å·¥å‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CoffeeFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">Coffee <span class="title">createCoffee</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“å·¥å‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LatteCoffeeFactory</span> <span class="keyword">implements</span> <span class="title">CoffeeFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Coffee <span class="title">createCoffee</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> LatteCoffee();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AmericanCoffeeFactory</span> <span class="keyword">implements</span> <span class="title">CoffeeFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Coffee <span class="title">createCoffee</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AmericanCoffee();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å’–å•¡åº—ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeStore</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> CoffeeFactory factory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CoffeeStore</span><span class="params">(CoffeeFactory factory)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.factory = factory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Coffee <span class="title">orderCoffee</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        Coffee coffee = factory.createCoffee();</span><br><span class="line">        coffee.addMilk();</span><br><span class="line">        coffee.addsugar();</span><br><span class="line">        <span class="keyword">return</span> coffee;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä»¥ä¸Šçš„ç¼–å†™çš„ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œè¦å¢åŠ äº§å“ç±»æ—¶ä¹Ÿè¦ç›¸åº”åœ°å¢åŠ å·¥å‚ç±»ï¼Œä¸éœ€è¦ä¿®æ”¹å·¥å‚ç±»çš„ä»£ç äº†ï¼Œè¿™æ ·å°±è§£å†³äº†ç®€å•å·¥å‚æ¨¡å¼çš„ç¼ºç‚¹ã€‚</p><p>å·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„è¿›ä¸€æ­¥æŠ½è±¡ã€‚ç”±äºä½¿ç”¨äº†å¤šæ€æ€§ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼ä¿æŒäº†ç®€å•å·¥å‚æ¨¡å¼çš„ä¼˜ç‚¹ï¼Œè€Œä¸”å…‹æœäº†å®ƒçš„ç¼ºç‚¹ã€‚</p><h4 id="4-2-3-4-ä¼˜ç¼ºç‚¹"><a href="#4-2-3-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="4.2.3.4 ä¼˜ç¼ºç‚¹"></a>4.2.3.4 ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>ç”¨æˆ·åªéœ€è¦çŸ¥é“å…·ä½“å·¥å‚çš„åç§°å°±å¯å¾—åˆ°æ‰€è¦çš„äº§å“ï¼Œæ— é¡»çŸ¥é“äº§å“çš„å…·ä½“åˆ›å»ºè¿‡ç¨‹ï¼›</li><li>åœ¨ç³»ç»Ÿå¢åŠ æ–°çš„äº§å“æ—¶åªéœ€è¦æ·»åŠ å…·ä½“äº§å“ç±»å’Œå¯¹åº”çš„å…·ä½“å·¥å‚ç±»ï¼Œæ— é¡»å¯¹åŸå·¥å‚è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œæ»¡è¶³å¼€é—­åŸåˆ™ï¼›</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>æ¯å¢åŠ ä¸€ä¸ªäº§å“å°±è¦å¢åŠ ä¸€ä¸ªå…·ä½“äº§å“ç±»å’Œä¸€ä¸ªå¯¹åº”çš„å…·ä½“å·¥å‚ç±»ï¼Œè¿™å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚</li></ul><h3 id="4-2-4-æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#4-2-4-æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="4.2.4 æŠ½è±¡å·¥å‚æ¨¡å¼"></a>4.2.4 æŠ½è±¡å·¥å‚æ¨¡å¼</h3><p>å‰é¢ä»‹ç»çš„å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­è€ƒè™‘çš„æ˜¯ä¸€ç±»äº§å“çš„ç”Ÿäº§ï¼Œå¦‚ç•œç‰§åœºåªå…»åŠ¨ç‰©ã€ç”µè§†æœºå‚åªç”Ÿäº§ç”µè§†æœºã€ä¼ æ™ºæ’­å®¢åªåŸ¹å…»è®¡ç®—æœºè½¯ä»¶ä¸“ä¸šçš„å­¦ç”Ÿç­‰ã€‚</p><p>è¿™äº›å·¥å‚åªç”Ÿäº§åŒç§ç±»äº§å“ï¼ŒåŒç§ç±»äº§å“ç§°ä¸ºåŒç­‰çº§äº§å“ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šå·¥å‚æ–¹æ³•æ¨¡å¼åªè€ƒè™‘ç”Ÿäº§åŒç­‰çº§çš„äº§å“ï¼Œä½†æ˜¯åœ¨ç°å®ç”Ÿæ´»ä¸­è®¸å¤šå·¥å‚æ˜¯ç»¼åˆå‹çš„å·¥å‚ï¼Œèƒ½ç”Ÿäº§å¤šç­‰çº§ï¼ˆç§ç±»ï¼‰ çš„äº§å“ï¼Œå¦‚ç”µå™¨å‚æ—¢ç”Ÿäº§ç”µè§†æœºåˆç”Ÿäº§æ´—è¡£æœºæˆ–ç©ºè°ƒï¼Œå¤§å­¦æ—¢æœ‰è½¯ä»¶ä¸“ä¸šåˆæœ‰ç”Ÿç‰©ä¸“ä¸šç­‰ã€‚</p><p>æœ¬èŠ‚è¦ä»‹ç»çš„æŠ½è±¡å·¥å‚æ¨¡å¼å°†è€ƒè™‘å¤šç­‰çº§äº§å“çš„ç”Ÿäº§ï¼Œå°†åŒä¸€ä¸ªå…·ä½“å·¥å‚æ‰€ç”Ÿäº§çš„ä½äºä¸åŒç­‰çº§çš„ä¸€ç»„äº§å“ç§°ä¸ºä¸€ä¸ªäº§å“æ—ï¼Œä¸‹å›¾æ‰€ç¤ºæ¨ªè½´æ˜¯äº§å“ç­‰çº§ï¼Œä¹Ÿå°±æ˜¯åŒä¸€ç±»äº§å“ï¼›çºµè½´æ˜¯äº§å“æ—ï¼Œä¹Ÿå°±æ˜¯åŒä¸€å“ç‰Œçš„äº§å“ï¼ŒåŒä¸€å“ç‰Œçš„äº§å“äº§è‡ªåŒä¸€ä¸ªå·¥å‚ã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å·¥å‚æ¨¡å¼/image-20200401214509176.png" style="zoom:67%;" /><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å·¥å‚æ¨¡å¼/image-20200401222951963.png" style="zoom:67%;" /><h4 id="4-2-4-1-æ¦‚å¿µ"><a href="#4-2-4-1-æ¦‚å¿µ" class="headerlink" title="4.2.4.1 æ¦‚å¿µ"></a>4.2.4.1 æ¦‚å¿µ</h4><p>æ˜¯ä¸€ç§ä¸ºè®¿é—®ç±»æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç»„ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œä¸”è®¿é—®ç±»æ— é¡»æŒ‡å®šæ‰€è¦äº§å“çš„å…·ä½“ç±»å°±èƒ½å¾—åˆ°åŒæ—çš„ä¸åŒç­‰çº§çš„äº§å“çš„æ¨¡å¼ç»“æ„ã€‚</p><p>æŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„å‡çº§ç‰ˆæœ¬ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼åªç”Ÿäº§ä¸€ä¸ªç­‰çº§çš„äº§å“ï¼Œè€ŒæŠ½è±¡å·¥å‚æ¨¡å¼å¯ç”Ÿäº§å¤šä¸ªç­‰çº§çš„äº§å“ã€‚</p><h4 id="4-2-4-2-ç»“æ„"><a href="#4-2-4-2-ç»“æ„" class="headerlink" title="4.2.4.2 ç»“æ„"></a>4.2.4.2 ç»“æ„</h4><p>æŠ½è±¡å·¥å‚æ¨¡å¼çš„ä¸»è¦è§’è‰²å¦‚ä¸‹ï¼š</p><ul><li>æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰ï¼šæä¾›äº†åˆ›å»ºäº§å“çš„æ¥å£ï¼Œå®ƒåŒ…å«å¤šä¸ªåˆ›å»ºäº§å“çš„æ–¹æ³•ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªä¸åŒç­‰çº§çš„äº§å“ã€‚</li><li>å…·ä½“å·¥å‚ï¼ˆConcrete Factoryï¼‰ï¼šä¸»è¦æ˜¯å®ç°æŠ½è±¡å·¥å‚ä¸­çš„å¤šä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®Œæˆå…·ä½“äº§å“çš„åˆ›å»ºã€‚</li><li>æŠ½è±¡äº§å“ï¼ˆProductï¼‰ï¼šå®šä¹‰äº†äº§å“çš„è§„èŒƒï¼Œæè¿°äº†äº§å“çš„ä¸»è¦ç‰¹æ€§å’ŒåŠŸèƒ½ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰å¤šä¸ªæŠ½è±¡äº§å“ã€‚</li><li>å…·ä½“äº§å“ï¼ˆConcreteProductï¼‰ï¼šå®ç°äº†æŠ½è±¡äº§å“è§’è‰²æ‰€å®šä¹‰çš„æ¥å£ï¼Œç”±å…·ä½“å·¥å‚æ¥åˆ›å»ºï¼Œå®ƒ åŒå…·ä½“å·¥å‚ä¹‹é—´æ˜¯å¤šå¯¹ä¸€çš„å…³ç³»ã€‚</li></ul><h4 id="4-2-4-2-å®ç°"><a href="#4-2-4-2-å®ç°" class="headerlink" title="4.2.4.2 å®ç°"></a>4.2.4.2 å®ç°</h4><p>ç°å’–å•¡åº—ä¸šåŠ¡å‘ç”Ÿæ”¹å˜ï¼Œä¸ä»…è¦ç”Ÿäº§å’–å•¡è¿˜è¦ç”Ÿäº§ç”œç‚¹ï¼Œå¦‚ææ‹‰ç±³è‹ã€æŠ¹èŒ¶æ…•æ–¯ç­‰ï¼Œè¦æ˜¯æŒ‰ç…§å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œéœ€è¦å®šä¹‰ææ‹‰ç±³è‹ç±»ã€æŠ¹èŒ¶æ…•æ–¯ç±»ã€ææ‹‰ç±³è‹å·¥å‚ã€æŠ¹èŒ¶æ…•æ–¯å·¥å‚ã€ç”œç‚¹å·¥å‚ç±»ï¼Œå¾ˆå®¹æ˜“å‘ç”Ÿç±»çˆ†ç‚¸æƒ…å†µã€‚å…¶ä¸­æ‹¿é“å’–å•¡ã€ç¾å¼å’–å•¡æ˜¯ä¸€ä¸ªäº§å“ç­‰çº§ï¼Œéƒ½æ˜¯å’–å•¡ï¼›ææ‹‰ç±³è‹ã€æŠ¹èŒ¶æ…•æ–¯ä¹Ÿæ˜¯ä¸€ä¸ªäº§å“ç­‰çº§ï¼›æ‹¿é“å’–å•¡å’Œææ‹‰ç±³è‹æ˜¯åŒä¸€äº§å“æ—ï¼ˆä¹Ÿå°±æ˜¯éƒ½å±äºæ„å¤§åˆ©é£å‘³ï¼‰ï¼Œç¾å¼å’–å•¡å’ŒæŠ¹èŒ¶æ…•æ–¯æ˜¯åŒä¸€äº§å“æ—ï¼ˆä¹Ÿå°±æ˜¯éƒ½å±äºç¾å¼é£å‘³ï¼‰ã€‚æ‰€ä»¥è¿™ä¸ªæ¡ˆä¾‹å¯ä»¥ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼å®ç°ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å·¥å‚æ¨¡å¼/æŠ½è±¡å·¥å‚æ¨¡å¼.png" style="zoom:67%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><p>æŠ½è±¡å·¥å‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DessertFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">Coffee <span class="title">createCoffee</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">Dessert <span class="title">createDessert</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“å·¥å‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¾å¼ç”œç‚¹å·¥å‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AmericanDessertFactory</span> <span class="keyword">implements</span> <span class="title">DessertFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Coffee <span class="title">createCoffee</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AmericanCoffee();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dessert <span class="title">createDessert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MatchaMousse();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ„å¤§åˆ©é£å‘³ç”œç‚¹å·¥å‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ItalyDessertFactory</span> <span class="keyword">implements</span> <span class="title">DessertFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Coffee <span class="title">createCoffee</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> LatteCoffee();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dessert <span class="title">createDessert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Tiramisu();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦åŠ åŒä¸€ä¸ªäº§å“æ—çš„è¯ï¼Œåªéœ€è¦å†åŠ ä¸€ä¸ªå¯¹åº”çš„å·¥å‚ç±»å³å¯ï¼Œä¸éœ€è¦ä¿®æ”¹å…¶ä»–çš„ç±»ã€‚</p><h4 id="4-2-4-3-ä¼˜ç¼ºç‚¹"><a href="#4-2-4-3-ä¼˜ç¼ºç‚¹" class="headerlink" title="4.2.4.3 ä¼˜ç¼ºç‚¹"></a>4.2.4.3 ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹ï¼š</strong></p><p>å½“ä¸€ä¸ªäº§å“æ—ä¸­çš„å¤šä¸ªå¯¹è±¡è¢«è®¾è®¡æˆä¸€èµ·å·¥ä½œæ—¶ï¼Œå®ƒèƒ½ä¿è¯å®¢æˆ·ç«¯å§‹ç»ˆåªä½¿ç”¨åŒä¸€ä¸ªäº§å“æ—ä¸­çš„å¯¹è±¡ã€‚</p><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>å½“äº§å“æ—ä¸­éœ€è¦å¢åŠ ä¸€ä¸ªæ–°çš„äº§å“æ—¶ï¼Œæ‰€æœ‰çš„å·¥å‚ç±»éƒ½éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚</p><h4 id="4-2-4-4-ä½¿ç”¨åœºæ™¯"><a href="#4-2-4-4-ä½¿ç”¨åœºæ™¯" class="headerlink" title="4.2.4.4 ä½¿ç”¨åœºæ™¯"></a>4.2.4.4 ä½¿ç”¨åœºæ™¯</h4><ul><li><p>å½“éœ€è¦åˆ›å»ºçš„å¯¹è±¡æ˜¯ä¸€ç³»åˆ—ç›¸äº’å…³è”æˆ–ç›¸äº’ä¾èµ–çš„äº§å“æ—æ—¶ï¼Œå¦‚ç”µå™¨å·¥å‚ä¸­çš„ç”µè§†æœºã€æ´—è¡£æœºã€ç©ºè°ƒç­‰ã€‚</p></li><li><p>ç³»ç»Ÿä¸­æœ‰å¤šä¸ªäº§å“æ—ï¼Œä½†æ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„æŸä¸€æ—äº§å“ã€‚å¦‚æœ‰äººåªå–œæ¬¢ç©¿æŸä¸€ä¸ªå“ç‰Œçš„è¡£æœå’Œé‹ã€‚</p></li><li><p>ç³»ç»Ÿä¸­æä¾›äº†äº§å“çš„ç±»åº“ï¼Œä¸”æ‰€æœ‰äº§å“çš„æ¥å£ç›¸åŒï¼Œå®¢æˆ·ç«¯ä¸ä¾èµ–äº§å“å®ä¾‹çš„åˆ›å»ºç»†èŠ‚å’Œå†…éƒ¨ç»“æ„ã€‚</p></li></ul><p>å¦‚ï¼šè¾“å…¥æ³•æ¢çš®è‚¤ï¼Œä¸€æ•´å¥—ä¸€èµ·æ¢ã€‚ç”Ÿæˆä¸åŒæ“ä½œç³»ç»Ÿçš„ç¨‹åºã€‚</p><h3 id="4-2-5-æ¨¡å¼æ‰©å±•"><a href="#4-2-5-æ¨¡å¼æ‰©å±•" class="headerlink" title="4.2.5 æ¨¡å¼æ‰©å±•"></a>4.2.5 æ¨¡å¼æ‰©å±•</h3><p><strong>ç®€å•å·¥å‚+é…ç½®æ–‡ä»¶è§£é™¤è€¦åˆ</strong></p><p>å¯ä»¥é€šè¿‡å·¥å‚æ¨¡å¼+é…ç½®æ–‡ä»¶çš„æ–¹å¼è§£é™¤å·¥å‚å¯¹è±¡å’Œäº§å“å¯¹è±¡çš„è€¦åˆã€‚åœ¨å·¥å‚ç±»ä¸­åŠ è½½é…ç½®æ–‡ä»¶ä¸­çš„å…¨ç±»åï¼Œå¹¶åˆ›å»ºå¯¹è±¡è¿›è¡Œå­˜å‚¨ï¼Œå®¢æˆ·ç«¯å¦‚æœéœ€è¦å¯¹è±¡ï¼Œç›´æ¥è¿›è¡Œè·å–å³å¯ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šå®šä¹‰é…ç½®æ–‡ä»¶</p><p>ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œæˆ‘ä»¬ä½¿ç”¨propertiesæ–‡ä»¶ä½œä¸ºé…ç½®æ–‡ä»¶ï¼Œåç§°ä¸ºbean.properties</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">american</span>=<span class="string">com.itheima.pattern.factory.config_factory.AmericanCoffee</span></span><br><span class="line"><span class="attr">latte</span>=<span class="string">com.itheima.pattern.factory.config_factory.LatteCoffee</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼šæ”¹è¿›å·¥å‚ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CoffeeFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String,Coffee&gt; map = <span class="keyword">new</span> HashMap();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        Properties p = <span class="keyword">new</span> Properties();</span><br><span class="line">        InputStream is = CoffeeFactory.class.getClassLoader().getResourceAsStream(<span class="string">&quot;bean.properties&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            p.load(is);</span><br><span class="line">            <span class="comment">//éå†Propertiesé›†åˆå¯¹è±¡</span></span><br><span class="line">            Set&lt;Object&gt; keys = p.keySet();</span><br><span class="line">            <span class="keyword">for</span> (Object key : keys) &#123;</span><br><span class="line">                <span class="comment">//æ ¹æ®é”®è·å–å€¼ï¼ˆå…¨ç±»åï¼‰</span></span><br><span class="line">                String className = p.getProperty((String) key);</span><br><span class="line">                <span class="comment">//è·å–å­—èŠ‚ç å¯¹è±¡</span></span><br><span class="line">                Class clazz = Class.forName(className);</span><br><span class="line">                Coffee obj = (Coffee) clazz.newInstance();</span><br><span class="line">                map.put((String)key,obj);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Coffee <span class="title">createCoffee</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> map.get(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™æ€æˆå‘˜å˜é‡ç”¨æ¥å­˜å‚¨åˆ›å»ºçš„å¯¹è±¡ï¼ˆé”®å­˜å‚¨çš„æ˜¯åç§°ï¼Œå€¼å­˜å‚¨çš„æ˜¯å¯¹åº”çš„å¯¹è±¡ï¼‰ï¼Œè€Œè¯»å–é…ç½®æ–‡ä»¶ä»¥åŠåˆ›å»ºå¯¹è±¡å†™åœ¨é™æ€ä»£ç å—ä¸­ï¼Œç›®çš„å°±æ˜¯åªéœ€è¦æ‰§è¡Œä¸€æ¬¡ã€‚</p><h3 id="4-2-6-JDKæºç è§£æ-Collection-iteratoræ–¹æ³•"><a href="#4-2-6-JDKæºç è§£æ-Collection-iteratoræ–¹æ³•" class="headerlink" title="4.2.6 JDKæºç è§£æ-Collection.iteratoræ–¹æ³•"></a>4.2.6 JDKæºç è§£æ-Collection.iteratoræ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        list.add(<span class="string">&quot;ä»¤ç‹å†²&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;é£æ¸…æ‰¬&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;ä»»æˆ‘è¡Œ&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–è¿­ä»£å™¨å¯¹è±¡</span></span><br><span class="line">        Iterator&lt;String&gt; it = list.iterator();</span><br><span class="line">        <span class="comment">//ä½¿ç”¨è¿­ä»£å™¨éå†</span></span><br><span class="line">        <span class="keyword">while</span>(it.hasNext()) &#123;</span><br><span class="line">            String ele = it.next();</span><br><span class="line">            System.out.println(ele);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹ä¸Šé¢çš„ä»£ç å¤§å®¶åº”è¯¥å¾ˆç†Ÿï¼Œä½¿ç”¨è¿­ä»£å™¨éå†é›†åˆï¼Œè·å–é›†åˆä¸­çš„å…ƒç´ ã€‚è€Œå•åˆ—é›†åˆè·å–è¿­ä»£å™¨çš„æ–¹æ³•å°±ä½¿ç”¨åˆ°äº†å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚æˆ‘ä»¬çœ‹é€šè¿‡ç±»å›¾çœ‹çœ‹ç»“æ„ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/å·¥å‚æ¨¡å¼/JDKæºç è§£æ.png" style="zoom:75%;" /><p>Collectionæ¥å£æ˜¯æŠ½è±¡å·¥å‚ç±»ï¼ŒArrayListæ˜¯å…·ä½“çš„å·¥å‚ç±»ï¼›Iteratoræ¥å£æ˜¯æŠ½è±¡å•†å“ç±»ï¼ŒArrayListç±»ä¸­çš„Iterå†…éƒ¨ç±»æ˜¯å…·ä½“çš„å•†å“ç±»ã€‚åœ¨å…·ä½“çš„å·¥å‚ç±»ä¸­iterator()æ–¹æ³•åˆ›å»ºå…·ä½“çš„å•†å“ç±»çš„å¯¹è±¡ã€‚</p><blockquote><p>å¦ï¼š</p><p>â€‹    1,DateForamtç±»ä¸­çš„getInstance()æ–¹æ³•ä½¿ç”¨çš„æ˜¯å·¥å‚æ¨¡å¼ï¼›</p><p>â€‹    2,Calendarç±»ä¸­çš„getInstance()æ–¹æ³•ä½¿ç”¨çš„æ˜¯å·¥å‚æ¨¡å¼ï¼›</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;4ï¼Œåˆ›å»ºå‹æ¨¡å¼&quot;&gt;&lt;a href=&quot;#4ï¼Œåˆ›å»ºå‹æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;4ï¼Œåˆ›å»ºå‹æ¨¡å¼&quot;&gt;&lt;/a&gt;4ï¼Œåˆ›å»ºå‹æ¨¡å¼&lt;/h1&gt;&lt;h2 id=&quot;4-2-å·¥å‚æ¨¡å¼&quot;&gt;&lt;a href=&quot;#4-2-å·¥å‚æ¨¡å¼&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/categories/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/tags/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="å·¥å‚æ¨¡å¼" scheme="http://example.com/tags/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>javaè®¾è®¡æ¨¡å¼--å•ä¾‹æ¨¡å¼</title>
    <link href="http://example.com/2024/08/28/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
    <id>http://example.com/2024/08/28/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</id>
    <published>2024-08-28T12:35:37.000Z</published>
    <updated>2024-08-28T12:56:19.224Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1ï¼Œåˆ›å»ºè€…æ¨¡å¼-å•ä¾‹æ¨¡å¼"><a href="#1ï¼Œåˆ›å»ºè€…æ¨¡å¼-å•ä¾‹æ¨¡å¼" class="headerlink" title="1ï¼Œåˆ›å»ºè€…æ¨¡å¼-å•ä¾‹æ¨¡å¼"></a>1ï¼Œåˆ›å»ºè€…æ¨¡å¼-å•ä¾‹æ¨¡å¼</h1><p>åˆ›å»ºå‹æ¨¡å¼çš„ä¸»è¦å…³æ³¨ç‚¹æ˜¯â€œæ€æ ·åˆ›å»ºå¯¹è±¡ï¼Ÿâ€ï¼Œå®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯â€œå°†å¯¹è±¡çš„åˆ›å»ºä¸ä½¿ç”¨åˆ†ç¦»â€ã€‚</p><p>è¿™æ ·å¯ä»¥é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦ï¼Œä½¿ç”¨è€…ä¸éœ€è¦å…³æ³¨å¯¹è±¡çš„åˆ›å»ºç»†èŠ‚ã€‚</p><p>åˆ›å»ºå‹æ¨¡å¼åˆ†ä¸ºï¼š</p><ul><li>å•ä¾‹æ¨¡å¼</li><li>å·¥å‚æ–¹æ³•æ¨¡å¼</li><li>æŠ½è±¡å·¥ç¨‹æ¨¡å¼</li><li>åŸå‹æ¨¡å¼</li><li>å»ºé€ è€…æ¨¡å¼</li></ul><h2 id="1-1-å•ä¾‹è®¾è®¡æ¨¡å¼"><a href="#1-1-å•ä¾‹è®¾è®¡æ¨¡å¼" class="headerlink" title="1.1 å•ä¾‹è®¾è®¡æ¨¡å¼"></a>1.1 å•ä¾‹è®¾è®¡æ¨¡å¼</h2><p>å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰æ˜¯ Java ä¸­æœ€ç®€å•çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ã€‚</p><p>è¿™ç§æ¨¡å¼æ¶‰åŠåˆ°ä¸€ä¸ªå•ä¸€çš„ç±»ï¼Œè¯¥ç±»è´Ÿè´£åˆ›å»ºè‡ªå·±çš„å¯¹è±¡ï¼ŒåŒæ—¶ç¡®ä¿åªæœ‰å•ä¸ªå¯¹è±¡è¢«åˆ›å»ºã€‚è¿™ä¸ªç±»æä¾›äº†ä¸€ç§è®¿é—®å…¶å”¯ä¸€çš„å¯¹è±¡çš„æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ï¼Œä¸éœ€è¦å®ä¾‹åŒ–è¯¥ç±»çš„å¯¹è±¡ã€‚</p><h3 id="1-1-1-å•ä¾‹æ¨¡å¼çš„ç»“æ„"><a href="#1-1-1-å•ä¾‹æ¨¡å¼çš„ç»“æ„" class="headerlink" title="1.1.1 å•ä¾‹æ¨¡å¼çš„ç»“æ„"></a>1.1.1 å•ä¾‹æ¨¡å¼çš„ç»“æ„</h3><p>å•ä¾‹æ¨¡å¼çš„ä¸»è¦æœ‰ä»¥ä¸‹è§’è‰²ï¼š</p><ul><li>å•ä¾‹ç±»ã€‚åªèƒ½åˆ›å»ºä¸€ä¸ªå®ä¾‹çš„ç±»</li><li>è®¿é—®ç±»ã€‚ä½¿ç”¨å•ä¾‹ç±»</li></ul><h3 id="1-1-2-å•ä¾‹æ¨¡å¼çš„å®ç°"><a href="#1-1-2-å•ä¾‹æ¨¡å¼çš„å®ç°" class="headerlink" title="1.1.2 å•ä¾‹æ¨¡å¼çš„å®ç°"></a>1.1.2 å•ä¾‹æ¨¡å¼çš„å®ç°</h3><blockquote><p>å•ä¾‹è®¾è®¡æ¨¡å¼åˆ†ç±»ä¸¤ç§ï¼š</p><p>â€‹    é¥¿æ±‰å¼ï¼šç±»åŠ è½½å°±ä¼šå¯¼è‡´è¯¥å•å®ä¾‹å¯¹è±¡è¢«åˆ›å»º    </p><p>â€‹    æ‡’æ±‰å¼ï¼šç±»åŠ è½½ä¸ä¼šå¯¼è‡´è¯¥å•å®ä¾‹å¯¹è±¡è¢«åˆ›å»ºï¼Œè€Œæ˜¯é¦–æ¬¡ä½¿ç”¨è¯¥å¯¹è±¡æ—¶æ‰ä¼šåˆ›å»º</p></blockquote><ol><li><p>é¥¿æ±‰å¼-æ–¹å¼1ï¼ˆé™æ€å˜é‡æ–¹å¼ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¥¿æ±‰å¼</span></span><br><span class="line"><span class="comment"> *      é™æ€å˜é‡åˆ›å»ºç±»çš„å¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance = <span class="keyword">new</span> Singleton();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color='red'>è¯´æ˜ï¼š</font></p><p>â€‹    è¯¥æ–¹å¼åœ¨æˆå‘˜ä½ç½®å£°æ˜Singletonç±»å‹çš„é™æ€å˜é‡ï¼Œå¹¶åˆ›å»ºSingletonç±»çš„å¯¹è±¡instanceã€‚instanceå¯¹è±¡æ˜¯éšç€ç±»çš„åŠ è½½è€Œåˆ›å»ºçš„ã€‚å¦‚æœè¯¥å¯¹è±¡è¶³å¤Ÿå¤§çš„è¯ï¼Œè€Œä¸€ç›´æ²¡æœ‰ä½¿ç”¨å°±ä¼šé€ æˆå†…å­˜çš„æµªè´¹ã€‚</p></li><li><p>é¥¿æ±‰å¼-æ–¹å¼2ï¼ˆé™æ€ä»£ç å—æ–¹å¼ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¶æ±‰å¼</span></span><br><span class="line"><span class="comment"> *      åœ¨é™æ€ä»£ç å—ä¸­åˆ›å»ºè¯¥ç±»å¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color='red'>è¯´æ˜ï¼š</font></p><p>â€‹    è¯¥æ–¹å¼åœ¨æˆå‘˜ä½ç½®å£°æ˜Singletonç±»å‹çš„é™æ€å˜é‡ï¼Œè€Œå¯¹è±¡çš„åˆ›å»ºæ˜¯åœ¨é™æ€ä»£ç å—ä¸­ï¼Œä¹Ÿæ˜¯å¯¹ç€ç±»çš„åŠ è½½è€Œåˆ›å»ºã€‚æ‰€ä»¥å’Œé¥¿æ±‰å¼çš„æ–¹å¼1åŸºæœ¬ä¸Šä¸€æ ·ï¼Œå½“ç„¶è¯¥æ–¹å¼ä¹Ÿå­˜åœ¨å†…å­˜æµªè´¹é—®é¢˜ã€‚</p></li><li><p>æ‡’æ±‰å¼-æ–¹å¼1ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‡’æ±‰å¼</span></span><br><span class="line"><span class="comment"> *  çº¿ç¨‹ä¸å®‰å…¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color='red'>è¯´æ˜ï¼š</font></p><p>â€‹    ä»ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¯¥æ–¹å¼åœ¨æˆå‘˜ä½ç½®å£°æ˜Singletonç±»å‹çš„é™æ€å˜é‡ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œå¯¹è±¡çš„èµ‹å€¼æ“ä½œï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™èµ‹å€¼çš„å‘¢ï¼Ÿå½“è°ƒç”¨getInstance()æ–¹æ³•è·å–Singletonç±»çš„å¯¹è±¡çš„æ—¶å€™æ‰åˆ›å»ºSingletonç±»çš„å¯¹è±¡ï¼Œè¿™æ ·å°±å®ç°äº†æ‡’åŠ è½½çš„æ•ˆæœã€‚ä½†æ˜¯ï¼Œå¦‚æœæ˜¯å¤šçº¿ç¨‹ç¯å¢ƒï¼Œä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p></li><li><p>æ‡’æ±‰å¼-æ–¹å¼2ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‡’æ±‰å¼</span></span><br><span class="line"><span class="comment"> *  çº¿ç¨‹å®‰å…¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color='red'>è¯´æ˜ï¼š</font></p><p>â€‹    è¯¥æ–¹å¼ä¹Ÿå®ç°äº†æ‡’åŠ è½½æ•ˆæœï¼ŒåŒæ—¶åˆè§£å†³äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ä½†æ˜¯åœ¨getInstance()æ–¹æ³•ä¸Šæ·»åŠ äº†synchronizedå…³é”®å­—ï¼Œå¯¼è‡´è¯¥æ–¹æ³•çš„æ‰§è¡Œæ•ˆæœç‰¹åˆ«ä½ã€‚ä»ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå…¶å®å°±æ˜¯åœ¨åˆå§‹åŒ–instanceçš„æ—¶å€™æ‰ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä¸€æ—¦åˆå§‹åŒ–å®Œæˆå°±ä¸å­˜åœ¨äº†ã€‚</p></li><li><p>æ‡’æ±‰å¼-æ–¹å¼3ï¼ˆåŒé‡æ£€æŸ¥é”ï¼‰</p><p>å†æ¥è®¨è®ºä¸€ä¸‹æ‡’æ±‰æ¨¡å¼ä¸­åŠ é”çš„é—®é¢˜ï¼Œå¯¹äº <code>getInstance()</code> æ–¹æ³•æ¥è¯´ï¼Œç»å¤§éƒ¨åˆ†çš„æ“ä½œéƒ½æ˜¯è¯»æ“ä½œï¼Œè¯»æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡å¿…è®©æ¯ä¸ªçº¿ç¨‹å¿…é¡»æŒæœ‰é”æ‰èƒ½è°ƒç”¨è¯¥æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦è°ƒæ•´åŠ é”çš„æ—¶æœºã€‚ç”±æ­¤ä¹Ÿäº§ç”Ÿäº†ä¸€ç§æ–°çš„å®ç°æ¨¡å¼ï¼šåŒé‡æ£€æŸ¥é”æ¨¡å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŒé‡æ£€æŸ¥æ–¹å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123; </span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œå¦‚æœinstanceä¸ä¸ºnullï¼Œä¸è¿›å…¥æŠ¢é”é˜¶æ®µï¼Œç›´æ¥è¿”å›å®ä¾‹</span></span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">                <span class="comment">//æŠ¢åˆ°é”ä¹‹åå†æ¬¡åˆ¤æ–­æ˜¯å¦ä¸ºnull</span></span><br><span class="line">                <span class="keyword">if</span>(instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒé‡æ£€æŸ¥é”æ¨¡å¼æ˜¯ä¸€ç§éå¸¸å¥½çš„å•ä¾‹å®ç°æ¨¡å¼ï¼Œè§£å†³äº†å•ä¾‹ã€æ€§èƒ½ã€çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä¸Šé¢çš„åŒé‡æ£€æµ‹é”æ¨¡å¼çœ‹ä¸Šå»å®Œç¾æ— ç¼ºï¼Œå…¶å®æ˜¯å­˜åœ¨é—®é¢˜ï¼Œåœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°ç©ºæŒ‡é’ˆé—®é¢˜ï¼Œå‡ºç°é—®é¢˜çš„åŸå› æ˜¯JVMåœ¨å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ä¼šè¿›è¡Œä¼˜åŒ–å’ŒæŒ‡ä»¤é‡æ’åºæ“ä½œã€‚</p><p>è¦è§£å†³åŒé‡æ£€æŸ¥é”æ¨¡å¼å¸¦æ¥ç©ºæŒ‡é’ˆå¼‚å¸¸çš„é—®é¢˜ï¼Œåªéœ€è¦ä½¿ç”¨ <code>volatile</code> å…³é”®å­—, <code>volatile</code> å…³é”®å­—å¯ä»¥ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŒé‡æ£€æŸ¥æ–¹å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œå¦‚æœinstanceä¸ä¸ºnullï¼Œä¸è¿›å…¥æŠ¢é”é˜¶æ®µï¼Œç›´æ¥è¿”å›å®é™…</span></span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">                <span class="comment">//æŠ¢åˆ°é”ä¹‹åå†æ¬¡åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">                <span class="keyword">if</span>(instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color="red">å°ç»“ï¼š</font></p><p>æ·»åŠ  <code>volatile</code> å…³é”®å­—ä¹‹åçš„åŒé‡æ£€æŸ¥é”æ¨¡å¼æ˜¯ä¸€ç§æ¯”è¾ƒå¥½çš„å•ä¾‹å®ç°æ¨¡å¼ï¼Œèƒ½å¤Ÿä¿è¯åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹çº¿ç¨‹å®‰å…¨ä¹Ÿä¸ä¼šæœ‰æ€§èƒ½é—®é¢˜ã€‚</p></li></ol><ol start="6"><li><p>æ‡’æ±‰å¼-æ–¹å¼4ï¼ˆé™æ€å†…éƒ¨ç±»æ–¹å¼ï¼‰</p><p>é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼ä¸­å®ä¾‹ç”±å†…éƒ¨ç±»åˆ›å»ºï¼Œç”±äº JVM åœ¨åŠ è½½å¤–éƒ¨ç±»çš„è¿‡ç¨‹ä¸­, æ˜¯ä¸ä¼šåŠ è½½é™æ€å†…éƒ¨ç±»çš„, åªæœ‰å†…éƒ¨ç±»çš„å±æ€§/æ–¹æ³•è¢«è°ƒç”¨æ—¶æ‰ä¼šè¢«åŠ è½½, å¹¶åˆå§‹åŒ–å…¶é™æ€å±æ€§ã€‚é™æ€å±æ€§ç”±äºè¢« <code>static</code> ä¿®é¥°ï¼Œä¿è¯åªè¢«å®ä¾‹åŒ–ä¸€æ¬¡ï¼Œå¹¶ä¸”ä¸¥æ ¼ä¿è¯å®ä¾‹åŒ–é¡ºåºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é™æ€å†…éƒ¨ç±»æ–¹å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton INSTANCE = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color='red'>è¯´æ˜ï¼š</font></p><p>â€‹    ç¬¬ä¸€æ¬¡åŠ è½½Singletonç±»æ—¶ä¸ä¼šå»åˆå§‹åŒ–INSTANCEï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨getInstanceï¼Œè™šæ‹ŸæœºåŠ è½½SingletonHolder</p><p>å¹¶åˆå§‹åŒ–INSTANCEï¼Œè¿™æ ·ä¸ä»…èƒ½ç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œä¹Ÿèƒ½ä¿è¯ Singleton ç±»çš„å”¯ä¸€æ€§ã€‚</p><p><font color="red">å°ç»“ï¼š</font></p><p>â€‹    é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§ä¼˜ç§€çš„å•ä¾‹æ¨¡å¼ï¼Œæ˜¯å¼€æºé¡¹ç›®ä¸­æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ç§å•ä¾‹æ¨¡å¼ã€‚åœ¨æ²¡æœ‰åŠ ä»»ä½•é”çš„æƒ…å†µä¸‹ï¼Œä¿è¯äº†å¤šçº¿ç¨‹ä¸‹çš„å®‰å…¨ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•æ€§èƒ½å½±å“å’Œç©ºé—´çš„æµªè´¹ã€‚</p></li><li><p>æšä¸¾æ–¹å¼</p><p>æšä¸¾ç±»å®ç°å•ä¾‹æ¨¡å¼æ˜¯æåŠ›æ¨èçš„å•ä¾‹å®ç°æ¨¡å¼ï¼Œå› ä¸ºæšä¸¾ç±»å‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¹¶ä¸”åªä¼šè£…è½½ä¸€æ¬¡ï¼Œè®¾è®¡è€…å……åˆ†çš„åˆ©ç”¨äº†æšä¸¾çš„è¿™ä¸ªç‰¹æ€§æ¥å®ç°å•ä¾‹æ¨¡å¼ï¼Œæšä¸¾çš„å†™æ³•éå¸¸ç®€å•ï¼Œè€Œä¸”æšä¸¾ç±»å‹æ˜¯æ‰€ç”¨å•ä¾‹å®ç°ä¸­å”¯ä¸€ä¸€ç§ä¸ä¼šè¢«ç ´åçš„å•ä¾‹å®ç°æ¨¡å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æšä¸¾æ–¹å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line">    INSTANCE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color='red'>è¯´æ˜ï¼š</font></p><p>â€‹    æšä¸¾æ–¹å¼å±äºæ¶æ±‰å¼æ–¹å¼ã€‚</p></li></ol><h3 id="1-1-3-å­˜åœ¨çš„é—®é¢˜"><a href="#1-1-3-å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="1.1.3 å­˜åœ¨çš„é—®é¢˜"></a>1.1.3 å­˜åœ¨çš„é—®é¢˜</h3><h4 id="1-1-3-1-é—®é¢˜æ¼”ç¤º"><a href="#1-1-3-1-é—®é¢˜æ¼”ç¤º" class="headerlink" title="1.1.3.1 é—®é¢˜æ¼”ç¤º"></a>1.1.3.1 é—®é¢˜æ¼”ç¤º</h4><p>ç ´åå•ä¾‹æ¨¡å¼ï¼š</p><p>ä½¿ä¸Šé¢å®šä¹‰çš„å•ä¾‹ç±»ï¼ˆSingletonï¼‰å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œæšä¸¾æ–¹å¼é™¤å¤–ã€‚æœ‰ä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯åºåˆ—åŒ–å’Œåå°„ã€‚</p><ul><li><p>åºåˆ—åŒ–ååºåˆ—åŒ–</p><p><strong>Singletonç±»ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton INSTANCE = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Testç±»ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//å¾€æ–‡ä»¶ä¸­å†™å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//writeObject2File();</span></span><br><span class="line">        <span class="comment">//ä»æ–‡ä»¶ä¸­è¯»å–å¯¹è±¡</span></span><br><span class="line">        Singleton s1 = readObjectFromFile();</span><br><span class="line">        Singleton s2 = readObjectFromFile();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­ä¸¤ä¸ªååºåˆ—åŒ–åçš„å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(s1 == s2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Singleton <span class="title">readObjectFromFile</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡è¾“å…¥æµå¯¹è±¡</span></span><br><span class="line">        ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(<span class="string">&quot;C:\\Users\\Think\\Desktop\\a.txt&quot;</span>));</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ä¸ªè¯»å–Singletonå¯¹è±¡</span></span><br><span class="line">        Singleton instance = (Singleton) ois.readObject();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeObject2File</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–Singletonç±»çš„å¯¹è±¡</span></span><br><span class="line">        Singleton instance = Singleton.getInstance();</span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡è¾“å‡ºæµ</span></span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">&quot;C:\\Users\\Think\\Desktop\\a.txt&quot;</span>));</span><br><span class="line">        <span class="comment">//å°†instanceå¯¹è±¡å†™å‡ºåˆ°æ–‡ä»¶ä¸­</span></span><br><span class="line">        oos.writeObject(instance);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸Šé¢ä»£ç è¿è¡Œç»“æœæ˜¯<code>false</code>ï¼Œè¡¨æ˜åºåˆ—åŒ–å’Œååºåˆ—åŒ–å·²ç»ç ´åäº†å•ä¾‹è®¾è®¡æ¨¡å¼ã€‚</p></blockquote></li><li><p>åå°„</p><p><strong>Singletonç±»ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">            <span class="keyword">if</span>(instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> instance;</span><br><span class="line">            &#125;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Testç±»ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–Singletonç±»çš„å­—èŠ‚ç å¯¹è±¡</span></span><br><span class="line">        Class clazz = Singleton.class;</span><br><span class="line">        <span class="comment">//è·å–Singletonç±»çš„ç§æœ‰æ— å‚æ„é€ æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        Constructor constructor = clazz.getDeclaredConstructor();</span><br><span class="line">        <span class="comment">//å–æ¶ˆè®¿é—®æ£€æŸ¥</span></span><br><span class="line">        constructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºSingletonç±»çš„å¯¹è±¡s1</span></span><br><span class="line">        Singleton s1 = (Singleton) constructor.newInstance();</span><br><span class="line">        <span class="comment">//åˆ›å»ºSingletonç±»çš„å¯¹è±¡s2</span></span><br><span class="line">        Singleton s2 = (Singleton) constructor.newInstance();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­é€šè¿‡åå°„åˆ›å»ºçš„ä¸¤ä¸ªSingletonå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(s1 == s2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸Šé¢ä»£ç è¿è¡Œç»“æœæ˜¯<code>false</code>ï¼Œè¡¨æ˜åºåˆ—åŒ–å’Œååºåˆ—åŒ–å·²ç»ç ´åäº†å•ä¾‹è®¾è®¡æ¨¡å¼</p></blockquote></li></ul><blockquote><p><font color="red">æ³¨æ„ï¼š</font>æšä¸¾æ–¹å¼ä¸ä¼šå‡ºç°è¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p></blockquote><h4 id="1-1-3-2-é—®é¢˜çš„è§£å†³"><a href="#1-1-3-2-é—®é¢˜çš„è§£å†³" class="headerlink" title="1.1.3.2 é—®é¢˜çš„è§£å†³"></a>1.1.3.2 é—®é¢˜çš„è§£å†³</h4><ul><li><p>åºåˆ—åŒ–ã€ååºåˆ—æ–¹å¼ç ´åå•ä¾‹æ¨¡å¼çš„è§£å†³æ–¹æ³•</p><p>åœ¨Singletonç±»ä¸­æ·»åŠ <code>readResolve()</code>æ–¹æ³•ï¼Œåœ¨ååºåˆ—åŒ–æ—¶è¢«åå°„è°ƒç”¨ï¼Œå¦‚æœå®šä¹‰äº†è¿™ä¸ªæ–¹æ³•ï¼Œå°±è¿”å›è¿™ä¸ªæ–¹æ³•çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰ï¼Œåˆ™è¿”å›æ–°newå‡ºæ¥çš„å¯¹è±¡ã€‚</p><p><strong>Singletonç±»ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Singleton INSTANCE = <span class="keyword">new</span> Singleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸‹é¢æ˜¯ä¸ºäº†è§£å†³åºåˆ—åŒ–ååºåˆ—åŒ–ç ´è§£å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Object <span class="title">readResolve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æºç è§£æï¼š</strong></p><p>ObjectInputStreamç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Object <span class="title">readObject</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException</span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// if nested read, passHandle contains handle of enclosing object</span></span><br><span class="line">    <span class="keyword">int</span> outerHandle = passHandle;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Object obj = readObject0(<span class="keyword">false</span>);<span class="comment">//é‡ç‚¹æŸ¥çœ‹readObject0æ–¹æ³•</span></span><br><span class="line">    .....</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">private</span> Object <span class="title">readObject0</span><span class="params">(<span class="keyword">boolean</span> unshared)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">...</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line"><span class="keyword">switch</span> (tc) &#123;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">case</span> TC_OBJECT:</span><br><span class="line"><span class="keyword">return</span> checkResolve(readOrdinaryObject(unshared));<span class="comment">//é‡ç‚¹æŸ¥çœ‹readOrdinaryObjectæ–¹æ³•</span></span><br><span class="line">...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        depth--;</span><br><span class="line">        bin.setBlockDataMode(oldMode);</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">private</span> Object <span class="title">readOrdinaryObject</span><span class="params">(<span class="keyword">boolean</span> unshared)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">...</span><br><span class="line"><span class="comment">//isInstantiable è¿”å›trueï¼Œæ‰§è¡Œ desc.newInstance()ï¼Œé€šè¿‡åå°„åˆ›å»ºæ–°çš„å•ä¾‹ç±»ï¼Œ</span></span><br><span class="line">    obj = desc.isInstantiable() ? desc.newInstance() : <span class="keyword">null</span>; </span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// åœ¨Singletonç±»ä¸­æ·»åŠ  readResolve æ–¹æ³•å desc.hasReadResolveMethod() æ–¹æ³•æ‰§è¡Œç»“æœä¸ºtrue</span></span><br><span class="line">    <span class="keyword">if</span> (obj != <span class="keyword">null</span> &amp;&amp; handles.lookupException(passHandle) == <span class="keyword">null</span> &amp;&amp; desc.hasReadResolveMethod()) &#123;</span><br><span class="line">    <span class="comment">// é€šè¿‡åå°„è°ƒç”¨ Singleton ç±»ä¸­çš„ readResolve æ–¹æ³•ï¼Œå°†è¿”å›å€¼èµ‹å€¼ç»™repå˜é‡</span></span><br><span class="line">    <span class="comment">// è¿™æ ·å¤šæ¬¡è°ƒç”¨ObjectInputStreamç±»ä¸­çš„readObjectæ–¹æ³•ï¼Œç»§è€Œå°±ä¼šè°ƒç”¨æˆ‘ä»¬å®šä¹‰çš„readResolveæ–¹æ³•ï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</span></span><br><span class="line">    Object rep = desc.invokeReadResolve(obj);</span><br><span class="line">     ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åå°„æ–¹å¼ç ´è§£å•ä¾‹çš„è§£å†³æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">           åå°„ç ´è§£å•ä¾‹æ¨¡å¼éœ€è¦æ·»åŠ çš„ä»£ç </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span>(instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">            <span class="keyword">if</span>(instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> instance;</span><br><span class="line">            &#125;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton();</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color="red">è¯´æ˜:</font></p><p>â€‹    è¿™ç§æ–¹å¼æ¯”è¾ƒå¥½ç†è§£ã€‚å½“é€šè¿‡åå°„æ–¹å¼è°ƒç”¨æ„é€ æ–¹æ³•è¿›è¡Œåˆ›å»ºåˆ›å»ºæ—¶ï¼Œç›´æ¥æŠ›å¼‚å¸¸ã€‚ä¸è¿è¡Œæ­¤ä¸­æ“ä½œã€‚</p></li></ul><h3 id="1-1-4-JDKæºç è§£æ-Runtimeç±»"><a href="#1-1-4-JDKæºç è§£æ-Runtimeç±»" class="headerlink" title="1.1.4 JDKæºç è§£æ-Runtimeç±»"></a>1.1.4 JDKæºç è§£æ-Runtimeç±»</h3><p>Runtimeç±»å°±æ˜¯ä½¿ç”¨çš„å•ä¾‹è®¾è®¡æ¨¡å¼ã€‚</p><ol><li><p>é€šè¿‡æºä»£ç æŸ¥çœ‹ä½¿ç”¨çš„æ˜¯å“ªå„¿ç§å•ä¾‹æ¨¡å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Runtime</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Runtime currentRuntime = <span class="keyword">new</span> Runtime();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the runtime object associated with the current Java application.</span></span><br><span class="line"><span class="comment">     * Most of the methods of class &lt;code&gt;Runtime&lt;/code&gt; are instance</span></span><br><span class="line"><span class="comment">     * methods and must be invoked with respect to the current runtime object.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>  the &lt;code&gt;Runtime&lt;/code&gt; object associated with the current</span></span><br><span class="line"><span class="comment">     *          Java application.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Runtime <span class="title">getRuntime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> currentRuntime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Don&#x27;t let anyone else instantiate this class */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Runtime</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢æºä»£ç ä¸­å¯ä»¥çœ‹å‡ºRuntimeç±»ä½¿ç”¨çš„æ˜¯æ¶æ±‰å¼ï¼ˆé™æ€å±æ€§ï¼‰æ–¹å¼æ¥å®ç°å•ä¾‹æ¨¡å¼çš„ã€‚</p></li><li><p>ä½¿ç”¨Runtimeç±»ä¸­çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RuntimeDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–Runtimeç±»å¯¹è±¡</span></span><br><span class="line">        Runtime runtime = Runtime.getRuntime();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¿”å› Java è™šæ‹Ÿæœºä¸­çš„å†…å­˜æ€»é‡ã€‚</span></span><br><span class="line">        System.out.println(runtime.totalMemory());</span><br><span class="line">        <span class="comment">//è¿”å› Java è™šæ‹Ÿæœºè¯•å›¾ä½¿ç”¨çš„æœ€å¤§å†…å­˜é‡ã€‚</span></span><br><span class="line">        System.out.println(runtime.maxMemory());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹æ‰§è¡ŒæŒ‡å®šçš„å­—ç¬¦ä¸²å‘½ä»¤ï¼Œè¿”å›è¿›ç¨‹å¯¹è±¡</span></span><br><span class="line">        Process process = runtime.exec(<span class="string">&quot;ipconfig&quot;</span>);</span><br><span class="line">        <span class="comment">//è·å–å‘½ä»¤æ‰§è¡Œåçš„ç»“æœï¼Œé€šè¿‡è¾“å…¥æµè·å–</span></span><br><span class="line">        InputStream inputStream = process.getInputStream();</span><br><span class="line">        <span class="keyword">byte</span>[] arr = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">1024</span>* <span class="number">100</span>];</span><br><span class="line">        <span class="keyword">int</span> b = inputStream.read(arr);</span><br><span class="line">        System.out.println(<span class="keyword">new</span> String(arr,<span class="number">0</span>,b,<span class="string">&quot;gbk&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1ï¼Œåˆ›å»ºè€…æ¨¡å¼-å•ä¾‹æ¨¡å¼&quot;&gt;&lt;a href=&quot;#1ï¼Œåˆ›å»ºè€…æ¨¡å¼-å•ä¾‹æ¨¡å¼&quot; class=&quot;headerlink&quot; title=&quot;1ï¼Œåˆ›å»ºè€…æ¨¡å¼-å•ä¾‹æ¨¡å¼&quot;&gt;&lt;/a&gt;1ï¼Œåˆ›å»ºè€…æ¨¡å¼-å•ä¾‹æ¨¡å¼&lt;/h1&gt;&lt;p&gt;åˆ›å»ºå‹æ¨¡å¼çš„ä¸»è¦å…³æ³¨ç‚¹æ˜¯â€œæ€æ ·åˆ›å»ºå¯¹è±¡ï¼Ÿâ€ï¼Œå®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯â€œ</summary>
      
    
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/categories/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/tags/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="å•ä¾‹æ¨¡å¼" scheme="http://example.com/tags/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>javaè®¾è®¡æ¨¡å¼--è®¾è®¡æ¨¡å¼åŸåˆ™</title>
    <link href="http://example.com/2024/08/28/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%8E%9F%E5%88%99/"/>
    <id>http://example.com/2024/08/28/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%8E%9F%E5%88%99/</id>
    <published>2024-08-28T12:31:25.000Z</published>
    <updated>2024-08-28T12:55:54.945Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°"><a href="#1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°" class="headerlink" title="1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°"></a>1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°</h1><h2 id="1-1-è½¯ä»¶è®¾è®¡æ¨¡å¼çš„äº§ç”ŸèƒŒæ™¯"><a href="#1-1-è½¯ä»¶è®¾è®¡æ¨¡å¼çš„äº§ç”ŸèƒŒæ™¯" class="headerlink" title="1.1 è½¯ä»¶è®¾è®¡æ¨¡å¼çš„äº§ç”ŸèƒŒæ™¯"></a>1.1 è½¯ä»¶è®¾è®¡æ¨¡å¼çš„äº§ç”ŸèƒŒæ™¯</h2><p>â€œè®¾è®¡æ¨¡å¼â€æœ€åˆå¹¶ä¸æ˜¯å‡ºç°åœ¨è½¯ä»¶è®¾è®¡ä¸­ï¼Œè€Œæ˜¯è¢«ç”¨äºå»ºç­‘é¢†åŸŸçš„è®¾è®¡ä¸­ã€‚</p><p>1977å¹´ç¾å›½è‘—åå»ºç­‘å¤§å¸ˆã€åŠ åˆ©ç¦å°¼äºšå¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡ç¯å¢ƒç»“æ„ä¸­å¿ƒä¸»ä»»<code>å…‹é‡Œæ–¯æ‰˜å¤«Â·äºšå†å±±å¤§ï¼ˆChristopher Alexanderï¼‰</code>åœ¨ä»–çš„è‘—ä½œã€Šå»ºç­‘æ¨¡å¼è¯­è¨€ï¼šåŸé•‡ã€å»ºç­‘ã€æ„é€ ã€‹ä¸­æè¿°äº†ä¸€äº›å¸¸è§çš„å»ºç­‘è®¾è®¡é—®é¢˜ï¼Œå¹¶æå‡ºäº† 253 ç§å…³äºå¯¹åŸé•‡ã€é‚»é‡Œã€ä½å®…ã€èŠ±å›­å’Œæˆ¿é—´ç­‰è¿›è¡Œè®¾è®¡çš„åŸºæœ¬æ¨¡å¼ã€‚</p><p>1990å¹´è½¯ä»¶å·¥ç¨‹ç•Œå¼€å§‹ç ”è®¨è®¾è®¡æ¨¡å¼çš„è¯é¢˜ï¼Œåæ¥å¬å¼€äº†å¤šæ¬¡å…³äºè®¾è®¡æ¨¡å¼çš„ç ”è®¨ä¼šã€‚ç›´åˆ°1995 å¹´ï¼Œè‰¾ç‘å…‹Â·ä¼½é©¬ï¼ˆErichGammaï¼‰ã€ç†æŸ»å¾·Â·æµ·å°”å§†ï¼ˆRichard Helmï¼‰ã€æ‹‰å°”å¤«Â·çº¦ç¿°æ£®ï¼ˆRalph Johnsonï¼‰ã€çº¦ç¿°Â·å¨åˆ©æ–¯è¿ªæ–¯ï¼ˆJohn Vlissidesï¼‰ç­‰ 4 ä½ä½œè€…åˆä½œå‡ºç‰ˆäº†ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹ä¸€ä¹¦ï¼Œåœ¨æ­¤ä¹¦ä¸­æ”¶å½•äº† 23 ä¸ªè®¾è®¡æ¨¡å¼ï¼Œè¿™æ˜¯è®¾è®¡æ¨¡å¼é¢†åŸŸé‡Œç¨‹ç¢‘çš„äº‹ä»¶ï¼Œå¯¼è‡´äº†è½¯ä»¶è®¾è®¡æ¨¡å¼çš„çªç ´ã€‚è¿™ 4 ä½ä½œè€…åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸé‡Œä¹Ÿä»¥ä»–ä»¬çš„â€œå››äººç»„â€ï¼ˆGang of Fourï¼ŒGoFï¼‰è‘—ç§°ã€‚  </p><h2 id="1-2-è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ"><a href="#1-2-è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ" class="headerlink" title="1.2 è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ"></a>1.2 è½¯ä»¶è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µ</h2><p>è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼ˆSoftware Design Patternï¼‰ï¼Œåˆç§°è®¾è®¡æ¨¡å¼ï¼Œæ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚å®ƒæè¿°äº†åœ¨è½¯ä»¶è®¾è®¡è¿‡ç¨‹ä¸­çš„ä¸€äº›ä¸æ–­é‡å¤å‘ç”Ÿçš„é—®é¢˜ï¼Œä»¥åŠè¯¥é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ˜¯è§£å†³ç‰¹å®šé—®é¢˜çš„ä¸€ç³»åˆ—å¥—è·¯ï¼Œæ˜¯å‰è¾ˆä»¬çš„ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼Œå…·æœ‰ä¸€å®šçš„æ™®éæ€§ï¼Œå¯ä»¥åå¤ä½¿ç”¨ã€‚</p><h2 id="1-3-å­¦ä¹ è®¾è®¡æ¨¡å¼çš„å¿…è¦æ€§"><a href="#1-3-å­¦ä¹ è®¾è®¡æ¨¡å¼çš„å¿…è¦æ€§" class="headerlink" title="1.3 å­¦ä¹ è®¾è®¡æ¨¡å¼çš„å¿…è¦æ€§"></a>1.3 å­¦ä¹ è®¾è®¡æ¨¡å¼çš„å¿…è¦æ€§</h2><p>è®¾è®¡æ¨¡å¼çš„æœ¬è´¨æ˜¯é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™çš„å®é™…è¿ç”¨ï¼Œæ˜¯å¯¹ç±»çš„å°è£…æ€§ã€ç»§æ‰¿æ€§å’Œå¤šæ€æ€§ä»¥åŠç±»çš„å…³è”å…³ç³»å’Œç»„åˆå…³ç³»çš„å……åˆ†ç†è§£ã€‚</p><p>æ­£ç¡®ä½¿ç”¨è®¾è®¡æ¨¡å¼å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ã€‚</p><ul><li>å¯ä»¥æé«˜ç¨‹åºå‘˜çš„æ€ç»´èƒ½åŠ›ã€ç¼–ç¨‹èƒ½åŠ›å’Œè®¾è®¡èƒ½åŠ›ã€‚</li><li>ä½¿ç¨‹åºè®¾è®¡æ›´åŠ æ ‡å‡†åŒ–ã€ä»£ç ç¼–åˆ¶æ›´åŠ å·¥ç¨‹åŒ–ï¼Œä½¿è½¯ä»¶å¼€å‘æ•ˆç‡å¤§å¤§æé«˜ï¼Œä»è€Œç¼©çŸ­è½¯ä»¶çš„å¼€å‘å‘¨æœŸã€‚</li><li>ä½¿è®¾è®¡çš„ä»£ç å¯é‡ç”¨æ€§é«˜ã€å¯è¯»æ€§å¼ºã€å¯é æ€§é«˜ã€çµæ´»æ€§å¥½ã€å¯ç»´æŠ¤æ€§å¼ºã€‚</li></ul><h2 id="1-4-è®¾è®¡æ¨¡å¼åˆ†ç±»"><a href="#1-4-è®¾è®¡æ¨¡å¼åˆ†ç±»" class="headerlink" title="1.4 è®¾è®¡æ¨¡å¼åˆ†ç±»"></a>1.4 è®¾è®¡æ¨¡å¼åˆ†ç±»</h2><ul><li><p><strong>åˆ›å»ºå‹æ¨¡å¼</strong></p><p>ç”¨äºæè¿°â€œæ€æ ·åˆ›å»ºå¯¹è±¡â€ï¼Œå®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯â€œå°†å¯¹è±¡çš„åˆ›å»ºä¸ä½¿ç”¨åˆ†ç¦»â€ã€‚GoFï¼ˆå››äººç»„ï¼‰ä¹¦ä¸­æä¾›äº†å•ä¾‹ã€åŸå‹ã€å·¥å‚æ–¹æ³•ã€æŠ½è±¡å·¥å‚ã€å»ºé€ è€…ç­‰ 5 ç§åˆ›å»ºå‹æ¨¡å¼ã€‚</p></li><li><p><strong>ç»“æ„å‹æ¨¡å¼</strong></p><p>ç”¨äºæè¿°å¦‚ä½•å°†ç±»æˆ–å¯¹è±¡æŒ‰æŸç§å¸ƒå±€ç»„æˆæ›´å¤§çš„ç»“æ„ï¼ŒGoFï¼ˆå››äººç»„ï¼‰ä¹¦ä¸­æä¾›äº†ä»£ç†ã€é€‚é…å™¨ã€æ¡¥æ¥ã€è£…é¥°ã€å¤–è§‚ã€äº«å…ƒã€ç»„åˆç­‰ 7 ç§ç»“æ„å‹æ¨¡å¼ã€‚</p></li><li><p><strong>è¡Œä¸ºå‹æ¨¡å¼</strong></p><p>ç”¨äºæè¿°ç±»æˆ–å¯¹è±¡ä¹‹é—´æ€æ ·ç›¸äº’åä½œå…±åŒå®Œæˆå•ä¸ªå¯¹è±¡æ— æ³•å•ç‹¬å®Œæˆçš„ä»»åŠ¡ï¼Œä»¥åŠæ€æ ·åˆ†é…èŒè´£ã€‚GoFï¼ˆå››äººç»„ï¼‰ä¹¦ä¸­æä¾›äº†æ¨¡æ¿æ–¹æ³•ã€ç­–ç•¥ã€å‘½ä»¤ã€èŒè´£é“¾ã€çŠ¶æ€ã€è§‚å¯Ÿè€…ã€ä¸­ä»‹è€…ã€è¿­ä»£å™¨ã€è®¿é—®è€…ã€å¤‡å¿˜å½•ã€è§£é‡Šå™¨ç­‰ 11 ç§è¡Œä¸ºå‹æ¨¡å¼ã€‚</p></li></ul><h1 id="2ï¼ŒUMLå›¾"><a href="#2ï¼ŒUMLå›¾" class="headerlink" title="2ï¼ŒUMLå›¾"></a>2ï¼ŒUMLå›¾</h1><p>ç»Ÿä¸€å»ºæ¨¡è¯­è¨€ï¼ˆUnified Modeling Languageï¼ŒUMLï¼‰æ˜¯ç”¨æ¥è®¾è®¡è½¯ä»¶çš„å¯è§†åŒ–å»ºæ¨¡è¯­è¨€ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯ç®€å•ã€ç»Ÿä¸€ã€å›¾å½¢åŒ–ã€èƒ½è¡¨è¾¾è½¯ä»¶è®¾è®¡ä¸­çš„åŠ¨æ€ä¸é™æ€ä¿¡æ¯ã€‚</p><p>UML ä»ç›®æ ‡ç³»ç»Ÿçš„ä¸åŒè§’åº¦å‡ºå‘ï¼Œå®šä¹‰äº†ç”¨ä¾‹å›¾ã€ç±»å›¾ã€å¯¹è±¡å›¾ã€çŠ¶æ€å›¾ã€æ´»åŠ¨å›¾ã€æ—¶åºå›¾ã€åä½œå›¾ã€æ„ä»¶å›¾ã€éƒ¨ç½²å›¾ç­‰ 9 ç§å›¾ã€‚</p><h2 id="2-1-ç±»å›¾æ¦‚è¿°"><a href="#2-1-ç±»å›¾æ¦‚è¿°" class="headerlink" title="2.1 ç±»å›¾æ¦‚è¿°"></a>2.1 ç±»å›¾æ¦‚è¿°</h2><p>ç±»å›¾(Class diagram)æ˜¯æ˜¾ç¤ºäº†æ¨¡å‹çš„é™æ€ç»“æ„ï¼Œç‰¹åˆ«æ˜¯æ¨¡å‹ä¸­å­˜åœ¨çš„ç±»ã€ç±»çš„å†…éƒ¨ç»“æ„ä»¥åŠå®ƒä»¬ä¸å…¶ä»–ç±»çš„å…³ç³»ç­‰ã€‚ç±»å›¾ä¸æ˜¾ç¤ºæš‚æ—¶æ€§çš„ä¿¡æ¯ã€‚ç±»å›¾æ˜¯é¢å‘å¯¹è±¡å»ºæ¨¡çš„ä¸»è¦ç»„æˆéƒ¨åˆ†ã€‚</p><h2 id="2-2-ç±»å›¾çš„ä½œç”¨"><a href="#2-2-ç±»å›¾çš„ä½œç”¨" class="headerlink" title="2.2 ç±»å›¾çš„ä½œç”¨"></a>2.2 ç±»å›¾çš„ä½œç”¨</h2><ul><li>åœ¨è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œç±»å›¾æ˜¯ä¸€ç§é™æ€çš„ç»“æ„å›¾ï¼Œæè¿°äº†ç³»ç»Ÿçš„ç±»çš„é›†åˆï¼Œç±»çš„å±æ€§å’Œç±»ä¹‹é—´çš„å…³ç³»ï¼Œå¯ä»¥ç®€åŒ–äº†äººä»¬å¯¹ç³»ç»Ÿçš„ç†è§£ï¼›</li><li>ç±»å›¾æ˜¯ç³»ç»Ÿåˆ†æå’Œè®¾è®¡é˜¶æ®µçš„é‡è¦äº§ç‰©ï¼Œæ˜¯ç³»ç»Ÿç¼–ç å’Œæµ‹è¯•çš„é‡è¦æ¨¡å‹ã€‚</li></ul><h2 id="2-3-ç±»å›¾è¡¨ç¤ºæ³•"><a href="#2-3-ç±»å›¾è¡¨ç¤ºæ³•" class="headerlink" title="2.3 ç±»å›¾è¡¨ç¤ºæ³•"></a>2.3 ç±»å›¾è¡¨ç¤ºæ³•</h2><h3 id="2-3-1-ç±»çš„è¡¨ç¤ºæ–¹å¼"><a href="#2-3-1-ç±»çš„è¡¨ç¤ºæ–¹å¼" class="headerlink" title="2.3.1 ç±»çš„è¡¨ç¤ºæ–¹å¼"></a>2.3.1 ç±»çš„è¡¨ç¤ºæ–¹å¼</h3><p>åœ¨UMLç±»å›¾ä¸­ï¼Œç±»ä½¿ç”¨åŒ…å«ç±»åã€å±æ€§(field) å’Œæ–¹æ³•(method) ä¸”å¸¦æœ‰åˆ†å‰²çº¿çš„çŸ©å½¢æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚ä¸‹å›¾è¡¨ç¤ºä¸€ä¸ªEmployeeç±»ï¼Œå®ƒåŒ…å«name,ageå’Œaddressè¿™3ä¸ªå±æ€§ï¼Œä»¥åŠwork()æ–¹æ³•ã€‚ </p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/Employee.jpg"></p><p>å±æ€§/æ–¹æ³•åç§°å‰åŠ çš„åŠ å·å’Œå‡å·è¡¨ç¤ºäº†è¿™ä¸ªå±æ€§/æ–¹æ³•çš„å¯è§æ€§ï¼ŒUMLç±»å›¾ä¸­è¡¨ç¤ºå¯è§æ€§çš„ç¬¦å·æœ‰ä¸‰ç§ï¼š</p><ul><li><p>+ï¼šè¡¨ç¤ºpublic</p></li><li><p>-ï¼šè¡¨ç¤ºprivate</p></li><li><p>#ï¼šè¡¨ç¤ºprotected</p></li></ul><p>å±æ€§çš„å®Œæ•´è¡¨ç¤ºæ–¹å¼æ˜¯ï¼š <strong>å¯è§æ€§  åç§° ï¼šç±»å‹ [ = ç¼ºçœå€¼]</strong>  </p><p>æ–¹æ³•çš„å®Œæ•´è¡¨ç¤ºæ–¹å¼æ˜¯ï¼š <strong>å¯è§æ€§  åç§°(å‚æ•°åˆ—è¡¨) [ ï¼š è¿”å›ç±»å‹]</strong></p><blockquote><p>æ³¨æ„ï¼š</p><p>â€‹    1ï¼Œä¸­æ‹¬å·ä¸­çš„å†…å®¹è¡¨ç¤ºæ˜¯å¯é€‰çš„</p><p>â€‹    2ï¼Œä¹Ÿæœ‰å°†ç±»å‹æ”¾åœ¨å˜é‡åå‰é¢ï¼Œè¿”å›å€¼ç±»å‹æ”¾åœ¨æ–¹æ³•åå‰é¢</p></blockquote><p><strong>ä¸¾ä¸ªæ —å­ï¼š</strong></p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/demo.png"></p><p>ä¸Šå›¾Demoç±»å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•ï¼š</p><ul><li>method()æ–¹æ³•ï¼šä¿®é¥°ç¬¦ä¸ºpublicï¼Œæ²¡æœ‰å‚æ•°ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚</li><li>method1()æ–¹æ³•ï¼šä¿®é¥°ç¬¦ä¸ºprivateï¼Œæ²¡æœ‰å‚æ•°ï¼Œè¿”å›å€¼ç±»å‹ä¸ºStringã€‚</li><li>method2()æ–¹æ³•ï¼šä¿®é¥°ç¬¦ä¸ºprotectedï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹ä¸ºintï¼Œç¬¬äºŒä¸ªå‚æ•°ç±»å‹ä¸ºStringï¼Œè¿”å›å€¼ç±»å‹æ˜¯intã€‚</li></ul><h3 id="2-3-2-ç±»ä¸ç±»ä¹‹é—´å…³ç³»çš„è¡¨ç¤ºæ–¹å¼"><a href="#2-3-2-ç±»ä¸ç±»ä¹‹é—´å…³ç³»çš„è¡¨ç¤ºæ–¹å¼" class="headerlink" title="2.3.2 ç±»ä¸ç±»ä¹‹é—´å…³ç³»çš„è¡¨ç¤ºæ–¹å¼"></a>2.3.2 ç±»ä¸ç±»ä¹‹é—´å…³ç³»çš„è¡¨ç¤ºæ–¹å¼</h3><h4 id="2-3-2-1-å…³è”å…³ç³»"><a href="#2-3-2-1-å…³è”å…³ç³»" class="headerlink" title="2.3.2.1 å…³è”å…³ç³»"></a>2.3.2.1 å…³è”å…³ç³»</h4><p>å…³è”å…³ç³»æ˜¯å¯¹è±¡ä¹‹é—´çš„ä¸€ç§å¼•ç”¨å…³ç³»ï¼Œç”¨äºè¡¨ç¤ºä¸€ç±»å¯¹è±¡ä¸å¦ä¸€ç±»å¯¹è±¡ä¹‹é—´çš„è”ç³»ï¼Œå¦‚è€å¸ˆå’Œå­¦ç”Ÿã€å¸ˆå‚…å’Œå¾’å¼Ÿã€ä¸ˆå¤«å’Œå¦»å­ç­‰ã€‚å…³è”å…³ç³»æ˜¯ç±»ä¸ç±»ä¹‹é—´æœ€å¸¸ç”¨çš„ä¸€ç§å…³ç³»ï¼Œåˆ†ä¸ºä¸€èˆ¬å…³è”å…³ç³»ã€èšåˆå…³ç³»å’Œç»„åˆå…³ç³»ã€‚æˆ‘ä»¬å…ˆä»‹ç»ä¸€èˆ¬å…³è”ã€‚</p><p>å…³è”åˆå¯ä»¥åˆ†ä¸ºå•å‘å…³è”ï¼ŒåŒå‘å…³è”ï¼Œè‡ªå…³è”ã€‚</p><p><strong>1ï¼Œå•å‘å…³è”</strong></p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/customer_address.png"></p><p>åœ¨UMLç±»å›¾ä¸­å•å‘å…³è”ç”¨ä¸€ä¸ªå¸¦ç®­å¤´çš„å®çº¿è¡¨ç¤ºã€‚ä¸Šå›¾è¡¨ç¤ºæ¯ä¸ªé¡¾å®¢éƒ½æœ‰ä¸€ä¸ªåœ°å€ï¼Œè¿™é€šè¿‡è®©Customerç±»æŒæœ‰ä¸€ä¸ªç±»å‹ä¸ºAddressçš„æˆå‘˜å˜é‡ç±»å®ç°ã€‚</p><p><strong>2ï¼ŒåŒå‘å…³è”</strong></p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/customer_product.png"></p><p>ä»ä¸Šå›¾ä¸­æˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œæ‰€è°“çš„åŒå‘å…³è”å°±æ˜¯åŒæ–¹å„è‡ªæŒæœ‰å¯¹æ–¹ç±»å‹çš„æˆå‘˜å˜é‡ã€‚</p><p>åœ¨UMLç±»å›¾ä¸­ï¼ŒåŒå‘å…³è”ç”¨ä¸€ä¸ªä¸å¸¦ç®­å¤´çš„ç›´çº¿è¡¨ç¤ºã€‚ä¸Šå›¾ä¸­åœ¨Customerç±»ä¸­ç»´æŠ¤ä¸€ä¸ªList&lt;Product&gt;ï¼Œè¡¨ç¤ºä¸€ä¸ªé¡¾å®¢å¯ä»¥è´­ä¹°å¤šä¸ªå•†å“ï¼›åœ¨Productç±»ä¸­ç»´æŠ¤ä¸€ä¸ªCustomerç±»å‹çš„æˆå‘˜å˜é‡è¡¨ç¤ºè¿™ä¸ªäº§å“è¢«å“ªä¸ªé¡¾å®¢æ‰€è´­ä¹°ã€‚</p><p><strong>3ï¼Œè‡ªå…³è”</strong></p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/node.png"></p><p>è‡ªå…³è”åœ¨UMLç±»å›¾ä¸­ç”¨ä¸€ä¸ªå¸¦æœ‰ç®­å¤´ä¸”æŒ‡å‘è‡ªèº«çš„çº¿è¡¨ç¤ºã€‚ä¸Šå›¾çš„æ„æ€å°±æ˜¯Nodeç±»åŒ…å«ç±»å‹ä¸ºNodeçš„æˆå‘˜å˜é‡ï¼Œä¹Ÿå°±æ˜¯â€œè‡ªå·±åŒ…å«è‡ªå·±â€ã€‚</p><h4 id="2-3-2-2-èšåˆå…³ç³»"><a href="#2-3-2-2-èšåˆå…³ç³»" class="headerlink" title="2.3.2.2 èšåˆå…³ç³»"></a>2.3.2.2 èšåˆå…³ç³»</h4><p>èšåˆå…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œæ˜¯å¼ºå…³è”å…³ç³»ï¼Œæ˜¯æ•´ä½“å’Œéƒ¨åˆ†ä¹‹é—´çš„å…³ç³»ã€‚</p><p>èšåˆå…³ç³»ä¹Ÿæ˜¯é€šè¿‡æˆå‘˜å¯¹è±¡æ¥å®ç°çš„ï¼Œå…¶ä¸­æˆå‘˜å¯¹è±¡æ˜¯æ•´ä½“å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯æˆå‘˜å¯¹è±¡å¯ä»¥è„±ç¦»æ•´ä½“å¯¹è±¡è€Œç‹¬ç«‹å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œå­¦æ ¡ä¸è€å¸ˆçš„å…³ç³»ï¼Œå­¦æ ¡åŒ…å«è€å¸ˆï¼Œä½†å¦‚æœå­¦æ ¡åœåŠäº†ï¼Œè€å¸ˆä¾ç„¶å­˜åœ¨ã€‚</p><p>åœ¨ UML ç±»å›¾ä¸­ï¼Œèšåˆå…³ç³»å¯ä»¥ç”¨å¸¦ç©ºå¿ƒè±å½¢çš„å®çº¿æ¥è¡¨ç¤ºï¼Œè±å½¢æŒ‡å‘æ•´ä½“ã€‚ä¸‹å›¾æ‰€ç¤ºæ˜¯å¤§å­¦å’Œæ•™å¸ˆçš„å…³ç³»å›¾ï¼š</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20191229173422328.png"></p><h4 id="2-3-2-3-ç»„åˆå…³ç³»"><a href="#2-3-2-3-ç»„åˆå…³ç³»" class="headerlink" title="2.3.2.3 ç»„åˆå…³ç³»"></a>2.3.2.3 ç»„åˆå…³ç³»</h4><p>ç»„åˆè¡¨ç¤ºç±»ä¹‹é—´çš„æ•´ä½“ä¸éƒ¨åˆ†çš„å…³ç³»ï¼Œä½†å®ƒæ˜¯ä¸€ç§æ›´å¼ºçƒˆçš„èšåˆå…³ç³»ã€‚</p><p>åœ¨ç»„åˆå…³ç³»ä¸­ï¼Œæ•´ä½“å¯¹è±¡å¯ä»¥æ§åˆ¶éƒ¨åˆ†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸€æ—¦æ•´ä½“å¯¹è±¡ä¸å­˜åœ¨ï¼Œéƒ¨åˆ†å¯¹è±¡ä¹Ÿå°†ä¸å­˜åœ¨ï¼Œéƒ¨åˆ†å¯¹è±¡ä¸èƒ½è„±ç¦»æ•´ä½“å¯¹è±¡è€Œå­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œå¤´å’Œå˜´çš„å…³ç³»ï¼Œæ²¡æœ‰äº†å¤´ï¼Œå˜´ä¹Ÿå°±ä¸å­˜åœ¨äº†ã€‚</p><p>åœ¨ UML ç±»å›¾ä¸­ï¼Œç»„åˆå…³ç³»ç”¨å¸¦å®å¿ƒè±å½¢çš„å®çº¿æ¥è¡¨ç¤ºï¼Œè±å½¢æŒ‡å‘æ•´ä½“ã€‚ä¸‹å›¾æ‰€ç¤ºæ˜¯å¤´å’Œå˜´çš„å…³ç³»å›¾ï¼š</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20191229173455149.png"></p><h4 id="2-3-2-4-ä¾èµ–å…³ç³»"><a href="#2-3-2-4-ä¾èµ–å…³ç³»" class="headerlink" title="2.3.2.4 ä¾èµ–å…³ç³»"></a>2.3.2.4 ä¾èµ–å…³ç³»</h4><p>ä¾èµ–å…³ç³»æ˜¯ä¸€ç§ä½¿ç”¨å…³ç³»ï¼Œå®ƒæ˜¯å¯¹è±¡ä¹‹é—´è€¦åˆåº¦æœ€å¼±çš„ä¸€ç§å…³è”æ–¹å¼ï¼Œæ˜¯ä¸´æ—¶æ€§çš„å…³è”ã€‚åœ¨ä»£ç ä¸­ï¼ŒæŸä¸ªç±»çš„æ–¹æ³•é€šè¿‡å±€éƒ¨å˜é‡ã€æ–¹æ³•çš„å‚æ•°æˆ–è€…å¯¹é™æ€æ–¹æ³•çš„è°ƒç”¨æ¥è®¿é—®å¦ä¸€ä¸ªç±»ï¼ˆè¢«ä¾èµ–ç±»ï¼‰ä¸­çš„æŸäº›æ–¹æ³•æ¥å®Œæˆä¸€äº›èŒè´£ã€‚</p><p>åœ¨ UML ç±»å›¾ä¸­ï¼Œä¾èµ–å…³ç³»ä½¿ç”¨å¸¦ç®­å¤´çš„è™šçº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´ä»ä½¿ç”¨ç±»æŒ‡å‘è¢«ä¾èµ–çš„ç±»ã€‚ä¸‹å›¾æ‰€ç¤ºæ˜¯å¸æœºå’Œæ±½è½¦çš„å…³ç³»å›¾ï¼Œå¸æœºé©¾é©¶æ±½è½¦ï¼š</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20191229173518926.png"></p><h4 id="2-3-2-5-ç»§æ‰¿å…³ç³»"><a href="#2-3-2-5-ç»§æ‰¿å…³ç³»" class="headerlink" title="2.3.2.5 ç»§æ‰¿å…³ç³»"></a>2.3.2.5 ç»§æ‰¿å…³ç³»</h4><p>ç»§æ‰¿å…³ç³»æ˜¯å¯¹è±¡ä¹‹é—´è€¦åˆåº¦æœ€å¤§çš„ä¸€ç§å…³ç³»ï¼Œè¡¨ç¤ºä¸€èˆ¬ä¸ç‰¹æ®Šçš„å…³ç³»ï¼Œæ˜¯çˆ¶ç±»ä¸å­ç±»ä¹‹é—´çš„å…³ç³»ï¼Œæ˜¯ä¸€ç§ç»§æ‰¿å…³ç³»ã€‚</p><p>åœ¨ UML ç±»å›¾ä¸­ï¼Œæ³›åŒ–å…³ç³»ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„å®çº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´ä»å­ç±»æŒ‡å‘çˆ¶ç±»ã€‚åœ¨ä»£ç å®ç°æ—¶ï¼Œä½¿ç”¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿æœºåˆ¶æ¥å®ç°æ³›åŒ–å…³ç³»ã€‚ä¾‹å¦‚ï¼ŒStudent ç±»å’Œ Teacher ç±»éƒ½æ˜¯ Person ç±»çš„å­ç±»ï¼Œå…¶ç±»å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20191229173539838.png"></p><h4 id="2-3-2-6-å®ç°å…³ç³»"><a href="#2-3-2-6-å®ç°å…³ç³»" class="headerlink" title="2.3.2.6 å®ç°å…³ç³»"></a>2.3.2.6 å®ç°å…³ç³»</h4><p>å®ç°å…³ç³»æ˜¯æ¥å£ä¸å®ç°ç±»ä¹‹é—´çš„å…³ç³»ã€‚åœ¨è¿™ç§å…³ç³»ä¸­ï¼Œç±»å®ç°äº†æ¥å£ï¼Œç±»ä¸­çš„æ“ä½œå®ç°äº†æ¥å£ä¸­æ‰€å£°æ˜çš„æ‰€æœ‰çš„æŠ½è±¡æ“ä½œã€‚</p><p>åœ¨ UML ç±»å›¾ä¸­ï¼Œå®ç°å…³ç³»ä½¿ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„è™šçº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´ä»å®ç°ç±»æŒ‡å‘æ¥å£ã€‚ä¾‹å¦‚ï¼Œæ±½è½¦å’Œèˆ¹å®ç°äº†äº¤é€šå·¥å…·ï¼Œå…¶ç±»å›¾å¦‚å›¾ 9 æ‰€ç¤ºã€‚</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/image-20191229173554296.png"></p><h1 id="3ï¼Œè½¯ä»¶è®¾è®¡åŸåˆ™"><a href="#3ï¼Œè½¯ä»¶è®¾è®¡åŸåˆ™" class="headerlink" title="3ï¼Œè½¯ä»¶è®¾è®¡åŸåˆ™"></a>3ï¼Œè½¯ä»¶è®¾è®¡åŸåˆ™</h1><p>åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œä¸ºäº†æé«˜è½¯ä»¶ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œå¯å¤ç”¨æ€§ï¼Œå¢åŠ è½¯ä»¶çš„å¯æ‰©å±•æ€§å’Œçµæ´»æ€§ï¼Œç¨‹åºå‘˜è¦å°½é‡æ ¹æ®6æ¡åŸåˆ™æ¥å¼€å‘ç¨‹åºï¼Œä»è€Œæé«˜è½¯ä»¶å¼€å‘æ•ˆç‡ã€èŠ‚çº¦è½¯ä»¶å¼€å‘æˆæœ¬å’Œç»´æŠ¤æˆæœ¬ã€‚</p><h2 id="3-1-å¼€é—­åŸåˆ™"><a href="#3-1-å¼€é—­åŸåˆ™" class="headerlink" title="3.1 å¼€é—­åŸåˆ™"></a>3.1 å¼€é—­åŸåˆ™</h2><p><strong>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</strong>ã€‚åœ¨ç¨‹åºéœ€è¦è¿›è¡Œæ‹“å±•çš„æ—¶å€™ï¼Œä¸èƒ½å»ä¿®æ”¹åŸæœ‰çš„ä»£ç ï¼Œå®ç°ä¸€ä¸ªçƒ­æ’æ‹”çš„æ•ˆæœã€‚ç®€è¨€ä¹‹ï¼Œæ˜¯ä¸ºäº†ä½¿ç¨‹åºçš„æ‰©å±•æ€§å¥½ï¼Œæ˜“äºç»´æŠ¤å’Œå‡çº§ã€‚</p><p>æƒ³è¦è¾¾åˆ°è¿™æ ·çš„æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ¥å£å’ŒæŠ½è±¡ç±»ã€‚</p><p>å› ä¸ºæŠ½è±¡çµæ´»æ€§å¥½ï¼Œé€‚åº”æ€§å¹¿ï¼Œåªè¦æŠ½è±¡çš„åˆç†ï¼Œå¯ä»¥åŸºæœ¬ä¿æŒè½¯ä»¶æ¶æ„çš„ç¨³å®šã€‚è€Œè½¯ä»¶ä¸­æ˜“å˜çš„ç»†èŠ‚å¯ä»¥ä»æŠ½è±¡æ´¾ç”Ÿæ¥çš„å®ç°ç±»æ¥è¿›è¡Œæ‰©å±•ï¼Œå½“è½¯ä»¶éœ€è¦å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåªéœ€è¦æ ¹æ®éœ€æ±‚é‡æ–°æ´¾ç”Ÿä¸€ä¸ªå®ç°ç±»æ¥æ‰©å±•å°±å¯ä»¥äº†ã€‚</p><p>ä¸‹é¢ä»¥ <code>æœç‹—è¾“å…¥æ³•</code> çš„çš®è‚¤ä¸ºä¾‹ä»‹ç»å¼€é—­åŸåˆ™çš„åº”ç”¨ã€‚</p><p>ã€ä¾‹ã€‘<code>æœç‹—è¾“å…¥æ³•</code> çš„çš®è‚¤è®¾è®¡ã€‚</p><p>åˆ†æï¼š<code>æœç‹—è¾“å…¥æ³•</code> çš„çš®è‚¤æ˜¯è¾“å…¥æ³•èƒŒæ™¯å›¾ç‰‡ã€çª—å£é¢œè‰²å’Œå£°éŸ³ç­‰å…ƒç´ çš„ç»„åˆã€‚ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œçˆ±æ›´æ¢è‡ªå·±çš„è¾“å…¥æ³•çš„çš®è‚¤ï¼Œä¹Ÿå¯ä»¥ä»ç½‘ä¸Šä¸‹è½½æ–°çš„çš®è‚¤ã€‚è¿™äº›çš®è‚¤æœ‰å…±åŒçš„ç‰¹ç‚¹ï¼Œå¯ä»¥ä¸ºå…¶å®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±»ï¼ˆAbstractSkinï¼‰ï¼Œè€Œæ¯ä¸ªå…·ä½“çš„çš®è‚¤ï¼ˆDefaultSpecificSkinå’ŒHeimaSpecificSkinï¼‰æ˜¯å…¶å­ç±»ã€‚ç”¨æˆ·çª—ä½“å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©æˆ–è€…å¢åŠ æ–°çš„ä¸»é¢˜ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹åŸä»£ç ï¼Œæ‰€ä»¥å®ƒæ˜¯æ»¡è¶³å¼€é—­åŸåˆ™çš„ã€‚</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/open-close.png"></p><h2 id="3-2-é‡Œæ°ä»£æ¢åŸåˆ™"><a href="#3-2-é‡Œæ°ä»£æ¢åŸåˆ™" class="headerlink" title="3.2 é‡Œæ°ä»£æ¢åŸåˆ™"></a>3.2 é‡Œæ°ä»£æ¢åŸåˆ™</h2><p>é‡Œæ°ä»£æ¢åŸåˆ™æ˜¯é¢å‘å¯¹è±¡è®¾è®¡çš„åŸºæœ¬åŸåˆ™ä¹‹ä¸€ã€‚</p><p>é‡Œæ°ä»£æ¢åŸåˆ™ï¼šä»»ä½•åŸºç±»å¯ä»¥å‡ºç°çš„åœ°æ–¹ï¼Œå­ç±»ä¸€å®šå¯ä»¥å‡ºç°ã€‚é€šä¿—ç†è§£ï¼šå­ç±»å¯ä»¥æ‰©å±•çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½æ”¹å˜çˆ¶ç±»åŸæœ‰çš„åŠŸèƒ½ã€‚æ¢å¥è¯è¯´ï¼Œå­ç±»ç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œé™¤æ·»åŠ æ–°çš„æ–¹æ³•å®Œæˆæ–°å¢åŠŸèƒ½å¤–ï¼Œå°½é‡ä¸è¦é‡å†™çˆ¶ç±»çš„æ–¹æ³•ã€‚</p><p>å¦‚æœé€šè¿‡é‡å†™çˆ¶ç±»çš„æ–¹æ³•æ¥å®Œæˆæ–°çš„åŠŸèƒ½ï¼Œè¿™æ ·å†™èµ·æ¥è™½ç„¶ç®€å•ï¼Œä½†æ˜¯æ•´ä¸ªç»§æ‰¿ä½“ç³»çš„å¯å¤ç”¨æ€§ä¼šæ¯”è¾ƒå·®ï¼Œç‰¹åˆ«æ˜¯è¿ç”¨å¤šæ€æ¯”è¾ƒé¢‘ç¹æ—¶ï¼Œç¨‹åºè¿è¡Œå‡ºé”™çš„æ¦‚ç‡ä¼šéå¸¸å¤§ã€‚</p><p>ä¸‹é¢çœ‹ä¸€ä¸ªé‡Œæ°æ›¿æ¢åŸåˆ™ä¸­ç»å…¸çš„ä¸€ä¸ªä¾‹å­</p><p>ã€ä¾‹ã€‘æ­£æ–¹å½¢ä¸æ˜¯é•¿æ–¹å½¢ã€‚</p><p>åœ¨æ•°å­¦é¢†åŸŸé‡Œï¼Œæ­£æ–¹å½¢æ¯«æ— ç–‘é—®æ˜¯é•¿æ–¹å½¢ï¼Œå®ƒæ˜¯ä¸€ä¸ªé•¿å®½ç›¸ç­‰çš„é•¿æ–¹å½¢ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¼€å‘çš„ä¸€ä¸ªä¸å‡ ä½•å›¾å½¢ç›¸å…³çš„è½¯ä»¶ç³»ç»Ÿï¼Œå°±å¯ä»¥é¡ºç†æˆç« çš„è®©æ­£æ–¹å½¢ç»§æ‰¿è‡ªé•¿æ–¹å½¢ã€‚</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%AD%A3%E6%96%B9%E5%BD%A2%E4%B8%8D%E6%98%AF%E9%95%BF%E6%96%B9%E5%BD%A2.png"></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><p><strong>é•¿æ–¹å½¢ç±»ï¼ˆRectangleï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> length;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> width;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getLength</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> length;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLength</span><span class="params">(<span class="keyword">double</span> length)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.length = length;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getWidth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> width;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWidth</span><span class="params">(<span class="keyword">double</span> width)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.width = width;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ­£æ–¹å½¢ï¼ˆSquareï¼‰ï¼š</strong></p><p>ç”±äºæ­£æ–¹å½¢çš„é•¿å’Œå®½ç›¸åŒï¼Œæ‰€ä»¥åœ¨æ–¹æ³•setLengthå’ŒsetWidthä¸­ï¼Œå¯¹é•¿åº¦å’Œå®½åº¦éƒ½éœ€è¦èµ‹ç›¸åŒå€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Square</span> <span class="keyword">extends</span> <span class="title">Rectangle</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWidth</span><span class="params">(<span class="keyword">double</span> width)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.setLength(width);</span><br><span class="line">        <span class="keyword">super</span>.setWidth(width);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLength</span><span class="params">(<span class="keyword">double</span> length)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.setLength(length);</span><br><span class="line">        <span class="keyword">super</span>.setWidth(length);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»RectangleDemoæ˜¯æˆ‘ä»¬çš„è½¯ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒæœ‰ä¸€ä¸ªresizeæ–¹æ³•ä¾èµ–åŸºç±»Rectangleï¼Œresizeæ–¹æ³•æ˜¯RectandleDemoç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥å®ç°å®½åº¦é€æ¸å¢é•¿çš„æ•ˆæœã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RectangleDemo</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">resize</span><span class="params">(Rectangle rectangle)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (rectangle.getWidth() &lt;= rectangle.getLength()) &#123;</span><br><span class="line">            rectangle.setWidth(rectangle.getWidth() + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰“å°é•¿æ–¹å½¢çš„é•¿å’Œå®½</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printLengthAndWidth</span><span class="params">(Rectangle rectangle)</span> </span>&#123;</span><br><span class="line">        System.out.println(rectangle.getLength());</span><br><span class="line">        System.out.println(rectangle.getWidth());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Rectangle rectangle = <span class="keyword">new</span> Rectangle();</span><br><span class="line">        rectangle.setLength(<span class="number">20</span>);</span><br><span class="line">        rectangle.setWidth(<span class="number">10</span>);</span><br><span class="line">        resize(rectangle);</span><br><span class="line">        printLengthAndWidth(rectangle);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;============&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Rectangle rectangle1 = <span class="keyword">new</span> Square();</span><br><span class="line">        rectangle1.setLength(<span class="number">10</span>);</span><br><span class="line">        resize(rectangle1);</span><br><span class="line">        printLengthAndWidth(rectangle1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿è¡Œä¸€ä¸‹è¿™æ®µä»£ç å°±ä¼šå‘ç°ï¼Œå‡å¦‚æˆ‘ä»¬æŠŠä¸€ä¸ªæ™®é€šé•¿æ–¹å½¢ä½œä¸ºå‚æ•°ä¼ å…¥resizeæ–¹æ³•ï¼Œå°±ä¼šçœ‹åˆ°é•¿æ–¹å½¢å®½åº¦é€æ¸å¢é•¿çš„æ•ˆæœï¼Œå½“å®½åº¦å¤§äºé•¿åº¦,ä»£ç å°±ä¼šåœæ­¢ï¼Œè¿™ç§è¡Œä¸ºçš„ç»“æœç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸï¼›å‡å¦‚æˆ‘ä»¬å†æŠŠä¸€ä¸ªæ­£æ–¹å½¢ä½œä¸ºå‚æ•°ä¼ å…¥resizeæ–¹æ³•åï¼Œå°±ä¼šçœ‹åˆ°æ­£æ–¹å½¢çš„å®½åº¦å’Œé•¿åº¦éƒ½åœ¨ä¸æ–­å¢é•¿ï¼Œä»£ç ä¼šä¸€ç›´è¿è¡Œä¸‹å»ï¼Œç›´è‡³ç³»ç»Ÿäº§ç”Ÿæº¢å‡ºé”™è¯¯ã€‚æ‰€ä»¥ï¼Œæ™®é€šçš„é•¿æ–¹å½¢æ˜¯é€‚åˆè¿™æ®µä»£ç çš„ï¼Œæ­£æ–¹å½¢ä¸é€‚åˆã€‚<br>æˆ‘ä»¬å¾—å‡ºç»“è®ºï¼šåœ¨resizeæ–¹æ³•ä¸­ï¼ŒRectangleç±»å‹çš„å‚æ•°æ˜¯ä¸èƒ½è¢«Squareç±»å‹çš„å‚æ•°æ‰€ä»£æ›¿ï¼Œå¦‚æœè¿›è¡Œäº†æ›¿æ¢å°±å¾—ä¸åˆ°é¢„æœŸç»“æœã€‚å› æ­¤ï¼ŒSquareç±»å’ŒRectangleç±»ä¹‹é—´çš„ç»§æ‰¿å…³ç³»è¿åäº†é‡Œæ°ä»£æ¢åŸåˆ™ï¼Œå®ƒä»¬ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ä¸æˆç«‹ï¼Œæ­£æ–¹å½¢ä¸æ˜¯é•¿æ–¹å½¢ã€‚</p><p>å¦‚ä½•æ”¹è¿›å‘¢ï¼Ÿæ­¤æ—¶æˆ‘ä»¬éœ€è¦é‡æ–°è®¾è®¡ä»–ä»¬ä¹‹é—´çš„å…³ç³»ã€‚æŠ½è±¡å‡ºæ¥ä¸€ä¸ªå››è¾¹å½¢æ¥å£(Quadrilateral)ï¼Œè®©Rectangleç±»å’ŒSquareç±»å®ç°Quadrilateralæ¥å£</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/æ­£æ–¹å½¢ä¸æ˜¯é•¿æ–¹å½¢æ”¹è¿›.png" style="zoom:80%;" /><h2 id="3-3-ä¾èµ–å€’è½¬åŸåˆ™"><a href="#3-3-ä¾èµ–å€’è½¬åŸåˆ™" class="headerlink" title="3.3 ä¾èµ–å€’è½¬åŸåˆ™"></a>3.3 ä¾èµ–å€’è½¬åŸåˆ™</h2><p>é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ï¼›æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚ç®€å•çš„è¯´å°±æ˜¯è¦æ±‚å¯¹æŠ½è±¡è¿›è¡Œç¼–ç¨‹ï¼Œä¸è¦å¯¹å®ç°è¿›è¡Œç¼–ç¨‹ï¼Œè¿™æ ·å°±é™ä½äº†å®¢æˆ·ä¸å®ç°æ¨¡å—é—´çš„è€¦åˆã€‚</p><p>ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­æ¥ç†è§£ä¾èµ–å€’è½¬åŸåˆ™</p><p>ã€ä¾‹ã€‘ç»„è£…ç”µè„‘</p><p>ç°è¦ç»„è£…ä¸€å°ç”µè„‘ï¼Œéœ€è¦é…ä»¶cpuï¼Œç¡¬ç›˜ï¼Œå†…å­˜æ¡ã€‚åªæœ‰è¿™äº›é…ç½®éƒ½æœ‰äº†ï¼Œè®¡ç®—æœºæ‰èƒ½æ­£å¸¸çš„è¿è¡Œã€‚é€‰æ‹©cpuæœ‰å¾ˆå¤šé€‰æ‹©ï¼Œå¦‚Intelï¼ŒAMDç­‰ï¼Œç¡¬ç›˜å¯ä»¥é€‰æ‹©å¸Œæ·ï¼Œè¥¿æ•°ç­‰ï¼Œå†…å­˜æ¡å¯ä»¥é€‰æ‹©é‡‘å£«é¡¿ï¼Œæµ·ç›—èˆ¹ç­‰ã€‚</p><p><strong>ç±»å›¾å¦‚ä¸‹ï¼š</strong></p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/ä¾èµ–å€’è½¬åŸåˆ™.png" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><p><strong>å¸Œæ·ç¡¬ç›˜ç±»ï¼ˆXiJieHardDiskï¼‰:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XiJieHardDisk</span> <span class="keyword">implements</span> <span class="title">HardDisk</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(String data)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä½¿ç”¨å¸Œæ·ç¡¬ç›˜å­˜å‚¨æ•°æ®&quot;</span> + data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä½¿ç”¨å¸Œæ·å¸Œæ·ç¡¬ç›˜å–æ•°æ®&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æ•°æ®&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Intelå¤„ç†å™¨ï¼ˆIntelCpuï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IntelCpu</span> <span class="keyword">implements</span> <span class="title">Cpu</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä½¿ç”¨Intelå¤„ç†å™¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é‡‘å£«é¡¿å†…å­˜æ¡ï¼ˆKingstonMemoryï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">KingstonMemory</span> <span class="keyword">implements</span> <span class="title">Memory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä½¿ç”¨é‡‘å£«é¡¿ä½œä¸ºå†…å­˜æ¡&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç”µè„‘ï¼ˆComputerï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Computer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> XiJieHardDisk hardDisk;</span><br><span class="line">    <span class="keyword">private</span> IntelCpu cpu;</span><br><span class="line">    <span class="keyword">private</span> KingstonMemory memory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IntelCpu <span class="title">getCpu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cpu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCpu</span><span class="params">(IntelCpu cpu)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.cpu = cpu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> KingstonMemory <span class="title">getMemory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> memory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMemory</span><span class="params">(KingstonMemory memory)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.memory = memory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> XiJieHardDisk <span class="title">getHardDisk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hardDisk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHardDisk</span><span class="params">(XiJieHardDisk hardDisk)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.hardDisk = hardDisk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è®¡ç®—æœºå·¥ä½œ&quot;</span>);</span><br><span class="line">        cpu.run();</span><br><span class="line">        memory.save();</span><br><span class="line">        String data = hardDisk.get();</span><br><span class="line">        System.out.println(<span class="string">&quot;ä»ç¡¬ç›˜ä¸­è·å–çš„æ•°æ®ä¸ºï¼š&quot;</span> + data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ç±»ï¼ˆTestComputerï¼‰ï¼š</strong></p><p>æµ‹è¯•ç±»ç”¨æ¥ç»„è£…ç”µè„‘ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestComputer</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Computer computer = <span class="keyword">new</span> Computer();</span><br><span class="line">        computer.setHardDisk(<span class="keyword">new</span> XiJieHardDisk());</span><br><span class="line">        computer.setCpu(<span class="keyword">new</span> IntelCpu());</span><br><span class="line">        computer.setMemory(<span class="keyword">new</span> KingstonMemory());</span><br><span class="line"></span><br><span class="line">        computer.run();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°å·²ç»ç»„è£…äº†ä¸€å°ç”µè„‘ï¼Œä½†æ˜¯ä¼¼ä¹ç»„è£…çš„ç”µè„‘çš„cpuåªèƒ½æ˜¯Intelçš„ï¼Œå†…å­˜æ¡åªèƒ½æ˜¯é‡‘å£«é¡¿çš„ï¼Œç¡¬ç›˜åªèƒ½æ˜¯å¸Œæ·çš„ï¼Œè¿™å¯¹ç”¨æˆ·è‚¯å®šæ˜¯ä¸å‹å¥½çš„ï¼Œç”¨æˆ·æœ‰äº†æœºç®±è‚¯å®šæ˜¯æƒ³æŒ‰ç…§è‡ªå·±çš„å–œå¥½ï¼Œé€‰æ‹©è‡ªå·±å–œæ¬¢çš„é…ä»¶ã€‚</p><p>æ ¹æ®ä¾èµ–å€’è½¬åŸåˆ™è¿›è¡Œæ”¹è¿›ï¼š</p><p>ä»£ç æˆ‘ä»¬åªéœ€è¦ä¿®æ”¹Computerç±»ï¼Œè®©Computerç±»ä¾èµ–æŠ½è±¡ï¼ˆå„ä¸ªé…ä»¶çš„æ¥å£ï¼‰ï¼Œè€Œä¸æ˜¯ä¾èµ–äºå„ä¸ªç»„ä»¶å…·ä½“çš„å®ç°ç±»ã€‚</p><p><strong>ç±»å›¾å¦‚ä¸‹ï¼š</strong></p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/ä¾èµ–å€’è½¬åŸåˆ™æ”¹è¿›.png" alt="image-20191229173554296" style="zoom:70%;" /><p><strong>ç”µè„‘ï¼ˆComputerï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Computer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> HardDisk hardDisk;</span><br><span class="line">    <span class="keyword">private</span> Cpu cpu;</span><br><span class="line">    <span class="keyword">private</span> Memory memory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HardDisk <span class="title">getHardDisk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hardDisk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHardDisk</span><span class="params">(HardDisk hardDisk)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.hardDisk = hardDisk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Cpu <span class="title">getCpu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> cpu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCpu</span><span class="params">(Cpu cpu)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.cpu = cpu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memory <span class="title">getMemory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> memory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMemory</span><span class="params">(Memory memory)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.memory = memory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;è®¡ç®—æœºå·¥ä½œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¢å‘å¯¹è±¡çš„å¼€å‘å¾ˆå¥½çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æŠ½è±¡çš„å˜åŒ–æ¦‚ç‡å¾ˆå°ï¼Œè®©ç”¨æˆ·ç¨‹åºä¾èµ–äºæŠ½è±¡ï¼Œå®ç°çš„ç»†èŠ‚ä¹Ÿä¾èµ–äºæŠ½è±¡ã€‚å³ä½¿å®ç°ç»†èŠ‚ä¸æ–­å˜åŠ¨ï¼Œåªè¦æŠ½è±¡ä¸å˜ï¼Œå®¢æˆ·ç¨‹åºå°±ä¸éœ€è¦å˜åŒ–ã€‚è¿™å¤§å¤§é™ä½äº†å®¢æˆ·ç¨‹åºä¸å®ç°ç»†èŠ‚çš„è€¦åˆåº¦ã€‚</p><h2 id="3-4-æ¥å£éš”ç¦»åŸåˆ™"><a href="#3-4-æ¥å£éš”ç¦»åŸåˆ™" class="headerlink" title="3.4 æ¥å£éš”ç¦»åŸåˆ™"></a>3.4 æ¥å£éš”ç¦»åŸåˆ™</h2><p>å®¢æˆ·ç«¯ä¸åº”è¯¥è¢«è¿«ä¾èµ–äºå®ƒä¸ä½¿ç”¨çš„æ–¹æ³•ï¼›ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Šã€‚</p><p>ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­æ¥ç†è§£æ¥å£éš”ç¦»åŸåˆ™</p><p>ã€ä¾‹ã€‘å®‰å…¨é—¨æ¡ˆä¾‹</p><p>æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª<code>é»‘é©¬</code>å“ç‰Œçš„å®‰å…¨é—¨ï¼Œè¯¥å®‰å…¨é—¨å…·æœ‰é˜²ç«ã€é˜²æ°´ã€é˜²ç›—çš„åŠŸèƒ½ã€‚å¯ä»¥å°†é˜²ç«ï¼Œé˜²æ°´ï¼Œé˜²ç›—åŠŸèƒ½æå–æˆä¸€ä¸ªæ¥å£ï¼Œå½¢æˆä¸€å¥—è§„èŒƒã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%99.png"></p><p>ä¸Šé¢çš„è®¾è®¡æˆ‘ä»¬å‘ç°äº†å®ƒå­˜åœ¨çš„é—®é¢˜ï¼Œé»‘é©¬å“ç‰Œçš„å®‰å…¨é—¨å…·æœ‰é˜²ç›—ï¼Œé˜²æ°´ï¼Œé˜²ç«çš„åŠŸèƒ½ã€‚ç°åœ¨å¦‚æœæˆ‘ä»¬è¿˜éœ€è¦å†åˆ›å»ºä¸€ä¸ªä¼ æ™ºå“ç‰Œçš„å®‰å…¨é—¨ï¼Œè€Œè¯¥å®‰å…¨é—¨åªå…·æœ‰é˜²ç›—ã€é˜²æ°´åŠŸèƒ½å‘¢ï¼Ÿå¾ˆæ˜¾ç„¶å¦‚æœå®ç°SafetyDooræ¥å£å°±è¿èƒŒäº†æ¥å£éš”ç¦»åŸåˆ™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è¿›è¡Œä¿®æ”¹å‘¢ï¼Ÿçœ‹å¦‚ä¸‹ç±»å›¾ï¼š</p><p><img src="/img/java/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%991.png"></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><p><strong>AntiTheftï¼ˆæ¥å£ï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AntiTheft</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">antiTheft</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Fireproofï¼ˆæ¥å£ï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Fireproof</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fireproof</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Waterproofï¼ˆæ¥å£ï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Waterproof</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">waterproof</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>HeiMaSafetyDoorï¼ˆç±»ï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeiMaSafetyDoor</span> <span class="keyword">implements</span> <span class="title">AntiTheft</span>,<span class="title">Fireproof</span>,<span class="title">Waterproof</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">antiTheft</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é˜²ç›—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fireproof</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é˜²ç«&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">waterproof</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é˜²æ°´&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ItcastSafetyDoorï¼ˆç±»ï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ItcastSafetyDoor</span> <span class="keyword">implements</span> <span class="title">AntiTheft</span>,<span class="title">Fireproof</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">antiTheft</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é˜²ç›—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fireproof</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é˜²ç«&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-5-è¿ªç±³ç‰¹æ³•åˆ™"><a href="#3-5-è¿ªç±³ç‰¹æ³•åˆ™" class="headerlink" title="3.5 è¿ªç±³ç‰¹æ³•åˆ™"></a>3.5 è¿ªç±³ç‰¹æ³•åˆ™</h2><p>è¿ªç±³ç‰¹æ³•åˆ™åˆå«æœ€å°‘çŸ¥è¯†åŸåˆ™ã€‚</p><p>åªå’Œä½ çš„ç›´æ¥æœ‹å‹äº¤è°ˆï¼Œä¸è·Ÿâ€œé™Œç”Ÿäººâ€è¯´è¯ï¼ˆTalk only to your immediate friends and not to strangersï¼‰ã€‚</p><p>å…¶å«ä¹‰æ˜¯ï¼šå¦‚æœä¸¤ä¸ªè½¯ä»¶å®ä½“æ— é¡»ç›´æ¥é€šä¿¡ï¼Œé‚£ä¹ˆå°±ä¸åº”å½“å‘ç”Ÿç›´æ¥çš„ç›¸äº’è°ƒç”¨ï¼Œå¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹è½¬å‘è¯¥è°ƒç”¨ã€‚å…¶ç›®çš„æ˜¯é™ä½ç±»ä¹‹é—´çš„è€¦åˆåº¦ï¼Œæé«˜æ¨¡å—çš„ç›¸å¯¹ç‹¬ç«‹æ€§ã€‚</p><p>è¿ªç±³ç‰¹æ³•åˆ™ä¸­çš„â€œæœ‹å‹â€æ˜¯æŒ‡ï¼šå½“å‰å¯¹è±¡æœ¬èº«ã€å½“å‰å¯¹è±¡çš„æˆå‘˜å¯¹è±¡ã€å½“å‰å¯¹è±¡æ‰€åˆ›å»ºçš„å¯¹è±¡ã€å½“å‰å¯¹è±¡çš„æ–¹æ³•å‚æ•°ç­‰ï¼Œè¿™äº›å¯¹è±¡åŒå½“å‰å¯¹è±¡å­˜åœ¨å…³è”ã€èšåˆæˆ–ç»„åˆå…³ç³»ï¼Œå¯ä»¥ç›´æ¥è®¿é—®è¿™äº›å¯¹è±¡çš„æ–¹æ³•ã€‚</p><p>ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­æ¥ç†è§£è¿ªç±³ç‰¹æ³•åˆ™</p><p>ã€ä¾‹ã€‘æ˜æ˜Ÿä¸ç»çºªäººçš„å…³ç³»å®ä¾‹</p><p>æ˜æ˜Ÿç”±äºå…¨èº«å¿ƒæŠ•å…¥è‰ºæœ¯ï¼Œæ‰€ä»¥è®¸å¤šæ—¥å¸¸äº‹åŠ¡ç”±ç»çºªäººè´Ÿè´£å¤„ç†ï¼Œå¦‚å’Œç²‰ä¸çš„è§é¢ä¼šï¼Œå’Œåª’ä½“å…¬å¸çš„ä¸šåŠ¡æ´½æ·¡ç­‰ã€‚è¿™é‡Œçš„ç»çºªäººæ˜¯æ˜æ˜Ÿçš„æœ‹å‹ï¼Œè€Œç²‰ä¸å’Œåª’ä½“å…¬å¸æ˜¯é™Œç”Ÿäººï¼Œæ‰€ä»¥é€‚åˆä½¿ç”¨è¿ªç±³ç‰¹æ³•åˆ™ã€‚</p><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/è¿ªç±³ç‰¹æ³•åˆ™.png" alt="image-20191229173554296" style="zoom:80%;" /><p>ä»£ç å¦‚ä¸‹ï¼š</p><p><strong>æ˜æ˜Ÿç±»ï¼ˆStarï¼‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Star</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Star</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç²‰ä¸ç±»ï¼ˆFansï¼‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fans</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Fans</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>åª’ä½“å…¬å¸ç±»ï¼ˆCompanyï¼‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Company</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Company</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ç»çºªäººç±»ï¼ˆAgentï¼‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Agent</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Star star;</span><br><span class="line">    <span class="keyword">private</span> Fans fans;</span><br><span class="line">    <span class="keyword">private</span> Company company;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStar</span><span class="params">(Star star)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.star = star;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFans</span><span class="params">(Fans fans)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.fans = fans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCompany</span><span class="params">(Company company)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.company = company;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">meeting</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(fans.getName() + <span class="string">&quot;ä¸æ˜æ˜Ÿ&quot;</span> + star.getName() + <span class="string">&quot;è§é¢äº†ã€‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">business</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(company.getName() + <span class="string">&quot;ä¸æ˜æ˜Ÿ&quot;</span> + star.getName() + <span class="string">&quot;æ´½æ·¡ä¸šåŠ¡ã€‚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-6-åˆæˆå¤ç”¨åŸåˆ™"><a href="#3-6-åˆæˆå¤ç”¨åŸåˆ™" class="headerlink" title="3.6 åˆæˆå¤ç”¨åŸåˆ™"></a>3.6 åˆæˆå¤ç”¨åŸåˆ™</h2><p>åˆæˆå¤ç”¨åŸåˆ™æ˜¯æŒ‡ï¼šå°½é‡å…ˆä½¿ç”¨ç»„åˆæˆ–è€…èšåˆç­‰å…³è”å…³ç³»æ¥å®ç°ï¼Œå…¶æ¬¡æ‰è€ƒè™‘ä½¿ç”¨ç»§æ‰¿å…³ç³»æ¥å®ç°ã€‚</p><p>é€šå¸¸ç±»çš„å¤ç”¨åˆ†ä¸ºç»§æ‰¿å¤ç”¨å’Œåˆæˆå¤ç”¨ä¸¤ç§ã€‚</p><p>ç»§æ‰¿å¤ç”¨è™½ç„¶æœ‰ç®€å•å’Œæ˜“å®ç°çš„ä¼˜ç‚¹ï¼Œä½†å®ƒä¹Ÿå­˜åœ¨ä»¥ä¸‹ç¼ºç‚¹ï¼š</p><ol><li>ç»§æ‰¿å¤ç”¨ç ´åäº†ç±»çš„å°è£…æ€§ã€‚å› ä¸ºç»§æ‰¿ä¼šå°†çˆ¶ç±»çš„å®ç°ç»†èŠ‚æš´éœ²ç»™å­ç±»ï¼Œçˆ¶ç±»å¯¹å­ç±»æ˜¯é€æ˜çš„ï¼Œæ‰€ä»¥è¿™ç§å¤ç”¨åˆç§°ä¸ºâ€œç™½ç®±â€å¤ç”¨ã€‚</li><li>å­ç±»ä¸çˆ¶ç±»çš„è€¦åˆåº¦é«˜ã€‚çˆ¶ç±»çš„å®ç°çš„ä»»ä½•æ”¹å˜éƒ½ä¼šå¯¼è‡´å­ç±»çš„å®ç°å‘ç”Ÿå˜åŒ–ï¼Œè¿™ä¸åˆ©äºç±»çš„æ‰©å±•ä¸ç»´æŠ¤ã€‚</li><li>å®ƒé™åˆ¶äº†å¤ç”¨çš„çµæ´»æ€§ã€‚ä»çˆ¶ç±»ç»§æ‰¿è€Œæ¥çš„å®ç°æ˜¯é™æ€çš„ï¼Œåœ¨ç¼–è¯‘æ—¶å·²ç»å®šä¹‰ï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ—¶ä¸å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚</li></ol><p>é‡‡ç”¨ç»„åˆæˆ–èšåˆå¤ç”¨æ—¶ï¼Œå¯ä»¥å°†å·²æœ‰å¯¹è±¡çº³å…¥æ–°å¯¹è±¡ä¸­ï¼Œä½¿ä¹‹æˆä¸ºæ–°å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œæ–°å¯¹è±¡å¯ä»¥è°ƒç”¨å·²æœ‰å¯¹è±¡çš„åŠŸèƒ½ï¼Œå®ƒæœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p><ol><li>å®ƒç»´æŒäº†ç±»çš„å°è£…æ€§ã€‚å› ä¸ºæˆåˆ†å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚æ˜¯æ–°å¯¹è±¡çœ‹ä¸è§çš„ï¼Œæ‰€ä»¥è¿™ç§å¤ç”¨åˆç§°ä¸ºâ€œé»‘ç®±â€å¤ç”¨ã€‚</li><li>å¯¹è±¡é—´çš„è€¦åˆåº¦ä½ã€‚å¯ä»¥åœ¨ç±»çš„æˆå‘˜ä½ç½®å£°æ˜æŠ½è±¡ã€‚</li><li>å¤ç”¨çš„çµæ´»æ€§é«˜ã€‚è¿™ç§å¤ç”¨å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€è¿›è¡Œï¼Œæ–°å¯¹è±¡å¯ä»¥åŠ¨æ€åœ°å¼•ç”¨ä¸æˆåˆ†å¯¹è±¡ç±»å‹ç›¸åŒçš„å¯¹è±¡ã€‚</li></ol><p>ä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­æ¥ç†è§£åˆæˆå¤ç”¨åŸåˆ™</p><p>ã€ä¾‹ã€‘æ±½è½¦åˆ†ç±»ç®¡ç†ç¨‹åº</p><p>æ±½è½¦æŒ‰â€œåŠ¨åŠ›æºâ€åˆ’åˆ†å¯åˆ†ä¸ºæ±½æ²¹æ±½è½¦ã€ç”µåŠ¨æ±½è½¦ç­‰ï¼›æŒ‰â€œé¢œè‰²â€åˆ’åˆ†å¯åˆ†ä¸ºç™½è‰²æ±½è½¦ã€é»‘è‰²æ±½è½¦å’Œçº¢è‰²æ±½è½¦ç­‰ã€‚å¦‚æœåŒæ—¶è€ƒè™‘è¿™ä¸¤ç§åˆ†ç±»ï¼Œå…¶ç»„åˆå°±å¾ˆå¤šã€‚ç±»å›¾å¦‚ä¸‹ï¼š </p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/åˆæˆå¤ç”¨åŸåˆ™.png" alt="image-20191229173554296" style="zoom:80%;" /><p>ä»ä¸Šé¢ç±»å›¾æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä½¿ç”¨ç»§æ‰¿å¤ç”¨äº§ç”Ÿäº†å¾ˆå¤šå­ç±»ï¼Œå¦‚æœç°åœ¨åˆæœ‰æ–°çš„åŠ¨åŠ›æºæˆ–è€…æ–°çš„é¢œè‰²çš„è¯ï¼Œå°±éœ€è¦å†å®šä¹‰æ–°çš„ç±»ã€‚æˆ‘ä»¬è¯•ç€å°†ç»§æ‰¿å¤ç”¨æ”¹ä¸ºèšåˆå¤ç”¨çœ‹ä¸€ä¸‹ã€‚</p><img src="/img/java/javaè®¾è®¡æ¨¡å¼/åˆæˆå¤ç”¨åŸåˆ™1.png" alt="image-20191229173554296" style="zoom:80%;" />]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°&quot;&gt;&lt;/a&gt;1ï¼Œè®¾è®¡æ¨¡å¼æ¦‚è¿°&lt;/h1&gt;&lt;h2 id=&quot;1-1-è½¯ä»¶è®¾è®¡æ¨¡å¼çš„äº§ç”ŸèƒŒæ™¯&quot;&gt;&lt;a href=&quot;#1-1-è½¯ä»¶è®¾è®¡æ¨¡å¼çš„äº§ç”ŸèƒŒ</summary>
      
    
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/categories/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
    <category term="javaè®¾è®¡æ¨¡å¼" scheme="http://example.com/tags/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    <category term="è®¾è®¡æ¨¡å¼åŸåˆ™" scheme="http://example.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E5%8E%9F%E5%88%99/"/>
    
  </entry>
  
  <entry>
    <title>Yolov5ä¹‹æ— äººæœºå ¤åæ£€æµ‹</title>
    <link href="http://example.com/2022/08/20/Yolov5%E4%B9%8B%E6%97%A0%E4%BA%BA%E6%9C%BA%E5%A0%A4%E5%9D%9D%E6%A3%80%E6%B5%8B/"/>
    <id>http://example.com/2022/08/20/Yolov5%E4%B9%8B%E6%97%A0%E4%BA%BA%E6%9C%BA%E5%A0%A4%E5%9D%9D%E6%A3%80%E6%B5%8B/</id>
    <published>2022-08-20T13:42:52.000Z</published>
    <updated>2022-12-11T02:30:16.719Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-yolov5ç¯å¢ƒé…ç½®ï¼š"><a href="#1-yolov5ç¯å¢ƒé…ç½®ï¼š" class="headerlink" title="1 yolov5ç¯å¢ƒé…ç½®ï¼š"></a>1 yolov5ç¯å¢ƒé…ç½®ï¼š</h2><p>ï¼ˆå‚è€ƒæˆ‘å‰é¢çš„åšå®¢ï¼‰</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//gaominghui123.github.io/2021/10/28/%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E7%9A%84ubuntu%E9%83%A8%E7%BD%B2yolov5-5-0/</span></span><br></pre></td></tr></table></figure><h2 id="2-æ•°æ®é›†çš„åˆ¶ä½œ"><a href="#2-æ•°æ®é›†çš„åˆ¶ä½œ" class="headerlink" title="2 æ•°æ®é›†çš„åˆ¶ä½œ"></a>2 æ•°æ®é›†çš„åˆ¶ä½œ</h2><p>(é‡‡ç”¨vcatå·¥å…·ï¼Œç›´æ¥å¯ä»¥åœ¨è§†é¢‘ä¸Šè¿›è¡Œæ ‡æ³¨)ï¼ˆå‚è€ƒæˆ‘å‰é¢çš„åšå®¢ï¼‰ï¼Œ</p><p>psï¼šé…ç½®vcatæœåŠ¡èŠ±è´¹æ—¶é—´æ¯”è¾ƒé•¿ï¼Œvcatè¿™ä¸ªå·¥å…·ä¸åŒäºlabelImgï¼Œåè€…æ˜¯exeæ‰§è¡Œæ–‡ä»¶ï¼Œç›´æ¥å°±å¯ä»¥æ ‡æ³¨å›¾ç‰‡ï¼Œä½†æ˜¯vcatç±»ä¼¼äºé¢å‘æœåŠ¡ç¼–ç¨‹ï¼Œè¦å®‰è£…dockerï¼Œdockerç¼–æ’å™¨æ‹‰å–é•œåƒï¼Œè¿è¡Œå®¹å™¨ç­‰ç­‰ï¼Œæœ€åå°†vcatæœåŠ¡è·‘èµ·æ¥ï¼Œåœ¨æµè§ˆå™¨è®¿é—®ï¼Œæ ‡æ³¨ã€‚</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//gaominghui123.github.io/2022/06/08/vcat%E6%A0%87%E6%B3%A8%E5%B7%A5%E5%85%B7%E7%9A%84%E5%AE%89%E8%A3%85%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8/</span></span><br></pre></td></tr></table></figure><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/yolo/3-%E6%97%A0%E4%BA%BA%E6%9C%BA%E5%A0%A4%E5%9D%9D%E6%A3%80%E6%B5%8B-yolov5%E9%83%A8%E5%88%86/%E5%A0%A4%E5%9D%9D%E6%95%B0%E6%8D%AE%E9%9B%86%E4%B8%8Eyolov%E7%9B%AE%E5%BD%95%E5%85%B3%E7%B3%BB.png" alt="å ¤åæ•°æ®é›†ä¸yolovç›®å½•å…³ç³»"></p><h2 id="3-yolov5sè®­ç»ƒè‡ªå®šä¹‰æ•°æ®é›†æ–¹æ³•"><a href="#3-yolov5sè®­ç»ƒè‡ªå®šä¹‰æ•°æ®é›†æ–¹æ³•" class="headerlink" title="3 yolov5sè®­ç»ƒè‡ªå®šä¹‰æ•°æ®é›†æ–¹æ³•"></a>3 yolov5sè®­ç»ƒè‡ªå®šä¹‰æ•°æ®é›†æ–¹æ³•</h2><p>å‚è€ƒï¼šï¼ˆå‚è€ƒæˆ‘å‰é¢çš„åšå®¢ï¼‰</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//gaominghui123.github.io/2021/11/13/yolov5-customData/</span></span><br></pre></td></tr></table></figure><h2 id="4-æ•ˆæœ"><a href="#4-æ•ˆæœ" class="headerlink" title="4 æ•ˆæœ"></a>4 æ•ˆæœ</h2><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/yolo/3-%E6%97%A0%E4%BA%BA%E6%9C%BA%E5%A0%A4%E5%9D%9D%E6%A3%80%E6%B5%8B-yolov5%E9%83%A8%E5%88%86/frame_004750.PNG" alt="frame_004750"></p><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/yolo/3-%E6%97%A0%E4%BA%BA%E6%9C%BA%E5%A0%A4%E5%9D%9D%E6%A3%80%E6%B5%8B-yolov5%E9%83%A8%E5%88%86/frame_004375.PNG" alt="frame_004375"></p><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/yolo/3-%E6%97%A0%E4%BA%BA%E6%9C%BA%E5%A0%A4%E5%9D%9D%E6%A3%80%E6%B5%8B-yolov5%E9%83%A8%E5%88%86/frame_004650.PNG" alt="frame_004650"></p><p>å¯ä»¥çœ‹åˆ°æ•ˆæœå¹¶ä¸ç®—å¾ˆå¥½ï¼ŒåŸå› ä¸»è¦æ˜¯æ•°æ®é›†å¤ªå°‘äº†ï¼Œåˆ«äººè®­ç»ƒä¸€ä¸ªæ¨¡å‹éœ€è¦å‡ ä¸ªGçš„æ•°æ®é›†ï¼Œæˆ‘è¿™åªæœ‰å‡ åå…†</p><p>è§£å†³æ–¹æ³•ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1</span> <span class="string">æ•°æ®å¢å¼ºï¼Œç½‘ä¸Šæ‰¾æ–¹æ³•ï¼Œæ¥ä¸‹æ¥çš„å·¥ä½œ</span></span><br><span class="line"><span class="attr">2</span> <span class="string">æƒ³åŠæ³•æ‹æ›´å¤šçš„è§†é¢‘ï¼Œç»§ç»­æ ‡æ³¨ï¼Œæ„å»ºæ›´åŠ åºå¤§çš„æ•°æ®é›†</span></span><br><span class="line"><span class="attr">3</span> <span class="string">æ‹å‡ºæ¥çš„å‡ ä¹æ˜¯æ­£å¸¸çš„å ¤åï¼Œæ ‡æ³¨æ—¶å‡ ä¹æ²¡æœ‰å‡ å¼ å›¾æ˜¯å¯ä»¥ä½œä¸ºæœ‰é—®é¢˜çš„å ¤åæ ‡ç­¾</span></span><br><span class="line"><span class="attr">4</span> <span class="string">é™¤äº†æ‹å¤šä¸€ç‚¹ç…§ç‰‡ï¼Œè¿˜éœ€è¦ä¸åŒç±»å‹çš„å ¤åç…§ç‰‡</span></span><br><span class="line"><span class="attr">5</span> <span class="string">æœ‰äº†ä¸åŒç±»å‹å ¤åçš„ç…§ç‰‡ï¼Œè®­ç»ƒæ—¶æ³¨æ„è¦å…ˆæ‰“ä¹±æ•°æ®é›†çš„é¡ºåºï¼Œæœ‰åŠ©äºæ›´å¥½çš„æ”¶æ•›</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-yolov5ç¯å¢ƒé…ç½®ï¼š&quot;&gt;&lt;a href=&quot;#1-yolov5ç¯å¢ƒé…ç½®ï¼š&quot; class=&quot;headerlink&quot; title=&quot;1 yolov5ç¯å¢ƒé…ç½®ï¼š&quot;&gt;&lt;/a&gt;1 yolov5ç¯å¢ƒé…ç½®ï¼š&lt;/h2&gt;&lt;p&gt;ï¼ˆå‚è€ƒæˆ‘å‰é¢çš„åšå®¢ï¼‰&lt;/p&gt;
&lt;figure cla</summary>
      
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="http://example.com/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="yolov5" scheme="http://example.com/tags/yolov5/"/>
    
    <category term="è‡ªå®šä¹‰æ•°æ®æ¨¡å‹" scheme="http://example.com/tags/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B/"/>
    
  </entry>
  
  <entry>
    <title>Vcatæ ‡æ³¨å·¥å…·çš„å®‰è£…å’Œä½¿ç”¨</title>
    <link href="http://example.com/2022/08/19/Vcat%E6%A0%87%E6%B3%A8%E5%B7%A5%E5%85%B7%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/"/>
    <id>http://example.com/2022/08/19/Vcat%E6%A0%87%E6%B3%A8%E5%B7%A5%E5%85%B7%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/</id>
    <published>2022-08-19T13:46:33.000Z</published>
    <updated>2022-12-11T02:30:16.348Z</updated>
    
    <content type="html"><![CDATA[<p>å‰é¢ç”¨yolov5è®­ç»ƒè‡ªå®šä¹‰çš„æ•°æ®é›†ï¼ˆç—…è™«å®³è¯†åˆ«ï¼‰çš„æ—¶å€™ï¼Œç”¨çš„æ˜¯labellmgè¿™æ¬¾è½¯ä»¶ï¼Œä½†æ˜¯è¿™æ¬¾è½¯ä»¶ä¸èƒ½å¤„ç†è§†é¢‘çš„æ ‡æ³¨ï¼Œæœ€è¿‘å¼ è€å¸ˆè¦æˆ‘ææ— äººæœºå ¤åæ£€æµ‹é¡¹ç›®ï¼Œå› æ­¤ä»Šå¤©å°±æ¥å†™å†™åœ¨è§†é¢‘ä¸Šè¿›è¡Œæ ‡æ³¨ï¼Œåˆ¶ä½œæ•°æ®é›†æ›´é«˜çº§ä¸€ç‚¹çš„æ ‡æ³¨å·¥å…·ï¼švcatã€‚è¯ä¸å¤šè¯´ï¼Œèµ¶ç´§ä¸Šè½¦ï¼</p><h1 id="1-Ubuntu-18-04ä¸Šå®‰è£…vcat"><a href="#1-Ubuntu-18-04ä¸Šå®‰è£…vcat" class="headerlink" title="1 Ubuntu 18.04ä¸Šå®‰è£…vcat"></a>1 Ubuntu 18.04ä¸Šå®‰è£…vcat</h1><p>å‚è€ƒæ•™ç¨‹ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//openvinotoolkit.github.io/cvat/docs/administration/basics/installation/</span></span><br></pre></td></tr></table></figure><h2 id="1-å®‰è£…docker"><a href="#1-å®‰è£…docker" class="headerlink" title="1 å®‰è£…docker"></a>1 å®‰è£…docker</h2><p>åˆ†åˆ«æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sudo</span> <span class="string">apt-get update</span></span><br><span class="line"></span><br><span class="line"><span class="attr">sudo</span> <span class="string">apt-get --no-install-recommends install -y \</span></span><br><span class="line"><span class="string">  apt-transport-https \</span></span><br><span class="line"><span class="string">  ca-certificates \</span></span><br><span class="line"><span class="string">  curl \</span></span><br><span class="line"><span class="string">  gnupg-agent \</span></span><br><span class="line"><span class="string">  software-properties-common</span></span><br><span class="line">  </span><br><span class="line"><span class="attr">curl</span> <span class="string">-fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span></span><br><span class="line"></span><br><span class="line"><span class="attr">sudo</span> <span class="string">add-apt-repository \</span></span><br><span class="line"><span class="string">  &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \</span></span><br><span class="line"><span class="string">  $(lsb_release -cs) \</span></span><br><span class="line"><span class="string">  stable&quot;</span></span><br><span class="line">  </span><br><span class="line"><span class="attr">sudo</span> <span class="string">apt-get update</span></span><br><span class="line"></span><br><span class="line"><span class="attr">sudo</span> <span class="string">apt-get --no-install-recommends install -y docker-ce docker-ce-cli containerd.io</span></span><br></pre></td></tr></table></figure><p>åˆ†ç»„ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo groupadd docker</span><br><span class="line">sudo usermod -aG docker $USER</span><br></pre></td></tr></table></figure><p>æ³¨é”€å¹¶é‡æ–°ç™»å½•ï¼ˆæˆ–é‡æ–°å¯åŠ¨ï¼‰ï¼Œä»¥ä¾¿é‡æ–°è¯„ä¼°æ‚¨çš„ç»„æˆå‘˜èº«ä»½ã€‚ä¹‹åï¼Œæ‚¨å¯ä»¥åœ¨ç»ˆç«¯çª—å£ä¸­é”®å…¥<code>groups</code>å‘½ä»¤å¹¶æ£€æŸ¥<code>docker</code>ç»„æ˜¯å¦åœ¨å…¶è¾“å‡ºä¸­ã€‚</p><h2 id="2-å®‰è£…-docker-composeï¼ˆ1-19-0-æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰"><a href="#2-å®‰è£…-docker-composeï¼ˆ1-19-0-æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰" class="headerlink" title="2 å®‰è£… docker-composeï¼ˆ1.19.0 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰"></a>2 å®‰è£… docker-composeï¼ˆ1.19.0 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰</h2><p>Compose æ˜¯ä¸€ä¸ªç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ docker åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get --no-install-recommends install -y python3-pip python3-setuptools</span><br><span class="line">sudo python3 -m pip install setuptools docker-compose</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jason@jason-virtual-machine:~$ pwd</span><br><span class="line">/home/jason</span><br></pre></td></tr></table></figure><h2 id="3-å…‹éš†cvatæºä»£ç "><a href="#3-å…‹éš†cvatæºä»£ç " class="headerlink" title="3 å…‹éš†cvatæºä»£ç "></a>3 å…‹éš†cvatæºä»£ç </h2><p>åœ¨/home/jasonä¸‹ï¼Œä» <a href="https://github.com/opencv/cvat">GitHub å­˜å‚¨</a><em>åº“å…‹éš† CVAT</em>æºä»£ç ã€‚</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sudo</span> <span class="string">apt-get --no-install-recommends install -y git</span></span><br><span class="line"><span class="attr">git</span> <span class="string">clone https://github.com/opencv/cvat</span></span><br><span class="line"><span class="attr">cd</span> <span class="string">cvat</span></span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢ç¬¬äºŒæ­¥å…‹éš†æ—¶å‘ç”Ÿå¦‚ä¸‹é”™è¯¯,æŠ˜è…¾äº†ä¸€ä¸‹ï¼Œå‘ç°è¿˜æ˜¯æ²¡è§£å†³ï¼Œå°±ä¸æŠ˜è…¾äº†ï¼Œç›´æ¥ä½¿ç”¨æ‰‹åŠ¨ä¸‹è½½zipï¼Œç„¶åè§£å‹ç¼©åˆ°å½“å‰ç›®å½•çš„cvatç›®å½•ä¸‹ï¼</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Failed</span> <span class="string">to connect to github.com port 443: æ‹’ç»è¿æ¥</span></span><br></pre></td></tr></table></figure><p>è¦é€šè¿‡ç½‘ç»œæˆ–é€šè¿‡å…¶ä»–ç³»ç»Ÿè®¿é—® CVATï¼Œè¯·å¯¼å‡º<code>CVAT_HOST</code>ç¯å¢ƒå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> CVAT_HOST=your-ip-address</span><br><span class="line">å¦‚ï¼š</span><br><span class="line"><span class="built_in">export</span> CVAT_HOST=192.168.1.138</span><br></pre></td></tr></table></figure><h2 id="4-è¿è¡Œ-docker-å®¹å™¨ã€‚"><a href="#4-è¿è¡Œ-docker-å®¹å™¨ã€‚" class="headerlink" title="4 è¿è¡Œ docker å®¹å™¨ã€‚"></a>4 è¿è¡Œ docker å®¹å™¨ã€‚</h2><p>å‰é¢ä¸‹è½½äº†dockerï¼Œè¿˜ä¸‹è½½å®‰è£…äº†docker-compose(å®¹å™¨ç¼–æ’)ï¼Œè¿™é‡Œå°±è¦åˆ©ç”¨å®¹å™¨ç¼–æ’æ¥ä¸‹è½½å¹¶ä¸”è¿è¡Œvcatæ‰€éœ€è¦çš„é•œåƒå•¦ï¼šä» DockerHub ä¸‹è½½æœ€æ–°çš„ CVAT ç‰ˆæœ¬å’Œå…¶ä»–æ‰€éœ€çš„é•œåƒï¼ˆå¦‚ postgresã€redis ç­‰ï¼‰å¹¶åˆ›å»ºå®¹å™¨éœ€è¦ä¸€äº›æ—¶é—´ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯å¥½å¥‡æ€ªï¼Œå‘ç”Ÿå¦‚ä¸‹æŠ¥é”™ï¼Œæç¤ºdocker-compose å‘½ä»¤æ‰¾ä¸åˆ°ï¼Œå‘½åä¸Šé¢å·²ç»å®‰è£…äº†docker-composeäº†</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">jason@jason-virtual-machine</span>:<span class="string">~/cvat$ docker-compose up -d</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Command</span> <span class="string">&#x27;docker-compose&#x27; not found, but can be installed with:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">sudo</span> <span class="string">snap install docker          # version 20.10.14, or</span></span><br><span class="line"><span class="attr">sudo</span> <span class="string">apt  install docker-compose</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œsudo snap install dockerä¹‹åå†å»æ‰§è¡Œdocker-compose up -då‘½ä»¤ï¼Œå°±å¯ä»¥å°†cvatç›¸å…³é•œåƒå®¹å™¨æ‹‰å–å¹¶ä¸”è¿è¡Œèµ·æ¥</p><p>æ‹‰å–å¹¶è¿è¡ŒæˆåŠŸï¼Œæ‰§è¡Œ docker ps å‘½ä»¤å¯ä»¥çœ‹åˆ°æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼š</p><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/cvat/image-20220608151329919.png" alt="image-20220608151329919"></p><p>æ³¨æ„ï¼Œè¿™éœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´ï¼Œå› ä¸ºæ‹‰å–çš„å‡ ä¸ªé•œåƒéƒ½å¾ˆå¤§ï¼Œè¶…1ä¸ªGçš„é•œåƒå¤§å°ï¼</p><h2 id="5-åˆ›å»ºä¸€ä¸ªè¶…çº§ç”¨æˆ·"><a href="#5-åˆ›å»ºä¸€ä¸ªè¶…çº§ç”¨æˆ·" class="headerlink" title="5 åˆ›å»ºä¸€ä¸ªè¶…çº§ç”¨æˆ·"></a>5 åˆ›å»ºä¸€ä¸ªè¶…çº§ç”¨æˆ·</h2><p>è¶…çº§ç”¨æˆ·å¯ä»¥ä½¿ç”¨ç®¡ç†é¢æ¿ä¸ºç”¨æˆ·åˆ†é…æ­£ç¡®çš„ç»„ã€‚è¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it cvat bash -ic &#x27;python3 ~/manage.py createsuperuser&#x27;</span><br></pre></td></tr></table></figure><p>éœ€è¦è¾“å…¥è¶…çº§ç”¨æˆ·çš„ç”¨æˆ·åä»¥åŠé‚®ç®±ï¼Œç”¨æˆ·å¯†ç ã€‚é‚®ç®±è¾“å…¥è‡ªå·±çš„qqé‚®ç®±å°±å¥½ã€‚ç”¨æˆ·åè·Ÿå¯†ç éƒ½æ˜¯è‡ªå·±å®šçš„ï¼Œæ¯”å¦‚adminï¼Œrootåˆ†åˆ«æ˜¯æˆ‘çš„ç”¨æˆ·åè·Ÿå¯†ç ã€‚</p><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/cvat/image-20220608152304339.png" alt="image-20220608152304339"></p><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œå·²ç»å°†cvatå®‰è£…è¿è¡Œèµ·æ¥äº†</p><h2 id="6-è®¿é—®vcatæœåŠ¡"><a href="#6-è®¿é—®vcatæœåŠ¡" class="headerlink" title="6 è®¿é—®vcatæœåŠ¡"></a>6 è®¿é—®vcatæœåŠ¡</h2><p>vcatæœåŠ¡åªæ”¯æŒè°·æ­Œæµè§ˆå™¨è®¿é—®ï¼Œå› æ­¤éœ€è¦å®‰è£…è°·æ­Œæµè§ˆå™¨ï¼Œå½“ç„¶ï¼Œç”±äºä¸Šé¢å·²ç»æ‰§è¡Œäº†å‘½ä»¤ï¼šexport CVAT_HOST=your-ip-addressï¼Œå› æ­¤ï¼Œåœ¨ubuntuå®¿ä¸»æœºçš„windowsç³»ç»Ÿä¸Šçš„è°·æ­Œæµè§ˆå™¨ä¹Ÿèƒ½è®¿é—®ubuntuçš„cvatæœåŠ¡ã€‚åˆšå¼€å§‹æµè§ˆå™¨è®¿é—®ï¼š<a href="http://192.168.1.138:8080/%EF%BC%8C%E4%BC%9A%E6%8F%90%E7%A4%BA%E4%BD%A0%E8%BF%9B%E8%A1%8C%E7%99%BB%E5%BD%95%EF%BC%8C%E7%94%A8%E4%B8%8A%E9%9D%A2%E9%85%8D%E7%BD%AE%E7%9A%84%E8%B6%85%E7%BA%A7%E7%94%A8%E6%88%B7%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D%E8%B7%9F%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%E5%B0%B1%E5%A5%BD%E5%95%A6%E3%80%82">http://192.168.1.138:8080/ï¼Œä¼šæç¤ºä½ è¿›è¡Œç™»å½•ï¼Œç”¨ä¸Šé¢é…ç½®çš„è¶…çº§ç”¨æˆ·çš„ç”¨æˆ·åè·Ÿå¯†ç ç™»å½•å°±å¥½å•¦ã€‚</a></p><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/cvat/image-20220608155602684.png" alt="image-20220608155602684"></p><p>ç™»å½•æˆåŠŸåæ˜¾ç¤ºå¦‚ä¸‹é¡µé¢</p><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/cvat/image-20220608152905908.png" alt="image-20220608152905908"></p><p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ubuntuä¸Šå®‰è£…è°·æ­Œæµè§ˆå™¨ï¼Œç›´æ¥åœ¨ubuntuè°·æ­Œæµè§ˆå™¨è¾“å…¥ï¼š<a href="http://127.0.0.1:8080/%E6%9D%A5%E8%AE%BF%E9%97%AEvcat%E6%9C%8D%E5%8A%A1%E3%80%82">http://127.0.0.1:8080/æ¥è®¿é—®vcatæœåŠ¡ã€‚</a></p><p>å®‰è£…æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb</span><br><span class="line"></span><br><span class="line">sudo apt-get -f install</span><br><span class="line"></span><br><span class="line">sudo dpkg -i google-chrome-stable_current_amd64.deb</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œåå°±å¯ä»¥åœ¨åº”ç”¨ä¸­æ‰¾åˆ°,æ‰“å¼€è°·æ­Œæµè§ˆå™¨ï¼Œå°†å…¶æ·»åŠ åˆ°æ”¶è—å¤¹å°±å¥½å•¦ã€‚</p><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/cvat/image-20220608155111313.png" alt="image-20220608155111313"></p><h1 id="2-vcatæœåŠ¡æ ‡æ³¨å·¥å…·çš„ä½¿ç”¨"><a href="#2-vcatæœåŠ¡æ ‡æ³¨å·¥å…·çš„ä½¿ç”¨" class="headerlink" title="2 vcatæœåŠ¡æ ‡æ³¨å·¥å…·çš„ä½¿ç”¨"></a>2 vcatæœåŠ¡æ ‡æ³¨å·¥å…·çš„ä½¿ç”¨</h1><p>å‚è€ƒï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//blog.csdn.net/ZHUO__zhuo/article/details/125068660</span></span><br></pre></td></tr></table></figure><p>æ€»ç»“æ­¥éª¤ä¸ºï¼š</p><h2 id="1-å¼€å¯cvatæœåŠ¡"><a href="#1-å¼€å¯cvatæœåŠ¡" class="headerlink" title="1 å¼€å¯cvatæœåŠ¡"></a>1 å¼€å¯cvatæœåŠ¡</h2><p>ubuntuä¸Šå¼€å¯cvatæœåŠ¡ï¼Œç„¶åwindowsç™»å½•è¿›å…¥cvatæœåŠ¡ï¼Œç„¶åæ–°å»ºä»»åŠ¡</p><h2 id="2-å¯¹æ–°ä»»åŠ¡è¿›è¡Œè®¾ç½®"><a href="#2-å¯¹æ–°ä»»åŠ¡è¿›è¡Œè®¾ç½®" class="headerlink" title="2 å¯¹æ–°ä»»åŠ¡è¿›è¡Œè®¾ç½®"></a>2 å¯¹æ–°ä»»åŠ¡è¿›è¡Œè®¾ç½®</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1</span> <span class="string">ä»»åŠ¡åï¼Œ</span></span><br><span class="line"><span class="attr">2</span> <span class="string">å·¥ç¨‹åï¼Œ</span></span><br><span class="line"><span class="attr">3</span> <span class="string">æ·»åŠ æ ‡ç­¾</span></span><br><span class="line"><span class="attr">4</span> <span class="string">é€‰æ‹©æ ‡æ³¨æ•°æ®æºï¼ˆæˆ‘è¿™é‡Œæ˜¯ç›´æ¥æ‹–æ‹½windowsä¸Šçš„è§†é¢‘åˆ°æµè§ˆå™¨ä¸­ï¼‰</span></span><br><span class="line"><span class="attr">5</span> <span class="string">é«˜çº§é…ç½®ï¼Œæˆ‘è¿™é‡Œé«˜çº§é…ç½®åªè®¾ç½®äº†æ¯éš”25å¸§æ ‡æ³¨ä¸€æ¬¡ï¼Œèµ·å§‹å¸§</span></span><br><span class="line"><span class="attr">ç„¶åç‚¹å‡»submitï¼Œä»»åŠ¡å°±åˆ›å»ºæˆåŠŸäº†ã€‚</span></span><br></pre></td></tr></table></figure><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/cvat/image-20220608170856792.png" alt="image-20220608170856792"></p><h2 id="3-æ ‡æ³¨"><a href="#3-æ ‡æ³¨" class="headerlink" title="3 æ ‡æ³¨"></a>3 æ ‡æ³¨</h2><p>ç‚¹å‡»ç›¸åº”Jobå°±å¯ä»¥è¿›è¡Œæ ‡æ³¨äº†</p><p>æ ‡æ³¨æ—¶ç‚¹å‡»å·¦ä¾§æ ï¼Œå¦‚ä¸‹å›¾ï¼Œç‚¹å‡»shapeå°±å¯ä»¥åœ¨å›¾ä¸­è¿›è¡Œæ ‡æ³¨äº†ï¼Œç„¶åå¯ä»¥é€‰æ‹©æ ‡ç­¾ç±»å‹ï¼Œä¸Šä¸‹å¸§åˆ‡æ¢ç­‰ï¼Œæœ€å¥½æ¯ç”»ä¸€ä¸ªæ¡†éƒ½ä¿å­˜ä¸€æ¬¡ã€‚</p><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/cvat/image-20220608220759657.png" alt="image-20220608220759657"></p><p>å¸¸ç”¨çš„å¿«æ·é”®ï¼ŒåŠ å¿«æ ‡æ³¨é€Ÿåº¦ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">ä¿å­˜ï¼š</span> <span class="string">Ctrl + S</span></span><br><span class="line"><span class="meta">åˆ é™¤ï¼š</span> <span class="string">Delete</span></span><br><span class="line"><span class="attr">ç¼©æ”¾ï¼šé¼ æ ‡æ»šè½´ï¼Œå¾€ä¸Šæ”¾å¤§ï¼Œå‘ä¸‹ç¼©å°</span></span><br><span class="line"><span class="attr">æ‹–åŠ¨ï¼šé¼ æ ‡å·¦é”®ç‚¹å‡»å¹¶æ‹–åŠ¨å›¾ç‰‡ï¼Œè°ƒæ•´ä½ç½®</span></span><br><span class="line"><span class="attr">ä¸‹ä¸€å¸§ï¼šF</span></span><br><span class="line"><span class="attr">ä¸Šä¸€å¸§ï¼šD</span></span><br><span class="line"><span class="meta">å‘åè·³åå¼ </span>: <span class="string">Shift+Ctrl + V</span></span><br><span class="line"><span class="meta">å‘å‰è·³åå¼ </span>: <span class="string">Shift+Ctrl + C</span></span><br><span class="line"><span class="meta">å¤åˆ¶æ¡†ï¼šCtrl</span> <span class="string">+ C</span></span><br><span class="line"><span class="meta">ç²˜è´´æ¡†ï¼šCtrl</span> <span class="string">+ V</span></span><br><span class="line"><span class="attr">é‡å¤ä¸Šä¸€æ¬¡æ ‡æ³¨æ¡†å‚æ•°ï¼šNï¼Œæ¯”å¦‚è¿ç»­æ ‡ä¸€ç±»å¤´æ¡†ï¼Œé‚£ä¹ˆæ¯æ¬¡é‡å¤æ ‡æ—¶æŒ‰Nå¯ä»¥ç›´æ¥æ ‡ä¸‹ä¸€ä¸ªå¤´æ¡†</span></span><br><span class="line"><span class="meta">å¯¹é€‰å®šå¯¹è±¡è¿ç»­æ ‡æ³¨æ¥ä¸‹æ¥æ‰€æœ‰å¸§å†…æ­¤å¯¹è±¡ï¼šCtrl</span> <span class="string">+ B</span></span><br><span class="line"><span class="attr">è½¬æ¢æ ‡ç­¾ï¼šCtrl+(0..9)</span></span><br></pre></td></tr></table></figure><h2 id="4-å¯¼å‡ºï¼š"><a href="#4-å¯¼å‡ºï¼š" class="headerlink" title="4 å¯¼å‡ºï¼š"></a>4 å¯¼å‡ºï¼š</h2><p>å¯¼å‡ºæ—¶é€‰æ‹©ç›¸åº”ç±»å‹ï¼Œç„¶åä¸‹è½½ä¸ºzipæ–‡ä»¶ã€‚</p><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/cvat/image-20220608222913963.png" alt="image-20220608222913963"></p><p>å¦‚ä¸‹å›¾ï¼Œé€‰æ‹©yolo 1.1 ç±»å‹ï¼Œä¸‹è½½çš„æ–‡ä»¶å°±æ˜¯pngçš„å›¾ç‰‡è·Ÿtxtæ ‡æ³¨æ–‡ä»¶ã€‚</p><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/cvat/image-20220608222930991.png" alt="image-20220608222930991"></p><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/cvat/1654745537(1).jpg" alt="1654745537(/img/æ·±åº¦å­¦ä¹ /cvat/1654745537(1).jpg)"></p><p><img src="/img/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/cvat/image-20220608223240874.png" alt="image-20220608223240874"></p><h2 id="5-æ³¨æ„ï¼š"><a href="#5-æ³¨æ„ï¼š" class="headerlink" title="5  æ³¨æ„ï¼š"></a>5  æ³¨æ„ï¼š</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1</span> <span class="string">å¯¼å‡ºæ–‡ä»¶ä¸­ï¼Œæ–‡ä»¶åå°±æ˜¯åŸè§†é¢‘çš„ç¬¬å‡ å¸§ï¼Œè€Œç½‘ç«™ä¸­çš„å½“å‰å¸§å°±æ˜¯æå–åçš„å¸§çš„ç¬¬å‡ å¸§ã€‚</span></span><br><span class="line"><span class="attr">2</span> <span class="string">æˆ‘ä»¬åœ¨åˆ›å»ºä»»åŠ¡æ—¶ï¼Œè®¾ç½®çš„éš”å‡ å¸§æ ‡æ³¨ä¸€æ¬¡ï¼Œè¿™ä¸ªæŒºé‡è¦ï¼Œå¦‚æœè®¾ç½®çš„å¤ªä½ï¼Œé‚£ä¹ˆå¾ˆå¤šå›¾ç‰‡å‡ ä¹éƒ½æ˜¯ä¸€æ ·çš„</span></span><br><span class="line"><span class="attr">è®¾ç½®çš„å¤ªé«˜ï¼Œé‚£ä¹ˆåˆå®¹æ˜“é”™è¿‡ä¸€äº›æ•°æ®é›†ï¼Œå› æ­¤çœ‹åŸè§†é¢‘æœ¬èº«çš„ç”»é¢åˆ‡æ¢é€Ÿåº¦è€Œå®šå§</span></span><br><span class="line"><span class="attr">3</span> <span class="string">ä¿å­˜æ—¶ï¼Œä¼šå°†æ‰€æœ‰çš„å¸§éƒ½ä¿å­˜ä¸‹æ¥ï¼Œå°±ç®—æ²¡æœ‰è¿›è¡Œæ–¹æ¡†æ ‡æ³¨çš„å¸§ä¹Ÿä¼šä¿å­˜ä¸‹æ¥ï¼ˆå›¾ç‰‡+txtæ ‡æ³¨æ–‡ä»¶ï¼‰</span></span><br><span class="line"><span class="attr">å¦‚æœåŸè§†é¢‘æ‹æ‘„çš„æ¯”è¾ƒå¤šé¢å¤–å†…å®¹çš„è¯ï¼Œä¿å­˜ä¸‹æ¥çš„æ•°æ®é›†å¯èƒ½ä¼šæ¯”è¾ƒæ‚ï¼Œè¿™ç‚¹è¦æ³¨æ„</span></span><br><span class="line"><span class="attr">ç¡®å®æ¯”è¾ƒæ‚æ—¶æœ€åæ ‡æ³¨æ—¶è®°ä¸‹æ¥æ ‡æ³¨è¿‡çš„å¸§æ˜¯ç¬¬å‡ å¸§ï¼Œç›´æ¥åœ¨å¯¼å‡ºä¿å­˜çš„æ–‡ä»¶ä¸­ï¼Œå°†æˆ‘ä»¬æ ‡æ³¨è¿‡çš„æ•°æ®é›†æå–å‡ºæ¥</span></span><br><span class="line"><span class="attr">è¿™æ ·å­çš„æ•°æ®é›†æ‰æ¯”è¾ƒçº¯å‡€ã€‚</span></span><br><span class="line"><span class="attr">4</span> <span class="string">ç½‘ä¸Šè¿˜çœ‹åˆ°ä¸€äº›æ•°æ®å¢å¼ºæ–¹å¼ï¼Œå°†å¯¼å‡ºä¸‹è½½çš„æ•°æ®é›†å†æ¬¡è¿›è¡Œå¢å¼ºï¼Œèƒ½å¤šå‡ºå…­å€çš„æ•°æ®é›†ï¼Œè¿™é‡Œè¯»è€…å¯ä»¥è‡ªè¡Œæµ‹è¯•ä¸€ä¸‹</span></span><br><span class="line"><span class="attr">5</span> <span class="string">å°†æ ‡æ³¨è¿‡çš„æ•°æ®é›†å†æ¬¡å€’è¿›æ¥ï¼Œå†æ¬¡ç»§ç»­æ ‡æ³¨ï¼Œå®Œå–„æŸäº›å¸§çš„æ ‡æ³¨ï¼Œè¿™é‡Œä¹Ÿè¯·è¯»è€…è‡ªå·±è‡ªè¡Œæµ‹è¯•å§ã€‚</span></span><br></pre></td></tr></table></figure><h2 id="æ¨èé˜…è¯»ï¼š"><a href="#æ¨èé˜…è¯»ï¼š" class="headerlink" title="æ¨èé˜…è¯»ï¼š"></a>æ¨èé˜…è¯»ï¼š</h2><p>yolov5+vcatæ ‡æ³¨å·¥å…·ç»“åˆæ¥è®­ç»ƒè‡ªå®šä¹‰æ•°æ®æ•™ç¨‹ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//blog.51cto.com/u_13565704/5136654</span></span><br></pre></td></tr></table></figure><p>å¸¸ç”¨æ•°æ®æ ‡æ³¨å·¥å…·ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//baijiahao.baidu.com/s?id=1727327620467031481&amp;wfr=spider&amp;for=pc</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å‰é¢ç”¨yolov5è®­ç»ƒè‡ªå®šä¹‰çš„æ•°æ®é›†ï¼ˆç—…è™«å®³è¯†åˆ«ï¼‰çš„æ—¶å€™ï¼Œç”¨çš„æ˜¯labellmgè¿™æ¬¾è½¯ä»¶ï¼Œä½†æ˜¯è¿™æ¬¾è½¯ä»¶ä¸èƒ½å¤„ç†è§†é¢‘çš„æ ‡æ³¨ï¼Œæœ€è¿‘å¼ è€å¸ˆè¦æˆ‘ææ— äººæœºå ¤åæ£€æµ‹é¡¹ç›®ï¼Œå› æ­¤ä»Šå¤©å°±æ¥å†™å†™åœ¨è§†é¢‘ä¸Šè¿›è¡Œæ ‡æ³¨ï¼Œåˆ¶ä½œæ•°æ®é›†æ›´é«˜çº§ä¸€ç‚¹çš„æ ‡æ³¨å·¥å…·ï¼švcatã€‚è¯ä¸å¤šè¯´ï¼Œèµ¶ç´§ä¸Šè½¦ï¼&lt;/p&gt;
&lt;h1 i</summary>
      
    
    
    
    <category term="æ·±åº¦å­¦ä¹ " scheme="http://example.com/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="vcat" scheme="http://example.com/tags/vcat/"/>
    
  </entry>
  
  <entry>
    <title>windowsä¸­å®‰è£…å¤šä¸ªnodejs</title>
    <link href="http://example.com/2022/08/19/windows%E4%B8%AD%E5%AE%89%E8%A3%85%E5%A4%9A%E4%B8%AAnodejs/"/>
    <id>http://example.com/2022/08/19/windows%E4%B8%AD%E5%AE%89%E8%A3%85%E5%A4%9A%E4%B8%AAnodejs/</id>
    <published>2022-08-19T13:38:16.000Z</published>
    <updated>2022-12-11T02:30:16.646Z</updated>
    
    <content type="html"><![CDATA[<p>æelasticsearch éœ€è¦ç”¨åˆ°kibana çš„å¯è§†åŒ–æ“ä½œï¼Œä½†æ˜¯éœ€è¦ä¸‹è½½å¯¹åº”çš„nodejsç‰ˆæœ¬ï¼Œä½†åŸæ¥ç”¨ä½œhexoåšå®¢çš„nodejsä¹Ÿéœ€è¦ç»´æŠ¤ä¸€ä¸ªnodejsç‰ˆæœ¬ï¼Œå› æ­¤ä½¿ç”¨nvmæ¥åŒæ—¶å®‰è£…å¹¶ä¸”éšæ„åˆ‡æ¢nodejsç‰ˆæœ¬ï¼</p><h3 id="1-ä¸‹è½½nvm"><a href="#1-ä¸‹è½½nvm" class="headerlink" title="1.ä¸‹è½½nvm"></a>1.ä¸‹è½½nvm</h3><p>ä¸‹è½½åœ°å€ï¼šï¼ˆé€‰æ‹©ä¸‹è½½<a href="https://github.com/coreybutler/nvm-windows/releases/download/1.1.9/nvm-setup.exe">nvm-setup.exe</a>ï¼‰</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//github.com/coreybutler/nvm-windows/releases</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šå®‰è£…å‰ï¼Œè¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œå¦‚æœä»¥å‰å®‰è£…è¿‡nodeï¼Œéœ€è¦å…ˆå¸è½½(å¸è½½æ–¹æ³•å°±æ˜¯åƒæ™®é€šè½¯ä»¶é‚£æ ·å¸è½½å°±å¥½å•¦ï¼‰ï¼Œå¹¶ä¸”è¦æŠŠç›®å½•æ¸…ç†å¹²å‡€åˆ é™¤ä¸‹é¢2ä¸ªæ–‡ä»¶å¤¹ï¼šC:\Program Files\nodejså’Œ C:\Users\AppData\Roaming\npm</p><h3 id="2-nvmå®‰è£…ç›®å½•"><a href="#2-nvmå®‰è£…ç›®å½•" class="headerlink" title="2 nvmå®‰è£…ç›®å½•"></a>2 nvmå®‰è£…ç›®å½•</h3><p><img src="https://img-blog.csdnimg.cn/20210317172150617.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgxNjMwOQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="3-nodejs-å®‰è£…ç›®å½•"><a href="#3-nodejs-å®‰è£…ç›®å½•" class="headerlink" title="3 nodejs å®‰è£…ç›®å½•"></a>3 nodejs å®‰è£…ç›®å½•</h3><p>ï¼ˆåˆ©ç”¨nvmä¸‹è½½çš„nodejsç›®å½•ï¼‰ï¼Œè¿™é‡Œä¸Šä¸‹ä¸¤ä¸ªè·¯å¾„éƒ½ä¸è¦æœ‰ç‰¹æ®Šå­—ç¬¦ä»¥åŠç©ºæ ¼ä»¥åŠä¸­æ–‡ï¼Œè€Œä¸”<strong>åŸè·¯å¾„è¦å­˜åœ¨</strong>ï¼ï¼ï¼</p><p><img src="https://img-blog.csdnimg.cn/20210317172221993.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgxNjMwOQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h4 id="4-æŸ¥çœ‹å½“å‰å·²ç»å®‰è£…çš„nodejsçš„ç‰ˆæœ¬"><a href="#4-æŸ¥çœ‹å½“å‰å·²ç»å®‰è£…çš„nodejsçš„ç‰ˆæœ¬" class="headerlink" title="4 æŸ¥çœ‹å½“å‰å·²ç»å®‰è£…çš„nodejsçš„ç‰ˆæœ¬"></a>4 æŸ¥çœ‹å½“å‰å·²ç»å®‰è£…çš„nodejsçš„ç‰ˆæœ¬</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">C</span>:<span class="string">\Users\holyhui&gt;nvm list</span></span><br><span class="line"><span class="attr">No</span> <span class="string">installations recognized.</span></span><br></pre></td></tr></table></figure><p>å› ä¸ºæ˜¯ç¬¬ä¸€æ¬¡å®‰è£…ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰å®‰è£…ä»»ä½•ç‰ˆæœ¬çš„ã€‚</p><h3 id="5-é…ç½®æ·˜å®é•œåƒæºï¼š"><a href="#5-é…ç½®æ·˜å®é•œåƒæºï¼š" class="headerlink" title="5 é…ç½®æ·˜å®é•œåƒæºï¼š"></a>5 é…ç½®æ·˜å®é•œåƒæºï¼š</h3><p>åœ¨ä½ nvm-windowså®‰è£…çš„ç›®å½•ä¸‹æ‰¾åˆ°settings.txtæ–‡ä»¶ï¼Œæ‰“å¼€ååŠ ä¸Š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">node_mirror</span>: <span class="string">https://npm.taobao.org/mirrors/node/</span></span><br><span class="line"><span class="attr">npm_mirror</span>: <span class="string">https://npm.taobao.org/mirrors/npm/</span></span><br></pre></td></tr></table></figure><h5 id="5-æŸ¥çœ‹å¯ä»¥å®‰è£…çš„nodejsç‰ˆæœ¬"><a href="#5-æŸ¥çœ‹å¯ä»¥å®‰è£…çš„nodejsç‰ˆæœ¬" class="headerlink" title="5 æŸ¥çœ‹å¯ä»¥å®‰è£…çš„nodejsç‰ˆæœ¬"></a>5 æŸ¥çœ‹å¯ä»¥å®‰è£…çš„nodejsç‰ˆæœ¬</h5><p><img src="https://img-blog.csdnimg.cn/20210317172612896.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgxNjMwOQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="6-å®‰è£…åˆ¶å®šç‰ˆæœ¬çš„node"><a href="#6-å®‰è£…åˆ¶å®šç‰ˆæœ¬çš„node" class="headerlink" title="6 å®‰è£…åˆ¶å®šç‰ˆæœ¬çš„node"></a>6 å®‰è£…åˆ¶å®šç‰ˆæœ¬çš„node</h3><p>è¿™é‡Œå®‰è£…äº†8.10.0å’Œ15.10.0ä¸¤ä¸ªç‰ˆæœ¬</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">//V5.6.0</span></span><br><span class="line"><span class="attr">C</span>:<span class="string">\Users\holyhui&gt;nvm install 8.10.0</span></span><br><span class="line"><span class="attr">Downloading</span> <span class="string">node.js version 8.10.0 (64-bit)...</span></span><br><span class="line"><span class="attr">Complete</span></span><br><span class="line"><span class="attr">Creating</span> <span class="string">E:\worksoftware\nvm\temp</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Downloading</span> <span class="string">npm version 3.6.0... Complete</span></span><br><span class="line"><span class="attr">Installing</span> <span class="string">npm v3.6.0...</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Installation</span> <span class="string">complete. If you want to use this version, type</span></span><br><span class="line"></span><br><span class="line"><span class="attr">nvm</span> <span class="string">use 8.10.0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">//V10.5.0</span></span><br><span class="line"><span class="attr">C</span>:<span class="string">\Users\holyhui&gt;nvm install 15.10.0</span></span><br><span class="line"><span class="attr">Downloading</span> <span class="string">node.js version 15.10.0 (64-bit)...</span></span><br><span class="line"><span class="attr">Complete</span></span><br><span class="line"><span class="attr">Creating</span> <span class="string">E:\worksoftware\nvm\temp</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Downloading</span> <span class="string">npm version 6.1.0... Complete</span></span><br><span class="line"><span class="attr">Installing</span> <span class="string">npm v6.1.0...</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Installation</span> <span class="string">complete. If you want to use this version, type</span></span><br><span class="line"></span><br><span class="line"><span class="attr">nvm</span> <span class="string">use 15.10.0</span></span><br></pre></td></tr></table></figure><h3 id="7-å†æ¬¡æŸ¥çœ‹å·²å®‰è£…çš„ç‰ˆæœ¬"><a href="#7-å†æ¬¡æŸ¥çœ‹å·²å®‰è£…çš„ç‰ˆæœ¬" class="headerlink" title="7  å†æ¬¡æŸ¥çœ‹å·²å®‰è£…çš„ç‰ˆæœ¬"></a>7  å†æ¬¡æŸ¥çœ‹å·²å®‰è£…çš„ç‰ˆæœ¬</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">C</span>:<span class="string">\Users\holyhui&gt; nvm list</span></span><br><span class="line">    <span class="attr">8.10.0</span></span><br><span class="line">    <span class="attr">15.10.0</span></span><br></pre></td></tr></table></figure><h3 id="8-ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„node"><a href="#8-ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„node" class="headerlink" title="8  ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„node"></a>8  ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„node</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">C</span>:<span class="string">\Users\holyhui&gt;nvm use 8.10.0</span></span><br><span class="line"><span class="attr">Now</span> <span class="string">using node v8.10.0 (64-bit)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">C</span>:<span class="string">\Users\holyhui&gt;nvm list</span></span><br><span class="line">    <span class="attr">15.10.0</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">*</span> <span class="string">8.10.0 (Currently using 64-bit executable)</span></span><br><span class="line">  <span class="meta">*</span> <span class="string">C:\Users\holyhui&gt;node -v</span></span><br><span class="line">    <span class="attr">v8.10.0</span></span><br></pre></td></tr></table></figure><p>nvm use å¯èƒ½ä¼šå‡ºç°exit status 1:ä¹±ç ï¼Œç”¨ç®¡ç†å‘˜æ‰“å¼€cmdå³å¯ï¼å‚è€ƒå¦‚ä¸‹</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//blog.csdn.net/weixin_44074879/article/details/121671731</span></span><br></pre></td></tr></table></figure><h3 id="9-åˆ é™¤æŒ‡å®šç‰ˆæœ¬çš„node"><a href="#9-åˆ é™¤æŒ‡å®šç‰ˆæœ¬çš„node" class="headerlink" title="9 åˆ é™¤æŒ‡å®šç‰ˆæœ¬çš„node"></a>9 åˆ é™¤æŒ‡å®šç‰ˆæœ¬çš„node</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">C</span>:<span class="string">\Users\holyhui&gt;nvm uninstall 8.10.0</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æelasticsearch éœ€è¦ç”¨åˆ°kibana çš„å¯è§†åŒ–æ“ä½œï¼Œä½†æ˜¯éœ€è¦ä¸‹è½½å¯¹åº”çš„nodejsç‰ˆæœ¬ï¼Œä½†åŸæ¥ç”¨ä½œhexoåšå®¢çš„nodejsä¹Ÿéœ€è¦ç»´æŠ¤ä¸€ä¸ªnodejsç‰ˆæœ¬ï¼Œå› æ­¤ä½¿ç”¨nvmæ¥åŒæ—¶å®‰è£…å¹¶ä¸”éšæ„åˆ‡æ¢nodejsç‰ˆæœ¬ï¼&lt;/p&gt;
&lt;h3 id=&quot;1-ä¸‹è½½nvm&quot;&gt;&lt;a </summary>
      
    
    
    
    
    <category term="nodejs" scheme="http://example.com/tags/nodejs/"/>
    
  </entry>
  
  <entry>
    <title>aliçŸ­ä¿¡æœåŠ¡çš„å¼€é€šå’ŒåŸºæœ¬é…ç½®ä¸æµ‹è¯•</title>
    <link href="http://example.com/2022/08/18/ali%E7%9F%AD%E4%BF%A1%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%BC%80%E9%80%9A%E5%92%8C%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%B5%8B%E8%AF%95/"/>
    <id>http://example.com/2022/08/18/ali%E7%9F%AD%E4%BF%A1%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%BC%80%E9%80%9A%E5%92%8C%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%B5%8B%E8%AF%95/</id>
    <published>2022-08-18T13:51:35.000Z</published>
    <updated>2022-12-11T02:30:14.468Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-å¼€é€šæœåŠ¡"><a href="#1-å¼€é€šæœåŠ¡" class="headerlink" title="1.å¼€é€šæœåŠ¡"></a>1.å¼€é€šæœåŠ¡</h1><h2 id="1-1-æ³¨å†Œé˜¿é‡Œäº‘"><a href="#1-1-æ³¨å†Œé˜¿é‡Œäº‘" class="headerlink" title="1.1.æ³¨å†Œé˜¿é‡Œäº‘"></a>1.1.æ³¨å†Œé˜¿é‡Œäº‘</h2><p>ç™»å½•é˜¿é‡Œäº‘é¦–é¡µï¼š<a href="https://account.aliyun.com/">https://account.aliyun.com/</a></p><p>ç„¶åæ³¨å†Œè´¦å·å¹¶ç™»å½•</p><h2 id="1-2-å¼€é€šçŸ­ä¿¡æœåŠ¡"><a href="#1-2-å¼€é€šçŸ­ä¿¡æœåŠ¡" class="headerlink" title="1.2.å¼€é€šçŸ­ä¿¡æœåŠ¡"></a>1.2.å¼€é€šçŸ­ä¿¡æœåŠ¡</h2><p>åœ¨é¦–é¡µçš„äº§å“ä¸­ï¼Œæ‰¾åˆ°çŸ­ä¿¡æœåŠ¡ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553774972732.png" alt="1553774972732"></p><p>é¦–æ¬¡ç™»å…¥ä¼šæ˜¾ç¤ºï¼š<code>ç«‹å³å¼€é€š</code>ï¼Œä»¥åä¼šæ˜¾ç¤º<code>ç®¡ç†æ§åˆ¶å°</code>ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553775033013.png" alt="1553775033013"></p><p>å¯ä»¥çœ‹åˆ°æ§åˆ¶å°é¡µé¢ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553775085494.png" alt="1553775085494"></p><h2 id="1-3-ä»˜è´¹å……å€¼"><a href="#1-3-ä»˜è´¹å……å€¼" class="headerlink" title="1.3.ä»˜è´¹å……å€¼"></a>1.3.ä»˜è´¹å……å€¼</h2><p>åœ¨é¡¶éƒ¨èœå•ä¸­é€‰æ‹©è´¹ç”¨ï¼Œå……å€¼ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553775135337.png" alt="1553775135337"></p><p>å……å€¼åå³å¯ä½¿ç”¨çŸ­ä¿¡æœåŠ¡å‘é€çŸ­ä¿¡äº†ã€‚</p><h1 id="2-æœåŠ¡å‡†å¤‡"><a href="#2-æœåŠ¡å‡†å¤‡" class="headerlink" title="2.æœåŠ¡å‡†å¤‡"></a>2.æœåŠ¡å‡†å¤‡</h1><p>æ­£å¼å¼€å‘å‘é€çŸ­ä¿¡å‰ï¼Œè¿˜æœ‰ä¸€ç³»åˆ—å‡†å¤‡å·¥ä½œè¦åšï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>å¼€é€šå­è´¦æˆ·ï¼Œè®¾ç½®AccessKeyIdå’ŒAccessKeySecret</li><li>å¼€é€šå­è´¦æˆ·çŸ­ä¿¡æƒé™</li><li>ç”³è¯·çŸ­ä¿¡ç­¾å</li><li>ç”³è¯·çŸ­ä¿¡æ¨¡æ¿</li></ul><h2 id="2-1-å¼€é€šå­è´¦æˆ·"><a href="#2-1-å¼€é€šå­è´¦æˆ·" class="headerlink" title="2.1.å¼€é€šå­è´¦æˆ·"></a>2.1.å¼€é€šå­è´¦æˆ·</h2><p>å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥ä½¿ç”¨ä¸»è´¦å·å¼€å‘ï¼Œå› ä¸ºä¸»è´¦å·å…·å¤‡æ•´ä¸ªäº‘æœåŠ¡çš„å®Œæ•´æƒé™ï¼Œé£é™©æ¯”è¾ƒå¤§ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å¼€é€šå­è´¦æˆ·ï¼Œç”¨äºä¸šåŠ¡å¼€å‘ã€‚</p><p>ç‚¹å‡»å³ä¸Šè§’çš„ç”¨æˆ·å¤´åƒï¼Œå¯ä»¥é€‰æ‹©æƒé™æ§åˆ¶ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553775502900.png" alt="1553775502900"></p><p>ç„¶ååœ¨å¼¹å‡ºçš„é¡µé¢ä¸­ï¼Œé€‰æ‹©æ–°å»ºç”¨æˆ·ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553775567420.png" alt="1553775567420"></p><p>ç„¶åè¾“å…¥ç”¨æˆ·åï¼Œå¹¶é€‰æ‹©<code>ç¼–ç¨‹è®¿é—®</code>ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553775613059.png" alt="1553775613059"></p><p>è¿™æ ·åˆ›å»ºçš„ç”¨æˆ·å°±ä¼šå¸¦ä¸ŠAccessKeyIDå’ŒAccessKeySecretäº†ã€‚</p><h2 id="2-2-å¼€é€šçŸ­ä¿¡æƒé™"><a href="#2-2-å¼€é€šçŸ­ä¿¡æƒé™" class="headerlink" title="2.2.å¼€é€šçŸ­ä¿¡æƒé™"></a>2.2.å¼€é€šçŸ­ä¿¡æƒé™</h2><p>åœ¨ç”¨æˆ·åˆ—è¡¨é¡µé¢ï¼Œé€‰ä¸­ä¸€ä¸ªæ–°å»ºçš„ç”¨æˆ·ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553775787645.png" alt="1553775787645"></p><p>ç„¶åä¼šè¿›å…¥ç”¨æˆ·è®¾ç½®é¡µé¢ï¼Œæˆ‘ä»¬é€‰æ‹©æƒé™ç®¡ç†ï¼Œå¹¶æ·»åŠ æƒé™ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553775853645.png" alt="1553775853645"></p><p>åœ¨å¼¹å‡ºçš„åˆ—è¡¨é¡µé¢ä¸­ï¼Œæœç´¢<code>çŸ­ä¿¡</code>ç›¸å…³æƒé™ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553775924262.png" alt="1553775924262"></p><p>é€‰ä¸­<code>ç®¡ç†çŸ­ä¿¡æœåŠ¡ï¼ˆSMSï¼‰çš„æƒé™</code>ï¼Œç‚¹å‡»ç¡®å®šå³å¯ï¼</p><h2 id="2-3-çŸ­ä¿¡ç­¾å"><a href="#2-3-çŸ­ä¿¡ç­¾å" class="headerlink" title="2.3.çŸ­ä¿¡ç­¾å"></a>2.3.çŸ­ä¿¡ç­¾å</h2><p>ä»€ä¹ˆæ˜¯çŸ­ä¿¡ç­¾åï¼Ÿ</p><p>çŸ­ä¿¡ç­¾åæ˜¯çŸ­ä¿¡æœåŠ¡æä¾›çš„ä¸€ç§å¿«æ·ã€æ–¹ä¾¿çš„ä¸ªæ€§åŒ–ç­¾åæ–¹å¼ã€‚å½“å‘é€çŸ­ä¿¡æ—¶ï¼ŒçŸ­ä¿¡å¹³å°ä¼šæ ¹æ®è®¾ç½®ï¼Œåœ¨çŸ­ä¿¡å†…å®¹é‡Œé™„åŠ ä¸ªæ€§ç­¾åï¼Œå†å‘é€ç»™æŒ‡å®šæ‰‹æœºå·ç ã€‚</p><p>ä¾‹å¦‚ï¼Œä¼ä¸šä¸»ä½“ä¸ºâ€œé˜¿é‡Œå·´å·´ç½‘ç»œæŠ€æœ¯æœ‰é™å…¬å¸â€ï¼Œåˆ™å¯ä»¥æäº¤çš„ç­¾åå¦‚ä¸‹ï¼š</p><ul><li>ä¼ä¸šå…¨ç§°æˆ–ç®€ç§°ï¼šã€é˜¿é‡Œå·´å·´ã€‘ã€ã€é˜¿é‡Œå·´å·´ç½‘ç»œæŠ€æœ¯æœ‰é™å…¬å¸ã€‘ã€‚</li><li>å…¬å¸æ——ä¸‹äº§å“åç§°ï¼šã€æ·˜å®ç½‘ã€‘ã€ã€é˜¿é‡Œäº‘ã€‘ç­‰ã€‚</li></ul><p>ç­¾åä¼šåœ¨çŸ­ä¿¡çš„å¼€å¤´æºå¸¦ï¼Œæ ‡ç¤ºçŸ­ä¿¡å‘é€æ–¹çš„èº«ä»½ã€‚</p><p>åœ¨ç®¡ç†æ§åˆ¶å°ï¼Œæ‰¾åˆ°å›½å†…çŸ­ä¿¡èœå•ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553776096731.png" alt="1553776096731"></p><p>ç‚¹å‡»æ·»åŠ ç­¾åï¼Œè¿›å…¥ç­¾åç”³è¯·é¡µé¢ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553776151886.png" alt="1553776151886"></p><p>å¡«å†™ä¿¡æ¯åï¼Œç‚¹å‡»ç¡®å®šï¼Œç­‰å¾…äººå·¥å®¡æ ¸å³å¯ã€‚</p><h2 id="2-4-çŸ­ä¿¡æ¨¡æ¿"><a href="#2-4-çŸ­ä¿¡æ¨¡æ¿" class="headerlink" title="2.4.çŸ­ä¿¡æ¨¡æ¿"></a>2.4.çŸ­ä¿¡æ¨¡æ¿</h2><p>ä»€ä¹ˆæ˜¯çŸ­ä¿¡æ¨¡æ¿ï¼Ÿ</p><p>é˜¿é‡Œè‚¯å®šä¸ä¼šå…è®¸ä½ éšæ„å‘é€çŸ­ä¿¡ï¼Œå› æ­¤ä¼šè¦æ±‚ä½ æå‰å®šä¹‰å¥½çŸ­ä¿¡å‘é€çš„å†…å®¹ã€‚å½“ç„¶ï¼Œå†…å®¹ä¸­å…è®¸å‡ºç°ä¸€äº›å‚æ•°å˜é‡ï¼Œä½†åŸºæœ¬å†…å®¹æ˜¯å›ºå®šçš„ï¼Œè¿™æ ·çš„ä¸€å¥—å®šä¹‰å¥½çš„çŸ­ä¿¡å†…å®¹ï¼Œå°±æ˜¯<strong>çŸ­ä¿¡æ¨¡æ¿</strong>ã€‚</p><p><strong>çŸ­ä¿¡æ¨¡æ¿ç”±å˜é‡å’Œæ¨¡æ¿å†…å®¹æ„æˆ</strong>ã€‚æ¨¡æ¿å˜é‡ä»¥å˜é‡å½¢å¼æä¾›é’ˆå¯¹ä¸åŒæ‰‹æœºå·ç çš„çŸ­ä¿¡å®šåˆ¶æ–¹å¼ï¼Œåœ¨æ¨¡æ¿ä¸­è®¾ç½®å˜é‡åï¼Œå‘é€çŸ­ä¿¡æ—¶æŒ‡å®šå˜é‡çš„å®é™…å€¼ï¼ŒçŸ­ä¿¡æœåŠ¡ä¼šè‡ªåŠ¨ç”¨å®é™…å€¼æ›¿æ¢æ¨¡æ¿å˜é‡ï¼Œå¹¶å‘é€çŸ­ä¿¡ï¼Œå®ç°çŸ­ä¿¡çš„å®šåˆ¶åŒ–ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ã€é˜¿é‡Œäº‘ã€‘æ‚¨æ­£åœ¨ç”³è¯·æ‰‹æœºæ³¨å†Œï¼ŒéªŒè¯ç ä¸ºï¼š$&#123;code&#125;ï¼Œ5åˆ†é’Ÿå†…æœ‰æ•ˆï¼</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼š</p><ul><li><strong>æ¨¡æ¿å†…å®¹</strong>ä¸ºï¼š<code>æ‚¨æ­£åœ¨ç”³è¯·æ‰‹æœºæ³¨å†Œï¼ŒéªŒè¯ç ä¸ºï¼š$&#123;code&#125;ï¼Œ5åˆ†é’Ÿå†…æœ‰æ•ˆï¼</code>ã€‚</li><li><strong>æ¨¡æ¿å˜é‡</strong>ä¸ºï¼š<code>$&#123;code&#125;</code>ã€‚</li></ul><blockquote><p>ç”³è¯·æ¨¡æ¿</p></blockquote><p>åœ¨å›½å†…çŸ­ä¿¡èœå•ä¸­ï¼Œç‚¹å‡»æ¨¡æ¿ç®¡ç†ï¼Œ</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553776492454.png" alt="1553776492454"></p><p>å†ç‚¹å‡»æ·»åŠ æ¨¡æ¿æŒ‰é’®ï¼Œè¿›å…¥æ¨¡æ¿ç”³è¯·é¡µé¢ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/1553776566827.png" alt="1553776566827"></p><p>å¡«å†™ä¿¡æ¯åï¼Œç‚¹å‡»æäº¤ï¼Œç­‰å¾…äººå·¥å®¡æ ¸å³å¯ï¼</p><h1 id="3-é˜¿é‡ŒSDK"><a href="#3-é˜¿é‡ŒSDK" class="headerlink" title="3.é˜¿é‡ŒSDK"></a>3.é˜¿é‡ŒSDK</h1><h2 id="3-1-å®˜æ–¹æ–‡æ¡£"><a href="#3-1-å®˜æ–¹æ–‡æ¡£" class="headerlink" title="3.1.å®˜æ–¹æ–‡æ¡£"></a>3.1.å®˜æ–¹æ–‡æ¡£</h2><p>å‘é€çŸ­ä¿¡æœ€ç»ˆè¦é€šè¿‡javaä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å†é˜¿é‡Œæ‰¾åˆ°å¯¹åº”çš„æ–‡æ¡£ä¿¡æ¯ï¼š<a href="https://help.aliyun.com/document_detail/101414.html?spm=a2c4g.11186623.6.615.635850a4SVoFBk">çŸ­ä¿¡å‘é€æ–‡æ¡£</a></p><p>è¯·æ±‚å‚æ•°ï¼š</p><table><thead><tr><th>åç§°</th><th>ç±»å‹</th><th>æ˜¯å¦å¿…é€‰</th><th>ç¤ºä¾‹å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td><strong>PhoneNumbers</strong></td><td>String</td><td>æ˜¯</td><td>15900000000</td><td>æ¥æ”¶çŸ­ä¿¡çš„æ‰‹æœºå·ç ã€‚æ ¼å¼ï¼šå›½å†…çŸ­ä¿¡ï¼š11ä½æ‰‹æœºå·ç ï¼Œä¾‹å¦‚15951955195ã€‚å›½é™…/æ¸¯æ¾³å°æ¶ˆæ¯ï¼šå›½é™…åŒºå·+å·ç ï¼Œä¾‹å¦‚85200000000ã€‚æ”¯æŒå¯¹å¤šä¸ªæ‰‹æœºå·ç å‘é€çŸ­ä¿¡ï¼Œæ‰‹æœºå·ç ä¹‹é—´ä»¥è‹±æ–‡é€—å·ï¼ˆ,ï¼‰åˆ†éš”ã€‚ä¸Šé™ä¸º1000ä¸ªæ‰‹æœºå·ç ã€‚æ‰¹é‡è°ƒç”¨ç›¸å¯¹äºå•æ¡è°ƒç”¨åŠæ—¶æ€§ç¨æœ‰å»¶è¿Ÿã€‚<strong>è¯´æ˜</strong> éªŒè¯ç ç±»å‹çŸ­ä¿¡ï¼Œå»ºè®®ä½¿ç”¨å•ç‹¬å‘é€çš„æ–¹å¼ã€‚</td></tr><tr><td><strong>SignName</strong></td><td>String</td><td>æ˜¯</td><td>é˜¿é‡Œäº‘</td><td>çŸ­ä¿¡ç­¾ååç§°ã€‚è¯·åœ¨æ§åˆ¶å°<strong>ç­¾åç®¡ç†</strong>é¡µé¢<strong>ç­¾ååç§°</strong>ä¸€åˆ—æŸ¥çœ‹ã€‚<strong>è¯´æ˜</strong> å¿…é¡»æ˜¯å·²æ·»åŠ ã€å¹¶é€šè¿‡å®¡æ ¸çš„çŸ­ä¿¡ç­¾åã€‚</td></tr><tr><td><strong>TemplateCode</strong></td><td>String</td><td>æ˜¯</td><td>SMS_153055065</td><td>çŸ­ä¿¡æ¨¡æ¿IDã€‚è¯·åœ¨æ§åˆ¶å°<strong>æ¨¡æ¿ç®¡ç†</strong>é¡µé¢<strong>æ¨¡æ¿CODE</strong>ä¸€åˆ—æŸ¥çœ‹ã€‚<strong>è¯´æ˜</strong> å¿…é¡»æ˜¯å·²æ·»åŠ ã€å¹¶é€šè¿‡å®¡æ ¸çš„çŸ­ä¿¡ç­¾åï¼›ä¸”å‘é€å›½é™…/æ¸¯æ¾³å°æ¶ˆæ¯æ—¶ï¼Œè¯·ä½¿ç”¨å›½é™…/æ¸¯æ¾³å°çŸ­ä¿¡æ¨¡ç‰ˆã€‚</td></tr><tr><td><strong>AccessKeyId</strong></td><td>String</td><td>å¦</td><td>LTAIP00vvvvvvvvv</td><td>ä¸»è´¦å·AccessKeyçš„IDã€‚</td></tr><tr><td><strong>Action</strong></td><td>String</td><td>å¦</td><td>SendSms</td><td>ç³»ç»Ÿè§„å®šå‚æ•°ã€‚å–å€¼ï¼š<strong>SendSms</strong>ã€‚</td></tr><tr><td><strong>OutId</strong></td><td>String</td><td>å¦</td><td>abcdefgh</td><td>å¤–éƒ¨æµæ°´æ‰©å±•å­—æ®µã€‚</td></tr><tr><td><strong>SmsUpExtendCode</strong></td><td>String</td><td>å¦</td><td>90999</td><td>ä¸Šè¡ŒçŸ­ä¿¡æ‰©å±•ç ï¼Œæ— ç‰¹æ®Šéœ€è¦æ­¤å­—æ®µçš„ç”¨æˆ·è¯·å¿½ç•¥æ­¤å­—æ®µã€‚</td></tr><tr><td><strong>TemplateParam</strong></td><td>String</td><td>å¦</td><td>{â€œcodeâ€:â€1111â€}</td><td>çŸ­ä¿¡æ¨¡æ¿å˜é‡å¯¹åº”çš„å®é™…å€¼ï¼ŒJSONæ ¼å¼ã€‚<strong>è¯´æ˜</strong> å¦‚æœJSONä¸­éœ€è¦å¸¦æ¢è¡Œç¬¦ï¼Œè¯·å‚ç…§æ ‡å‡†çš„JSONåè®®å¤„ç†ã€‚</td></tr></tbody></table><p>è¿”å›ç»“æœï¼š</p><table><thead><tr><th>åç§°</th><th>ç±»å‹</th><th>ç¤ºä¾‹å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>BizId</td><td>String</td><td>900619746936498440^0</td><td>å‘é€å›æ‰§IDï¼Œå¯æ ¹æ®è¯¥IDåœ¨æ¥å£QuerySendDetailsä¸­æŸ¥è¯¢å…·ä½“çš„å‘é€çŠ¶æ€ã€‚</td></tr><tr><td>Code</td><td>String</td><td>OK</td><td>è¯·æ±‚çŠ¶æ€ç ã€‚è¿”å›OKä»£è¡¨è¯·æ±‚æˆåŠŸã€‚å…¶ä»–é”™è¯¯ç è¯¦è§<a href="https://help.aliyun.com/document_detail/101346.html">é”™è¯¯ç åˆ—è¡¨</a>ã€‚</td></tr><tr><td>Message</td><td>String</td><td>OK</td><td>çŠ¶æ€ç çš„æè¿°ã€‚</td></tr><tr><td>RequestId</td><td>String</td><td>F655A8D5-B967-440B-8683-DAD6FF8DE990</td><td>è¯·æ±‚IDã€‚</td></tr></tbody></table><h2 id="3-2-å®˜æ–¹Demo"><a href="#3-2-å®˜æ–¹Demo" class="headerlink" title="3.2.å®˜æ–¹Demo"></a>3.2.å®˜æ–¹Demo</h2><p>é˜¿é‡Œæä¾›äº†åœ¨çº¿æµ‹è¯•çš„Demoï¼š<a href="https://api.aliyun.com/?spm=a2c4g.11186623.2.14.56ef50a4PQx5ux#/?product=Dysmsapi&amp;api=SendSms">https://api.aliyun.com/?spm=a2c4g.11186623.2.14.56ef50a4PQx5ux#/?product=Dysmsapi&amp;api=SendSms</a></p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/10%E7%94%A8%E6%88%B7%E4%B8%AD%E5%BF%83-%E6%B3%A8%E5%86%8C/image-20200719151428659.png" alt="image-20200719151428659"></p><p>å¡«å†™åŸºæœ¬ä¿¡æ¯ï¼Œå³å¯å‘é€å¹¶æµ‹è¯•ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;1-å¼€é€šæœåŠ¡&quot;&gt;&lt;a href=&quot;#1-å¼€é€šæœåŠ¡&quot; class=&quot;headerlink&quot; title=&quot;1.å¼€é€šæœåŠ¡&quot;&gt;&lt;/a&gt;1.å¼€é€šæœåŠ¡&lt;/h1&gt;&lt;h2 id=&quot;1-1-æ³¨å†Œé˜¿é‡Œäº‘&quot;&gt;&lt;a href=&quot;#1-1-æ³¨å†Œé˜¿é‡Œäº‘&quot; class=&quot;headerlink</summary>
      
    
    
    
    <category term="JWT" scheme="http://example.com/categories/JWT/"/>
    
    
    <category term="é˜¿é‡ŒçŸ­ä¿¡æœåŠ¡" scheme="http://example.com/tags/%E9%98%BF%E9%87%8C%E7%9F%AD%E4%BF%A1%E6%9C%8D%E5%8A%A1/"/>
    
  </entry>
  
  <entry>
    <title>RabbitMQæ•´åˆSpringBootå’Œé‚®ä»¶å‘é€</title>
    <link href="http://example.com/2022/08/18/RabbitMQ%E6%95%B4%E5%90%88SpringBoot%E5%92%8C%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81/"/>
    <id>http://example.com/2022/08/18/RabbitMQ%E6%95%B4%E5%90%88SpringBoot%E5%92%8C%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81/</id>
    <published>2022-08-18T13:42:00.000Z</published>
    <updated>2022-12-11T02:30:15.754Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SpringBootæ•´åˆé‚®ä»¶å‘é€"><a href="#SpringBootæ•´åˆé‚®ä»¶å‘é€" class="headerlink" title="SpringBootæ•´åˆé‚®ä»¶å‘é€"></a>SpringBootæ•´åˆé‚®ä»¶å‘é€</h1><p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/rabbitMQ/image-20210708162108584.png" alt="image-20210708162108584"></p><p>è¯´æ˜ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1</span> <span class="string">æœ€ä¸‹é¢çš„å‡ ä¸ªç®­å¤´è¡¨ç¤ºå¤‡ä»½ï¼Œ</span></span><br><span class="line"><span class="attr">2</span> <span class="string">æœ€ä¸Šé¢çš„åŒå‘ç®­å¤´ä¸­çš„å‘ä¸‹ç®­å¤´è¡¨ç¤ºåˆ·æ–°ï¼Œ</span></span><br><span class="line"><span class="attr">å¼ºåˆ¶æŸ¥çœ‹æœ‰æ²¡æœ‰æ¥å—åˆ°é‚®ç®±ï¼Œ</span></span><br><span class="line"><span class="attr">è‡ªå·±ä¸æ‰‹åŠ¨åˆ·æ–°ï¼Œé‚£ä¹ˆå°±æ˜¯å®šæ—¶åˆ·æ–°æŸ¥çœ‹æœ‰æ²¡æœ‰é‚®ç®±åˆ°è¾¾</span></span><br></pre></td></tr></table></figure><h2 id="SpringBoot-å®Œæˆé‚®ä»¶çš„æŠ•é€’"><a href="#SpringBoot-å®Œæˆé‚®ä»¶çš„æŠ•é€’" class="headerlink" title="SpringBoot å®Œæˆé‚®ä»¶çš„æŠ•é€’"></a>SpringBoot å®Œæˆé‚®ä»¶çš„æŠ•é€’</h2><p>å‡†å¤‡å·¥ä½œï¼š ç™»å½•è‡ªå·±çš„å¼€é€šé‚®ä»¶çš„ ä»¥163ä¸ºä¾‹      </p><p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/rabbitMQ/1600574189645.png" alt="1600574189645"> </p><p>ç”Ÿæˆè‡ªå·±å”¯ä¸€çš„æˆæƒç </p><p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/rabbitMQ/1600574220514.png" alt="1600574220514"> </p><ul><li>åŸºäºspringbootç¯å¢ƒå¯¼å…¥emailå‘é€ä¾èµ–</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--springbooté‚®ä»¶å‘é€--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>é…ç½®é‚®ä»¶å‘é€å‚æ•°  yamlæ–‡ä»¶</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#  é‚®ä»¶å‘é€é…ç½®</span><br><span class="line">#  spring.mail.username=fanqixxxx@163.com</span><br><span class="line">#  spring.mail.password=xxxxxxx  å¡«å†™æˆæƒç </span><br><span class="line">#  spring.mail.host=smtp.163.com  å¡«å†™é‚®ç®±ä¾›åº”çš„SMTPåœ°å€</span><br><span class="line">#  spring.mail.properties.mail.smtp.ssl.enable=true</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">mail:</span></span><br><span class="line">  <span class="comment"># å‘é€è€…çš„é‚®ç®±åœ°å€</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">xsitheima163@163.com</span></span><br><span class="line">  <span class="comment"># æ­¤å¯†ç å¹¶éç™»å½•çš„å¯†ç ,è€Œæ˜¯ä½¿ç”¨javaä»£ç å‘é€é‚®ä»¶æ—¶ä½¿ç”¨çš„æˆæƒç </span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">AKELOGXEFRJZOAWU</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">smtp.163.com</span></span><br><span class="line">    <span class="attr">properties:</span></span><br><span class="line">      <span class="attr">mail:</span></span><br><span class="line">        <span class="attr">smtp:</span></span><br><span class="line">          <span class="attr">ssl:</span></span><br><span class="line">            <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™æµ‹è¯•ç±» å®Œæˆé‚®ä»¶å‘é€</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmailSend</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JavaMailSenderImpl javaMailSender;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">send</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            SimpleMailMessage message = <span class="keyword">new</span> SimpleMailMessage();</span><br><span class="line">            message.setSubject(<span class="string">&quot;ä¼ æ™ºå¥åº·å®˜æ–¹é‚®ä»¶&quot;</span>);</span><br><span class="line">            message.setText(<span class="string">&quot;ä½ å¥½ï¼Œè¯·ä¿æŒå¥½éªŒè¯ç ï¼š7788ï¼Œæ‰“æ­»éƒ½ä¸èƒ½æ³„éœ²ç»™ä½ çš„åŒæ¡Œ&quot;</span>);</span><br><span class="line">            message.setTo(<span class="string">&quot;tps520tps@163.com&quot;</span>);</span><br><span class="line">            message.setFrom(<span class="string">&quot;tps520wx@163.com&quot;</span>);</span><br><span class="line">            javaMailSender.send(message);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MailException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŸ¥æ”¶é‚®ä»¶ï¼š</p><p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/rabbitMQ/1600574300195.png" alt="1600574300195"> </p><p>é‚®ä»¶å‘é€ç¤ºä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima;</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SendEmailApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JavaMailSenderImpl javaMailSender;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            SimpleMailMessage message = <span class="keyword">new</span> SimpleMailMessage();</span><br><span class="line">            message.setSubject(<span class="string">&quot;è¡¨ç™½é‚®ä»¶&quot;</span>);</span><br><span class="line">            message.setText(<span class="string">&quot;rose ä½ å¥½, æˆ‘æƒ³.....&quot;</span>);</span><br><span class="line">            message.setTo(<span class="string">&quot;xsitheima126@126.com&quot;</span>);</span><br><span class="line">            message.setFrom(<span class="string">&quot;xsitheima163@163.com&quot;</span>);</span><br><span class="line">            javaMailSender.send(message);</span><br><span class="line">            System.out.println(<span class="string">&quot;========å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MailException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="é¢„å¤‡è´¦å·"><a href="#é¢„å¤‡è´¦å·" class="headerlink" title="é¢„å¤‡è´¦å·"></a>é¢„å¤‡è´¦å·</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xsitheima126@<span class="number">126.</span>com    a123456</span><br><span class="line">    æˆæƒç : YKJOGNHCCFDLIJKO</span><br><span class="line">xsitheima163@<span class="number">163.</span>com    a12345678</span><br><span class="line">æˆæƒç : AKELOGXEFRJZOAWU</span><br></pre></td></tr></table></figure><h1 id="SpringBootæ•´åˆRabbitMQä»¥åŠæ•´åˆé‚®ä»¶å‘é€"><a href="#SpringBootæ•´åˆRabbitMQä»¥åŠæ•´åˆé‚®ä»¶å‘é€" class="headerlink" title="SpringBootæ•´åˆRabbitMQä»¥åŠæ•´åˆé‚®ä»¶å‘é€"></a>SpringBootæ•´åˆRabbitMQä»¥åŠæ•´åˆé‚®ä»¶å‘é€</h1><p>æ•´åˆæè¿°ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring</span> <span class="string">boot ä¸­ç”Ÿäº§è€…çš„controllerç±»æä¾›çš„ è®¿é—®åœ°å€å¸¦çš„å‚æ•°å°±æ˜¯é‚®ç®±è´¦å·ï¼Œ</span></span><br><span class="line"><span class="meta">è®¿é—®ç”Ÿäº§è€…çš„</span> <span class="string">spring boot controller å¹¶ä¸”å°†é‚®ç®±è´¦å·ä½œä¸ºæ¶ˆæ¯ï¼Œ</span></span><br><span class="line"><span class="attr">æ¶ˆè´¹è€…æ‹¿åˆ°çš„ä¿¡æ¯å°±æ˜¯é‚®ç®±è´¦å·ï¼Œ</span></span><br><span class="line"><span class="meta">ç„¶åæ¶ˆè´¹è€…ä½¿ç”¨163è´¦å·ç»™æ¥æ”¶åˆ°çš„é‚®ç®±è´¦å·</span> <span class="string">å‘é€é‚®ä»¶ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="attr">psï¼šå…ˆå¯åŠ¨æ¶ˆè´¹è€…ï¼Œç„¶åå†å¯åŠ¨ç”Ÿäº§è€…ï¼Œç”Ÿäº§è€…ç”Ÿäº§10æ¬¡é‚®ç®±ä¿¡æ¯ï¼Œé‚£ä¹ˆæ¶ˆè´¹è€…å‘é€åæ¬¡é‚®ç®±ã€‚</span></span><br><span class="line"><span class="attr">æ¶ˆæ¯å·¥ä½œæ¨¡å¼ä¸ºç›´è¿æ¨¡å¼ï¼</span></span><br></pre></td></tr></table></figure><h3 id="1-æ¶ˆè´¹è€…ä»£ç "><a href="#1-æ¶ˆè´¹è€…ä»£ç " class="headerlink" title="1 æ¶ˆè´¹è€…ä»£ç "></a>1 æ¶ˆè´¹è€…ä»£ç </h3><h4 id="æ¶ˆè´¹è€…é…ç½®æ–‡ä»¶ï¼š"><a href="#æ¶ˆè´¹è€…é…ç½®æ–‡ä»¶ï¼š" class="headerlink" title="æ¶ˆè´¹è€…é…ç½®æ–‡ä»¶ï¼š"></a>æ¶ˆè´¹è€…é…ç½®æ–‡ä»¶ï¼š</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8082</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">consumer-application</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/itheima129</span>  <span class="comment"># è™šæ‹Ÿæœºåç§°</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">leyou</span> <span class="comment"># rabbitMQç”¨æˆ·å</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123321</span> <span class="comment"># rabbitMQå¯†ç </span></span><br><span class="line">    <span class="attr">addresses:</span> <span class="number">192.168</span><span class="number">.190</span><span class="number">.153</span><span class="string">:5672</span></span><br><span class="line">  <span class="attr">mail:</span></span><br><span class="line">  <span class="comment"># å‘é€è€…çš„é‚®ç®±åœ°å€</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">xsitheima163@163.com</span></span><br><span class="line">  <span class="comment"># æ­¤å¯†ç å¹¶éç™»å½•çš„å¯†ç ,è€Œæ˜¯ä½¿ç”¨javaä»£ç å‘é€é‚®ä»¶æ—¶ä½¿ç”¨çš„æˆæƒç </span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">AKELOGXEFRJZOAWU</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">smtp.163.com</span></span><br><span class="line">    <span class="attr">properties:</span></span><br><span class="line">      <span class="attr">mail:</span></span><br><span class="line">        <span class="attr">smtp:</span></span><br><span class="line">          <span class="attr">ssl:</span></span><br><span class="line">            <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…pom-xmlæ–‡ä»¶"><a href="#æ¶ˆè´¹è€…pom-xmlæ–‡ä»¶" class="headerlink" title="æ¶ˆè´¹è€…pom.xmlæ–‡ä»¶"></a>æ¶ˆè´¹è€…pom.xmlæ–‡ä»¶</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>day08-rabbit-consumer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- webç¯å¢ƒå¯åŠ¨å™¨ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- rabbitMQå¯åŠ¨å™¨ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.dataformat<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-dataformat-xml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--springbooté‚®ä»¶å‘é€--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-mail<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…å¯åŠ¨æ–‡ä»¶ï¼š"><a href="#æ¶ˆè´¹è€…å¯åŠ¨æ–‡ä»¶ï¼š" class="headerlink" title="æ¶ˆè´¹è€…å¯åŠ¨æ–‡ä»¶ï¼š"></a>æ¶ˆè´¹è€…å¯åŠ¨æ–‡ä»¶ï¼š</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.support.converter.Jackson2JsonMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.support.converter.MessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsumerApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(ConsumerApplication.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç±»å‹è½¬æ¢å™¨: å°†å¯¹è±¡è½¬æˆjsonå¹¶å­˜æ”¾åˆ°MQä¸­</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MessageConverter <span class="title">jsonMessageConverter</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºJSONçš„æ¶ˆæ¯è½¬æ¢å™¨</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Jackson2JsonMessageConverter();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…ç›‘å¬ç”Ÿäº§è€…ç±»ï¼š"><a href="#æ¶ˆè´¹è€…ç›‘å¬ç”Ÿäº§è€…ç±»ï¼š" class="headerlink" title="æ¶ˆè´¹è€…ç›‘å¬ç”Ÿäº§è€…ç±»ï¼š"></a>æ¶ˆè´¹è€…ç›‘å¬ç”Ÿäº§è€…ç±»ï¼š</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.consumer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rabbitmq.client.Channel;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Message;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.SimpleMailMessage;</span><br><span class="line"><span class="keyword">import</span> org.springframework.mail.javamail.JavaMailSenderImpl;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestConsumer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JavaMailSenderImpl javaMailSender;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> msg : å‚æ•°ç±»å‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> channel</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;boot-queue&quot;)</span><span class="comment">//  æ³¨æ„åªéœ€è¦ é˜Ÿåˆ—åç§°ä¸€è‡´å³å¯ï¼</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receive</span><span class="params">(String msg, Channel channel, Message message)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="comment">//public void receive(Map msg, Channel channel, Message message) throws IOException &#123;</span></span><br><span class="line">        <span class="comment">//ä¼šè¯å”¯ä¸€ID</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;æ”¶åˆ°æ¶ˆæ¯ &quot;</span> + msg);</span><br><span class="line">            <span class="comment">//System.out.println(&quot;æ”¶åˆ°æ¶ˆæ¯ &quot; + new String(message.getBody()));</span></span><br><span class="line">            Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">            <span class="comment">//System.out.println(&quot;message:&quot; +message.toString());</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// =====================å‘é€é‚®ä»¶</span></span><br><span class="line">            <span class="comment">// ç¼–å†™é‚®ä»¶ä¿¡æ¯</span></span><br><span class="line">            SimpleMailMessage emailMessage = <span class="keyword">new</span> SimpleMailMessage();</span><br><span class="line">            <span class="comment">// é‚®ä»¶ä¸»é¢˜</span></span><br><span class="line">            emailMessage.setSubject(<span class="string">&quot;ä¸‹å•é€šçŸ¥&quot;</span>);</span><br><span class="line">            <span class="comment">// é‚®ä»¶å†…å®¹</span></span><br><span class="line">            emailMessage.setText(<span class="string">&quot;æ‚¨çš„å®è´ä»¥å‘è´§&quot;</span>);</span><br><span class="line">            emailMessage.setTo(msg);</span><br><span class="line">            emailMessage.setFrom(<span class="string">&quot;xsitheima163@163.com&quot;</span>);</span><br><span class="line">            javaMailSender.send(emailMessage);</span><br><span class="line">            System.out.println(<span class="string">&quot;========å‘é€æˆåŠŸ&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-ç”Ÿäº§è€…ä»£ç ï¼š"><a href="#2-ç”Ÿäº§è€…ä»£ç ï¼š" class="headerlink" title="2 ç”Ÿäº§è€…ä»£ç ï¼š"></a>2 ç”Ÿäº§è€…ä»£ç ï¼š</h3><h4 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8081</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">producer-application</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/itheima129</span>  <span class="comment"># è™šæ‹Ÿæœºåç§°</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">leyou</span> <span class="comment"># rabbitMQç”¨æˆ·å</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123321</span> <span class="comment"># rabbitMQå¯†ç </span></span><br><span class="line">    <span class="attr">addresses:</span> <span class="number">192.168</span><span class="number">.190</span><span class="number">.153</span><span class="string">:5672</span></span><br></pre></td></tr></table></figure><h4 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itheima<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>day08-rabbit-producer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.10.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- webç¯å¢ƒå¯åŠ¨å™¨ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- rabbitMQå¯åŠ¨å™¨ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.dataformat<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-dataformat-xml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="å¯åŠ¨ç±»"><a href="#å¯åŠ¨ç±»" class="headerlink" title="å¯åŠ¨ç±»"></a>å¯åŠ¨ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.support.converter.Jackson2JsonMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.support.converter.MessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProducerApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(ProducerApplication.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç±»å‹è½¬æ¢å™¨: å°†å¯¹è±¡è½¬æˆjsonå¹¶å­˜æ”¾åˆ°MQä¸­</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MessageConverter <span class="title">jsonMessageConverter</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºJSONçš„æ¶ˆæ¯è½¬æ¢å™¨</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Jackson2JsonMessageConverter();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="Controllerç±»"><a href="#Controllerç±»" class="headerlink" title="Controllerç±»"></a>Controllerç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PathVariable;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProducerController</span> </span>&#123;</span><br><span class="line">    <span class="comment">// rabbitå®¢æˆ·ç«¯å¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/send/&#123;msg&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sendMsg</span><span class="params">(<span class="meta">@PathVariable(&quot;msg&quot;)</span> String msg)</span></span>&#123;</span><br><span class="line">        <span class="comment">// å‚æ•°1: é˜Ÿåˆ—åç§°,æ“ä½œçš„é˜Ÿåˆ—å¿…é¡»å®ç°å­˜åœ¨</span></span><br><span class="line">        <span class="comment">// å‚æ•°2: å­˜æ”¾çš„æ¶ˆæ¯ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++) &#123;</span><br><span class="line">            rabbitTemplate.convertAndSend(<span class="string">&quot;boot-queue&quot;</span>,msg);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;OK&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SpringBootæ•´åˆé‚®ä»¶å‘é€&quot;&gt;&lt;a href=&quot;#SpringBootæ•´åˆé‚®ä»¶å‘é€&quot; class=&quot;headerlink&quot; title=&quot;SpringBootæ•´åˆé‚®ä»¶å‘é€&quot;&gt;&lt;/a&gt;SpringBootæ•´åˆé‚®ä»¶å‘é€&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;/img</summary>
      
    
    
    
    <category term="RabbitMQ" scheme="http://example.com/categories/RabbitMQ/"/>
    
    
    <category term="RabbitMQ" scheme="http://example.com/tags/RabbitMQ/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨å­¦ç”Ÿé‚®ç®±ç™»å½•idea</title>
    <link href="http://example.com/2022/08/16/%E4%BD%BF%E7%94%A8%E5%AD%A6%E7%94%9F%E9%82%AE%E7%AE%B1%E7%99%BB%E5%BD%95idea/"/>
    <id>http://example.com/2022/08/16/%E4%BD%BF%E7%94%A8%E5%AD%A6%E7%94%9F%E9%82%AE%E7%AE%B1%E7%99%BB%E5%BD%95idea/</id>
    <published>2022-08-16T13:50:38.000Z</published>
    <updated>2022-12-11T02:30:17.075Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1-æ‰¾åˆ°è‡ªå·±æ‰€åœ¨çš„å­¦æ ¡ç»™è‡ªå·±åˆ†é…çš„å­¦ç”Ÿé‚®ç®±ã€‚"><a href="#1-æ‰¾åˆ°è‡ªå·±æ‰€åœ¨çš„å­¦æ ¡ç»™è‡ªå·±åˆ†é…çš„å­¦ç”Ÿé‚®ç®±ã€‚" class="headerlink" title="1 æ‰¾åˆ°è‡ªå·±æ‰€åœ¨çš„å­¦æ ¡ç»™è‡ªå·±åˆ†é…çš„å­¦ç”Ÿé‚®ç®±ã€‚"></a>1 æ‰¾åˆ°è‡ªå·±æ‰€åœ¨çš„å­¦æ ¡ç»™è‡ªå·±åˆ†é…çš„å­¦ç”Ÿé‚®ç®±ã€‚</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">æˆ‘æ˜¯ç›´æ¥ç™¾åº¦çš„ï¼Œè¿›å…¥é“¾æ¥å‘ç°æ˜¯å†…éƒ¨ç½‘é‡Œé¢çš„å…¬å‘Šï¼Œå…¬æ–‡é€š</span></span><br><span class="line"><span class="attr">å…¬å‘Šå¾ˆæ¸…æ™°è¯´æ˜ç»™æˆ‘ä»¬åˆ†é…çš„é‚®ç®±è·Ÿå¯†ç æ˜¯å¤šå°‘</span></span><br></pre></td></tr></table></figure><h3 id="2-ä½¿ç”¨åˆ†é…çš„é‚®ç®±å»è®¤è¯idea-å¦‚ä¸‹æ˜¯è®¤è¯é¡µé¢"><a href="#2-ä½¿ç”¨åˆ†é…çš„é‚®ç®±å»è®¤è¯idea-å¦‚ä¸‹æ˜¯è®¤è¯é¡µé¢" class="headerlink" title="2 ä½¿ç”¨åˆ†é…çš„é‚®ç®±å»è®¤è¯idea,å¦‚ä¸‹æ˜¯è®¤è¯é¡µé¢"></a>2 ä½¿ç”¨åˆ†é…çš„é‚®ç®±å»è®¤è¯idea,å¦‚ä¸‹æ˜¯è®¤è¯é¡µé¢</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//www.jetbrains.com/shop/eform/students</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨é‚®ç®±è®¤è¯ï¼Œå¡«å†™ä¿¡æ¯å°±å¥½ã€‚</p><h3 id="3-åˆ©ç”¨è®¤è¯çš„å­¦ç”Ÿé‚®ç®±æ³¨å†Œä¸€ä¸ªideaè´¦å·"><a href="#3-åˆ©ç”¨è®¤è¯çš„å­¦ç”Ÿé‚®ç®±æ³¨å†Œä¸€ä¸ªideaè´¦å·" class="headerlink" title="3 åˆ©ç”¨è®¤è¯çš„å­¦ç”Ÿé‚®ç®±æ³¨å†Œä¸€ä¸ªideaè´¦å·"></a>3 åˆ©ç”¨è®¤è¯çš„å­¦ç”Ÿé‚®ç®±æ³¨å†Œä¸€ä¸ªideaè´¦å·</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//account.jetbrains.com/signup-complete</span></span><br></pre></td></tr></table></figure><p>æ³¨å†Œå®Œè´¦å·å°±ä¼šæç¤ºï¼Œä½ è¿™æ˜¯å­¦ç”Ÿè´¦å·ï¼Œå·²ç»æˆæƒï¼Œäº«æœ‰å“ªäº›èµ„æºã€‚</p><p><img src="/img/java/idea/1.png" alt="803e2a688844f57fa3fa425a70a122c"></p><h3 id="4-ä½¿ç”¨3ä¸­æ³¨å†Œçš„ideaè´¦å·åœ¨ç¤¾åŒºç‰ˆideaä¸­ç™»å½•è´¦å·ï¼ˆå­¦ç”Ÿé‚®ç®±è·Ÿå¯†ç ç™»å½•ï¼‰"><a href="#4-ä½¿ç”¨3ä¸­æ³¨å†Œçš„ideaè´¦å·åœ¨ç¤¾åŒºç‰ˆideaä¸­ç™»å½•è´¦å·ï¼ˆå­¦ç”Ÿé‚®ç®±è·Ÿå¯†ç ç™»å½•ï¼‰" class="headerlink" title="4 ä½¿ç”¨3ä¸­æ³¨å†Œçš„ideaè´¦å·åœ¨ç¤¾åŒºç‰ˆideaä¸­ç™»å½•è´¦å·ï¼ˆå­¦ç”Ÿé‚®ç®±è·Ÿå¯†ç ç™»å½•ï¼‰"></a>4 ä½¿ç”¨3ä¸­æ³¨å†Œçš„ideaè´¦å·åœ¨ç¤¾åŒºç‰ˆideaä¸­ç™»å½•è´¦å·ï¼ˆå­¦ç”Ÿé‚®ç®±è·Ÿå¯†ç ç™»å½•ï¼‰</h3><p>ï¼ˆè´¦å·å¯†ç è·Ÿå­¦ç”Ÿé‚®ç®±å¯†ç æ˜¯ä¸åŒçš„ä¸€ä¸ªå¯†ç ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è®¾ä¸ºä¸€æ ·ï¼‰</p><p><img src="/img/java/idea/2.png" alt="4428d753eebde9c4e8fe9d01e295981"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;1-æ‰¾åˆ°è‡ªå·±æ‰€åœ¨çš„å­¦æ ¡ç»™è‡ªå·±åˆ†é…çš„å­¦ç”Ÿé‚®ç®±ã€‚&quot;&gt;&lt;a href=&quot;#1-æ‰¾åˆ°è‡ªå·±æ‰€åœ¨çš„å­¦æ ¡ç»™è‡ªå·±åˆ†é…çš„å­¦ç”Ÿé‚®ç®±ã€‚&quot; class=&quot;headerlink&quot; title=&quot;1 æ‰¾åˆ°è‡ªå·±æ‰€åœ¨çš„å­¦æ ¡ç»™è‡ªå·±åˆ†é…çš„å­¦ç”Ÿé‚®ç®±ã€‚&quot;&gt;&lt;/a&gt;1 æ‰¾åˆ°è‡ªå·±æ‰€åœ¨çš„å­¦æ ¡ç»™è‡ªå·±åˆ†é…çš„å­¦ç”Ÿé‚®</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>nginxéƒ¨ç½²é™æ€èµ„æºä»¥åŠåå‘ä»£ç†çš„é…ç½®æ–¹å¼å¤§æ€»ç»“</title>
    <link href="http://example.com/2022/08/16/nginx%E9%83%A8%E7%BD%B2%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E4%BB%A5%E5%8F%8A%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F%E5%A4%A7%E6%80%BB%E7%BB%93/"/>
    <id>http://example.com/2022/08/16/nginx%E9%83%A8%E7%BD%B2%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E4%BB%A5%E5%8F%8A%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F%E5%A4%A7%E6%80%BB%E7%BB%93/</id>
    <published>2022-08-16T13:09:14.000Z</published>
    <updated>2022-12-11T02:30:15.326Z</updated>
    
    <content type="html"><![CDATA[<p>nginx çš„å‡ ç§åŠŸèƒ½ä»‹ç»ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1</span> <span class="string">æœ¬æœºé™æ€èµ„æºéƒ¨ç½²ï¼Œ</span></span><br><span class="line"><span class="comment">    # åŒ¹é…localhostä¸‹çš„ä¸€åˆ‡è·¯å¾„</span></span><br><span class="line">    <span class="attr">location</span> <span class="string">/ &#123;</span></span><br><span class="line"><span class="comment">        # é»˜è®¤èµ„æºå»nginxç›®å½•ä¸‹çš„htmlç›®å½•å¯»æ‰¾</span></span><br><span class="line">        <span class="attr">root</span>   <span class="string">html;</span></span><br><span class="line">        <span class="attr">index</span>  <span class="string">index.html index.htm;</span></span><br><span class="line">    <span class="attr">&#125;</span></span><br><span class="line"><span class="comment">    # è®¿é—®ï¼šhttp://localhost/  å°±æ˜¯nginxç›®å½•ä¸‹çš„htmlæ–‡ä»¶å¤¹ä¸‹çš„èµ„æº</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">location</span> <span class="string">/gaominghui &#123;</span></span><br><span class="line">        <span class="attr">alias</span> <span class="string">F:/java/MyCode/leyouProject/leyou-portal/;</span></span><br><span class="line">        <span class="attr">index</span> <span class="string">index.html;</span></span><br><span class="line">    <span class="attr">&#125;</span></span><br><span class="line"><span class="comment">    # è®¿é—®ï¼šhttp://localhost/gaominghui/  å°±æ˜¯F:/java/MyCode/leyouProject/leyou-portal/æ–‡ä»¶å¤¹ä¸‹çš„èµ„æº</span></span><br><span class="line"><span class="attr">2</span> <span class="string">æœ¬æœºé™æ€èµ„æºåå‘ä»£ç†ï¼Œç›´æ¥åœ¨å¤–éƒ¨confé…ç½®æ–‡ä»¶è¿›è¡Œå¦‚ä¸‹é…ç½®å°±å¥½ï¼š</span></span><br><span class="line">    <span class="attr">server</span> <span class="string">&#123;</span></span><br><span class="line">        <span class="attr">listen</span>       <span class="string">80;</span></span><br><span class="line">        <span class="attr">server_name</span>  <span class="string">image.leyou.com;</span></span><br><span class="line"></span><br><span class="line">        <span class="attr">location</span> <span class="string">/ &#123;</span></span><br><span class="line"><span class="comment">            # é»˜è®¤èµ„æºå»nginxç›®å½•ä¸‹çš„htmlç›®å½•å¯»æ‰¾</span></span><br><span class="line">            <span class="attr">root</span>   <span class="string">html;</span></span><br><span class="line">            <span class="attr">index</span>  <span class="string">/images/0/0/1524297512647.jpg;</span></span><br><span class="line">        <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"><span class="comment"># è®¿é—® http://image.leyou.com/ å°±æ˜¯è®¿é—®nginxç›®å½•ä¸‹çš„htmlæ–‡ä»¶å¤¹ä¸‹çš„èµ„æº</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">server</span> <span class="string">&#123;</span></span><br><span class="line">        <span class="attr">listen</span>       <span class="string">80;</span></span><br><span class="line">        <span class="attr">server_name</span>  <span class="string">www.leyou.com;</span></span><br><span class="line"></span><br><span class="line">        <span class="attr">location</span> <span class="string">/ &#123;</span></span><br><span class="line">                <span class="attr">root</span><span class="string">F:/java/MyCode/leyouProject/leyou-portal;</span></span><br><span class="line">                <span class="attr">index</span><span class="string">index.html;</span></span><br><span class="line">        <span class="attr">&#125;</span></span><br><span class="line">    <span class="attr">&#125;</span></span><br><span class="line"><span class="comment">    # è®¿é—®ï¼šhttp://www.leyou.com/  å°±æ˜¯F:/java/MyCode/leyouProject/leyou-portal/æ–‡ä»¶å¤¹ä¸‹çš„èµ„æº</span></span><br><span class="line">    </span><br><span class="line"><span class="attr">3</span> <span class="string">å¾®æœåŠ¡åå‘ä»£ç†,ç›´æ¥åœ¨å¤–éƒ¨confé…ç½®æ–‡ä»¶è¿›è¡Œå¦‚ä¸‹é…ç½®å°±å¥½ï¼š</span></span><br><span class="line">    <span class="attr">server</span> <span class="string">&#123;</span></span><br><span class="line">        <span class="attr">listen</span>       <span class="string">80;</span></span><br><span class="line">        <span class="attr">server_name</span>  <span class="string">manage.leyou.com;</span></span><br><span class="line"></span><br><span class="line">        <span class="attr">location</span> <span class="string">/ &#123;</span></span><br><span class="line">            <span class="attr">proxy_pass</span>   <span class="string">http://127.0.0.1:9001;</span></span><br><span class="line">            <span class="attr">proxy_connect_timeout</span> <span class="string">600;</span></span><br><span class="line">            <span class="attr">proxy_read_timeout</span> <span class="string">5000;</span></span><br><span class="line">        <span class="attr">&#125;</span></span><br><span class="line">    <span class="attr">&#125;</span></span><br><span class="line"><span class="comment"># è®¿é—® http://www.manage.leyou.com  ä¼šåå‘ä»£ç†åˆ°http://127.0.0.1:9001</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„æ³¨æ„æ³¨æ„ï¼š</strong>ä¸Šé¢ä½¿ç”¨åŸŸåçš„åå‘ä»£ç†ï¼Œä¸€å®šè¦åœ¨æœ¬åœ°hostsåŸŸåé…ç½®æ–‡ä»¶ä¸­é…ç½®åŸŸåæ˜ å°„ï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;nginx çš„å‡ ç§åŠŸèƒ½ä»‹ç»ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight properties&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;li</summary>
      
    
    
    
    <category term="nginx" scheme="http://example.com/categories/nginx/"/>
    
    
    <category term="nginx" scheme="http://example.com/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>i9ç”µè„‘å®‰è£…ubuntu18.04æœ‰çº¿ç½‘å›¾æ ‡æ²¡æœ‰æ˜¾ç¤ºä¸”è¿æ¥ä¸ä¸Šç½‘ç»œ</title>
    <link href="http://example.com/2022/08/15/i9%E7%94%B5%E8%84%91%E5%AE%89%E8%A3%85ubuntu18-04%E6%9C%89%E7%BA%BF%E7%BD%91%E5%9B%BE%E6%A0%87%E6%B2%A1%E6%9C%89%E6%98%BE%E7%A4%BA%E4%B8%94%E8%BF%9E%E6%8E%A5%E4%B8%8D%E4%B8%8A%E7%BD%91%E7%BB%9C/"/>
    <id>http://example.com/2022/08/15/i9%E7%94%B5%E8%84%91%E5%AE%89%E8%A3%85ubuntu18-04%E6%9C%89%E7%BA%BF%E7%BD%91%E5%9B%BE%E6%A0%87%E6%B2%A1%E6%9C%89%E6%98%BE%E7%A4%BA%E4%B8%94%E8%BF%9E%E6%8E%A5%E4%B8%8D%E4%B8%8A%E7%BD%91%E7%BB%9C/</id>
    <published>2022-08-15T08:28:17.000Z</published>
    <updated>2022-12-11T02:30:15.044Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘è¦ææ— äººæœºå¹³å°çš„å ¤åè¯†åˆ«ï¼Œå¼ è€å¸ˆä¹°å›æ¥ä¸€å°i9å¤„ç†å™¨çš„æœåŠ¡å™¨ï¼Œè®©æˆ‘é…ç½®ç¯å¢ƒï¼Œè°çŸ¥é“å®‰è£…äº†ç³»ç»Ÿubuntu18.04ä¹‹åæ— æ³•ä¸Šç½‘ï¼Œåˆšå¼€å§‹pingä¸åŒç™¾åº¦ï¼Œç„¶åifconfigï¼Œæç¤ºæ²¡æœ‰è¿™ä¸ªå·¥å…·ï¼Œå†ç„¶åsudo apt-get install net-tools æ²¡æœ‰å¯¹åº”çš„åŒ…ï¼Œå†ç„¶åæ˜¯ sudo apt-get update å‡ºç°åŸŸåè§£æå¤±è´¥ï¼Œå†ç„¶åæ‰‹åŠ¨é…ç½®ä¸‡èƒ½åŸŸåï¼Œå†åˆ°æ›´è¿˜æºï¼Œéƒ½è¯•äº†è¿˜æ˜¯ä¸è¡Œã€‚</p><p>æœ€åæœç´¢åˆ°ä¸€ä¸‹åšå®¢ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//blog.csdn.net/weixin_44359479/article/details/123019056</span></span><br></pre></td></tr></table></figure><p>åŸæ¥æ˜¯æ²¡æœ‰å¯¹åº”çš„é©±åŠ¨ï¼Œç½‘å¡é©±åŠ¨æ˜¯æœ‰çš„ï¼Œå®˜ç½‘ä¸Šçš„ubuntué•œåƒï¼Œæ€ä¹ˆå¯èƒ½æ²¡æœ‰é©±åŠ¨ï¼Œåªæ˜¯ç¡¬ä»¶ç‰ˆæœ¬ä¸å¯¹ï¼Œé©±åŠ¨ä¸å…¼å®¹ï¼Œä»¥å‰windowsç”µè„‘é‡è£…éƒ½éœ€è¦å®‰è£…é©±åŠ¨ç²¾çµï¼Œæ‰«æä¸€ä¸‹ç½‘å¡ï¼Œå£°å¡è¿™äº›é©±åŠ¨æœ‰æ²¡æœ‰å®‰è£…æˆåŠŸï¼Œç°åœ¨ubuntuç³»ç»Ÿé‡è£…æˆ‘æ€ä¹ˆå°±æ²¡æƒ³åˆ°å‘¢ï¼Œè€Œä¸”å­¦armçš„æ—¶å€™ä¹Ÿæ˜¯ï¼Œä¸€èˆ¬æ˜¯ç½‘å¡é©±åŠ¨çš„é—®é¢˜ã€‚</p><p>å…·ä½“è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p><h3 id="1-ç»ˆç«¯è¾“å…¥"><a href="#1-ç»ˆç«¯è¾“å…¥" class="headerlink" title="1.ç»ˆç«¯è¾“å…¥"></a>1.ç»ˆç«¯è¾“å…¥</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lspci</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ç½‘å¡å‹å·</p><h3 id="2-é€šè¿‡å¦ä¸€å°å¯ä»¥ä¸Šç½‘çš„ç”µè„‘ï¼Œåœ¨å®˜ç½‘ä¸‹è½½å¯¹åº”å‹å·"><a href="#2-é€šè¿‡å¦ä¸€å°å¯ä»¥ä¸Šç½‘çš„ç”µè„‘ï¼Œåœ¨å®˜ç½‘ä¸‹è½½å¯¹åº”å‹å·" class="headerlink" title="2.é€šè¿‡å¦ä¸€å°å¯ä»¥ä¸Šç½‘çš„ç”µè„‘ï¼Œåœ¨å®˜ç½‘ä¸‹è½½å¯¹åº”å‹å·"></a>2.é€šè¿‡å¦ä¸€å°å¯ä»¥ä¸Šç½‘çš„ç”µè„‘ï¼Œåœ¨å®˜ç½‘ä¸‹è½½å¯¹åº”å‹å·</h3><p><img src="https://img-blog.csdnimg.cn/23e51a1e888d4a1f8b51c1b16cd77964.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5piO5b63emh1YW5n,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="3-ä¸‹è½½å®Œä¹‹åï¼Œè¿˜éœ€è¦ä¸‹è½½build-essentialæ–‡ä»¶åŒ…ã€‚ä¸‹é¢ç»™å‡ºé“¾æ¥ï¼Œå¯æ‰“åŒ…ä¸‹è½½è‡³ç”µè„‘ä¸­ã€‚"><a href="#3-ä¸‹è½½å®Œä¹‹åï¼Œè¿˜éœ€è¦ä¸‹è½½build-essentialæ–‡ä»¶åŒ…ã€‚ä¸‹é¢ç»™å‡ºé“¾æ¥ï¼Œå¯æ‰“åŒ…ä¸‹è½½è‡³ç”µè„‘ä¸­ã€‚" class="headerlink" title="3.ä¸‹è½½å®Œä¹‹åï¼Œè¿˜éœ€è¦ä¸‹è½½build-essentialæ–‡ä»¶åŒ…ã€‚ä¸‹é¢ç»™å‡ºé“¾æ¥ï¼Œå¯æ‰“åŒ…ä¸‹è½½è‡³ç”µè„‘ä¸­ã€‚"></a>3.ä¸‹è½½å®Œä¹‹åï¼Œè¿˜éœ€è¦ä¸‹è½½build-essentialæ–‡ä»¶åŒ…ã€‚ä¸‹é¢ç»™å‡ºé“¾æ¥ï¼Œå¯æ‰“åŒ…ä¸‹è½½è‡³ç”µè„‘ä¸­ã€‚</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">é“¾æ¥ï¼šhttps</span>:<span class="string">//pan.baidu.com/s/1Zr1B-PO7O_htbWl4kbCfbw </span></span><br><span class="line"><span class="meta">æå–ç ï¼š6666</span> <span class="string"></span></span><br></pre></td></tr></table></figure><p>4.å°†ä¸Šè¿°å››ä¸ªæ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ä¸”æ‹·è´è‡³Uç›˜ï¼Œå†å¤åˆ¶åˆ°Ubuntu18.04 lstç³»ç»Ÿçš„æŸä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼ˆå°ç¼–å°†å…¶å¤åˆ¶åˆ°downloadsæ–‡ä»¶å¤¹ä¸‹ï¼‰ã€‚</p><p><img src="https://img-blog.csdnimg.cn/70c8ba602c474a6395f76dd9b97a664b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5piO5b63emh1YW5n,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="5-è¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œç„¶åé¼ æ ‡å³å‡»é€‰æ‹©â€œopen-Ternimalâ€è¿›å…¥ç»ˆç«¯ã€‚"><a href="#5-è¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œç„¶åé¼ æ ‡å³å‡»é€‰æ‹©â€œopen-Ternimalâ€è¿›å…¥ç»ˆç«¯ã€‚" class="headerlink" title="5.è¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œç„¶åé¼ æ ‡å³å‡»é€‰æ‹©â€œopen Ternimalâ€è¿›å…¥ç»ˆç«¯ã€‚"></a>5.è¿›å…¥è¯¥æ–‡ä»¶å¤¹ï¼Œç„¶åé¼ æ ‡å³å‡»é€‰æ‹©â€œopen Ternimalâ€è¿›å…¥ç»ˆç«¯ã€‚</h3><p>ï¼ˆ1ï¼‰ä¾æ¬¡cdè¿›å…¥gccã€makeã€build-essentialç›®å½•ï¼Œæ‰§è¡Œ</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sudo</span> <span class="string">dpkg -i *.deb</span></span><br></pre></td></tr></table></figure><p>å‘½ä»¤è¿›è¡Œå®‰è£…å³å¯ã€‚ï¼ˆæ³¨æ„ï¼šä¸æŒ‰gccã€makeã€build-essentialçš„é¡ºåºå®‰è£…å¯èƒ½å¯¼è‡´å¤±è´¥ã€‚ï¼‰<br>ï¼ˆ2ï¼‰ä¸Šè¿°å®‰è£…å®Œåï¼Œè¿›å…¥r8125-9.007.01æ–‡ä»¶å¤¹ï¼Œç»ˆç«¯æ‰§è¡Œ</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sudo</span> <span class="string">chmod +x autorun.sh</span></span><br><span class="line"><span class="attr">sudo</span> <span class="string">sh ./autorun.sh</span></span><br><span class="line"><span class="attr">å®Œæˆå®‰è£…ï¼ï¼ï¼</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="6-å†æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯æ˜¾ç¤ºæœ‰çº¿å›¾æ ‡"><a href="#6-å†æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯æ˜¾ç¤ºæœ‰çº¿å›¾æ ‡" class="headerlink" title="6.å†æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯æ˜¾ç¤ºæœ‰çº¿å›¾æ ‡"></a>6.å†æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯æ˜¾ç¤ºæœ‰çº¿å›¾æ ‡</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sudo</span> <span class="string">service network-manager stop</span></span><br><span class="line"><span class="attr">sudo</span> <span class="string">rm /var/lib/NetworkManager/NetworkManager.state</span></span><br><span class="line"><span class="attr">sudo</span> <span class="string">service network-manager start</span></span><br><span class="line"><span class="attr">sudo</span> <span class="string">gedit /etc/NetworkManager/NetworkManager.conf</span></span><br><span class="line"><span class="attr">ï¼ˆæŠŠfalseæ”¹æˆtrueï¼‰</span></span><br><span class="line"><span class="attr">sudo</span> <span class="string">service network-manager restart</span></span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://img-blog.csdnimg.cn/92a33a5a0ca44c4e8e6ab27fdeafac69.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ€è¿‘è¦ææ— äººæœºå¹³å°çš„å ¤åè¯†åˆ«ï¼Œå¼ è€å¸ˆä¹°å›æ¥ä¸€å°i9å¤„ç†å™¨çš„æœåŠ¡å™¨ï¼Œè®©æˆ‘é…ç½®ç¯å¢ƒï¼Œè°çŸ¥é“å®‰è£…äº†ç³»ç»Ÿubuntu18.04ä¹‹åæ— æ³•ä¸Šç½‘ï¼Œåˆšå¼€å§‹pingä¸åŒç™¾åº¦ï¼Œç„¶åifconfigï¼Œæç¤ºæ²¡æœ‰è¿™ä¸ªå·¥å…·ï¼Œå†ç„¶åsudo apt-get install net-tools æ²¡æœ‰å¯¹åº”çš„</summary>
      
    
    
    
    <category term="ubuntu" scheme="http://example.com/categories/ubuntu/"/>
    
    
    <category term="ubuntu" scheme="http://example.com/tags/ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>gitç²¾ç®€ç¯‡-å¿«é€Ÿä¸Šæ‰‹</title>
    <link href="http://example.com/2022/08/14/git%E7%B2%BE%E7%AE%80%E7%AF%87-%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/"/>
    <id>http://example.com/2022/08/14/git%E7%B2%BE%E7%AE%80%E7%AF%87-%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/</id>
    <published>2022-08-14T13:35:54.000Z</published>
    <updated>2022-12-11T02:30:14.954Z</updated>
    
    <content type="html"><![CDATA[<p>å‰ç«¯æ—¶é—´å†™äº†ä¸€å¤§ç¯‡å…³äºgitçš„ä½¿ç”¨æ–‡ç« ï¼Œæ„Ÿè§‰å¤ªæ‚ä¹±äº†ï¼Œä»Šå¤©å†™ä¸€ç¯‡æ¯”è¾ƒç²¾ç®€çš„å§ï¼</p><h3 id="ï¼ˆä¸€ï¼‰ç¬¬ä¸€æ¬¡ä¸Šä¼ æ—¶"><a href="#ï¼ˆä¸€ï¼‰ç¬¬ä¸€æ¬¡ä¸Šä¼ æ—¶" class="headerlink" title="ï¼ˆä¸€ï¼‰ç¬¬ä¸€æ¬¡ä¸Šä¼ æ—¶"></a>ï¼ˆä¸€ï¼‰ç¬¬ä¸€æ¬¡ä¸Šä¼ æ—¶</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1</span> <span class="string">å»ºç«‹åˆ›åº“ï¼Œå¤åˆ¶ä»“åº“é“¾æ¥åœ°å€</span></span><br><span class="line"><span class="attr">2</span> <span class="string">åœ¨ç›®å½•ä¸­ git init</span></span><br><span class="line"><span class="attr">3</span> <span class="string">git add .(.è¡¨ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæ–‡ä»¶ï¼‰</span></span><br><span class="line"><span class="attr">4</span> <span class="string">git commit -m &#x27;hh&#x27;</span></span><br><span class="line"><span class="attr">5</span> <span class="string">git remote add origin https://gitee.com/gao-minghui-jason/fundamentals-of-computer.gitï¼ˆæ³¨æ„httpåè®®è¿˜æ˜¯sshåè®®ï¼‰</span></span><br><span class="line"><span class="attr">6</span> <span class="string">git push --set-upstream origin master  ç„¶åä¸‹é¢è¿›è¡Œç»‘å®š</span></span><br><span class="line"><span class="attr">git</span> <span class="string">branch --set-upstream-to=origin/masterï¼ˆç»‘å®šæœ¬åœ°masterä¸è¿œç¨‹çš„masterï¼‰</span></span><br><span class="line"><span class="attr">7</span> <span class="string">ç”±äºç»‘å®šäº†ï¼Œå› æ­¤å¯ä»¥ç›´æ¥git pushï¼› git pull</span></span><br></pre></td></tr></table></figure><h3 id="ï¼ˆäºŒï¼‰-ç¬¬ä¸€æ¬¡æ‹‰å–æ—¶ï¼š"><a href="#ï¼ˆäºŒï¼‰-ç¬¬ä¸€æ¬¡æ‹‰å–æ—¶ï¼š" class="headerlink" title="ï¼ˆäºŒï¼‰ ç¬¬ä¸€æ¬¡æ‹‰å–æ—¶ï¼š"></a>ï¼ˆäºŒï¼‰ ç¬¬ä¸€æ¬¡æ‹‰å–æ—¶ï¼š</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1</span> <span class="string">git init</span></span><br><span class="line"><span class="attr">2</span> <span class="string">git remote add origin https://gitee.com/gao-minghui-jason/fundamentals-of-computer.gitï¼ˆæ³¨æ„httpåè®®è¿˜æ˜¯sshåè®®ï¼‰</span></span><br><span class="line"><span class="attr">3</span> <span class="string">git pull origin masterï¼ˆå¦‚æœæœ¬ç›®å½•æœ¬æ¥æœ‰å†…å®¹çš„è¯ï¼Œä¼šåˆå¹¶ï¼‰</span></span><br><span class="line"><span class="attr">4</span> <span class="string">git branch --set-upstream-to=origin/masterï¼ˆç»‘å®šæœ¬åœ°masterä¸è¿œç¨‹çš„masterï¼‰</span></span><br><span class="line"><span class="attr">5</span> <span class="string">ç”±äºç»‘å®šäº†ï¼Œå› æ­¤ä¸‹æ¬¡å¯ä»¥ç›´æ¥git pushï¼› git pull</span></span><br></pre></td></tr></table></figure><h3 id="ï¼ˆä¸‰ï¼‰è‡ªæ­¤ä¹‹åï¼Œæ¯æ¬¡æŒ‰ç…§æµç¨‹ï¼š"><a href="#ï¼ˆä¸‰ï¼‰è‡ªæ­¤ä¹‹åï¼Œæ¯æ¬¡æŒ‰ç…§æµç¨‹ï¼š" class="headerlink" title="ï¼ˆä¸‰ï¼‰è‡ªæ­¤ä¹‹åï¼Œæ¯æ¬¡æŒ‰ç…§æµç¨‹ï¼š"></a>ï¼ˆä¸‰ï¼‰è‡ªæ­¤ä¹‹åï¼Œæ¯æ¬¡æŒ‰ç…§æµç¨‹ï¼š</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1</span> <span class="string">git pull </span></span><br><span class="line"><span class="attr">2</span> <span class="string">ä¿®æ”¹ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰</span></span><br><span class="line"><span class="attr">3</span> <span class="string">git add .  &amp;&amp;  git commit -m &#x27;hh&#x27;  &amp;&amp; git pull &amp;&amp; git push æ¥æ“ä½œã€‚</span></span><br></pre></td></tr></table></figure><p>å¦‚æœç¬¬3æ­¥çš„pull æç¤ºè¿œç¨‹å†…å®¹è·Ÿç¬¬1æ­¥çš„pullä¸åŒæ—¶ï¼Œæ·»åŠ æè¿°ï¼Œé€‰æ‹©ç»§ç»­æ“ä½œï¼ˆä¹Ÿå°±æ˜¯é»˜è®¤åˆå¹¶åˆ°æœ¬åœ°ï¼‰ï¼Œç„¶åç»§ç»­git pushã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å‰ç«¯æ—¶é—´å†™äº†ä¸€å¤§ç¯‡å…³äºgitçš„ä½¿ç”¨æ–‡ç« ï¼Œæ„Ÿè§‰å¤ªæ‚ä¹±äº†ï¼Œä»Šå¤©å†™ä¸€ç¯‡æ¯”è¾ƒç²¾ç®€çš„å§ï¼&lt;/p&gt;
&lt;h3 id=&quot;ï¼ˆä¸€ï¼‰ç¬¬ä¸€æ¬¡ä¸Šä¼ æ—¶&quot;&gt;&lt;a href=&quot;#ï¼ˆä¸€ï¼‰ç¬¬ä¸€æ¬¡ä¸Šä¼ æ—¶&quot; class=&quot;headerlink&quot; title=&quot;ï¼ˆä¸€ï¼‰ç¬¬ä¸€æ¬¡ä¸Šä¼ æ—¶&quot;&gt;&lt;/a&gt;ï¼ˆä¸€ï¼‰ç¬¬ä¸€æ¬¡ä¸Šä¼ æ—¶&lt;/h</summary>
      
    
    
    
    <category term="git" scheme="http://example.com/categories/git/"/>
    
    
    <category term="git" scheme="http://example.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>çˆ¬è™«-æ–°å† ç–«æƒ…æ•°æ®</title>
    <link href="http://example.com/2022/08/14/%E7%88%AC%E8%99%AB-%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE/"/>
    <id>http://example.com/2022/08/14/%E7%88%AC%E8%99%AB-%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE/</id>
    <published>2022-08-14T13:30:38.000Z</published>
    <updated>2022-12-11T02:30:17.330Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©å›é¡¾ä»¥å‰åšçš„å¥½å¤šé¡¹ç›®éƒ½æ²¡æœ‰è®°å½•ä¸‹æ¥ï¼Œè¶è¿™ä¸¤å¤©æœ‰æ—¶é—´èµ¶ç´§å†™å‡ ç¯‡åšå®¢å“ˆï¼å…ˆå†™å†™ç”¨pythonå†™çš„çˆ¬è™«é¡¹ç›®</p><p>1.åˆ©ç”¨Pythonçˆ¬è™«è®¿é—®å¹¶çˆ¬å–ä¸€æ¬¡æ–°å‹å† çŠ¶ç—…æ¯’ç›¸å…³ç½‘é¡µå¦‚ç™¾åº¦ç½‘ã€ä¸é¦™å›­ç­‰çš„ç–«æƒ…æ–°é—»æ•°æ®ï¼Œä¿å­˜ä¸ºjsonæ–‡ä»¶æ ¼å¼ï¼Œå¹¶ä¸”ä¿å­˜æ‰€æœ‰å†å²æ•°æ®çš„æ›´æ–°ï¼Œä»¥ä¾¿åœ¨æœªæ¥å›æº¯åˆ†æç—…æƒ…æ—¶æä¾›æ ·æœ¬ã€‚</p><p>2.çˆ¬å–å„ä¸ªç½‘é¡µå…³äºç–«æƒ…çš„æŠ¥é“æ•°æ®ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œåˆ†ç±»æ•´åˆï¼Œå¦‚æœ€æ–°å…¨å›½å„çœç–«æƒ…æ•°æ®ï¼Œä¸–ç•Œå„å›½ç–«æƒ…æ•°æ®ï¼Œä¸–ç•Œå„å›½ä»¥åŠä¸­å›½å„çœç­‰ä»2020å¹´1æœˆä»½æˆªæ­¢ä»Šæ—¥ä¸ºæ­¢çš„æ‰€æœ‰å†å²æ•°æ®ç­‰ã€‚</p><h2 id="1-æŠ“å–åŒ…å«æ‰€æœ‰ç–«æƒ…ä¿¡æ¯çš„API"><a href="#1-æŠ“å–åŒ…å«æ‰€æœ‰ç–«æƒ…ä¿¡æ¯çš„API" class="headerlink" title="1  æŠ“å–åŒ…å«æ‰€æœ‰ç–«æƒ…ä¿¡æ¯çš„API"></a>1  æŠ“å–åŒ…å«æ‰€æœ‰ç–«æƒ…ä¿¡æ¯çš„API</h2><p>é¦–å…ˆï¼Œä»¥ç™¾åº¦ç½‘ä¸ºä¾‹ï¼Œç”¨æµè§ˆå™¨æ‰“å¼€ç›®æ ‡ç½‘ç«™ï¼ŒæŒ‰ä¸‹F12è¿›å…¥webå¼€å‘è€…æ¨¡å¼ï¼Œè¿›å…¥networkæ¨¡å—å¹¶åˆ·æ–°ç½‘é¡µï¼š</p><p><img src="/img/%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E7%88%AC%E8%99%AB/1.jpg" alt="1"></p><p>ç„¶åï¼ŒæŒ‰ç±»å‹è¿›è¡Œæ’åºï¼Œæ‰¾åˆ°jsonæ ¼å¼çš„æ–‡ä»¶ï¼Œç½‘ç«™ä»æœåŠ¡å™¨è·å–æ•°æ®çš„æ–¹æ³•ä¸ºgetï¼Œä»è€Œé”å®šå…¶ä¸­è¯·æ±‚ã€‚</p><p>æœ€åï¼Œåœ¨æ¶ˆæ¯å¤´ä¸­æ‰¾åˆ°ç›¸åº”çš„è¯·æ±‚ç½‘å€è¿›è¡Œæ’æŸ¥ï¼Œä»è€Œé¡ºåˆ©æ‰¾åˆ°æ•°æ®æ¥å£ã€‚</p><h2 id="2-æ•°æ®çˆ¬å–åŠå¤„ç†"><a href="#2-æ•°æ®çˆ¬å–åŠå¤„ç†" class="headerlink" title="2 æ•°æ®çˆ¬å–åŠå¤„ç†"></a>2 æ•°æ®çˆ¬å–åŠå¤„ç†</h2><h4 id="ï¼ˆ1ï¼‰éœ€è¦å¯¼å…¥çš„åŒ…ï¼š"><a href="#ï¼ˆ1ï¼‰éœ€è¦å¯¼å…¥çš„åŒ…ï¼š" class="headerlink" title="ï¼ˆ1ï¼‰éœ€è¦å¯¼å…¥çš„åŒ…ï¼š"></a>ï¼ˆ1ï¼‰éœ€è¦å¯¼å…¥çš„åŒ…ï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.animation <span class="keyword">as</span> animation</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> map_draw</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> wordcloud <span class="keyword">import</span> WordCloud</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pyecharts <span class="keyword">import</span> options <span class="keyword">as</span> opts</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pyecharts.charts <span class="keyword">import</span> Map</span><br></pre></td></tr></table></figure><h4 id="ï¼ˆ2ï¼‰ç¨‹åºä¸»ä½“ï¼š"><a href="#ï¼ˆ2ï¼‰ç¨‹åºä¸»ä½“ï¼š" class="headerlink" title="ï¼ˆ2ï¼‰ç¨‹åºä¸»ä½“ï¼š"></a>ï¼ˆ2ï¼‰ç¨‹åºä¸»ä½“ï¼š</h4><p>ç¨‹åºé€šè¿‡requestså…ˆè·å–ä¸»é¡µé¢çš„æ•°æ®ä¿¡æ¯ï¼Œç„¶ååˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–å¹¶åˆ†æå½“å‰æœ€æ–°ç–«æƒ…æ•°æ®ä¿¡æ¯ä¿å­˜åˆ°jsonæ ¼å¼çš„æ–‡ä»¶ä¸­å»ï¼Œå†æå–æœ‰ç”¨ä¿¡æ¯ä¿å­˜åˆ°xlsxè¡¨æ ¼ä¸­å»ï¼Œç„¶åç”Ÿæˆè¯äº‘å›¾ï¼Œç”Ÿæˆåœ°å›¾ï¼Œç„¶åä¸‹è½½è¿‡å¾€å†å²æ•°æ®ï¼Œå†è¿›è¡ŒåŠ¨æ€å›¾çš„å¯è§†åŒ–æ˜¾ç¤ºã€‚</p><h2 id="3-æ¯ä¸€æ­¥çš„å…·ä½“ä»‹ç»"><a href="#3-æ¯ä¸€æ­¥çš„å…·ä½“ä»‹ç»" class="headerlink" title="3 æ¯ä¸€æ­¥çš„å…·ä½“ä»‹ç»"></a>3 æ¯ä¸€æ­¥çš„å…·ä½“ä»‹ç»</h2><h4 id="ï¼ˆ1ï¼‰æœ€æ–°ä¸€å¤©ç–«æƒ…æ•°æ®é‡‡é›†ï¼š"><a href="#ï¼ˆ1ï¼‰æœ€æ–°ä¸€å¤©ç–«æƒ…æ•°æ®é‡‡é›†ï¼š" class="headerlink" title="ï¼ˆ1ï¼‰æœ€æ–°ä¸€å¤©ç–«æƒ…æ•°æ®é‡‡é›†ï¼š"></a>ï¼ˆ1ï¼‰æœ€æ–°ä¸€å¤©ç–«æƒ…æ•°æ®é‡‡é›†ï¼š</h4><p>è¯»å–ç½‘å€ä¿¡æ¯ <a href="https://ncov.dxy.cn/ncovh5/view/pneumonia%EF%BC%8C">https://ncov.dxy.cn/ncovh5/view/pneumoniaï¼Œ</a> è·å¾—æœ€è¿‘ä¸€å¤©æ–°å† çŠ¶ç—…æ¯’çš„æ•°æ®ä¿¡æ¯ä»¥åŠé’ˆå¯¹æ”¶é›†åˆ°çš„æ•°æ®è¿›è¡Œå¤„ç†å¹¶ä¿å­˜ä¸ºjsonæ–‡æœ¬ï¼Œæœ€æ–°ä¸€å¤©çš„ä¸–ç•Œå„å›½ç–«æƒ…ä¿¡æ¯è·Ÿæœ€æ–°ä¸€å¤©çš„ä¸­å›½å„çœæ•°æ®çš„æå–æ–¹æ³•ä¸åŒä¹‹å¤„åœ¨äºï¼šå‰è€…æ˜¯é€šè¿‡å±æ€§idä¸ºgetListByCountryTypeService2trueæ¥è·å–åˆ°æ ‡ç­¾ï¼Œè€Œåè€…æ˜¯é€šè¿‡å±æ€§id= getAreaStatæ¥è·å¾—æ ‡ç­¾ï¼Œè·å–åˆ°æ•°æ®åå†é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æ¥è·å–jsonæ ¼å¼çš„å­—ç¬¦ä¸²å¹¶ä¿å­˜jsonæ ¼å¼æ–‡ä»¶ï¼›ç„¶åå†ä¿å­˜åˆ°exclæ–‡ä»¶ä¸­ï¼</p><p><img src="/img/%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E7%88%AC%E8%99%AB/2.jpg"></p><p><img src="/img/%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E7%88%AC%E8%99%AB/3.jpg" alt="3"></p><h4 id="ï¼ˆ2ï¼‰è¿‡å¾€å†å²ç–«æƒ…æ•°æ®æ”¶é›†ï¼š"><a href="#ï¼ˆ2ï¼‰è¿‡å¾€å†å²ç–«æƒ…æ•°æ®æ”¶é›†ï¼š" class="headerlink" title="ï¼ˆ2ï¼‰è¿‡å¾€å†å²ç–«æƒ…æ•°æ®æ”¶é›†ï¼š"></a>ï¼ˆ2ï¼‰è¿‡å¾€å†å²ç–«æƒ…æ•°æ®æ”¶é›†ï¼š</h4><p>é¦–å…ˆåŠ è½½ç”±ä¸Šé¢è¯»å–ç½‘å€ä¿¡æ¯  <a href="https://ncov.dxy.cn/ncovh5/view/pneumonia">https://ncov.dxy.cn/ncovh5/view/pneumonia</a>  ååˆ†ææå–æœ‰ç”¨ä¿¡æ¯ä¿å­˜çš„jsonæ–‡ä»¶æ•°æ®ï¼Œé‡Œé¢ä¿å­˜äº†å„ä¸ªå›½å®¶æˆ–è€…å„å›½çœçš„æœ€æ–°ä¸€å¤©æ•°æ®ï¼Œè¿˜æœ‰https://â€¦.jsoné“¾æ¥ï¼Œå¯ä»¥é€šè¿‡requestæ¨¡å—å¯¹è¿™äº›é“¾æ¥è¿›è¡Œè®¿é—®ç„¶åç¼–ç ï¼Œæå–åˆ°æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå¦‚ï¼šæŒ‰ç…§å­—å…¸ä¸ºä¿å­˜å•ä½ï¼Œä¸€ä¸ªå­—å…¸è¡¨ç¤ºä¸€ä¸ªå›½å®¶çš„ä¸€å¤©çš„ç–«æƒ…æ•°æ®ï¼Œç„¶åè¿™äº›å­—å…¸æ•°æ®åˆ©ç”¨pythonåˆ—è¡¨å¯¹è±¡çš„extendæ–¹æ³•ç»„åˆæˆä¸ºä¸€ä¸ªåŒ…å«äº†å„ä¸ªå›½å®¶å„ä¸ªä¸åŒæ—¥æœŸçš„ç–«æƒ…æ•°æ®ï¼Œç»„åˆæˆä¸€ä¸ªå¤§çš„åˆ—è¡¨ï¼Œç„¶åä¿å­˜ä¸ºjsonæ–‡ä»¶ï¼Œä»¥ä¾¿æˆ‘ä»¬åé¢åŠ¨æ€å›¾æ˜¾ç¤ºæ•°æ®æ—¶åšå‡†å¤‡ã€‚</p><p><img src="/img/%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E7%88%AC%E8%99%AB/4.jpg" alt="4"></p><h4 id="ï¼ˆ3ï¼‰è¯äº‘å›¾çš„ç”Ÿæˆï¼š"><a href="#ï¼ˆ3ï¼‰è¯äº‘å›¾çš„ç”Ÿæˆï¼š" class="headerlink" title="ï¼ˆ3ï¼‰è¯äº‘å›¾çš„ç”Ÿæˆï¼š"></a>ï¼ˆ3ï¼‰è¯äº‘å›¾çš„ç”Ÿæˆï¼š</h4><p>ç”Ÿæˆçš„è¯äº‘å›¾æœ‰ä¸¤å¼ ï¼Œæ ¹æ®å…¨å›½å„çœç´¯è®¡ç¡®è¯Šè¿˜æœ‰ä¸–ç•Œå„å›½çš„ç´¯è®¡ç¡®è¯Šäººæ•°è€Œç”Ÿæˆçš„è¯äº‘å›¾ã€‚è¯äº‘å›¾ä¸Šé¢çš„å­—ä½“æ ¼å¼å¯ä»¥æ ¹æ®è‡ªå·±windowsä¸Šçš„fontè‡ªè¡Œè°ƒæ•´ã€‚åˆ©ç”¨äº†è¯äº‘å›¾æ›´åŠ ç›´è§‚çš„çœ‹åˆ°äº†é‚£ä¸ªåœ°æ–¹çš„ç´¯è®¡ç¡®è¯Šäººæ•°çš„å¯¹æ¯”</p><p>1 å›½å†…ç–«æƒ…è¯äº‘å›¾å¦‚ä¸‹ï¼š</p><p><img src="/img/%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E7%88%AC%E8%99%AB/6.jpg" alt="6"></p><p>2 ä¸–ç•Œå„å›½ç–«æƒ…è¯äº‘å›¾å¦‚ä¸‹ï¼š</p><p><img src="/img/%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E7%88%AC%E8%99%AB/7.jpg" alt="7"></p><h4 id="ï¼ˆ4ï¼‰ç–«æƒ…åœ°å›¾çš„ç”Ÿæˆï¼š"><a href="#ï¼ˆ4ï¼‰ç–«æƒ…åœ°å›¾çš„ç”Ÿæˆï¼š" class="headerlink" title="ï¼ˆ4ï¼‰ç–«æƒ…åœ°å›¾çš„ç”Ÿæˆï¼š"></a>ï¼ˆ4ï¼‰ç–«æƒ…åœ°å›¾çš„ç”Ÿæˆï¼š</h4><p>Matplotlibä¸­çš„Basemapå®ƒå…·æœ‰ä¸“ä¸šæ ‡å‡†çš„åœ°å›¾ç»˜åˆ¶å·¥å…·ã€‚å®ƒå¯ä»¥ä¸matplotlibçš„ä¸€èˆ¬ç»˜å›¾åŠŸèƒ½ç›¸ç»“åˆï¼Œå¹¶åœ¨åœ°å›¾ä¸Šç»˜åˆ¶æ•°æ®ã€‚ Matplotlibçš„Basemapå·¥å…·åŒ…æ˜¯ä¸€ä¸ªç”¨äºåœ¨Pythonä¸­çš„åœ°å›¾ä¸Šç»˜åˆ¶2Dæ•°æ®çš„åº“ã€‚æœ¬å®éªŒä½¿ç”¨basemapåº“æ¥æ„å»ºä¸­å›½çš„åœ°å›¾æ¨¡å‹å±•ç¤ºã€‚</p><p><img src="/img/%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E7%88%AC%E8%99%AB/5.jpg" alt="5"></p><p><img src="/img/%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E7%88%AC%E8%99%AB/10.jpg" alt="10"></p><h4 id="ï¼ˆ5ï¼‰åŠ¨æ€å›¾æ˜¾ç¤ºå†å²ç¡®è¯Šæ•°æ®ï¼š"><a href="#ï¼ˆ5ï¼‰åŠ¨æ€å›¾æ˜¾ç¤ºå†å²ç¡®è¯Šæ•°æ®ï¼š" class="headerlink" title="ï¼ˆ5ï¼‰åŠ¨æ€å›¾æ˜¾ç¤ºå†å²ç¡®è¯Šæ•°æ®ï¼š"></a>ï¼ˆ5ï¼‰åŠ¨æ€å›¾æ˜¾ç¤ºå†å²ç¡®è¯Šæ•°æ®ï¼š</h4><p>FuncAnimationæ˜¯Matplotlibåº“ä¸ºæˆ‘ä»¬æä¾›çš„ç”¨äºç»˜åˆ¶åŠ¨æ€å›¾åƒçš„æ¥å£ï¼Œå…¶ä¸­åŒ…å«å¦‚ä¸‹å‚æ•°ï¼šfigï¼šç”»å¸ƒå¯¹è±¡ï¼Œç”±åˆ›å»ºç”»å¸ƒæ—¶çš„è¿”å›å¾—åˆ°ï¼Œå³fig = plt.figure()  framesï¼šæŒ‡å®šåŠ¨å›¾çš„å¸§æ•°ï¼Œä½†è¿™ä¸ªå‚æ•°ç±»å‹å¿…é¡»æ˜¯å¯è¿­ä»£çš„åˆ—è¡¨ç­‰ã€‚æ¯æ¬¡è°ƒç”¨funcå‡½æ•°å¯¹å›¾åƒè¿›è¡Œæ›´æ–°æ—¶ï¼Œæ¥å£å°†è‡ªåŠ¨å‘funcå‡½æ•°æä¾›æ­¤æ—¶çš„å¸§æ•°numï¼Œè¿™ä½¿å¾—æ›´æ–°æ•°æ®ååˆ†æ–¹ä¾¿ã€‚funcï¼šç”¨äºæ›´æ–°å›¾ç‰‡ä»è€Œäº§ç”ŸåŠ¨æ€æ•ˆæœçš„è°ƒç”¨å‡½æ•°ï¼Œåœ¨ç¼–å†™æ—¶é€šå¸¸ä¼šç”¨åˆ°set_dataç­‰ç±»ä¼¼çš„æ–¹æ³•ï¼Œå…¶è¿”å›å€¼æ˜¯ä¸€ä¸ªå…ƒç´ ä¸ºè¢«æ›´æ–°çš„å›¾å½¢å¯¹è±¡çš„åˆ—è¡¨ã€‚åŒæ—¶ï¼Œfuncå¯ä»¥æ¥å—å¸§æ•°å‚æ•°numï¼Œç”¨æ¥æ›´æ–°æ¯å¸§å›¾åƒã€‚å…·ä½“å†…å®¹æˆ‘ä»¬å°†åœ¨ç¤ºä¾‹ä¸­çœ‹åˆ°ã€‚intervalï¼šæ›´æ–°é¢‘ç‡ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚è¿™é‡Œçš„intervalå‚æ•°å·²ç»è°ƒæ•´çš„éå¸¸å°äº†ï¼Œä½†æ˜¯æ„Ÿè§‰è¿˜æ˜¯ä¸å¤Ÿå¿«ï¼Œæ˜¯å› ä¸ºæ•°æ®é‡å¤ªåºå¤§äº†ï¼Œå–æ•°æ®çš„è¿‡ç¨‹ä¼šç•¥æœ‰å»¶è¿Ÿï¼Œå› æ­¤æœ€ç»ˆåªå–å€¼ä¸º10msã€‚</p><p><img src="/img/%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E7%88%AC%E8%99%AB/8.jpg" alt="8"></p><p><img src="/img/%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E7%88%AC%E8%99%AB/9.jpg" alt="9"></p><h2 id="4æ€»ç»“"><a href="#4æ€»ç»“" class="headerlink" title="4æ€»ç»“"></a>4æ€»ç»“</h2><p>â€‹       æœ¬æ¬¡ä¸»è¦æ˜¯å¯¹æ–°å† è‚ºç‚ç–«æƒ…çš„æ•°æ®é‡‡é›†ï¼Œåˆ©ç”¨pythonçˆ¬è™«å¯¹ç™¾åº¦ã€ä¸é¦™å›­ç­‰ç½‘ç«™è¿›è¡Œæ•°æ®çˆ¬å–ï¼Œå¾—åˆ°äº†ä¸­å›½æ•´ä½“ã€å„çœå¸‚ä»¥åŠä¸–ç•Œå„å›½çš„ç–«æƒ…å®æ—¶æ•°æ®å’Œå†å²ç»Ÿè®¡æ•°æ®ï¼Œèƒ½æ¸…æ¥šçš„çŸ¥é“äº†å„æ—¶å„åœ°å„é¡¹çš„æ‚£è€…äººæ•°ï¼Œæ¯”å¦‚è¯´ç´¯è®¡ç¡®è¯Šï¼Œç°æœ‰ç¡®è¯Šï¼Œæ²»æ„ˆäººæ•°ï¼Œæ­»äº¡äººæ•°ç­‰ç­‰æ•°æ®ã€‚åŒæ—¶ï¼Œåˆ©ç”¨çˆ¬å–åˆ°çš„æ•°æ®å¯¹æ–°å† ç–«æƒ…è¿›è¡Œå¯è§†åŒ–åˆ†æï¼Œæ¯”å¦‚è¯´åˆ©ç”¨åˆ°äº†åœ°å›¾ï¼Œè¯äº‘å›¾ï¼ŒåŠ¨æ€å›¾ç­‰å¯è§†åŒ–æ–¹å¼ï¼Œä»¥ä¾¿æ›´ç›´è§‚äº†è§£ç–«æƒ…å½¢å¼ã€‚</p><p>â€‹        ä¸è¶³çš„åœ°æ–¹æ˜¯æ²¡æœ‰åˆ©ç”¨çˆ¬å–åˆ°çš„æ–°å† ç–«æƒ…æ•°æ®æ¥è¿›è¡Œæ·±å…¥åˆ†ææ•´ç†ï¼Œæ¯”å¦‚å¯¹æ–°å† ç–«æƒ…çš„å½¢å¼ã€è§„å¾‹ä»¥åŠèµ°åŠ¿è¿›è¡Œé¢„æµ‹ï¼Œåç»­çš„å·¥ä½œæ˜¯å¯¹å¯†åˆ‡æ¥è§¦è€…çš„è½¨è¿¹æ•°æ®è¿›è¡Œæ›´è¯¦ç»†çˆ¬å–ï¼Œå¾—åˆ°æ›´å…¨é¢çš„æ•°æ®ï¼Œæ–¹ä¾¿ç–«æƒ…çš„å…¨é¢é˜²æ§ã€‚</p><p>æœ€åç”±è¡·æ„Ÿè°¢å¥‹æˆ˜åœ¨ä¸€çº¿çš„æ‰€æœ‰äººå‘˜ï¼Œå¸Œæœ›ç–«æƒ…å¿«ç‚¹è¿‡å»ï¼ŒåŠ æ²¹åŠ æ²¹åŠ æ²¹ï¼ï¼ï¼</p><p><img src="/img/%E6%96%B0%E5%86%A0%E7%96%AB%E6%83%85%E6%95%B0%E6%8D%AE%E7%88%AC%E8%99%AB/11.gif" alt="11"></p><h3 id="ä»£ç ä¸‹è½½"><a href="#ä»£ç ä¸‹è½½" class="headerlink" title="ä»£ç ä¸‹è½½"></a>ä»£ç ä¸‹è½½</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps://pan.baidu.com/s/1LIWSzyy7KlfXxj7LdALq_g </span><br><span class="line">æå–ç ï¼š6666 </span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä»Šå¤©å›é¡¾ä»¥å‰åšçš„å¥½å¤šé¡¹ç›®éƒ½æ²¡æœ‰è®°å½•ä¸‹æ¥ï¼Œè¶è¿™ä¸¤å¤©æœ‰æ—¶é—´èµ¶ç´§å†™å‡ ç¯‡åšå®¢å“ˆï¼å…ˆå†™å†™ç”¨pythonå†™çš„çˆ¬è™«é¡¹ç›®&lt;/p&gt;
&lt;p&gt;1.åˆ©ç”¨Pythonçˆ¬è™«è®¿é—®å¹¶çˆ¬å–ä¸€æ¬¡æ–°å‹å† çŠ¶ç—…æ¯’ç›¸å…³ç½‘é¡µå¦‚ç™¾åº¦ç½‘ã€ä¸é¦™å›­ç­‰çš„ç–«æƒ…æ–°é—»æ•°æ®ï¼Œä¿å­˜ä¸ºjsonæ–‡ä»¶æ ¼å¼ï¼Œå¹¶ä¸”ä¿å­˜æ‰€æœ‰å†å²æ•°æ®çš„æ›´æ–°ï¼Œä»¥ä¾¿åœ¨æœªæ¥</summary>
      
    
    
    
    <category term="çˆ¬è™«" scheme="http://example.com/categories/%E7%88%AC%E8%99%AB/"/>
    
    
    <category term="python" scheme="http://example.com/tags/python/"/>
    
    <category term="æ–°å‹å† çŠ¶ç—…æ¯’" scheme="http://example.com/tags/%E6%96%B0%E5%9E%8B%E5%86%A0%E7%8A%B6%E7%97%85%E6%AF%92/"/>
    
    <category term="çˆ¬è™«" scheme="http://example.com/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>nginxå¯åŠ¨é‡åˆ°çš„ä¸€äº›é—®é¢˜</title>
    <link href="http://example.com/2022/08/13/nginx%E5%90%AF%E5%8A%A8%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/"/>
    <id>http://example.com/2022/08/13/nginx%E5%90%AF%E5%8A%A8%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/</id>
    <published>2022-08-13T07:05:52.000Z</published>
    <updated>2022-12-11T02:30:15.288Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-3-å®‰è£…Nginx"><a href="#1-3-å®‰è£…Nginx" class="headerlink" title="1.3.å®‰è£…Nginx"></a>1.3.å®‰è£…Nginx</h2><p>å®‰è£…éå¸¸ç®€å•ï¼Œå°†ä¸‹è½½çš„å®‰è£…åŒ…ç›´æ¥è§£å‹å³å¯ï¼šï¼ˆ<strong>æ³¨æ„è·¯å¾„ä¸èƒ½æœ‰ä¸­æ–‡è·¯å¾„</strong>ï¼‰</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/2%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20200111175232233.png" alt="image-20200111175232233"> </p><p>ç»¿è‰²å…å®‰è£…ï¼Œèˆ’æœï¼</p><p>è§£å‹åçš„ç›®å½•ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/2%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20200111175323969.png" alt="image-20200111175323969"> </p><p>nginxå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ¥å¯åŠ¨ï¼Œæ‰“å¼€CMDå‘½ä»¤è¡Œï¼Œç„¶åè¾“å…¥å‘½ä»¤ï¼š</p><ul><li><p>å¯åŠ¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start nginx.exe</span><br></pre></td></tr></table></figure></li><li><p>åœæ­¢ï¼š #########æ³¨æ„å•Šï¼Œ<strong>æ¯æ¬¡å¯åŠ¨å‰è¦å…ˆæŠŠnginxåœæ‰ï¼Œå› ä¸ºå‰é¢å¯åŠ¨çš„åœ¨åå°ï¼Œä½ è¦å…ˆå…³é—­</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx.exe -s stop   </span><br></pre></td></tr></table></figure></li><li><p>é‡æ–°åŠ è½½ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx.exe -s reload</span><br></pre></td></tr></table></figure></li></ul><p>å¯åŠ¨åï¼Œè®¿é—®ï¼š<a href="http://localhost/">http://localhost</a> å³å¯è®¿é—®nginxçš„é»˜è®¤é¡µé¢ï¼š</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/2%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20200111175634260.png" alt="image-20200111175634260"></p><p>ï¼ˆ<strong>ä¸ºä»€ä¹ˆè®¿é—®localhostå°±ä¼šè®¿é—®nginxå‘¢ï¼Ÿ</strong>ï¼‰å› ä¸ºnginxé…ç½®æ–‡ä»¶é‚£é‡Œç›‘å¬çš„åŸŸå+ç«¯å£å°±æ˜¯localhost:80ï¼Œè€Œhttpåè®®é»˜è®¤ç«¯å£å°±æ˜¯80</p><p>å°æ„å¤–ï¼šå½“è¿è¡Œ<strong>start nginx.exe æ—¶å‘ç”Ÿäº†æŠ¥é”™</strong>ï¼šnginx: [error] CreateFile() â€œD:\nginx-1.12.2/logs/nginx.pidâ€ failed (2: The system cannot find the file specified)ï¼Œä»æ—¥å¿—logç›®å½•ä¸‹çš„errorä¹Ÿå¯ä»¥çœ‹çœ‹æ˜æ˜¾çš„é”™è¯¯ä¿¡æ¯ï¼Œè¡¨ç¤ºæ²¡æœ‰å¯åŠ¨æˆåŠŸï¼Œ<strong>å†è¿è¡Œnginx.exe å‘½ä»¤æ—¶æŠ¥é”™</strong>ï¼šnginx: [emerg] bind() to 0.0.0.0:80 failed (10013: An attempt was made to access a socket in a way forbidden by its access permissions)ï¼Œè¡¨ç¤ºç«¯å£80è¢«å ç”¨äº†ï¼Œå› æ­¤éœ€è¦åˆ°confç›®å½•ä¸‹çš„confæ–‡ä»¶ï¼Œæ›´æ”¹ç›‘å¬ç«¯å£ï¼Œæ”¹ä¸º81åï¼Œç›´æ¥ä½¿ç”¨å‘½ä»¤start nginx.exeå°±å¯ä»¥è¿è¡ŒæˆåŠŸäº†ï¼Œç„¶ååœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š<a href="http://localhost:81/">http://localhost:81</a> å°±å¯ä»¥æ˜¾ç¤ºnginxçš„é»˜è®¤ç•Œé¢äº†ï¼Œä½†æ˜¯å‘ç”Ÿäº†ä¸­æ–‡ä¹±ç é—®é¢˜ï¼</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/2%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20220813144402171.png" alt="image-20220813144402171"></p><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•å°±æ˜¯æ‰¾åˆ°80ç«¯å£è¢«å ç”¨çš„è¿›ç¨‹çš„pidï¼Œç„¶åæ€æ­»è¿™ä¸ªâ€œæ— å…³ç´§è¦çš„è¿›ç¨‹â€ï¼Œé‚£ä¹ˆnginxä¾ç„¶å¯ä»¥ç›‘å¬80ç«¯å£!</p><h5 id="1-æ‰¾åˆ°80ç«¯å£è¢«å ç”¨çš„è¿›ç¨‹çš„pidï¼Œç”±å›¾å¯çŸ¥å¯¹åº”pidä¸º-65205"><a href="#1-æ‰¾åˆ°80ç«¯å£è¢«å ç”¨çš„è¿›ç¨‹çš„pidï¼Œç”±å›¾å¯çŸ¥å¯¹åº”pidä¸º-65205" class="headerlink" title="1 æ‰¾åˆ°80ç«¯å£è¢«å ç”¨çš„è¿›ç¨‹çš„pidï¼Œç”±å›¾å¯çŸ¥å¯¹åº”pidä¸º 65205"></a>1 æ‰¾åˆ°80ç«¯å£è¢«å ç”¨çš„è¿›ç¨‹çš„pidï¼Œç”±å›¾å¯çŸ¥å¯¹åº”pidä¸º 65205</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 netstat -aon|findstr &quot;80&quot;              </span><br></pre></td></tr></table></figure><p> netstat -aonè¡¨ç¤ºæŸ¥çœ‹æ‰€æœ‰è¿è¡Œä¸­çš„è¿›ç¨‹</p><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/2%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20220813145630635.png" alt="image-20220813145630635"></p><h5 id="2-æ€æ­»è¿›ç¨‹"><a href="#2-æ€æ­»è¿›ç¨‹" class="headerlink" title="2 æ€æ­»è¿›ç¨‹"></a>2 æ€æ­»è¿›ç¨‹</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskkill /pid 6520 /F</span><br></pre></td></tr></table></figure><p><img src="/img/java/06%E9%98%B6%E6%AE%B5%E4%B9%90%E4%BC%98%E5%95%86%E5%9F%8E%E9%A1%B9%E7%9B%AE/2%E5%88%86%E7%B1%BB%E7%AE%A1%E7%90%86/image-20220813145743411.png" alt="image-20220813145743411"></p><h5 id="nginxä¸­æ–‡ä¹±ç é—®é¢˜çš„è§£å†³ï¼š"><a href="#nginxä¸­æ–‡ä¹±ç é—®é¢˜çš„è§£å†³ï¼š" class="headerlink" title="nginxä¸­æ–‡ä¹±ç é—®é¢˜çš„è§£å†³ï¼š"></a>nginxä¸­æ–‡ä¹±ç é—®é¢˜çš„è§£å†³ï¼š</h5><p>å¾ˆç®€å•ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šç¼–ç æ ¼å¼ä¸ºuft-8å°±å¥½</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">server</span> &#123;</span><br><span class="line">    <span class="string">listen</span>       <span class="number">80</span><span class="string">;</span></span><br><span class="line">    <span class="string">server_name</span>  <span class="string">localhost;</span></span><br><span class="line">    <span class="string">charset</span> <span class="string">utf-8;</span></span><br><span class="line">    <span class="string">...</span></span><br></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1-3-å®‰è£…Nginx&quot;&gt;&lt;a href=&quot;#1-3-å®‰è£…Nginx&quot; class=&quot;headerlink&quot; title=&quot;1.3.å®‰è£…Nginx&quot;&gt;&lt;/a&gt;1.3.å®‰è£…Nginx&lt;/h2&gt;&lt;p&gt;å®‰è£…éå¸¸ç®€å•ï¼Œå°†ä¸‹è½½çš„å®‰è£…åŒ…ç›´æ¥è§£å‹å³å¯ï¼šï¼ˆ&lt;strong&gt;æ³¨æ„è·¯å¾„</summary>
      
    
    
    
    <category term="nginx" scheme="http://example.com/categories/nginx/"/>
    
    
    <category term="nginx" scheme="http://example.com/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>windowså®‰è£…å¤šä¸ªç‰ˆæœ¬çš„jdk</title>
    <link href="http://example.com/2022/08/11/windows%E5%AE%89%E8%A3%85%E5%A4%9A%E4%B8%AA%E7%89%88%E6%9C%AC%E7%9A%84jdk/"/>
    <id>http://example.com/2022/08/11/windows%E5%AE%89%E8%A3%85%E5%A4%9A%E4%B8%AA%E7%89%88%E6%9C%AC%E7%9A%84jdk/</id>
    <published>2022-08-11T13:20:13.000Z</published>
    <updated>2023-08-09T15:26:44.722Z</updated>
    
    <content type="html"><![CDATA[<p>å•ä¸ªjdkçš„å®‰è£…å¹¶é…ç½®ç¯å¢ƒè¯·å‚è€ƒï¼š<a href="https://blog.csdn.net/xhmico/article/details/122390181?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169008530616800213019317%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169008530616800213019317&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-4-122390181-null-null.142%5Ev90%5Econtrol_2,239%5Ev3%5Econtrol&utm_term=java%20%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE&spm=1018.2226.3001.4187">è¯·ç‚¹å‡»é“¾æ¥</a>ã€‚</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//blog.csdn.net/xhmico/article/details/122390181?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169008530616800213019317%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=169008530616800213019317&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-4-122390181-null-null.142^v90^control_2,239^v3^control&amp;utm_term=java%20%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE&amp;spm=1018.2226.3001.4187</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯jdk1.8ï¼ˆjdk8ï¼‰çš„å®‰è£…é…ç½®è¿‡ç¨‹ï¼Œè™½ç„¶jdk8æ¯”è¾ƒæ—§ï¼Œä½†æ˜¯ç¨³å®šï¼Œå¾ˆå¤šä¼ä¸šéƒ½æ˜¯ä½¿ç”¨çš„è¿™ä¸ªç‰ˆæœ¬ã€‚</p><h3 id="1-ä¸‹è½½"><a href="#1-ä¸‹è½½" class="headerlink" title="1 ä¸‹è½½"></a>1 ä¸‹è½½</h3><p>å®˜ç½‘åœ°å€ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//www.oracle.com/java/technologies/downloads/#java8-windows</span></span><br></pre></td></tr></table></figure><h3 id="2-å®‰è£…"><a href="#2-å®‰è£…" class="headerlink" title="2 å®‰è£…"></a>2 å®‰è£…</h3><p>ä¸‹è½½æˆåŠŸéƒ½åŒå‡»å®‰è£…å°±å¥½ï¼Œæ›´æ”¹å®‰è£…è·¯å¾„ï¼Œæˆ‘ä¸€èˆ¬æ˜¯å®‰è£…åˆ°Dç›˜æ²¡æœ‰ä¸­æ–‡ç¬¦å·çš„è·¯å¾„ä¸‹ï¼Œå½“ç„¶jdkæœ¬æ¥ä¸å¤§ï¼Œå¯ä»¥å®‰è£…åˆ°cç›˜ã€‚</p><h3 id="3-é…ç½®ç¯å¢ƒå˜é‡"><a href="#3-é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="3 é…ç½®ç¯å¢ƒå˜é‡"></a>3 é…ç½®ç¯å¢ƒå˜é‡</h3><p>å‚ç…§ä¸Šé¢é“¾æ¥å°±å¥½ä¸»è¦æ˜¯åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š</p><p>3.1 Java_Home é…ç½®ï¼šç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­æ·»åŠ JAVA_HOMEå˜é‡åï¼Œå˜é‡å€¼ä¸ºjdkå®‰è£…ç›®å½•ã€‚</p><p>3.2 Path é…ç½®ï¼šç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­çš„Pathå˜é‡ä¸­â€œç¼–è¾‘â€ç„¶åâ€œæ·»åŠ â€å¦‚ä¸‹ä¸¤ä¸ªå˜é‡ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">%Java_Home%\bin</span></span><br></pre></td></tr></table></figure><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">%Java_Home%\jre\bin</span></span><br></pre></td></tr></table></figure><p>3.3 CLASSPATH é…ç½®ï¼šç³»ç»Ÿå˜é‡ä¸­æ·»åŠ CLASSPATHå˜é‡ï¼Œå€¼ä¸ºï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">.;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar;</span></span><br></pre></td></tr></table></figure><p>3.1ä»¥åŠ3.2å·²ç»ç®—æ˜¯é…ç½®å¥½è¿è¡Œç¯å¢ƒäº†ï¼Œå…³äºCLASSPATHå˜é‡çš„ä½œç”¨ï¼Œè¯·å‚è€ƒæ­¤åšå®¢ï¼š<a href="https://blog.csdn.net/cuipp0509/article/details/74852740">é…ç½®JAVAç¯å¢ƒå˜é‡ä¸­CLASSPATHå˜é‡çš„ä½œç”¨</a></p><h3 id="é…ç½®å¤šä¸ªjdk"><a href="#é…ç½®å¤šä¸ªjdk" class="headerlink" title="é…ç½®å¤šä¸ªjdk"></a>é…ç½®å¤šä¸ªjdk</h3><p>ä¸‹è½½å®‰è£…å®Œå…¨è·Ÿä¸Šé¢ä¸€æ ·ï¼Œåªä¸è¿‡é…ç½®ç¯å¢ƒå˜é‡æ—¶ä¼šæœ‰ä¸ä¸€æ ·ï¼Œå…·ä½“è¯·å‚è€ƒï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">https</span>:<span class="string">//blog.csdn.net/weixin_52790678/article/details/125112899?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-125112899-blog-123652927.pc_relevant_multi_platform_whitelistv3&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-125112899-blog-123652927.pc_relevant_multi_platform_whitelistv3&amp;utm_relevant_index=1</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æŒ‰ç…§ä¸Šé¢çš„é…ç½®ï¼Œå¹¶æ²¡æœ‰ç”Ÿæ•ˆï¼å¯„ï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å•ä¸ªjdkçš„å®‰è£…å¹¶é…ç½®ç¯å¢ƒè¯·å‚è€ƒï¼š&lt;a href=&quot;https://blog.csdn.net/xhmico/article/details/122390181?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522</summary>
      
    
    
    
    <category term="java" scheme="http://example.com/categories/java/"/>
    
    
    <category term="java" scheme="http://example.com/tags/java/"/>
    
  </entry>
  
</feed>
