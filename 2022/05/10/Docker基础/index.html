<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Docker基础 | Jason</title><meta name="keywords" content="Docker"><meta name="author" content="高明辉"><meta name="copyright" content="高明辉"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="直击Docker的作用1技术存在的必然性,一个技术的存在都是为了解决指定的问题.    Docker介绍概述12345678910111213#什么是镜像?	将Linux程序基于运行环境打包，就是镜像，特征：			只读			分层，每一层都基于前一层，层称为Layer#什么是容器?	容器是镜像运行的一个实例。	是将镜像做只读拷贝后创建一层可写的Layer层，然后创建独立内存、网络等空间并运行。	特征">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker基础">
<meta property="og:url" content="http://example.com/2022/05/10/Docker%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="Jason">
<meta property="og:description" content="直击Docker的作用1技术存在的必然性,一个技术的存在都是为了解决指定的问题.    Docker介绍概述12345678910111213#什么是镜像?	将Linux程序基于运行环境打包，就是镜像，特征：			只读			分层，每一层都基于前一层，层称为Layer#什么是容器?	容器是镜像运行的一个实例。	是将镜像做只读拷贝后创建一层可写的Layer层，然后创建独立内存、网络等空间并运行。	特征">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/%E5%B0%81%E9%9D%A2.png">
<meta property="article:published_time" content="2022-05-10T03:14:24.000Z">
<meta property="article:modified_time" content="2022-08-12T09:26:11.232Z">
<meta property="article:author" content="高明辉">
<meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/%E5%B0%81%E9%9D%A2.png"><link rel="shortcut icon" href="/img/%E7%BD%91%E7%AB%99%E5%9B%BE%E6%A0%87.png"><link rel="canonical" href="http://example.com/2022/05/10/Docker%E5%9F%BA%E7%A1%80/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Docker基础',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-12 17:26:11'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Jason" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/%E5%A4%B4%E5%83%8F.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">178</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">206</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">35</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/timeline/"><i class="fa-fw fa fa-bell"></i><span> 日志</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 菜单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/%E5%85%B3%E4%BA%8E"><i class="fa-fw /about/"></i><span> 0</span></a></li><li><a class="site-page child" href="/myself"><i class="fa-fw /myself/"></i><span> 1</span></a></li><li><a class="site-page child" href="/butterfly%E4%B8%BB%E9%A2%98"><i class="fa-fw https://github.com/jerryc127/hexo-theme-butterfly/"></i><span> 2</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/%E5%B0%81%E9%9D%A2.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jason</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/timeline/"><i class="fa-fw fa fa-bell"></i><span> 日志</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 菜单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/%E5%85%B3%E4%BA%8E"><i class="fa-fw /about/"></i><span> 0</span></a></li><li><a class="site-page child" href="/myself"><i class="fa-fw /myself/"></i><span> 1</span></a></li><li><a class="site-page child" href="/butterfly%E4%B8%BB%E9%A2%98"><i class="fa-fw https://github.com/jerryc127/hexo-theme-butterfly/"></i><span> 2</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Docker基础</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-05-10T03:14:24.000Z" title="发表于 2022-05-10 11:14:24">2022-05-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-12T09:26:11.232Z" title="更新于 2022-08-12 17:26:11">2022-08-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Docker/">Docker</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Docker基础"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="直击Docker的作用"><a href="#直击Docker的作用" class="headerlink" title="直击Docker的作用"></a>直击Docker的作用</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">技术存在的必然性,一个技术的存在都是为了解决指定的问题.</span><br></pre></td></tr></table></figure>

<p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210610090947848.png" alt="image-20210610090947848"></p>
<p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210628090441036.png" alt="image-20210628090441036"></p>
<h1 id="Docker介绍"><a href="#Docker介绍" class="headerlink" title="Docker介绍"></a>Docker介绍</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#什么是镜像?</span></span><br><span class="line">	<span class="attr">将Linux程序基于运行环境打包，就是镜像，特征：</span></span><br><span class="line">			<span class="attr">只读</span></span><br><span class="line">			<span class="attr">分层，每一层都基于前一层，层称为Layer</span></span><br><span class="line"><span class="comment">#什么是容器?</span></span><br><span class="line">	<span class="attr">容器是镜像运行的一个实例。</span></span><br><span class="line">	<span class="attr">是将镜像做只读拷贝后创建一层可写的Layer层，然后创建独立内存、网络等空间并运行。</span></span><br><span class="line">	<span class="attr">特征：</span></span><br><span class="line">			<span class="attr">容器是宿主机的一个独立进程。</span></span><br><span class="line">			<span class="attr">多个容器间相互独立</span></span><br><span class="line">			<span class="attr">容器操作不影响镜像</span></span><br><span class="line"><span class="comment">#Docker作用?</span></span><br><span class="line">	<span class="attr">软件或程序环境迁移</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210628101716586.png" alt="image-20210628101716586"></p>
<h2 id="Docker镜像服务"><a href="#Docker镜像服务" class="headerlink" title="Docker镜像服务"></a>Docker镜像服务</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> 镜像服务: 管理存放镜像的位置,用于共享镜像文件</span><br><span class="line">    官方: https:<span class="comment">//hub.docker.com/</span></span><br><span class="line">	阿里: https:<span class="comment">//www.aliyun.com/</span></span><br><span class="line"><span class="number">2</span> 仓库:每一种软件对应一个仓库,在仓库中存放有当前软件不同版本的各个镜像；不同版本使用tag区分</span><br><span class="line">    eg: </span><br><span class="line">	mysql:<span class="number">5.6</span>  mysql:<span class="number">5.7</span><span class="number">.25</span>   </span><br></pre></td></tr></table></figure>

<p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210610102444848.png" alt="image-20210610102444848"></p>
<h2 id="Docker架构"><a href="#Docker架构" class="headerlink" title="Docker架构"></a>Docker架构</h2><p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210330102632713.png" alt="image-20210330102632713"></p>
<h1 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h1><h2 id="1-卸载旧版docker"><a href="#1-卸载旧版docker" class="headerlink" title="1.卸载旧版docker"></a>1.卸载旧版docker</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">yum</span> <span class="string">remove docker \</span></span><br><span class="line"><span class="string">   docker-client \</span></span><br><span class="line"><span class="string">   docker-client-latest \</span></span><br><span class="line"><span class="string">   docker-common \</span></span><br><span class="line"><span class="string">   docker-latest \</span></span><br><span class="line"><span class="string">   docker-latest-logrotate \</span></span><br><span class="line"><span class="string">   docker-logrotate \</span></span><br><span class="line"><span class="string">   docker-selinux \</span></span><br><span class="line"><span class="string">   docker-engine-selinux \</span></span><br><span class="line"><span class="string">   docker-engine \</span></span><br><span class="line"><span class="string">   docker-ce</span></span><br></pre></td></tr></table></figure>

<h2 id="2-安装docker依赖"><a href="#2-安装docker依赖" class="headerlink" title="2.安装docker依赖"></a>2.安装docker依赖</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装基本依赖库</span></span><br><span class="line"><span class="attr">yum</span> <span class="string">install -y yum-utils  device-mapper-persistent-data  lvm2 --skip-broken</span></span><br><span class="line"><span class="comment"># 更新XFS文件系统管理工具</span></span><br><span class="line"><span class="attr">yum</span> <span class="string">update xfsprogs -y</span></span><br></pre></td></tr></table></figure>

<p>有可能报错：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[Errno</span> <span class="string">14] curl#7 - &quot;Failed  connect to repo.mysql.com:80; 拒绝连接&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">解决：</span></span><br><span class="line"><span class="attr">先给yum配置阿里云镜像：</span></span><br><span class="line"><span class="attr">curl</span> <span class="string">-o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo</span></span><br><span class="line"><span class="attr">然后：</span></span><br><span class="line"><span class="attr">cd</span> <span class="string">/etc/yum.repos.d</span></span><br><span class="line"><span class="attr">rm</span> <span class="string">-f mysql-community.repo</span></span><br><span class="line"><span class="attr">rm</span> <span class="string">-f mysql-community-source.repo</span></span><br></pre></td></tr></table></figure>



<h2 id="3-安装docker"><a href="#3-安装docker" class="headerlink" title="3.安装docker"></a>3.安装docker</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更新本地镜像源</span></span><br><span class="line"><span class="meta">yum-config-manager</span> <span class="string">--add-repo https://mirrors.ustc.edu.cn/docker-ce/linux/centos/docker-ce.repo</span></span><br><span class="line"><span class="comment"># 更新镜像源缓存</span></span><br><span class="line"><span class="attr">sed</span> <span class="string">-i &#x27;s/download.docker.com/mirrors.ustc.edu.cn\/docker-ce/g&#x27; /etc/yum.repos.d/docker-ce.repo</span></span><br><span class="line"><span class="comment"># 更新镜像源缓存</span></span><br><span class="line"><span class="attr">yum</span> <span class="string">makecache fast</span></span><br><span class="line"><span class="comment"># 安装Docker</span></span><br><span class="line"><span class="attr">yum</span> <span class="string">install -y docker-ce</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>安装docker时可能会报错：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">container-selinux-2.119.2-1.91</span> <span class="string">FAILED</span></span><br><span class="line"><span class="attr">http</span>:<span class="string">//mirrors.cloud.aliyuncs.com/centos/7/extras/x86_64/Packages/container-selinux-2.119.2-1.911c772.el7_8.noarch.rpm: [Errno 14] curl#6 - &quot;Could not resolve host: mirrors.cloud.aliyuncs.com; Name or service not known&quot;</span></span><br><span class="line"><span class="attr">正在尝试其它镜像。</span></span><br><span class="line"></span><br><span class="line"><span class="attr">解决：好像自己又行了</span></span><br></pre></td></tr></table></figure>



<h2 id="4-启动docker服务"><a href="#4-启动docker服务" class="headerlink" title="4.启动docker服务"></a>4.启动docker服务</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看防火墙状态</span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">status firewalld</span></span><br><span class="line"><span class="comment"># 关闭本地防火墙</span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">stop firewalld</span></span><br><span class="line"><span class="comment"># 禁止开机启动防火墙</span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">disable firewalld</span></span><br><span class="line"><span class="comment"># 启动docker服务</span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">start docker</span></span><br><span class="line"><span class="comment"># 设置开机自启动</span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">enable docker</span></span><br><span class="line"><span class="comment"># 查看docker服务是否已经开启：</span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">status docker</span></span><br></pre></td></tr></table></figure>

<h2 id="5-配置镜像加速"><a href="#5-配置镜像加速" class="headerlink" title="5.配置镜像加速"></a>5.配置镜像加速</h2><p>Docker官方镜像仓库网速较差，我们需要设置国内镜像:参考阿里云的镜像加速文档:阿里云镜像管理地址(<a target="_blank" rel="noopener" href="https://www.aliyun.com/">https://www.aliyun.com/</a>)</p>
<p><strong>注意：</strong>“registry-mirrors”后面对应的链接要是自己的账号里面的相关加速器链接，如果是别人的话，可以拉取，但是上传需要权限。</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建配置文件</span></span><br><span class="line"><span class="attr">mkdir</span> <span class="string">-p /etc/docker</span></span><br><span class="line"><span class="comment"># 配置镜像加速地址 (填写自己阿里云下的镜像加速地址)</span></span><br><span class="line"><span class="comment"># 这里这里也是命令哦，整个copy过去终端执行这条命令，</span></span><br><span class="line"><span class="comment"># 或者你也可以创建/etc/docker/daemon.json文件，然后将内容写进去</span></span><br><span class="line"><span class="attr">tee</span> <span class="string">/etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span></span><br><span class="line"><span class="attr">&#123;</span></span><br><span class="line">  <span class="meta">&quot;registry-mirrors&quot;</span>: <span class="string">[&quot;https://1sagdwyx.mirror.aliyuncs.com&quot;]</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"><span class="attr">EOF</span></span><br><span class="line"><span class="comment"># 重新加载配置并重启Docker</span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">daemon-reload</span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">restart docker</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210610112711816.png" alt="image-20210610112711816"></p>
<p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210610112740492.png" alt="image-20210610112740492"></p>
<p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210329193827827.png" alt="image-20210329193827827"></p>
<h1 id="Docker相关命令"><a href="#Docker相关命令" class="headerlink" title="Docker相关命令"></a>Docker相关命令</h1><h2 id="镜像操作"><a href="#镜像操作" class="headerlink" title="镜像操作"></a>镜像操作</h2><h3 id="相关命令"><a href="#相关命令" class="headerlink" title="相关命令"></a>相关命令</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">操作Docker镜像的常用命令有</span>:<span class="string"></span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">--help : 查询帮助</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">xxx --help : 查询xxx命令的作用和使用方式★★★★★</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">search 镜像名称 : 在镜像仓库搜索镜像</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">pull 镜像名称:tag : 从镜像仓库拉取镜像</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">push : 将本地镜像推送到远程镜像库</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">images : 查看本地镜像列表</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">rmi 镜像名称:tag : 删除本地镜像</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">save -o xxx.tar 镜像名1 镜像名2 : 保存镜像为一个tar文件</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">load -i xxx.tar : 加载本地tar文件中包含的镜像</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">build : 构建一个镜像(我们自己制作镜像)</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">tag 镜像名:tag 新镜像名:tag : 给镜像打新标签(重命名)</span></span><br></pre></td></tr></table></figure>

<h3 id="练习1"><a href="#练习1" class="headerlink" title="练习1:"></a>练习1:</h3><p><span style="color:blue">需求:从镜像仓库中拉取一个nginx镜像</span></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.首先去镜像仓库搜索nginx镜像，比如DockerHub: https://hub.docker.com/</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210329195043716.png" alt="image-20210329195043716"></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2.根据镜像名称搜索,相关镜像对应的拉取命令</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">pull nginx</span></span><br><span class="line"><span class="comment"># 3.查看拉取到的镜像</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">images</span></span><br></pre></td></tr></table></figure>

<h3 id="练习2"><a href="#练习2" class="headerlink" title="练习2"></a>练习2</h3><p><span style="color:blue">需求:去DockerHub搜索并拉取一个Redis镜像</span></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 步骤一:去DockerHub搜索redis镜像</span></span><br><span class="line"><span class="comment"># 步骤二:查看Redis镜像的名称和版本</span></span><br><span class="line"><span class="comment"># 步骤三:利用docker pull命令拉取镜像</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">pull redis:版本</span></span><br></pre></td></tr></table></figure>

<h3 id="练习3"><a href="#练习3" class="headerlink" title="练习3"></a>练习3</h3><p><span style="color:blue">需求:将Redis镜像打包为一个新镜像myredis:1.0，并导出到本地磁盘</span></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.查询docker tag命令的作用和语法</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">tag --help</span></span><br><span class="line"><span class="comment"># 2.使用docker tag打包镜像</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">tag redis:latest myredis:1.0</span></span><br><span class="line"><span class="comment"># 3.使用docker save将镜像打入到tar包中,便于传播</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">save -o myredis.tar myredis:1.0 镜像2 镜像3</span></span><br></pre></td></tr></table></figure>

<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">docker</span> <span class="string">load -i 文件名.tar</span></span><br></pre></td></tr></table></figure>



<h2 id="容器操作"><a href="#容器操作" class="headerlink" title="容器操作"></a>容器操作</h2><p><strong>将一个镜像运行起来,就可以得到镜像对应的容器.</strong></p>
<h3 id="相关命令-1"><a href="#相关命令-1" class="headerlink" title="相关命令"></a>相关命令</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">操作Docker容器的常用命令有</span>:<span class="string"></span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">run --name 容器名称 -p 80:80 -d 镜像名称 : 创建并运行容器</span></span><br><span class="line">  	<span class="meta">--name</span> <span class="string">容器名称</span></span><br><span class="line">  	<span class="meta">-p</span> <span class="string">端口映射</span></span><br><span class="line">  	<span class="meta">-d</span> <span class="string">后台运行</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">stop 容器名称 :停止容器</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">start 容器名称:启动容器</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">ps :查看运行中的容器</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">ps -a : 查看所有容器</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">rm 容器名称:删除容器</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">rm -f 容器名称 : 强制删除容器(无论运行与否) </span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">exec :执行容器内的指定指令</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">commit :提交一个容器为镜像</span></span><br></pre></td></tr></table></figure>

<h3 id="案例1"><a href="#案例1" class="headerlink" title="案例1"></a>案例1</h3><p><span style="color:blue">需求:创建并运行一个Nginx容器</span></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.创建并运行一个Nginx容器的命令为:</span></span><br><span class="line">		<span class="attr">docker</span> <span class="string">run --name mn -p 80:80 -d nginx</span></span><br><span class="line"><span class="comment">    # 命令解读：</span></span><br><span class="line"><span class="comment">    # docker run ：创建并运行一个容器</span></span><br><span class="line"><span class="comment">    # --name : 给容器起一个名字，比如叫做mn</span></span><br><span class="line"><span class="comment">    # -p ：端口映射，例如：-p 8080:80，把容器的80端口映射到宿主机的8080端口</span></span><br><span class="line"><span class="comment">    # -d：后台运行容器</span></span><br><span class="line"><span class="comment">    # nginx：镜像名称</span></span><br><span class="line"><span class="comment"># 2.访问虚拟机页面 http://[你的虚拟机IP]</span></span><br><span class="line">		<span class="meta">192.168.190.149</span>:<span class="string">80</span></span><br></pre></td></tr></table></figure>

<h3 id="案例2-了解"><a href="#案例2-了解" class="headerlink" title="案例2(了解)"></a>案例2(了解)</h3><p>需求:进入Nginx容器，修改HTML文件内容，添加“传智播客欢迎您”</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建并运行nginx容器</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">run \</span></span><br><span class="line"><span class="string">--name mn \</span></span><br><span class="line"><span class="string">-p 80:80 \</span></span><br><span class="line"><span class="string">-d \</span></span><br><span class="line"><span class="string">nginx</span></span><br></pre></td></tr></table></figure>

<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.进入nginx容器的命令为</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">exec -it mn bash</span></span><br><span class="line"><span class="comment">	#命令解读：</span></span><br><span class="line"><span class="comment">  #  docker exec ：进入容器内部执行</span></span><br><span class="line"><span class="comment">  #  -it : 给当前进入的容器创建一个Linux命令行终端，允许我们通过命令行与容器交互</span></span><br><span class="line"><span class="comment">  #  mn ：要进入的容器的名称</span></span><br><span class="line"><span class="comment">  #  bash：进入容器后执行的命令，bash是一个linux终端交互语言格式</span></span><br><span class="line"><span class="comment"># 2.进入nginx的HTML所在目录 /usr/share/nginx/html (此目录去官网查找，tags旁边的description选项)</span></span><br><span class="line">	<span class="attr">cd</span> <span class="string">/usr/share/nginx/html</span></span><br><span class="line"><span class="comment"># 3.修改index.html的内容</span></span><br><span class="line">	<span class="attr">sed</span> <span class="string">-i &#x27;s#Welcome to nginx#传智播客欢迎您#g&#x27; index.html</span></span><br><span class="line">	<span class="attr">sed</span> <span class="string">-i &#x27;s#&lt;head&gt;#&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;#g&#x27; index.html</span></span><br><span class="line"><span class="comment"># 4.退出,容器的客户端</span></span><br><span class="line">	<span class="attr">exit</span></span><br></pre></td></tr></table></figure>

<h3 id="案例3"><a href="#案例3" class="headerlink" title="案例3"></a>案例3</h3><p>运行一个redis容器，并且支持数据持久化</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.到DockerHub搜索Redis镜像</span></span><br><span class="line"><span class="comment">#2.查看Redis镜像文档中的帮助信息</span></span><br><span class="line"><span class="comment">#3.利用docker run 命令运行一个Redis容器</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">run --name redis -p 6379:6379 -d redis redis-server --appendonly yes</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">redis:</span><br><span class="line">	持久化机制:<span class="number">6379</span>：</span><br><span class="line">		RDB: 默认开启的(快照机制)</span><br><span class="line">    AOF: 手动配置</span><br></pre></td></tr></table></figure>

<h3 id="案例4"><a href="#案例4" class="headerlink" title="案例4"></a>案例4</h3><p>进入redis容器，并执行redis-cli客户端命令，存入num=666</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.进入redis容器</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">exec -it 容器名称 bash</span></span><br><span class="line"><span class="comment">#2.执行redis-cli客户端命令</span></span><br><span class="line">	<span class="attr">redis-cli</span></span><br><span class="line"><span class="comment">#3.设置数据num=666</span></span><br><span class="line">	<span class="attr">set</span> <span class="string">num 666</span></span><br></pre></td></tr></table></figure>



<h2 id="数据卷"><a href="#数据卷" class="headerlink" title="数据卷"></a>数据卷</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210330002905638.png" alt="image-20210330002905638"></p>
<p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210330002928724.png" alt="image-20210330002928724"></p>
<p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210330003000678.png" alt="image-20210330003000678"></p>
<p>数据与容器分离（解耦）的方法有两种，一种是<strong>直接目录挂载</strong>，一种是<strong>通过数据卷映射</strong>。</p>
<h3 id="操作数据卷命令"><a href="#操作数据卷命令" class="headerlink" title="操作数据卷命令"></a>操作数据卷命令</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">数据卷是一个虚拟的概念,一个数据卷指向宿主机上的一个文件夹</span>:<span class="string"></span></span><br><span class="line">	<span class="attr">每创建一个数据卷就会在/var/lib/docker/volumes目录下新建一个对应的文件夹</span></span><br><span class="line"><span class="comment">#创建数据卷</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">volume create 数据卷名称 </span></span><br><span class="line"><span class="comment">#查询数据卷信息</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">volume inspect 数据卷名称</span></span><br><span class="line"><span class="comment">#查询所有数据卷基本信息</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">volume ls</span></span><br><span class="line"><span class="comment">#删除未使用的数据卷</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">volume prune</span></span><br><span class="line"><span class="comment">#删除数据卷</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">volume rm 数据卷名称</span></span><br><span class="line"><span class="comment">#挂载数据卷 (建立数据卷与容器目录的对应关系)</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">run \ </span></span><br><span class="line">  <span class="meta">--name</span> <span class="string">mn \</span></span><br><span class="line"><span class="string">  -v html:/usr/share/nginx/html \</span></span><br><span class="line"><span class="string">  -p 8080:80 \</span></span><br><span class="line"><span class="string">  -d \</span></span><br><span class="line"><span class="string">  nginx</span></span><br><span class="line"><span class="comment">  # 说明:</span></span><br><span class="line"><span class="comment">  # 		docker run ：就是创建并运行容器</span></span><br><span class="line"><span class="comment">  #   	--name mn ：给容器起个名字叫mn</span></span><br><span class="line"><span class="comment">  #   	-v html:/root/htm ：把html数据卷挂载到容器内的/root/html这个目录中</span></span><br><span class="line"><span class="comment">  #  	 	-p 8080:80 ：把宿主机的8080端口映射到容器内的80端口</span></span><br><span class="line"><span class="comment">  #   	nginx ：镜像名称</span></span><br></pre></td></tr></table></figure>

<h3 id="案例1-1"><a href="#案例1-1" class="headerlink" title="案例1"></a>案例1</h3><p>创建一个数据卷，并查看数据卷在宿主机的目录位置</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.创建数据卷</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">volume create html</span></span><br><span class="line"><span class="comment">#2.查看所有数据卷</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">volume ls</span></span><br><span class="line"><span class="comment">#3.查看数据卷详细信息</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">volume inspect html</span></span><br></pre></td></tr></table></figure>

<h3 id="案例2"><a href="#案例2" class="headerlink" title="案例2"></a>案例2</h3><p>创建一个nginx容器，将容器内的HTML<strong>目录挂载到数据卷</strong>HTML上，并修改HTML卷中的index.html内容</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.去DockerHub的Nginx页面查看HTML目录在容器内的位置</span></span><br><span class="line"><span class="comment">#2.创建容器并挂载数据卷到容器内的HTML目录</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">run \</span></span><br><span class="line"><span class="string">	--name mn \</span></span><br><span class="line"><span class="string">	-v html:/usr/share/nginx/html \</span></span><br><span class="line"><span class="string">	-p 80:80 \</span></span><br><span class="line"><span class="string">	-d \</span></span><br><span class="line"><span class="string">	nginx</span></span><br><span class="line"><span class="comment">#3.进入HTML数据卷所在位置，并修改HTML内容</span></span><br><span class="line"><span class="comment">  # 查看html数据卷的位置</span></span><br><span class="line">  <span class="attr">docker</span> <span class="string">volume inspect html</span></span><br><span class="line"><span class="comment">  # 进入该目录</span></span><br><span class="line">  <span class="attr">cd</span> <span class="string">/var/lib/docker/volumes/html/_data</span></span><br><span class="line"><span class="comment">  # 修改文件</span></span><br><span class="line">  <span class="attr">vi</span> <span class="string">index.html</span></span><br></pre></td></tr></table></figure>

<h3 id="案例3-1"><a href="#案例3-1" class="headerlink" title="案例3"></a>案例3</h3><p><strong>挂载文件</strong></p>
<p>挂载到宿主机文件覆盖nginx容器内配置文件，并修改内容。实现一个方向代理效果：<br><a target="_blank" rel="noopener" href="http://localhost/s">http://localhost:80/s</a> 请求代理到 <a target="_blank" rel="noopener" href="http://www.baidu.com/s">http://www.baidu.com/s</a></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.去DockerHub的Nginx页面查看配置文件在容器内的位置</span></span><br><span class="line">	<span class="meta">容器中配置文件位置</span>: <span class="string">/etc/nginx/nginx.conf</span></span><br><span class="line"><span class="comment">#2.在宿主机的/tmp目录新建一个nginx.conf文件，编写反向代理逻辑</span></span><br><span class="line">	<span class="attr">cd</span> <span class="string">/tmp</span></span><br><span class="line">	<span class="attr">touch</span> <span class="string">nginx.conf</span></span><br><span class="line">	<span class="attr">参考下面配置</span></span><br><span class="line"><span class="comment">#3.创建nginx容器，挂载/tmp/nginx.conf到容器内的nginx配置文件</span></span><br><span class="line"><span class="comment">	# 删除旧容器</span></span><br><span class="line">		<span class="attr">docker</span> <span class="string">rm -f mn</span></span><br><span class="line"><span class="comment">	# 创建新容器，挂载nginx.conf文件</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">run \</span></span><br><span class="line"><span class="string">    --name mn \</span></span><br><span class="line"><span class="string">    -v html:/usr/share/nginx/html \</span></span><br><span class="line"><span class="string">    -v /tmp/nginx.conf:/etc/nginx/nginx.conf \</span></span><br><span class="line"><span class="string">    -p 80:80 \</span></span><br><span class="line"><span class="string">    -d \</span></span><br><span class="line"><span class="string">    nginx</span></span><br><span class="line"><span class="comment">#4.然后vim /tmp/nginx.conf，给挂载的文件添加如下内容。</span></span><br><span class="line"><span class="comment">#5.在浏览器查看访问：http://192.168.190.145s，这里的192.168.190.145替换为你的IP地址</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">worker_processes  1;</span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line">    sendfile        on;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line">        location /s &#123;</span><br><span class="line">            proxy_pass https://www.baidu.com;</span><br><span class="line">        &#125;</span><br><span class="line">				location / &#123;</span><br><span class="line">            root  /usr/share/nginx/html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="网络管理"><a href="#网络管理" class="headerlink" title="网络管理"></a>网络管理</h2><p>当我们要部署基于docker的微服务群时，往往会需要容器之间互相连接。这时就需要用到Docker中的网络配置了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">集群: 多台服务器做相同的事情</span><br><span class="line">分布式: 多台服务器做不同的事情,在共同协作下完成一个具体的业务</span><br></pre></td></tr></table></figure>

<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建一个名为my-net的网络(名称可以自定义)</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">network create my-net</span></span><br><span class="line"><span class="comment">#将指定容器加入到my-net网络</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">network connet my-net 容器名称</span></span><br><span class="line"><span class="comment">#将一个容器退出指定的网络</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">network disconnect 网络名称 容器名称</span></span><br><span class="line"><span class="comment">#查看网络的详细信息，如IP网段等</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">network inspect 网络名称</span></span><br><span class="line"><span class="comment">#列出所有的网络</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">network ls</span></span><br><span class="line"><span class="comment">#删除所有未使用的网络</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">network prune</span></span><br><span class="line"><span class="comment">#删除所有指定的网络</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">network rm	网络名</span></span><br></pre></td></tr></table></figure>

<h3 id="案例1-2"><a href="#案例1-2" class="headerlink" title="案例1"></a>案例1</h3><p>创建一个网络my-net，并且将之前的nginx容器加入网络中</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.创建一个名为my-net的网络</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">network create my-net</span></span><br><span class="line"><span class="comment">#2.查看创建的网络</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">network ls</span></span><br><span class="line"><span class="comment">#3.查看网络加入语法</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">network connect --help</span></span><br><span class="line"><span class="comment">#4.将nginx容器加入网络</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">network connect my-net mn</span></span><br></pre></td></tr></table></figure>

<h3 id="案例2-1"><a href="#案例2-1" class="headerlink" title="案例2"></a>案例2</h3><p>基于busyBox镜像创建并运行一个容器，加入my-net网络，测试与nginx容器的网络是否畅通</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.基于BusyBox镜像创建容器，并使用--network参数加入my-net网络</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">run -it --rm --name busybox1 --network my-net busybox sh</span></span><br><span class="line"><span class="comment">  # 命令说明：</span></span><br><span class="line"><span class="comment">  #   -it	运行容器并保持一个可交互的shell终端</span></span><br><span class="line"><span class="comment">  #   --rm	容器退出时，自动删除容器</span></span><br><span class="line"><span class="comment">  #   --network my-net		连接到my-net网络</span></span><br><span class="line"><span class="comment">  #   busybox	是一个测试用的简单容器</span></span><br><span class="line"><span class="comment">  #   sh	终端交互方式采用sh方式</span></span><br><span class="line"><span class="comment">#2.通过ping命令测试网络连接，同一个网络中的容器可以用容器名互联</span></span><br><span class="line">	<span class="attr">ping</span> <span class="string">mn</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">小结:</span><br><span class="line">	创建容器时的 --network 参数允许我们直接加入一个网络中</span><br><span class="line">	互联的容器可以利用 容器名互相访问</span><br></pre></td></tr></table></figure>



<h2 id="常用镜像"><a href="#常用镜像" class="headerlink" title="常用镜像"></a>常用镜像</h2><h3 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">==========================</span><br><span class="line"><span class="comment"># 关闭或禁用Linux上已经安装的mysql,因为端口被占用了</span></span><br><span class="line"><span class="comment"># 关闭</span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">stop [mysql/mysqld]</span></span><br><span class="line"><span class="comment"># 禁用</span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">disable [mysql/mysqld]</span></span><br><span class="line">===========================</span><br><span class="line"><span class="comment">#1.拉取或从本地加载MySQL镜像。因为镜像文件较大，推荐从本地加载</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">pull mysql:5.6</span></span><br><span class="line"><span class="comment">#2.创建两个数据卷mysql-data、mysql-conf</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">volume create mysql-data</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">volume create mysql-conf</span></span><br><span class="line"><span class="comment">#3.进入mysql-conf数据卷所在目录，新建一个my.cnf文件</span></span><br><span class="line"><span class="comment">	# 查看数据卷对应目录</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">volume inspect mysql-conf</span></span><br><span class="line"><span class="comment">	# 进入</span></span><br><span class="line">	<span class="attr">cd</span> <span class="string">/var/lib/docker/volumes/mysql-conf/_data</span></span><br><span class="line"><span class="comment">	# 创建核心配置文件  my.cnf(Linux环境下mysql的核心配置文件)</span></span><br><span class="line">	<span class="attr">touch</span> <span class="string">my.cnf</span></span><br><span class="line"><span class="comment">#4.编辑my.cnf文件，设置mysql编码等配置属性</span></span><br><span class="line">	<span class="attr">--------------</span></span><br><span class="line"><span class="comment">    # mysql配置文件内容：（注意，每一行前面没有空格）</span></span><br><span class="line">    <span class="attr">[mysqld]</span></span><br><span class="line">    <span class="attr">skip-name-resolve</span></span><br><span class="line">    <span class="attr">character_set_server</span>=<span class="string">utf8</span></span><br><span class="line">    <span class="attr">datadir</span>=<span class="string">/var/lib/mysql</span></span><br><span class="line">    <span class="meta">server-id</span>=<span class="string">1000</span></span><br><span class="line">	<span class="attr">---------------</span></span><br><span class="line"><span class="comment">#5.创建并运行容器。【具体参数及挂载目录参考DockerHub网站的说明】</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">run \</span></span><br><span class="line"><span class="string">--name mysql \</span></span><br><span class="line"><span class="string">-p 3306:3306 \</span></span><br><span class="line"><span class="string">-d \</span></span><br><span class="line"><span class="string">-e MYSQL_ROOT_PASSWORD=root \</span></span><br><span class="line"><span class="string">-v mysql-data:/var/lib/mysql \</span></span><br><span class="line"><span class="string">-v mysql-conf:/etc/mysql/conf.d \</span></span><br><span class="line"><span class="string">--privileged \</span></span><br><span class="line"><span class="string">mysql:5.6</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#6.用window上的mysql软件工具SQLyog测试一下是否能连接成功，并且创建数据库的编码是否是utf8</span></span><br></pre></td></tr></table></figure>

<h2 id="DockerFile自定义镜像"><a href="#DockerFile自定义镜像" class="headerlink" title="DockerFile自定义镜像"></a>DockerFile自定义镜像</h2><h3 id="dockerFile概述"><a href="#dockerFile概述" class="headerlink" title="dockerFile概述"></a>dockerFile概述</h3><p>回顾之前镜像原理的章节，我们可以了解到，镜像的本质是一层层的Layer。基于一个rootfs这个基础的Layer定制每一层所添加的配置、文件，要执行的操作等。<br>如果我们可以<strong>把每一层修改、安装、构建、操作的命令都写入一个脚本，用这个脚本来构建、定制镜像，那么这个脚本就是 Dockerfile</strong>。<br>因此，<strong>Dockerfile就是一个描述镜像构建的文件</strong>。其中一定会有一个基础镜像（BaseImage），然后在基础镜像上每完成一次修改或安装命令，就形成一层新的Layer，直到镜像构建完成。</p>
<h3 id="常用命令-参考"><a href="#常用命令-参考" class="headerlink" title="常用命令(参考)"></a>常用命令(参考)</h3><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>FROM image_name:tag</td>
<td>定义了使用哪个基础镜像启动构建流程</td>
</tr>
<tr>
<td>MAINTAINER user_name</td>
<td>声明镜像的创建者</td>
</tr>
<tr>
<td>ENV key value</td>
<td>设置环境变量 (可以写多条)</td>
</tr>
<tr>
<td>RUN command</td>
<td>是Dockerfile的核心部分(可以写多条)</td>
</tr>
<tr>
<td>ADD source_dir/file dest_dir/file</td>
<td>将宿主机的文件复制到容器内，如果是一个压缩文件，将会在复制后自动解压</td>
</tr>
<tr>
<td>COPY source_dir/file dest_dir/file</td>
<td>和ADD相似，但是如果有压缩文件并不能解压</td>
</tr>
<tr>
<td>WORKDIR path_dir</td>
<td>设置工作目录</td>
</tr>
<tr>
<td>EXPOSE port1 prot2</td>
<td>用来指定端口，使容器内的应用可以通过端口和外界交互</td>
</tr>
<tr>
<td>CMD argument</td>
<td>在构建容器时使用，会被docker run 后的argument覆盖</td>
</tr>
<tr>
<td>ENTRYPOINT argument</td>
<td>入口点，容器启动后会执行的命令，比如启动mysql。效果和CMD相似，但是并不会被docker run指定的参数覆盖</td>
</tr>
<tr>
<td>VOLUME</td>
<td>将本地文件夹或者其他容器的文件挂载到容器中</td>
</tr>
</tbody></table>
<h3 id="案例1-3"><a href="#案例1-3" class="headerlink" title="案例1"></a>案例1</h3><p>基于Nginx镜像构建一个新镜像，修改其中的index.html文件</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.在一个空文件夹新建一个文件，命名为Dockerfile，内容如下</span></span><br><span class="line"><span class="comment">	# 创建空文件夹</span></span><br><span class="line">	<span class="attr">mkdir</span> <span class="string">/tmp/nginxfile</span></span><br><span class="line"><span class="comment">	# 进入空文件夹</span></span><br><span class="line">	<span class="attr">cd</span> <span class="string">/tmp/nginxfile</span></span><br><span class="line"><span class="comment">	# 创建Dockerfile文件 （文件名一定是Dockerfile）</span></span><br><span class="line">	<span class="attr">touch</span> <span class="string">Dockerfile</span></span><br><span class="line"><span class="comment">	# 给Dockerfile文件添加如下内容，第二行表示&#x27;...&#x27;直接代替.../index.html 文件 内容。</span></span><br><span class="line">	<span class="attr">-----------------</span></span><br><span class="line"><span class="attr">FROM</span> <span class="string">nginx </span></span><br><span class="line"><span class="attr">RUN</span> <span class="string">echo &#x27;&lt;h1&gt;Hello, Docker!&lt;/h1&gt;&#x27; &gt; /usr/share/nginx/html/index.html </span></span><br><span class="line">  <span class="attr">-----------------</span></span><br><span class="line"><span class="comment">#2.执行命令，构建镜像</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">build -t mynginx:1.0 .    # 最后的. 别漏掉了，表示根据当前路径下的 Dockerfile构建镜像。</span></span><br><span class="line"><span class="comment">#3.删除已经存在的镜像</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">rm -f mn</span></span><br><span class="line"><span class="comment">#4.创建并运行容器</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">run --name mn -p 80:80 -d mynginx:1.0 </span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">这个Dockerfile非常简单，就两个命令：FROM和RUN</span><br><span class="line">FROM：就是基础镜像，是Dockerfile中必备的，</span><br><span class="line">    我们构建镜像没必要从rootfs开始，可以基于已有镜像基础上去构建自己的镜像，节省很多时间</span><br><span class="line">RUN：像 Shell 脚本一样可以执行命令，</span><br><span class="line">    这里是直接echo 命令将<span class="string">&#x27;&lt;h1&gt;Hello, Docker!&lt;/h1&gt;&#x27;</span>写入容器的index.html文件中，</span><br><span class="line">    那么nginx的欢迎页面内容就被修改了。</span><br><span class="line">这个Dockerfile描述的镜像就比nginx官方镜像多了一层Layer，定制了nginx欢迎页面。</span><br></pre></td></tr></table></figure>

<h3 id="案例2-2"><a href="#案例2-2" class="headerlink" title="案例2"></a>案例2</h3><p>从CentOS定制nginx镜像，步骤如下：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1</span> <span class="string">复制 nginx-1.10.3.tar.gz 到当前目录下</span></span><br><span class="line"><span class="attr">2</span> <span class="string">在当前目录下的Dockerfile文件中添加如下代码（可以直接覆盖上面的Dockerfile文件哈）</span></span><br><span class="line"><span class="attr">3</span> <span class="string">执行命令进行构建镜像：docker build -t nginx:2.0 . </span></span><br></pre></td></tr></table></figure>

<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基于centos7安装</span></span><br><span class="line"><span class="attr">FROM</span> <span class="string">centos:7</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#拷贝nginx的安装包</span></span><br><span class="line"><span class="attr">COPY</span> <span class="string">nginx-1.10.3.tar.gz /usr/local/src</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 环境变量</span></span><br><span class="line"><span class="attr">ENV</span> <span class="string">NGX_DIR=/opt/nginx</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#安装依赖、解压、编译、安装</span></span><br><span class="line"><span class="attr">RUN</span> <span class="string">yum -y install pcre pcre-devel zlib zlib-devel openssl openssl-devel gcc tar \</span></span><br><span class="line"><span class="string">  &amp;&amp; cd /usr/local/src \</span></span><br><span class="line"><span class="string">	&amp;&amp; tar -xvf nginx-1.10.3.tar.gz \</span></span><br><span class="line"><span class="string">	&amp;&amp; rm -rf nginx-1.10.3.tar.gz \</span></span><br><span class="line"><span class="string">	&amp;&amp; cd nginx-1.10.3 \</span></span><br><span class="line"><span class="string">	&amp;&amp; ./configure --prefix=$NGX_DIR --sbin-path=/usr/bin/nginx \</span></span><br><span class="line"><span class="string">	&amp;&amp; make \</span></span><br><span class="line"><span class="string">	&amp;&amp; make install </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#设置数据挂载目录以及工作目录 匿名卷:当前卷默认不存在,当容器创建时,再生成当前卷</span></span><br><span class="line"><span class="attr">VOLUME</span> <span class="string">$NGX_DIR</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#容器启动后执行该命令</span></span><br><span class="line"><span class="attr">ENTRYPOINT</span> <span class="string">[&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>因为是从centos的基础上进行构建的，因此本地docker没有centos镜像的话，先去下载centos镜像哈！</p>
<h3 id="案例3★"><a href="#案例3★" class="headerlink" title="案例3★"></a>案例3★</h3><p>基于java:8-alpine镜像，将一个Java项目构建为镜像</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.新建一个空的目录，然后在目录中新建一个文件，命名为Dockerfile</span></span><br><span class="line"><span class="comment"># 2.拷贝课前资料提供的app.jar到这个目录中</span></span><br><span class="line"><span class="comment"># 3.编写Dockerfile文件：</span></span><br><span class="line">		<span class="attr">touch</span> <span class="string">Dockerfile</span></span><br><span class="line">		<span class="attr">--------------------</span></span><br><span class="line"><span class="comment">		# 基于java:8-alpine作为基础镜像</span></span><br><span class="line">		<span class="attr">FROM</span> <span class="string">java:8-alpine</span></span><br><span class="line"><span class="comment">		# 将app.jar拷贝到镜像中作为新Layer层</span></span><br><span class="line">		<span class="attr">COPY</span> <span class="string">app.jar /tmp/app.jar</span></span><br><span class="line"><span class="comment">		# 编写入口ENTRYPOINT</span></span><br><span class="line">		<span class="attr">ENTRYPOINT</span> <span class="string">[&quot;java&quot;, &quot;-jar&quot;, &quot;/tmp/app.jar&quot;]</span></span><br><span class="line">		<span class="attr">----------------------</span></span><br><span class="line"><span class="comment"># 4.使用docker build命令构建镜像</span></span><br><span class="line">		<span class="attr">docker</span> <span class="string">build -t web:1.0 .</span></span><br><span class="line"><span class="comment"># 5.使用docker run创建容器并允许</span></span><br><span class="line">		<span class="attr">docker</span> <span class="string">run --name web -p 9090:9090 -d web:1.0 </span></span><br></pre></td></tr></table></figure>

<p>完成了镜像创建之后，将相关的几个镜像打包成压缩包就可以交给其他人了（运维，测试等）</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">docker</span> <span class="string">save -o ziliao.tar web:1.0 mysql:5.6 nginx .....等环境镜像</span></span><br></pre></td></tr></table></figure>



<h2 id="Docker镜像服务-1"><a href="#Docker镜像服务-1" class="headerlink" title="Docker镜像服务"></a>Docker镜像服务</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">之前当我们需要使用镜像时都是从阿里云上或DockerHub上下载.</span><br><span class="line">也可以自己通过Dockerfile做镜像.</span><br><span class="line">然后将我们自己做的镜像上传到阿里云或DockerHub</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="阿里云镜像服务"><a href="#阿里云镜像服务" class="headerlink" title="阿里云镜像服务"></a>阿里云镜像服务</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">镜像服务地址: https:<span class="comment">//cr.console.aliyun.com/</span></span><br><span class="line"><span class="number">1.</span>找到个人实例</span><br><span class="line"><span class="number">2.</span>创建命名空间(阿里云域名/你的命名空间)</span><br><span class="line"><span class="number">3.</span>设置登录的密码</span><br></pre></td></tr></table></figure>

<p><img src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/image-20210610174834160.png" alt="image-20210610174834160"></p>
<p>建立命名空间时，是唯一的名称，因此我们使用的命名空间就相当于公网地址,如下：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">registry.cn-hangzhou.aliyuncs.com/jasongaominghui/nginx</span></span><br></pre></td></tr></table></figure>

<p>想要上传到阿里云的镜像仓库，必须先要建立镜像仓库（先建立并且选择命名空间），然后登录，将本地的镜像名称设置成阿里云规定的名称，就可以推送了。如下实例：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1 登录，这里需要输入密码</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">login --username=gaominghuijasonzhang registry.cn-hangzhou.aliyuncs.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#2 将镜像busybox 另存为规定名称的镜像  jasongaominghui是命名空间，nginx是仓库名</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">tag busybox registry.cn-hangzhou.aliyuncs.com/jasongaominghui/nginx:1.11</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#3 推送命名好的符合名称规则的镜像</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">push registry.cn-hangzhou.aliyuncs.com/jasongaominghui/nginx:1.11</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#删除刚才另存的镜像</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">rmi registry.cn-hangzhou.aliyuncs.com/jasongaominghui/nginx:1.11</span></span><br><span class="line"><span class="comment">#从jasongaominghui/nginx仓库中拉取 刚才上传的镜像，</span></span><br><span class="line"><span class="comment"># 由此可知，只要知道公网地址就可以拉取上面的镜像</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">pull registry.cn-hangzhou.aliyuncs.com/jasongaominghui/nginx:1.11</span></span><br></pre></td></tr></table></figure>



<h3 id="私有镜像仓库"><a href="#私有镜像仓库" class="headerlink" title="私有镜像仓库"></a>私有镜像仓库</h3><p>1 步骤：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>在宿主机上安装私有镜像仓库软件</span><br><span class="line"><span class="number">2.</span>将要上传的镜像重新命名,再上传</span><br></pre></td></tr></table></figure>

<p>2 具体操作：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1 安装镜像仓库镜像   也就是说：registry 是安装镜像仓库 的镜像，下载安装registry然后再安装镜像仓库</span></span><br><span class="line"><span class="attr">docker</span> <span class="string">run -d \</span></span><br><span class="line"><span class="string">  --restart=always \</span></span><br><span class="line"><span class="string">  --name registry	\</span></span><br><span class="line"><span class="string">  -p 5000:5000 \</span></span><br><span class="line"><span class="string">  -v registry-data:/var/lib/registry \</span></span><br><span class="line"><span class="string">  registry</span></span><br><span class="line"><span class="comment"># docker images 查看registry镜像是否安装成功哈。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#2  镜像仓库默认会自动启动运行,如何查看镜像仓库中有哪些镜像呢?</span></span><br><span class="line">	<span class="meta">浏览器访问</span>: <span class="string">http://你的宿主机地址:5000/v2/_catalog</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">#3 配置允许指定ip向本地镜像仓库提交镜像</span></span><br><span class="line"><span class="comment">	# 打开要修改的文件</span></span><br><span class="line">	<span class="attr">vi</span> <span class="string">/etc/docker/daemon.json</span></span><br><span class="line"><span class="comment">	# 添加内容： json格式,</span></span><br><span class="line">	<span class="meta">&quot;insecure-registries&quot;</span>:<span class="string">[&quot;http://宿主机ip地址:5000&quot;]</span></span><br><span class="line"><span class="comment">	# 注意前面配了阿里云的镜像仓库，json数据之间需要加 逗号 ，添加完之后如下：</span></span><br><span class="line">	<span class="attr">&#123;</span></span><br><span class="line">  <span class="meta">&quot;registry-mirrors&quot;</span>: <span class="string">[&quot;https://1sagdwyx.mirror.aliyuncs.com&quot;],</span></span><br><span class="line">  <span class="meta">&quot;insecure-registries&quot;</span>:<span class="string">[&quot;http://192.168.159.131:5000&quot;]</span></span><br><span class="line">	<span class="attr">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 重加载</span></span><br><span class="line">		<span class="attr">systemctl</span> <span class="string">daemon-reload</span></span><br><span class="line"><span class="comment"># 重启docker</span></span><br><span class="line">		<span class="attr">systemctl</span> <span class="string">restart docker</span></span><br><span class="line"><span class="comment"># 推送</span></span><br><span class="line"><span class="comment">	# 镜像若想存放到本地镜像仓库,需满足本地仓库的格式，因此推送前需要重命名镜像</span></span><br><span class="line">	<span class="meta">格式</span>: <span class="string">docker tag nginx:latest 宿主机ip地址:5000/nginx:1.0</span></span><br><span class="line"><span class="comment">	# 推送</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">push 宿主机ip地址:5000/nginx:1.0</span></span><br><span class="line"><span class="comment">	# 推送成功后再浏览器访问 http://你的宿主机地址:5000/v2/_catalog：得到如下内容</span></span><br><span class="line"><span class="comment">	# &#123;&quot;repositories&quot;:[&quot;nginx&quot;]&#125; 表示本地镜像仓库具有nginx 镜像</span></span><br><span class="line"><span class="comment"># 拉取</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">pull 宿主机ip地址:5000/nginx:1.0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">Docker(码头工人)</span>: <span class="string">容器化管理技术</span></span><br><span class="line">    <span class="meta">相关名词</span>:<span class="string"></span></span><br><span class="line">    <span class="attr">1</span> <span class="string">镜像: 对现有的环境和程序进行打包,打好的包叫做镜像.</span></span><br><span class="line">        <span class="attr">在镜像中进行分层,现有层需要基于前一层,对前一层做了只读拷贝</span></span><br><span class="line">        <span class="meta">底层</span>: <span class="string">文件系统 rootfs</span></span><br><span class="line">        <span class="meta">中间层</span>: <span class="string">软件安装层</span></span><br><span class="line">        <span class="meta">顶层</span>: <span class="string">软件入口</span></span><br><span class="line">    <span class="attr">2</span> <span class="string">容器: 根据镜像创建对应的运行环境</span></span><br><span class="line">    	<span class="attr">将镜像做了只读拷贝后,提供了一个可写层,在可写层中可以操作这个软件</span></span><br><span class="line">    <span class="attr">3</span> <span class="string">镜像服务:</span></span><br><span class="line">    <span class="attr">本质上就是一个存放有镜像文件的远程仓库,在该仓库中提供了无数个可用的镜像文件</span></span><br><span class="line">        <span class="meta">镜像仓库</span>: <span class="string">一款软件对应一个镜像仓库</span></span><br><span class="line">        <span class="meta">镜像文件</span>: <span class="string">xxx:tag</span></span><br><span class="line">        <span class="attr">xxx</span>: <span class="string">软件的名称</span></span><br><span class="line">        <span class="attr">tag</span>: <span class="string">软件的版本号</span></span><br><span class="line">    <span class="meta">Docker工作原理</span>:<span class="string"></span></span><br><span class="line">        <span class="attr">Docker是使用go语言开发的一款C/S架构的软件.使用之前必须先启动docker服务.</span></span><br><span class="line">        <span class="attr">通过在客户端发送docker命令给服务器,服务器解析后,完成对应的功能</span></span><br><span class="line">        <span class="attr">systemctl</span> <span class="string">start docker : 启动docker服务</span></span><br><span class="line">        <span class="attr">systemctl</span> <span class="string">stop/restart/status docker</span></span><br><span class="line"><span class="attr">1</span> <span class="string">命令常用方式: 命令提示</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">--help : 查询帮助</span></span><br><span class="line">	<span class="attr">docker</span> <span class="string">xxx --help : 查询xxx命令的作用和使用方式★★★★★</span></span><br><span class="line"><span class="attr">2</span> <span class="string">操作Docker镜像的常用命令有:</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">search 镜像名 : 在镜像仓库搜索镜像</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">pull 镜像名称 : 从镜像仓库拉取镜像</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">push 镜像名称 : 将本地镜像推送到远程镜像库</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">images : 查看本地镜像列表</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">rmi 镜像名称:tag : 删除本地镜像</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">save -o xxx.tar 镜像名1 镜像名2 : 保存一个或多个镜像到一个tar文件</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">load -i xxx.tar : 加载本地tar文件中包含的镜像</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">build : 构建一个镜像</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">tag : 给镜像打新标签(重命名)</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">tag nginx mynginx:1.0</span></span><br><span class="line"><span class="attr">3</span> <span class="string">操作Docker容器的常用命令有:</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">run --name mn -p 80:80 -d 镜像名称 :       作用：创建并运行容器</span></span><br><span class="line">      <span class="meta">--name</span> <span class="string">容器名称</span></span><br><span class="line">      <span class="meta">-p</span> <span class="string">端口映射</span></span><br><span class="line">      <span class="meta">-d</span> <span class="string">后台运行</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">stop 容器名称:停止容器</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">start 容器名称:启动容器</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">ps :查看运行中的容器</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">ps -a : 查看所有容器</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">rm 容器名称:删除容器(删除未运行的容器)</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">rm -f 容器名称 : 强制删除容器(无论运行与否) </span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">update 容器名 --restart=always  设置容器开机自启动</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">exec :执行容器内的指定指令</span></span><br><span class="line">    <span class="attr">docker</span> <span class="string">commit :提交一个容器为镜像</span></span><br><span class="line"></span><br><span class="line"><span class="meta">数据卷</span>:<span class="string"></span></span><br><span class="line">	<span class="meta">作用</span>: <span class="string">将数据与容器相分离 (解耦)</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Dockerfile</span>:<span class="string"></span></span><br><span class="line">	<span class="attr">制作镜像</span></span><br><span class="line">	<span class="attr">基于已有镜像构建新镜像</span></span><br><span class="line">	<span class="attr">基于文件系统构建新镜像(从0开始构建)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">远程镜像服务</span>:<span class="string"></span></span><br><span class="line">	<span class="meta">作用</span>: <span class="string">将自己制作的镜像上传到镜像服务(远程仓库),供其他人使用.</span></span><br><span class="line"><span class="meta">私有镜像服务</span>:<span class="string"></span></span><br><span class="line">	<span class="attr">在宿主机上安装一个镜像服务器容器(软件),将自己制作的镜像,传到镜像服务容器中,在本宿主机上进行管理</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">高明辉</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/05/10/Docker%E5%9F%BA%E7%A1%80/">http://example.com/2022/05/10/Docker%E5%9F%BA%E7%A1%80/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Jason</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Docker/">Docker</a></div><div class="post_share"><div class="social-share" data-image="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/%E5%B0%81%E9%9D%A2.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="添加微信"/></a><div class="post-qr-code-desc">添加微信</div></li><li class="reward-item"><a href="/img/pay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/pay.jpg" alt="付款码"/></a><div class="post-qr-code-desc">付款码</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/05/13/ElasticSearch%E5%9F%BA%E7%A1%80/"><img class="prev-cover" src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/02-ElasticSearch/%E5%B0%81%E9%9D%A2.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ElasticSearch基础</div></div></a></div><div class="next-post pull-right"><a href="/2022/04/28/hibernate-validate%E6%A0%A1%E9%AA%8C%E6%9D%A5%E8%87%AA%E5%89%8D%E7%AB%AF%E7%9A%84%E6%95%B0%E6%8D%AE/"><img class="next-cover" src="/img/java/04%E9%98%B6%E6%AE%B5%E7%83%AD%E9%97%A8%E6%A1%86%E6%9E%B6/day10-day11springboot+/%E5%B0%81%E9%9D%A2.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">hibernate-validate校验来自前端的数据</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/05/26/docker%E9%AB%98%E7%BA%A7/" title="docker高级"><img class="cover" src="/img/java/05%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6/01-Docker%E5%9F%BA%E7%A1%80/%E5%B0%81%E9%9D%A2.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-26</div><div class="title">docker高级</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9B%B4%E5%87%BBDocker%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">1.</span> <span class="toc-text">直击Docker的作用</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">Docker介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">2.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E9%95%9C%E5%83%8F%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.2.</span> <span class="toc-text">Docker镜像服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E6%9E%B6%E6%9E%84"><span class="toc-number">2.3.</span> <span class="toc-text">Docker架构</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker%E5%AE%89%E8%A3%85"><span class="toc-number">3.</span> <span class="toc-text">Docker安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%8D%B8%E8%BD%BD%E6%97%A7%E7%89%88docker"><span class="toc-number">3.1.</span> <span class="toc-text">1.卸载旧版docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AE%89%E8%A3%85docker%E4%BE%9D%E8%B5%96"><span class="toc-number">3.2.</span> <span class="toc-text">2.安装docker依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%AE%89%E8%A3%85docker"><span class="toc-number">3.3.</span> <span class="toc-text">3.安装docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%90%AF%E5%8A%A8docker%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.4.</span> <span class="toc-text">4.启动docker服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E9%85%8D%E7%BD%AE%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F"><span class="toc-number">3.5.</span> <span class="toc-text">5.配置镜像加速</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">4.</span> <span class="toc-text">Docker相关命令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E6%93%8D%E4%BD%9C"><span class="toc-number">4.1.</span> <span class="toc-text">镜像操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">4.1.1.</span> <span class="toc-text">相关命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A01"><span class="toc-number">4.1.2.</span> <span class="toc-text">练习1:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A02"><span class="toc-number">4.1.3.</span> <span class="toc-text">练习2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A03"><span class="toc-number">4.1.4.</span> <span class="toc-text">练习3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">4.2.</span> <span class="toc-text">容器操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">相关命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B1"><span class="toc-number">4.2.2.</span> <span class="toc-text">案例1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B2-%E4%BA%86%E8%A7%A3"><span class="toc-number">4.2.3.</span> <span class="toc-text">案例2(了解)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B3"><span class="toc-number">4.2.4.</span> <span class="toc-text">案例3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B4"><span class="toc-number">4.2.5.</span> <span class="toc-text">案例4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-number">4.3.</span> <span class="toc-text">数据卷</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="toc-number">4.3.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%91%BD%E4%BB%A4"><span class="toc-number">4.3.2.</span> <span class="toc-text">操作数据卷命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B1-1"><span class="toc-number">4.3.3.</span> <span class="toc-text">案例1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B2"><span class="toc-number">4.3.4.</span> <span class="toc-text">案例2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B3-1"><span class="toc-number">4.3.5.</span> <span class="toc-text">案例3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86"><span class="toc-number">4.4.</span> <span class="toc-text">网络管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B1-2"><span class="toc-number">4.4.1.</span> <span class="toc-text">案例1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B2-1"><span class="toc-number">4.4.2.</span> <span class="toc-text">案例2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E9%95%9C%E5%83%8F"><span class="toc-number">4.5.</span> <span class="toc-text">常用镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85mysql"><span class="toc-number">4.5.1.</span> <span class="toc-text">安装mysql</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DockerFile%E8%87%AA%E5%AE%9A%E4%B9%89%E9%95%9C%E5%83%8F"><span class="toc-number">4.6.</span> <span class="toc-text">DockerFile自定义镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dockerFile%E6%A6%82%E8%BF%B0"><span class="toc-number">4.6.1.</span> <span class="toc-text">dockerFile概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4-%E5%8F%82%E8%80%83"><span class="toc-number">4.6.2.</span> <span class="toc-text">常用命令(参考)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B1-3"><span class="toc-number">4.6.3.</span> <span class="toc-text">案例1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B2-2"><span class="toc-number">4.6.4.</span> <span class="toc-text">案例2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B3%E2%98%85"><span class="toc-number">4.6.5.</span> <span class="toc-text">案例3★</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker%E9%95%9C%E5%83%8F%E6%9C%8D%E5%8A%A1-1"><span class="toc-number">4.7.</span> <span class="toc-text">Docker镜像服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BF%E9%87%8C%E4%BA%91%E9%95%9C%E5%83%8F%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.7.1.</span> <span class="toc-text">阿里云镜像服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%81%E6%9C%89%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93"><span class="toc-number">4.7.2.</span> <span class="toc-text">私有镜像仓库</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">总结</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 高明辉</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'Aaee0Vekhg5KbLhMOJQrEU6A-gzGzoHsz',
      appKey: 'mmLHPEEtqvOSJhsqWra8Sq6K',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script type="text/javascript" src="/js/fairyDustCursor.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>