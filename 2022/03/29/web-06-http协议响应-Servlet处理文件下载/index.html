<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>web-06-http协议响应-Servlet处理文件下载 | Jason</title><meta name="keywords" content="http响应,Servlet处理文件下载,servlet"><meta name="author" content="高明辉"><meta name="copyright" content="高明辉"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="上篇博客内容回顾回顾前先回答个问题：为什么ServletRequest 要强转为HttpServletRequest ： 1234因为后者是前者子类，子类代表了更多的方法，更多的功能嘛。比如说，前者都没有getMethod方法，都无法快速得到请求的方式是Get还是Post，因此肯定是强转为HttpServletRequest 好。当然，如果不强转的话，可以获取输入流，自己写一个方法去解析（哈哈哈，">
<meta property="og:type" content="article">
<meta property="og:title" content="web-06-http协议响应-Servlet处理文件下载">
<meta property="og:url" content="http://example.com/2022/03/29/web-06-http%E5%8D%8F%E8%AE%AE%E5%93%8D%E5%BA%94-Servlet%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/index.html">
<meta property="og:site_name" content="Jason">
<meta property="og:description" content="上篇博客内容回顾回顾前先回答个问题：为什么ServletRequest 要强转为HttpServletRequest ： 1234因为后者是前者子类，子类代表了更多的方法，更多的功能嘛。比如说，前者都没有getMethod方法，都无法快速得到请求的方式是Get还是Post，因此肯定是强转为HttpServletRequest 好。当然，如果不强转的话，可以获取输入流，自己写一个方法去解析（哈哈哈，">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day06-http-servlet/%E5%B0%81%E9%9D%A2.png">
<meta property="article:published_time" content="2022-03-29T15:03:11.000Z">
<meta property="article:modified_time" content="2022-12-11T02:30:16.431Z">
<meta property="article:author" content="高明辉">
<meta property="article:tag" content="http响应">
<meta property="article:tag" content="Servlet处理文件下载">
<meta property="article:tag" content="servlet">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day06-http-servlet/%E5%B0%81%E9%9D%A2.png"><link rel="shortcut icon" href="/img/%E7%BD%91%E7%AB%99%E5%9B%BE%E6%A0%87.png"><link rel="canonical" href="http://example.com/2022/03/29/web-06-http%E5%8D%8F%E8%AE%AE%E5%93%8D%E5%BA%94-Servlet%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'web-06-http协议响应-Servlet处理文件下载',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-12-11 10:30:16'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Jason" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/%E5%A4%B4%E5%83%8F.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">192</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">230</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">36</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/timeline/"><i class="fa-fw fa fa-bell"></i><span> 日志</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 菜单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/%E5%85%B3%E4%BA%8E"><i class="fa-fw /about/"></i><span> 0</span></a></li><li><a class="site-page child" href="/myself"><i class="fa-fw /myself/"></i><span> 1</span></a></li><li><a class="site-page child" href="/butterfly%E4%B8%BB%E9%A2%98"><i class="fa-fw https://github.com/jerryc127/hexo-theme-butterfly/"></i><span> 2</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day06-http-servlet/%E5%B0%81%E9%9D%A2.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jason</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/timeline/"><i class="fa-fw fa fa-bell"></i><span> 日志</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 菜单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/%E5%85%B3%E4%BA%8E"><i class="fa-fw /about/"></i><span> 0</span></a></li><li><a class="site-page child" href="/myself"><i class="fa-fw /myself/"></i><span> 1</span></a></li><li><a class="site-page child" href="/butterfly%E4%B8%BB%E9%A2%98"><i class="fa-fw https://github.com/jerryc127/hexo-theme-butterfly/"></i><span> 2</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">web-06-http协议响应-Servlet处理文件下载</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-29T15:03:11.000Z" title="发表于 2022-03-29 23:03:11">2022-03-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-12-11T02:30:16.431Z" title="更新于 2022-12-11 10:30:16">2022-12-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/web/">web</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="web-06-http协议响应-Servlet处理文件下载"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="上篇博客内容回顾"><a href="#上篇博客内容回顾" class="headerlink" title="上篇博客内容回顾"></a>上篇博客内容回顾</h2><p>回顾前先回答个问题：为什么ServletRequest 要强转为HttpServletRequest ：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">因为后者是前者子类，子类代表了更多的方法，更多的功能嘛。</span></span><br><span class="line"><span class="attr">比如说，前者都没有getMethod方法，都无法快速得到请求的方式是Get还是Post，</span></span><br><span class="line"><span class="meta">因此肯定是强转为HttpServletRequest</span> <span class="string">好。</span></span><br><span class="line"><span class="attr">当然，如果不强转的话，可以获取输入流，自己写一个方法去解析（哈哈哈，好麻烦）</span></span><br></pre></td></tr></table></figure>



<p><img src="/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day06-http-servlet/image-20210516090112679.png" alt="image-20210516090112679"></p>
<p><img src="/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day06-http-servlet/image-20210516092438104.png" alt="image-20210516092438104"></p>
<p>忽略上面的底层原理流程，可以看下面的简化版模型：</p>
<p><img src="/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day06-http-servlet/image-20210516094823427.png" alt="image-20210516094823427"></p>
<h2 id="请求信息对象-Request"><a href="#请求信息对象-Request" class="headerlink" title="请求信息对象-Request"></a>请求信息对象-Request</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">浏览器和服务器数据交互时,需要遵循HTTP协议</span>:<span class="string"></span></span><br><span class="line"><span class="meta">组成部分</span>:<span class="string"></span></span><br><span class="line"><span class="meta">请求</span>: <span class="string">浏览器发送给服务器的内容叫做-请求</span></span><br><span class="line">    <span class="meta">在http协议中规定了请求数据的格式</span>: <span class="string">请求行 请求头 请求体</span></span><br><span class="line"><span class="meta">响应</span>: <span class="string">服务器返回给浏览器的内容叫做-响应</span></span><br><span class="line">    <span class="meta">在http协议中规定了响应数据的格式</span>:<span class="string">响应行  响应头  响应体</span></span><br><span class="line"></span><br><span class="line"><span class="meta">http协议-请求</span>:<span class="string"></span></span><br><span class="line">	<span class="meta">请求行</span>: <span class="string">请求方式 请求路径 协议/版本</span></span><br><span class="line">	<span class="meta">请求头</span>: <span class="string">约束请求信息的格式</span></span><br><span class="line">        	<span class="attr">referer</span>: <span class="string">防盗链(标识请求来自哪个页面,直接在浏览器地址栏输入地址没有防盗链)</span></span><br><span class="line">          	<span class="meta">user-agent</span>: <span class="string">用户代理</span></span><br><span class="line">	<span class="meta">请求体</span>: <span class="string">存放post请求携带的数据信息,get请求没有请求体</span></span><br><span class="line"><span class="meta">Request对象</span>:<span class="string"></span></span><br><span class="line">    <span class="attr">请求来的时候,tomcat会解析本次请求携带的数据信息,</span></span><br><span class="line">    <span class="attr">将解析到的数据封装到Request对象中.</span></span><br><span class="line">    <span class="attr">此对象由服务器创建,存放本次请求携带的所有数据信息,</span></span><br><span class="line">    <span class="attr">想要获取请求携带的数据直接从该对象中获取即可.</span></span><br><span class="line">	<span class="attr">API</span>:<span class="string"></span></span><br><span class="line">    <span class="meta">getMethod();</span> <span class="string">获取请求方式 get/post</span></span><br><span class="line">    <span class="meta">getContextPath();</span> <span class="string">获取当前项目的项目名 /day06</span></span><br><span class="line">    <span class="meta">getHeader(&quot;头名称&quot;);</span> <span class="string">获取指定头的值</span></span><br><span class="line">    <span class="attr">String</span> <span class="string">getParameter(&quot;键&quot;); 获取一个请求参数</span></span><br><span class="line">    <span class="meta">String[]</span> <span class="string">getParameterValues(&quot;键&quot;); 获取一个参数对应的多个值</span></span><br><span class="line">    <span class="meta">Map&lt;String,String[]&gt;</span> <span class="string">getParameterMap(); 获取请求携带的所有信息,封装到Map集合中</span></span><br><span class="line"><span class="meta">注意事项</span>: <span class="string">中文参数乱码问题</span></span><br><span class="line">    <span class="attr">服务器的解码方式与浏览器的编码方式不一致,导致的中文乱码</span></span><br><span class="line">    <span class="meta">解决方案</span>: <span class="string">设置Request对象的编码方式</span></span><br><span class="line">    <span class="attr">request.setCharacterEncoding(&quot;utf-8&quot;);</span></span><br></pre></td></tr></table></figure>



<h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">Request作用域</span>:<span class="string"></span></span><br><span class="line">	<span class="meta">作用范围</span>: <span class="string">本次请求,在本次请求中都有效</span></span><br><span class="line">  <span class="attr">API</span>:<span class="string"></span></span><br><span class="line">  <span class="attr">设置同名属性则为覆盖,修改</span></span><br><span class="line">  <span class="meta">setAttribute(String,Object);</span> <span class="string">// 往作用域中设置共享的属性</span></span><br><span class="line">  <span class="meta">getAttribute(String);</span> <span class="string">// 从作用域中获取共享的属性值</span></span><br><span class="line">  <span class="meta">removeAttribute(String);</span> <span class="string">// 删除作用域中共享的属性值</span></span><br><span class="line">  <span class="meta">注意</span>:<span class="string">getParameter()获取的是浏览器携带的数据信息.别跟上面的属性搞混了。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">Request生命周期</span>:<span class="string"></span></span><br><span class="line">	<span class="meta">创建</span>: <span class="string">请求来的时候,tomcat会为本次请求创建一个Request对象,封装本次请求携带的数据信息</span></span><br><span class="line">	<span class="meta">销毁</span>: <span class="string">service方法执行完毕后,销毁Request对象(响应信息生成的时候销毁)</span></span><br><span class="line">  	<span class="meta">注意</span>: <span class="string">这次销毁是整个tomcat结束后才销毁。一次service执行完毕后只是将Request清楚，</span></span><br><span class="line">  		 <span class="attr">下次响应时还是这个Request对象。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>请求转发: 一次请求的延续</strong></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">API</span>:  <span class="string">request.getRequestDispatcher(&quot;转发路径&quot;).forward(req,resp);</span></span><br><span class="line"><span class="meta">特征和场景</span>:<span class="string"></span></span><br><span class="line">      <span class="meta">1.请求转发时,浏览器发送了几次请求?</span>  <span class="string"></span></span><br><span class="line">        <span class="attr">1次</span></span><br><span class="line">      <span class="meta">2.请求转发时,访问了几个Servlet?</span>  <span class="string"></span></span><br><span class="line">        <span class="attr">多个,被访问的多个servlet称之为请求链,或请求串</span></span><br><span class="line">      <span class="meta">3.请求转发时,浏览器地址显示的是哪个Servlet的地址?</span>  <span class="string"></span></span><br><span class="line">         <span class="attr">第一个Servlet的地址</span></span><br><span class="line">      <span class="attr">4.请求转发时多个Servlet之间能否共享Request对象?</span></span><br><span class="line">         <span class="attr">可以共享Request对象</span></span><br><span class="line">      <span class="attr">5.请求转发,能转发到哪些位置?</span></span><br><span class="line">         <span class="attr">请求转发是服务器内部行为,只能在当前服务器内转发</span></span><br><span class="line"><span class="meta">应用场景</span>:<span class="string">可以将繁琐的业务拆分成多个步骤,分别转发调用,实现最终的业务处理.</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day06-http-servlet/image-20210516102638139.png" alt="image-20210516102638139"></p>
<div style="background-color: orange">示例代码</div>

<p>前端</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>request-请求转发<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;my?money=30&quot;</span>&gt;</span>班长借钱-请求转发<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>servlet代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/my&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;班长曰: 讲师借我钱!&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;我曰: 借多少?&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;班长曰: 自己获取!&quot;</span>);</span><br><span class="line">        String money = request.getParameter(<span class="string">&quot;money&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;班长预计借: &quot;</span>+money);</span><br><span class="line">        System.out.println(<span class="string">&quot;我曰: 我没有零钱,稍等...&quot;</span>);</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span>借助request作用域实现数据共享,在请求转发前设置共享的数据信息</span></span><br><span class="line">        request.setAttribute(<span class="string">&quot;str&quot;</span>,<span class="string">&quot;&lt;&lt;班长&gt;&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span>请求转发 找人帮忙</span></span><br><span class="line">        <span class="comment">// 调用其他的Servlet帮忙处理业务逻辑</span></span><br><span class="line">        <span class="comment">// getRequestDispatcher(&quot;转发的对象路径&quot;)</span></span><br><span class="line">        <span class="comment">// forward(request,response): 转发时共享对象</span></span><br><span class="line">        request.getRequestDispatcher(<span class="string">&quot;qin&quot;</span>).forward(request,response);</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span>请求转发后的代码还会执行,但是响应对象不可在使用,</span></span><br><span class="line">        System.out.println(<span class="string">&quot;请求转发后的代码执行了.....&quot;</span>);</span><br><span class="line">        <span class="comment">// 此行代码无效</span></span><br><span class="line"><span class="comment">//        response.getWriter().print(&quot;failed...&quot;);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.doPost(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/qin&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QinServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;================================&quot;</span>);</span><br><span class="line">        <span class="comment">// 获取上一个Servlet共享的数据信息</span></span><br><span class="line">        Object str = request.getAttribute(<span class="string">&quot;str&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;我曰: 班主任,咱们&quot;</span>+str+<span class="string">&quot;没钱吃饭了,你去给送点钱!&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;班主任曰: 送多少?&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;我曰: 自己获取!&quot;</span>);</span><br><span class="line">        String money = request.getParameter(<span class="string">&quot;money&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;获取的金额为: &quot;</span>+money);</span><br><span class="line">        <span class="comment">// 送钱给班长,生成响应</span></span><br><span class="line">        response.getWriter().print(<span class="string">&quot;&lt;h1&gt;success &quot;</span>+money+<span class="string">&quot; &lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.doPost(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="第一章-http协议-响应"><a href="#第一章-http协议-响应" class="headerlink" title="第一章 http协议-响应"></a>第一章 http协议-响应</h2><p>响应(response): 服务器返回给浏览器的内容</p>
<h3 id="1-1-组成部分-p"><a href="#1-1-组成部分-p" class="headerlink" title="1.1 组成部分:\p;]"></a>1.1 组成部分:\p;]</h3><p>​    响应行 响应头 响应体</p>
<h3 id="1-2-响应行"><a href="#1-2-响应行" class="headerlink" title="1.2 响应行"></a>1.2 响应行</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">格式: 响应信息的第一行</span><br><span class="line">	协议/版本 响应的状态码 (状态码说明)    omcat8以后 没有响应状态码说明了</span><br><span class="line">		   t</span><br><span class="line">	eg: HTTP/<span class="number">1.1</span> <span class="number">200</span> OK    tomcat7</span><br><span class="line">    </span><br><span class="line">响应状态码:	</span><br><span class="line">	1xx	:请求已发送</span><br><span class="line">	2xx	:响应已完成</span><br><span class="line">		<span class="number">200</span>:响应成功</span><br><span class="line">	3xx	:需要浏览器进一步操作才可以完成</span><br><span class="line">		<span class="number">302</span>:重定向(配合location头使用)；</span><br><span class="line">            相比较上面请求转发不同，如果访问的sevlet未能实现逻辑处理，</span><br><span class="line">            该servlet可以将<span class="number">302</span>状态码以及可以解决浏览器问题的目标url返回给浏览器</span><br><span class="line">            那么浏览器再去访问第二个url处理逻辑！</span><br><span class="line">		<span class="number">304</span>:读缓存，上一篇博客将发送请求时提到了该机制哦，同过发送头参数实现该机制。</span><br><span class="line">	4xx :用户访问错误</span><br><span class="line">		<span class="number">404</span>:用户访问的资源不存在</span><br><span class="line">    	<span class="number">405</span>:doGet方法或doPost方法没有重写</span><br><span class="line">	5xx :服务器内部错误</span><br><span class="line">		<span class="number">500</span>:服务器内部异常</span><br><span class="line">面试题: 常见的状态码有哪些? （除了上面那些，可以去离线文档查看）</span><br></pre></td></tr></table></figure>

<p><img src="/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day06-http-servlet/1587264084725.png" alt="1587264084725"></p>
<h3 id="1-3-响应头"><a href="#1-3-响应头" class="headerlink" title="1.3 响应头"></a>1.3 响应头</h3><p>清除浏览器缓存快捷键:  ctrl + shift + delete</p>
<h5 id="格式"><a href="#格式" class="headerlink" title="格式:"></a>格式:</h5><p>​         key/values的格式 (values可以为多个值的)</p>
<h5 id="常见的响应头"><a href="#常见的响应头" class="headerlink" title="常见的响应头"></a>常见的响应头</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Location: 	http:<span class="comment">//www.itcast.cn 		--重定向时跳转方向</span></span><br><span class="line">Server: 	apache tomcat				--服务器型号</span><br><span class="line">Content-Encoding: gzip 					--数据压缩</span><br><span class="line">Content-Length: <span class="number">80</span> 						--数据长度</span><br><span class="line">Content-Language: zh-cn 				--语言环境	</span><br><span class="line">Last-Modified: Tue, <span class="number">11</span> Jul <span class="number">2000</span> <span class="number">18</span>:<span class="number">23</span>:<span class="number">51</span> GMT	--最后修改时</span><br><span class="line">Refresh: <span class="number">1</span>(秒);url=http:<span class="comment">//www.itcast.cn			--定时刷新</span></span><br><span class="line">★Content-Disposition: attachment;filename=aaa.zip	--下载 用于文件下载  附件</span><br><span class="line">★Set-Cookie:SS=Q0=5Lb_nQ; path=/search</span><br><span class="line">★★Content-Type: text/html;charset=utf-<span class="number">8</span>		--数据类型(MIME类型)  大类型/小类型 </span><br><span class="line">  响应结果类型: mime类型</span><br><span class="line">    	<span class="keyword">int</span>: <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line">      mime类型: 描述一切文件的扩展名</span><br><span class="line">        	格式 : 大类型/小类型</span><br><span class="line">        	*.html  text/html</span><br><span class="line">        	*.js    text/js</span><br><span class="line">  响应头Content-Type的作用:</span><br><span class="line">	设置响应文件的mime类型(告诉浏览器本次响应的文件是什么格式的文件)</span><br><span class="line">	设置响应流的编码方式(告诉浏览器服务器在响应此文件时,使用的是什么编码)</span><br><span class="line">	通知浏览器使用指定的编码方式进行解码</span><br></pre></td></tr></table></figure>

<h5 id="重点的头"><a href="#重点的头" class="headerlink" title="重点的头:"></a>重点的头:</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Content-Type: 设置响应文件的mime类型</span><br><span class="line">Refresh: 定时刷新</span><br><span class="line">Content-Disposition: 文件下载专用头</span><br><span class="line">Location: 重定向时,设置重定向的路径</span><br><span class="line">Set-Cookie: 设置返回的cookie对象</span><br></pre></td></tr></table></figure>



<h3 id="1-4-响应体"><a href="#1-4-响应体" class="headerlink" title="1.4 响应体"></a>1.4 响应体</h3><p>​    存放的是需求浏览器解析的内容</p>
<p><img src="/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day06-http-servlet/image-20200628155003263.png" alt="image-20200628155003263"></p>
<h2 id="第二章-response★"><a href="#第二章-response★" class="headerlink" title="第二章 response★"></a>第二章 response★</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Response是响应信息对象,在此对象中存放有本次响应给浏览器的所有信息,</span><br><span class="line">如果你想将一些数据返回给浏览器,直接向Response对象中设置即可,</span><br><span class="line">该对象会自动返回给浏览器,浏览器会自动解析.</span><br></pre></td></tr></table></figure>

<h3 id="2-1-操作响应行"><a href="#2-1-操作响应行" class="headerlink" title="2.1 操作响应行:"></a>2.1 操作响应行:</h3><p>格式: 协议/版本 状态码(说明)          </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">协议跟版本由TomCat封装，我们只要设置状态码就好了，</span><br><span class="line">而下面的状态码中，除了302，其他状态码都是自动发给浏览器的！</span><br></pre></td></tr></table></figure>

<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">200</span> <span class="string">ok : 成功</span></span><br><span class="line"><span class="attr">302</span> <span class="string">found: 找到了资源,但不能成功的处理</span></span><br><span class="line">			<span class="attr">结合location头使用</span></span><br><span class="line"><span class="attr">304</span> <span class="string">not modified: 资源未修改,读缓存</span></span><br><span class="line"><span class="attr">404</span> <span class="string">not found: 未发现资源</span></span><br><span class="line"><span class="attr">405</span> <span class="string">Method Not Allowed: 方法不允许被访问(我们自己的Servlet没有重写doGet和doPost方法)</span></span><br><span class="line"><span class="attr">500</span> <span class="string">Internal ServerError: 服务器内部错误</span></span><br></pre></td></tr></table></figure>



<h4 id="常用API"><a href="#常用API" class="headerlink" title="常用API"></a>常用API</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(理解)setStatus(<span class="keyword">int</span> code):针对<span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span> 开头的状态码</span><br><span class="line">(了解)sendError(<span class="keyword">int</span> code):针对 <span class="number">4</span>   <span class="number">5</span> 开头的</span><br></pre></td></tr></table></figure>

<h5 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码:"></a>示例代码:</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/status&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StatusServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 操作响应行,设置响应状态码</span></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * response.setStatus();  1 2 3</span></span><br><span class="line"><span class="comment">         * response.sendError();  4 5</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="comment">//response.setStatus(200);</span></span><br><span class="line">        <span class="comment">// 302: 发现了服务器上的资源,但是没能将问题解决</span></span><br><span class="line">        <span class="comment">//response.setStatus(302); // 重定向,需要结合location头一起使用</span></span><br><span class="line">        <span class="comment">//response.setHeader(&quot;location&quot;,&quot;https://www.baidu.com&quot;);</span></span><br><span class="line">        <span class="comment">//response.sendError(404,&quot;你的小可爱走丢了.....&quot;);</span></span><br><span class="line">        response.sendError(<span class="number">500</span>,<span class="string">&quot;服务器上的代码写错了.....&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;StatusServlet执行了...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.doPost(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-2-操作响应头"><a href="#2-2-操作响应头" class="headerlink" title="2.2 操作响应头:"></a>2.2 操作响应头:</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">格式</span>: <span class="string">key/values</span></span><br><span class="line"><span class="meta">常见的响应头</span>:<span class="string"></span></span><br><span class="line">    <span class="attr">location</span>: <span class="string">设置跳转路径</span></span><br><span class="line">    <span class="meta">content-type</span>: <span class="string">设置响应文件的mime类型</span></span><br><span class="line">    <span class="attr">refresh</span>: <span class="string">定时刷新</span></span><br><span class="line">    <span class="meta">Content-Disposition</span>: <span class="string">文件下载专用头	</span></span><br></pre></td></tr></table></figure>

<h4 id="常用API-1"><a href="#常用API-1" class="headerlink" title="常用API"></a>常用API</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">★★★setHeader(String name,String value);  <span class="comment">// 设置一个字符串形式的响应头</span></span><br><span class="line">★★★sendRedirect(<span class="string">&quot;路径&quot;</span>);  <span class="comment">// 重定向</span></span><br><span class="line">★★★setContentType(<span class="string">&quot;mime类型&quot;</span>); <span class="comment">// 设置响应文件的mime类型</span></span><br></pre></td></tr></table></figure>

<h4 id="常见的响应头-1"><a href="#常见的响应头-1" class="headerlink" title="常见的响应头"></a>常见的响应头</h4><h5 id="location-重定向★★★"><a href="#location-重定向★★★" class="headerlink" title="location:重定向★★★"></a>location:重定向★★★</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">方式<span class="number">1</span>: 需要配合<span class="number">302</span>状态码一起使用 (了解)</span><br><span class="line">	response.setStatus(<span class="number">302</span>);</span><br><span class="line">	response.setHeader(<span class="string">&quot;location&quot;</span>,<span class="string">&quot;绝对路径&quot;</span>);</span><br><span class="line">	路径:绝对路径</span><br><span class="line">方式<span class="number">2</span>: (掌握)</span><br><span class="line">	response.sendRedirect(<span class="string">&quot;路径&quot;</span>);</span><br><span class="line"></span><br><span class="line">重定向发送的是多次请求</span><br><span class="line">重定向不可以共享request对象(因为发送的是多次请求)</span><br><span class="line">重定向时浏览器地址栏显示的是最后一次的地址</span><br><span class="line">重定向可以跳转到任何路径，一般应用在多平台的跳转！</span><br><span class="line"></span><br><span class="line">与请求转发的对比：</span><br><span class="line">    请求转发是服务器内部的资源共享，多业务处理，而重定向是服务器外部的业务处理</span><br><span class="line">    因此，能用转发请求用转发请求，要跳转到服务器外部的话，只能是重定向了。</span><br><span class="line">    当然重定向既可以重定向到服务器内部，也可以重定向其他服务器资源。</span><br></pre></td></tr></table></figure>

<p><img src="/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day06-http-servlet/image-20210516143012933.png" alt="image-20210516143012933"></p>
<p><strong>示例代码:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/my&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;========================&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;班长曰: 讲师借我钱!&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;我曰: 借多少?&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;班长曰: 自己获取!&quot;</span>);</span><br><span class="line">        String money = request.getParameter(<span class="string">&quot;money&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;金额: &quot;</span>+money);</span><br><span class="line">        System.out.println(<span class="string">&quot;我曰: 不好意思,我没有零钱!你去找班主任借吧!&quot;</span>);</span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span>重定向</span></span><br><span class="line">        <span class="comment">// 方式1: 理解</span></span><br><span class="line">        <span class="comment">//a.设置响应状态码</span></span><br><span class="line">        <span class="comment">//response.setStatus(302);</span></span><br><span class="line">        <span class="comment">//b.设置重定向路径</span></span><br><span class="line">        <span class="comment">// 注意: 重定向的路径为绝对路径  /项目/资源   http://ip地址:端口/项目/资源</span></span><br><span class="line">        <span class="comment">//response.setHeader(&quot;location&quot;,&quot;/day06/qin?money=30000&quot;);</span></span><br><span class="line">        <span class="comment">// 方式2: 掌握</span></span><br><span class="line">        <span class="comment">//response.sendRedirect(&quot;/day06/qin?money=30000&quot;);</span></span><br><span class="line">        <span class="comment">//response.sendRedirect(request.getContextPath()+&quot;/qin?money=30000&quot;);</span></span><br><span class="line">        response.sendRedirect(<span class="string">&quot;https://www.baidu.com?money=30000000&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;=============================&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.doPost(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/qin&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QinServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;----------------------&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;班长曰: 班主任,借我钱!&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;班主任曰: 借多少?&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;班长曰: 自己获取!&quot;</span>);</span><br><span class="line">        String money = request.getParameter(<span class="string">&quot;money&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;金额: &quot;</span>+money);</span><br><span class="line">        System.out.println(<span class="string">&quot;班主任曰: 好的...&quot;</span>);</span><br><span class="line">        response.getWriter().print(<span class="string">&quot;&lt;h1&gt;success&lt;/h1&gt;&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;----------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.doPost(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="请求转发与重定向区别"><a href="#请求转发与重定向区别" class="headerlink" title="请求转发与重定向区别"></a>请求转发与重定向区别</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">请求转发:</span><br><span class="line">		概念: 一次请求的延续</span><br><span class="line">    跳转的方向: 服务器内部行为,只能在服务器内部找资源解决问题</span><br><span class="line">    <span class="number">1.</span>请求转发时,浏览器发送了几次请求?  </span><br><span class="line">        <span class="number">1</span>次</span><br><span class="line">    <span class="number">2.</span>请求转发时,访问了几个Servlet?  </span><br><span class="line">      多个,被访问的多个servlet称之为请求链,或请求串</span><br><span class="line">    <span class="number">3.</span>请求转发时,浏览器地址显示的是哪个Servlet的地址?  </span><br><span class="line">      第一个Servlet的地址</span><br><span class="line">    <span class="number">4.</span>请求转发时多个Servlet之间能否共享Request对象?</span><br><span class="line">      可以共享Request对象</span><br><span class="line">    <span class="number">5.</span>请求转发,能转发到哪些位置?</span><br><span class="line">      请求转发是服务器内部行为,只能在当前服务器内转发</span><br><span class="line">重定向:</span><br><span class="line">		概念: 改变方向,发送多次请求</span><br><span class="line">		跳转的方向: 可以跳转到任何位置</span><br><span class="line">		<span class="number">1.</span>浏览器发送了几次请求?</span><br><span class="line">   			多次</span><br><span class="line">		<span class="number">2.</span>浏览器地址栏显示的是那次请求的地址?</span><br><span class="line">   			最后一次请求的路径</span><br><span class="line">		<span class="number">3.</span>重定向是否可以共享Request对象?</span><br><span class="line">   			不可以</span><br><span class="line">		<span class="number">4.</span>重定向的路径可以为任意路径</span><br></pre></td></tr></table></figure>





<h5 id="refresh-定时刷新"><a href="#refresh-定时刷新" class="headerlink" title="refresh:定时刷新"></a>refresh:定时刷新</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;秒数;url=跳转的路径&quot;</span>); 几秒之后跳转到指定的路径上</span><br></pre></td></tr></table></figure>

<p><strong>课堂代码</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/refresh&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RefreshServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;RefreshServlet执行了&quot;</span>);</span><br><span class="line">        <span class="comment">// 设置定时跳转</span></span><br><span class="line">      	<span class="comment">// 单位为 秒 </span></span><br><span class="line">        response.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;5;url=https://www.baidu.com&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.doPost(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="content-type-设置响应文件的mime类型"><a href="#content-type-设置响应文件的mime类型" class="headerlink" title="content-type:设置响应文件的mime类型"></a>content-type:设置响应文件的mime类型</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">作用:</span><br><span class="line">	设置响应文件的类型</span><br><span class="line">    设置响应流的编码方式</span><br><span class="line">    通知浏览器使用指定的编码解析</span><br><span class="line">方式<span class="number">1</span>: 了解</span><br><span class="line">	response.setHeader(<span class="string">&quot;content-type&quot;</span>,<span class="string">&quot;mime类型;charset=编码&quot;</span>);</span><br><span class="line">	response.setHeader(<span class="string">&quot;content-type&quot;</span>,<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">方式<span class="number">2</span>: 掌握</span><br><span class="line">	response.setContentType(<span class="string">&quot;文件的mime类型;charset=utf-8&quot;</span>);</span><br></pre></td></tr></table></figure>

<p><strong>示例代码</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/contentType&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ContentTypeServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 方式1: 了解</span></span><br><span class="line">        <span class="comment">// 设置响应信息的mime类型</span></span><br><span class="line">        <span class="comment">// 设置响应流的编码方式</span></span><br><span class="line">        <span class="comment">// 通知浏览器使用指定的编码解析</span></span><br><span class="line">        <span class="comment">//response.setHeader(&quot;content-type&quot;,&quot;text/html;charset=utf-8&quot;);</span></span><br><span class="line">        <span class="comment">// 方式2: 掌握</span></span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">        response.getWriter().print(<span class="string">&quot;&lt;h1&gt;Success 成功&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.doPost(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="content-disposition-文件下载专用头"><a href="#content-disposition-文件下载专用头" class="headerlink" title="content-disposition:文件下载专用头"></a>content-disposition:文件下载专用头</h5><p>​            response.setHeader(“content-disposition”,”attachment;filename=”+文件名称);</p>
<h3 id="2-3-操作响应体"><a href="#2-3-操作响应体" class="headerlink" title="2.3 操作响应体:"></a>2.3 操作响应体:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">响应体: 存放需要浏览器解析的内容,在浏览器上展示的内容</span><br></pre></td></tr></table></figure>

<h4 id="常用API-2"><a href="#常用API-2" class="headerlink" title="常用API:"></a>常用API:</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">作用:</span><br><span class="line">	将要响应给浏览器的信息返回,通过响应输出流返回给浏览器.</span><br><span class="line">	<span class="function">PrintWriter <span class="title">getWriter</span><span class="params">()</span>:字符流</span></span><br><span class="line"><span class="function">	ServletOutputStream <span class="title">getOutputStream</span><span class="params">()</span>:字节流</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">注意事项:</span></span><br><span class="line"><span class="function">	自己编写的文件   一般都使用字符流输出 如:txt  html等</span></span><br><span class="line"><span class="function">	音频,视频等文件使用字节流输出</span></span><br><span class="line"><span class="function">	</span></span><br><span class="line"><span class="function">	字节流和字符流互斥,不能同时使用！！！！！！</span></span><br><span class="line"><span class="function">	底层使用的是高效缓冲流；</span></span><br><span class="line"><span class="function">	服务器会帮我们释放资源,建议自己关闭</span>;</span><br></pre></td></tr></table></figure>

<p><strong>示例代码</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/responseBody&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResponseBodyServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">        <span class="comment">// 字节流和字符流不能同时存在,这两个流互斥</span></span><br><span class="line">        <span class="comment">// ServletOutputStream outputStream = response.getOutputStream();</span></span><br><span class="line">        <span class="comment">//获取响应输出流  字符流</span></span><br><span class="line">        PrintWriter writer = response.getWriter();</span><br><span class="line">        writer.print(<span class="string">&quot;&lt;table border=&#x27;1px&#x27;&gt;&quot;</span>);</span><br><span class="line">            writer.print(<span class="string">&quot;&lt;tr&gt;&quot;</span>);</span><br><span class="line">                writer.print(<span class="string">&quot;&lt;th&gt;学号&lt;/th&gt;&quot;</span>);</span><br><span class="line">                writer.print(<span class="string">&quot;&lt;th&gt;姓名&lt;/th&gt;&quot;</span>);</span><br><span class="line">            writer.print(<span class="string">&quot;&lt;/tr&gt;&quot;</span>);</span><br><span class="line">            writer.print(<span class="string">&quot;&lt;tr&gt;&quot;</span>);</span><br><span class="line">                writer.print(<span class="string">&quot;&lt;td&gt;1&lt;/td&gt;&quot;</span>);</span><br><span class="line">                writer.print(<span class="string">&quot;&lt;td&gt;大幂幂&lt;/td&gt;&quot;</span>);</span><br><span class="line">            writer.print(<span class="string">&quot;&lt;/tr&gt;&quot;</span>);</span><br><span class="line">            writer.print(<span class="string">&quot;&lt;tr&gt;&quot;</span>);</span><br><span class="line">                writer.print(<span class="string">&quot;&lt;td&gt;2&lt;/td&gt;&quot;</span>);</span><br><span class="line">                writer.print(<span class="string">&quot;&lt;td&gt;宝强&lt;/td&gt;&quot;</span>);</span><br><span class="line">            writer.print(<span class="string">&quot;&lt;/tr&gt;&quot;</span>);</span><br><span class="line">        writer.print(<span class="string">&quot;&lt;/table&gt;&quot;</span>);</span><br><span class="line">        writer.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.doPost(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">响应行:</span><br><span class="line">  	setStatus();  <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line">  	sendError();  <span class="number">4</span> <span class="number">5</span> </span><br><span class="line">响应头:</span><br><span class="line">        setHeader(String,String);</span><br><span class="line">        		location: 重定向,设置重定向的路径,结合<span class="number">302</span>使用</span><br><span class="line">        		refresh: 定时刷新</span><br><span class="line">        		★content-type: 设置响应文件的mime类型</span><br><span class="line">          			设置响应文件的mime类型(告诉浏览器本次返回的是什么格式的数据)</span><br><span class="line">          			设置响应流的编码(响应的数据使用这个编码)</span><br><span class="line">          			通知浏览器使用指定的编码解析</span><br><span class="line">    	sendRedirect(<span class="string">&quot;重定向的路径&quot;</span>); 重定向  这是重定向的方法<span class="number">2</span>；</span><br><span class="line">    	setContentType(<span class="string">&quot;mime类型&quot;</span>);  设置响应文件类型的方法<span class="number">2</span>；</span><br><span class="line">		content-disposition: 文件下载专用头,文件下载时使用</span><br><span class="line">         		attachment;filename=默认名称</span><br><span class="line">响应体:</span><br><span class="line">		getWriter(); <span class="comment">// 字符流</span></span><br><span class="line">		getOutputStream(); <span class="comment">// 字节流 跟 字符流 只能取其一！</span></span><br></pre></td></tr></table></figure>



<h2 id="第三章-ServletContext"><a href="#第三章-ServletContext" class="headerlink" title="第三章 ServletContext"></a>第三章 ServletContext</h2><p><strong>上下文:</strong> 知上知下,知全局,知道一个项目发生的一切</p>
<p><strong>上下文对象：</strong>全局管理者,管理一个项目中所有的Servlet,可以在这些servlet之间共享数据信息</p>
<p><strong>上下文对象的获取：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方式1: 通过配置信息对象获取上下文对象</span></span><br><span class="line">ServletConfig servletConfig = getServletConfig();</span><br><span class="line">ServletContext servletContext = servletConfig.getServletContext();</span><br><span class="line">System.out.println(servletContext);</span><br><span class="line"><span class="comment">// 方式2: 直接在Servlet中调用getServletContext获取上下文对象</span></span><br><span class="line">ServletContext servletContext1 = getServletContext();</span><br><span class="line">System.out.println(servletContext1);</span><br></pre></td></tr></table></figure>

<h3 id="作用"><a href="#作用" class="headerlink" title="作用:"></a>作用:</h3><p>给项目中的servlet提供一些通用的功能.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> 获取文件的mime类型     </span><br><span class="line"><span class="number">2</span> 资源共享</span><br><span class="line"><span class="number">3</span> 获取资源的完整路径</span><br></pre></td></tr></table></figure>

<h5 id="1-掌握-获取一个文件的mime类型"><a href="#1-掌握-获取一个文件的mime类型" class="headerlink" title="1: (掌握)获取一个文件的mime类型"></a>1: (掌握)获取一个文件的mime类型</h5><p>​        String getMimeType(String 文件名)  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   String filename = <span class="string">&quot;index.html&quot;</span></span><br><span class="line"><span class="comment">// 获取上下文对象</span></span><br><span class="line">   ServletContext context = getServletContext();</span><br><span class="line">   <span class="comment">// 获取文件的mime类型</span></span><br><span class="line">   String mimeType = context.getMimeType(filename);</span><br></pre></td></tr></table></figure>



<h5 id="2-掌握-资源共享-相当于一个map集合"><a href="#2-掌握-资源共享-相当于一个map集合" class="headerlink" title="2: (掌握)资源共享: 相当于一个map集合"></a>2: (掌握)资源共享: 相当于一个map集合</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">1</span> <span class="string">setAttribute(String name,Object value): 设置  注意：设置相同名称的属性就是修改</span></span><br><span class="line"><span class="attr">2</span> <span class="string">getAttribute(String name):获取指定的属性值</span></span><br><span class="line"><span class="attr">3</span> <span class="string">removeAttribute(String name):移除指定的属性</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/setAttr&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SetAttrServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">        ServletContext servletContext = getServletContext();</span><br><span class="line">        <span class="comment">// 设置数据信息</span></span><br><span class="line">        servletContext.setAttribute(<span class="string">&quot;str&quot;</span>,<span class="string">&quot;高明辉，好好加油！！！&quot;</span>);</span><br><span class="line">        response.getWriter().print(<span class="string">&quot;往上下文对象中设置数据信息成功&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/getAttr&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetAttrServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">        <span class="comment">// 从上下文对象中获取数据信息</span></span><br><span class="line">        ServletContext servletContext = getServletContext();</span><br><span class="line">        Object str = servletContext.getAttribute(<span class="string">&quot;str&quot;</span>);</span><br><span class="line">        response.getWriter().print(<span class="string">&quot;获取到的内容为: &quot;</span>+str);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h5 id="3-掌握-获取资源在服务器上的路径"><a href="#3-掌握-获取资源在服务器上的路径" class="headerlink" title="3: (掌握)获取资源在服务器上的路径"></a>3: (掌握)获取资源在服务器上的路径</h5><p>​        String getRealPath(String filepath)</p>
<p>​        注意:filepath:直接从项目的根目录开始写</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/getRealPath&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetRealPathServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        String filename = request.getParameter(<span class="string">&quot;filename&quot;</span>);</span><br><span class="line">        <span class="comment">// 获取上下文对象</span></span><br><span class="line">        ServletContext context = getServletContext();</span><br><span class="line">        <span class="comment">// 获取文件在服务器上的绝对路径</span></span><br><span class="line">        String realPath1 = context.getRealPath(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        String realPath2 = context.getRealPath(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        String realPath3 = context.getRealPath(<span class="string">&quot;/download/&quot;</span>+filename);</span><br><span class="line">        System.out.println(realPath1);</span><br><span class="line">        System.out.println(realPath2);</span><br><span class="line">        System.out.println(realPath3);</span><br><span class="line">        <span class="comment">//E:\java\MyCode\day01_web\target\day01_web-1.0-SNAPSHOT\</span></span><br><span class="line">        <span class="comment">//E:\java\MyCode\day01_web\target\day01_web-1.0-SNAPSHOT\</span></span><br><span class="line">        <span class="comment">//E:\java\MyCode\day01_web\target\day01_web-1.0-SNAPSHOT\download\meinv.png</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期:"></a>生命周期:</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">创建</span>:<span class="string">当服务器启动的时候,服务器会为每一个项目创建servletcontext对象,</span></span><br><span class="line">	<span class="attr">一个项目有且仅有一个servletcontext对象</span></span><br><span class="line"><span class="meta">销毁</span>:<span class="string">项目从服务器上移除或者服务器关闭的时候</span></span><br><span class="line">        </span><br><span class="line"><span class="attr">servletContext对象与项目共存亡</span></span><br></pre></td></tr></table></figure>



<h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><p>案例1 : 10秒钟之后跳转到百度官网(定时刷新)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;10;url=路径);</span></span><br></pre></td></tr></table></figure>

<p>案例2：使用location响应头实现跳转(重定向)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">response.setStatus(<span class="number">302</span>);</span><br><span class="line">response.setHeader(<span class="string">&quot;location&quot;</span>,<span class="string">&quot;路径&quot;</span>);</span><br><span class="line"></span><br><span class="line">response.sendRedirect(<span class="string">&quot;路径&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>案例3：向浏览器输出中文数据(无乱码)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.setContentType(<span class="string">&quot;mime类型&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>案例4：点击切换验证码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">防止暴力破解:</span><br><span class="line">	使用程序一次一次的尝试.</span><br><span class="line">    动态验证码</span><br></pre></td></tr></table></figure>



<p>案例5：文件下载</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">需求分析:</span><br><span class="line">当用户在浏览器上点击<span class="string">&quot;下载&quot;</span>超链接时,向服务器发送一个下载资源的请求,</span><br><span class="line">将服务器上的资源文件,以流的形式返回给浏览器,保存在用户电脑上.</span><br><span class="line"></span><br><span class="line">技术分析:两个头,一个流:</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> 两个头指的是：响应头  文件下载专用头</span><br><span class="line">    (<span class="number">1</span>)mime类型头: 告诉浏览器本次携带的附件类型是什么</span><br><span class="line">    			setContentType(<span class="string">&quot;mime类型&quot;</span>)</span><br><span class="line">	(<span class="number">2</span>)文件下载头：告诉浏览器本次响应携带了一个附件,需要单独保存而不是展示的。</span><br><span class="line">    			参数：content-disposition: attachment;filename=默认名称</span><br><span class="line">          	</span><br><span class="line"><span class="number">2</span> 一个流指的是：响应输出流 (字符跟字节流只能是其一)</span><br><span class="line">	response.getWriter(); 字符流</span><br><span class="line">	response.getOutputStream(); 字节流</span><br><span class="line"></span><br><span class="line">步骤分析:</span><br><span class="line">    前端:</span><br><span class="line">    	&lt;a href=<span class="string">&quot;download?filename=meinv.png&quot;</span>&gt;下载【美女的诱惑】&lt;/a&gt;</span><br><span class="line">        &lt;a href=<span class="string">&quot;download?filename=美女.txt&quot;</span>&gt;下载【回家的诱惑】&lt;/a&gt;</span><br><span class="line">        &lt;a href=<span class="string">&quot;download?filename=下课.mp4&quot;</span>&gt;下载【下课的诱惑】&lt;/a&gt;</span><br><span class="line">            </span><br><span class="line">	后台:DownloadServlet: /download</span><br><span class="line">          <span class="comment">//0.获取要下载的文件的名称  meinv.png</span></span><br><span class="line">          String filename = request.getParameter(<span class="string">&quot;filename&quot;</span>);</span><br><span class="line">          <span class="comment">//1.设置文件下载专用头</span></span><br><span class="line">          response.setHeader(<span class="string">&quot;content-disposition&quot;</span>,<span class="string">&quot;attachment;filename=&quot;</span>+filename);</span><br><span class="line">        <span class="comment">//2.设置下载文件的mime类型</span></span><br><span class="line">        <span class="comment">// 获取下载的文件的mime类型</span></span><br><span class="line">        ServletContext context = getServletContext();</span><br><span class="line">        String mimeType = context.getMimeType(filename);</span><br><span class="line">        response.setContentType(mimeType);</span><br><span class="line">        <span class="comment">//3.一个流:将被加载的文件以流的形式写回给浏览器</span></span><br><span class="line">        <span class="comment">// 获取被下载的文件的路径</span></span><br><span class="line">        String fileUrl = context.getRealPath(<span class="string">&quot;/download/&quot;</span>+filename);</span><br><span class="line">        <span class="comment">// 读取被下载的文件</span></span><br><span class="line">        InputStream is = <span class="keyword">new</span> FileInputStream(fileUrl);</span><br><span class="line">        <span class="comment">// 将被加载的文件以流的形式写回给浏览器</span></span><br><span class="line">        ServletOutputStream os = response.getOutputStream();</span><br><span class="line">        <span class="comment">// 文件拷贝</span></span><br><span class="line">          <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">          <span class="keyword">byte</span> []b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">          <span class="keyword">while</span>((len=is.read(b))!=-<span class="number">1</span>)&#123;</span><br><span class="line">              os.write(b,<span class="number">0</span>,len);</span><br><span class="line">          &#125;</span><br><span class="line">				  os.close();</span><br><span class="line">					is.close();</span><br></pre></td></tr></table></figure>

<p>课堂代码</p>
<p>（1）前端   download.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="keyword">function</span> <span class="title">isIE</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="comment">//获取当前浏览器相关信息</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> explorer = <span class="built_in">window</span>.navigator.userAgent.toLowerCase() ;</span></span><br><span class="line"><span class="javascript">            <span class="comment">//判断是否是ie浏览器</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (explorer.indexOf(<span class="string">&quot;msie&quot;</span>) &gt;= <span class="number">0</span> || explorer.indexOf(<span class="string">&quot;rv:11.0) like gecko&quot;</span>) &gt;=</span></span><br><span class="line"><span class="javascript">                <span class="number">0</span>)     &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="javascript">            &#125;<span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">        onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span>(isIE())&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">//在是IE浏览器的情况下，对中文请求参数编码</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> str = <span class="built_in">document</span>.getElementById(<span class="string">&quot;ww&quot;</span>).href;</span></span><br><span class="line"><span class="javascript">                str = <span class="built_in">encodeURI</span>(str);</span></span><br><span class="line"><span class="javascript">                <span class="built_in">document</span>.getElementById(<span class="string">&quot;ww&quot;</span>).href = str;</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;;</span></span><br><span class="line"><span class="javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>资源下载<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;download?filename=meinv.png&quot;</span>&gt;</span>下载【美女的诱惑】<span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;download?filename=1.jpg&quot;</span>&gt;</span>下载【回家的诱惑】<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;download?filename=大数据简单理解.txt&quot;</span> <span class="attr">id</span>=<span class="string">&quot;ww&quot;</span>&gt;</span>下载【下课的诱惑】<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（2）Servlet类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.f_download;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletContext;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletOutputStream;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.net.URLEncoder;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/download&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DownloadServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">//0.获取要下载的文件的名称  meinv.png</span></span><br><span class="line">        String filename = request.getParameter(<span class="string">&quot;filename&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;要下载的文件名称为: &quot;</span>+filename);</span><br><span class="line">        <span class="comment">//1.设置文件下载专用头</span></span><br><span class="line">        <span class="comment">// <span class="doctag">TODO:</span>注意,文件下载时,文件的名称使用浏览器默认的解码方式进行解码</span></span><br><span class="line">        <span class="comment">// 解决方案,使用浏览器的解码方式进行对文件名称编码</span></span><br><span class="line">        String downloadName = URLEncoder.encode(filename,<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;编码后的文件名为: &quot;</span>+downloadName);</span><br><span class="line">        response.setHeader(<span class="string">&quot;content-disposition&quot;</span>,<span class="string">&quot;attachment;filename=&quot;</span>+downloadName);</span><br><span class="line">        <span class="comment">//2.设置下载文件的mime类型</span></span><br><span class="line">        <span class="comment">// 利用上下文对象方法获取下载的文件的mime类型，然后设置mime类型。</span></span><br><span class="line">        ServletContext context = getServletContext();</span><br><span class="line">        String mimeType = context.getMimeType(filename);</span><br><span class="line">        response.setContentType(mimeType);</span><br><span class="line">        <span class="comment">//3.一个流:将被加载的文件以流的形式写回给浏览器</span></span><br><span class="line">        <span class="comment">// 获取被下载的文件的路径</span></span><br><span class="line">        String fileUrl = context.getRealPath(<span class="string">&quot;/download/&quot;</span>+filename);</span><br><span class="line">        <span class="comment">// 读取被下载的文件</span></span><br><span class="line">        InputStream is = <span class="keyword">new</span> FileInputStream(fileUrl);</span><br><span class="line">        <span class="comment">// 将被加载的文件以流的形式写回给浏览器</span></span><br><span class="line">        ServletOutputStream os = response.getOutputStream();</span><br><span class="line">        <span class="comment">// 文件拷贝</span></span><br><span class="line">        <span class="comment">/*int len = 0;</span></span><br><span class="line"><span class="comment">        byte []b = new byte[1024];</span></span><br><span class="line"><span class="comment">        while((len=is.read(b))!=-1)&#123;</span></span><br><span class="line"><span class="comment">            os.write(b,0,len);</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">        IOUtils.copy(is,os); <span class="comment">//导入commons-io-1.4.jar 后可以直接使用封装方法啦！</span></span><br><span class="line">        os.close();</span><br><span class="line">        is.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.doPost(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<p>（1）解决点击下载时文件名中文乱码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解决方案,使用浏览器的解码方式进行对文件名称编码后再设置response参数。</span></span><br><span class="line">String downloadName = URLEncoder.encode(filename,<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;编码后的文件名为: &quot;</span>+downloadName);</span><br><span class="line">response.setHeader(<span class="string">&quot;content-disposition&quot;</span>,<span class="string">&quot;attachment;filename=&quot;</span>+downloadName);</span><br></pre></td></tr></table></figure>

<p>（2）对于IE浏览器的特殊下载，在download.html文件中head标签添加了预处理代码</p>
<p>（3）在流传输下载文件时，可以导入commons-io-1.4.jar 后可以直接使用封装方法IOUtils.copy(is,os); </p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>：request: 请求信息对象,用于封装请求携带的所有数据信息</span><br><span class="line">    http协议-请求:</span><br><span class="line">      请求行: 请求方式 请求资源 协议/版本</span><br><span class="line">      请求头: 约束请求携带的相关数据</span><br><span class="line">          referer  user-agent</span><br><span class="line">      请求体:</span><br><span class="line">          存放post请求携带的参数信息,get请求没有请求体</span><br><span class="line">   	API: 请求来的时候tomcat会自动解析请求行头体信息,并封装到request对象中</span><br><span class="line">		getMethod();</span><br><span class="line">        getContextPath();</span><br><span class="line">        getParameter(<span class="string">&quot;键&quot;</span>);</span><br><span class="line">        getParameterValue(<span class="string">&quot;键&quot;</span>);</span><br><span class="line">        getParameterMap();</span><br><span class="line">        getHeader(<span class="string">&quot;头名称&quot;</span>);</span><br><span class="line">        setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">		作用域:</span><br><span class="line">			作用范围: 本次请求,本次请求链</span><br><span class="line">      		资源共享:</span><br><span class="line">					setAttribute(String,Object);</span><br><span class="line">					getAttribute(String);</span><br><span class="line">					removeAttribute(String);</span><br><span class="line">		生命周期:</span><br><span class="line">			创建: 请求来的时候创建</span><br><span class="line">      		销毁: 响应生成的时候</span><br><span class="line">                </span><br><span class="line">		请求转发: 一次请求的延续,服务内部行为</span><br><span class="line">			request.getRequestDispatcher(<span class="string">&quot;请求转发路径&quot;</span>).forward(req,resp);</span><br><span class="line">			应用场景:  将一个复杂的业务拆分成多个步骤,方便调用和维护</span><br><span class="line"><span class="number">2</span>：response: 响应信息对象,用于封装响应的数据信息给浏览器</span><br><span class="line">		http协议-响应:  </span><br><span class="line">		(<span class="number">1</span>)响应行: 协议/版本 状态码</span><br><span class="line">          		其中状态码有：<span class="number">200</span> <span class="number">302</span> <span class="number">304</span> <span class="number">404</span> <span class="number">405</span> <span class="number">500</span></span><br><span class="line">		(<span class="number">2</span>)响应头: 约束响应信息的格式</span><br><span class="line">          	location</span><br><span class="line">          	refresh</span><br><span class="line">          	content-type: 设置响应文件的mime类型</span><br><span class="line">            content-disposition: 文件下载专用头</span><br><span class="line">		(<span class="number">3</span>)响应体: 存放需要浏览器解析的内容</span><br></pre></td></tr></table></figure>



</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">高明辉</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/03/29/web-06-http%E5%8D%8F%E8%AE%AE%E5%93%8D%E5%BA%94-Servlet%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/">http://example.com/2022/03/29/web-06-http%E5%8D%8F%E8%AE%AE%E5%93%8D%E5%BA%94-Servlet%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Jason</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/http%E5%93%8D%E5%BA%94/">http响应</a><a class="post-meta__tags" href="/tags/Servlet%E5%A4%84%E7%90%86%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/">Servlet处理文件下载</a><a class="post-meta__tags" href="/tags/servlet/">servlet</a></div><div class="post_share"><div class="social-share" data-image="/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day06-http-servlet/%E5%B0%81%E9%9D%A2.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="添加微信"/></a><div class="post-qr-code-desc">添加微信</div></li><li class="reward-item"><a href="/img/pay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/pay.jpg" alt="付款码"/></a><div class="post-qr-code-desc">付款码</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/03/31/web-07-cookie-session/"><img class="prev-cover" src="/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day07-cookie-session/%E5%B0%81%E9%9D%A2.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">web-07-cookie-session</div></div></a></div><div class="next-post pull-right"><a href="/2022/03/27/web-05-Servlet-http%E5%8D%8F%E8%AE%AE/"><img class="next-cover" src="/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day04-tomcat-servlet/%E5%B0%81%E9%9D%A2.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">web-05-Servlet-http协议</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/03/27/web-05-Servlet-http%E5%8D%8F%E8%AE%AE/" title="web-05-Servlet-http协议"><img class="cover" src="/img/java/03%E9%98%B6%E6%AE%B5Web%E6%A0%B8%E5%BF%83/day04-tomcat-servlet/%E5%B0%81%E9%9D%A2.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-27</div><div class="title">web-05-Servlet-http协议</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E7%AF%87%E5%8D%9A%E5%AE%A2%E5%86%85%E5%AE%B9%E5%9B%9E%E9%A1%BE"><span class="toc-number">1.</span> <span class="toc-text">上篇博客内容回顾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E4%BF%A1%E6%81%AF%E5%AF%B9%E8%B1%A1-Request"><span class="toc-number">2.</span> <span class="toc-text">请求信息对象-Request</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">2.1.</span> <span class="toc-text">作用域</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-http%E5%8D%8F%E8%AE%AE-%E5%93%8D%E5%BA%94"><span class="toc-number">3.</span> <span class="toc-text">第一章 http协议-响应</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86-p"><span class="toc-number">3.1.</span> <span class="toc-text">1.1 组成部分:\p;]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%93%8D%E5%BA%94%E8%A1%8C"><span class="toc-number">3.2.</span> <span class="toc-text">1.2 响应行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E5%93%8D%E5%BA%94%E5%A4%B4"><span class="toc-number">3.3.</span> <span class="toc-text">1.3 响应头</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.3.0.1.</span> <span class="toc-text">格式:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%93%8D%E5%BA%94%E5%A4%B4"><span class="toc-number">3.3.0.2.</span> <span class="toc-text">常见的响应头</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%87%8D%E7%82%B9%E7%9A%84%E5%A4%B4"><span class="toc-number">3.3.0.3.</span> <span class="toc-text">重点的头:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E5%93%8D%E5%BA%94%E4%BD%93"><span class="toc-number">3.4.</span> <span class="toc-text">1.4 响应体</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-response%E2%98%85"><span class="toc-number">4.</span> <span class="toc-text">第二章 response★</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%93%8D%E4%BD%9C%E5%93%8D%E5%BA%94%E8%A1%8C"><span class="toc-number">4.1.</span> <span class="toc-text">2.1 操作响应行:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8API"><span class="toc-number">4.1.1.</span> <span class="toc-text">常用API</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-number">4.1.1.1.</span> <span class="toc-text">示例代码:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%93%8D%E4%BD%9C%E5%93%8D%E5%BA%94%E5%A4%B4"><span class="toc-number">4.2.</span> <span class="toc-text">2.2 操作响应头:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8API-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">常用API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%93%8D%E5%BA%94%E5%A4%B4-1"><span class="toc-number">4.2.2.</span> <span class="toc-text">常见的响应头</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#location-%E9%87%8D%E5%AE%9A%E5%90%91%E2%98%85%E2%98%85%E2%98%85"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">location:重定向★★★</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91%E5%8C%BA%E5%88%AB"><span class="toc-number">4.3.</span> <span class="toc-text">请求转发与重定向区别</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#refresh-%E5%AE%9A%E6%97%B6%E5%88%B7%E6%96%B0"><span class="toc-number">4.3.0.1.</span> <span class="toc-text">refresh:定时刷新</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#content-type-%E8%AE%BE%E7%BD%AE%E5%93%8D%E5%BA%94%E6%96%87%E4%BB%B6%E7%9A%84mime%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.3.0.2.</span> <span class="toc-text">content-type:设置响应文件的mime类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#content-disposition-%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E4%B8%93%E7%94%A8%E5%A4%B4"><span class="toc-number">4.3.0.3.</span> <span class="toc-text">content-disposition:文件下载专用头</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%93%8D%E4%BD%9C%E5%93%8D%E5%BA%94%E4%BD%93"><span class="toc-number">4.4.</span> <span class="toc-text">2.3 操作响应体:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8API-2"><span class="toc-number">4.4.1.</span> <span class="toc-text">常用API:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">4.5.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-ServletContext"><span class="toc-number">5.</span> <span class="toc-text">第三章 ServletContext</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E7%94%A8"><span class="toc-number">5.1.</span> <span class="toc-text">作用:</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E6%8E%8C%E6%8F%A1-%E8%8E%B7%E5%8F%96%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E7%9A%84mime%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.1.0.1.</span> <span class="toc-text">1: (掌握)获取一个文件的mime类型</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E6%8E%8C%E6%8F%A1-%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB-%E7%9B%B8%E5%BD%93%E4%BA%8E%E4%B8%80%E4%B8%AAmap%E9%9B%86%E5%90%88"><span class="toc-number">5.1.0.2.</span> <span class="toc-text">2: (掌握)资源共享: 相当于一个map集合</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-%E6%8E%8C%E6%8F%A1-%E8%8E%B7%E5%8F%96%E8%B5%84%E6%BA%90%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%9A%84%E8%B7%AF%E5%BE%84"><span class="toc-number">5.1.0.3.</span> <span class="toc-text">3: (掌握)获取资源在服务器上的路径</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">5.2.</span> <span class="toc-text">生命周期:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-number">6.</span> <span class="toc-text">案例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">7.</span> <span class="toc-text">总结</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 高明辉</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'Aaee0Vekhg5KbLhMOJQrEU6A-gzGzoHsz',
      appKey: 'mmLHPEEtqvOSJhsqWra8Sq6K',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script type="text/javascript" src="/js/fairyDustCursor.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>